(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){t.exports=n("zUnb")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},"4ZJM":function(t,e,n){t.exports=function(){"use strict";var t,e,n;function r(r,i){if(t)if(e){var a="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",s={};t(s),(n=i(s)).workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))}else e=i;else t=i}return r(0,(function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=r;function r(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=n,this.p2y=r}r.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},r.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},r.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},r.prototype.solveCurveX=function(t,e){var n,r,i,a,s;for(void 0===e&&(e=1e-6),i=t,s=0;s<8;s++){if(a=this.sampleCurveX(i)-t,Math.abs(a)<e)return i;var o=this.sampleCurveDerivativeX(i);if(Math.abs(o)<1e-6)break;i-=a/o}if((i=t)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(a=this.sampleCurveX(i),Math.abs(a-t)<e)return i;t>a?n=i:r=i,i=.5*(r-n)+n}return i},r.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=a;function a(t,e){this.x=t,this.y=e}function s(t,e,r,i){var a=new n(t,e,r,i);return function(t){return a.solve(t)}}a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-r*(this.y-e.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t};var o=s(.25,.1,.25,1);function l(t,e,n){return Math.min(n,Math.max(e,t))}function u(t,e,n){var r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i}function c(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var a=i[r];for(var s in a)t[s]=a[s]}return t}var h=1;function d(){return h++}function p(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function f(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function m(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function g(t,e){return-1!==t.indexOf(e,t.length-e.length)}function y(t,e,n){var r={};for(var i in t)r[i]=e.call(n||this,t[i],i,t);return r}function v(t,e,n){var r={};for(var i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function _(t){return Array.isArray(t)?t.map(_):"object"==typeof t&&t?y(t,_):t}var b={};function x(t){b[t]||("undefined"!=typeof console&&console.warn(t),b[t]=!0)}function w(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function S(t){for(var e=0,n=0,r=t.length,i=r-1,a=void 0,s=void 0;n<r;i=n++)e+=((s=t[i]).x-(a=t[n]).x)*(a.y+s.y);return e}function C(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function D(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,n,r,i){var a=r||i;return e[n]=!a||a.toLowerCase(),""})),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}var I=null;function k(t){if(null==I){var e=t.navigator?t.navigator.userAgent:null;I=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return I}function E(t){try{var e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var A,T,R,M,N=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),O=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,P=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,F={now:N,frame:function(t){var e=O(t);return{cancel:function(){return P(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var n=self.document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return A||(A=self.document.createElement("a")),A.href=t,A.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==T&&(T=self.matchMedia("(prefers-reduced-motion: reduce)")),T.matches)}},L={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},z={supported:!1,testSupport:function(t){!$&&M&&(B?W(t):R=t)}},$=!1,B=!1;function W(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,M),t.isContextLost())return;z.supported=!0}catch(t){}t.deleteTexture(e),$=!0}self.document&&((M=self.document.createElement("img")).onload=function(){R&&W(R),R=null,B=!0},M.onerror=function(){$=!0,R=null},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var q="01",V=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function U(t){return 0===t.indexOf("mapbox:")}V.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",q,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},V.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},V.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},V.prototype.normalizeStyleURL=function(t,e){if(!U(t))return t;var n=J(t);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},V.prototype.normalizeGlyphsURL=function(t,e){if(!U(t))return t;var n=J(t);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},V.prototype.normalizeSourceURL=function(t,e){if(!U(t))return t;var n=J(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)},V.prototype.normalizeSpriteURL=function(t,e,n,r){var i=J(t);return U(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+n,this._makeAPIURL(i,this._customAccessToken||r)):(i.path+=""+e+n,X(i))},V.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!U(t))return t;var n=J(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,(F.devicePixelRatio>=2||512===e?"@2x":"")+(z.supported?".webp":"$1")),n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/v4"+n.path;var r=this._customAccessToken||function(t){for(var e=0,n=t;e<n.length;e+=1){var r=n[e].match(/^access_token=(.*)$/);if(r)return r[1]}return null}(n.params)||L.ACCESS_TOKEN;return L.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&n.params.push("sku="+this._skuToken),this._makeAPIURL(n,r)},V.prototype.canonicalizeTileURL=function(t,e){var n=J(t);if(!n.path.match(/(^\/v4\/)/)||!n.path.match(/\.[\w]+$/))return t;var r="mapbox://tiles/";r+=n.path.replace("/v4/","");var i=n.params;return e&&(i=i.filter((function(t){return!t.match(/^access_token=/)}))),i.length&&(r+="?"+i.join("&")),r},V.prototype.canonicalizeTileset=function(t,e){for(var n=!!e&&U(e),r=[],i=0,a=t.tiles||[];i<a.length;i+=1){var s=a[i];H(s)?r.push(this.canonicalizeTileURL(s,n)):r.push(s)}return r},V.prototype._makeAPIURL=function(t,e){var n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",r=J(L.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"/"!==r.path&&(t.path=""+r.path+t.path),!L.REQUIRE_ACCESS_TOKEN)return X(t);if(!(e=e||L.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n);return t.params=t.params.filter((function(t){return-1===t.indexOf("access_token")})),t.params.push("access_token="+e),X(t)};var j=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function H(t){return j.test(t)}var G=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function J(t){var e=t.match(G);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function X(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function K(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(e[1]).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(t){return null}}var Z=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Z.prototype.getStorageKey=function(t){var e,n=K(L.ACCESS_TOKEN);return e=n&&n.u?self.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))}))):L.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},Z.prototype.fetchEventData=function(){var t=E("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{var r=self.localStorage.getItem(e);r&&(this.eventData=JSON.parse(r));var i=self.localStorage.getItem(n);i&&(this.anonId=i)}catch(t){x("Unable to read from LocalStorage")}},Z.prototype.saveEventData=function(){var t=E("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{self.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){x("Unable to write to LocalStorage")}},Z.prototype.processRequests=function(t){},Z.prototype.postEvent=function(t,e,n,r){var i=this;if(L.EVENTS_URL){var a=J(L.EVENTS_URL);a.params.push("access_token="+(r||L.ACCESS_TOKEN||""));var s={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:q,userId:this.anonId},o=e?c(s,e):s,l={url:X(a),headers:{"Content-Type":"text/plain"},body:JSON.stringify([o])};this.pendingRequest=_t(l,(function(t){i.pendingRequest=null,n(t),i.saveEventData(),i.processRequests(r)}))}},Z.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var Y,Q,tt=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(t,e,n,r){this.skuToken=n,(L.EVENTS_URL&&r||L.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return U(t)||H(t)})))&&this.queueRequest({id:e,timestamp:Date.now()},r)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),r=n.id,i=n.timestamp;r&&this.success[r]||(this.anonId||this.fetchEventData(),f(this.anonId)||(this.anonId=p()),this.postEvent(i,{skuToken:this.skuToken},(function(t){t||r&&(e.success[r]=!0)}),t))}},e}(Z),et=new(function(t){function e(e){t.call(this,"appUserTurnstile"),this._customAccessToken=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(t,e){L.EVENTS_URL&&L.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return U(t)||H(t)}))&&this.queueRequest(Date.now(),e)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var n=K(L.ACCESS_TOKEN),r=n?n.u:L.ACCESS_TOKEN,i=r!==this.eventData.tokenU;f(this.anonId)||(this.anonId=p(),i=!0);var a=this.queue.shift();if(this.eventData.lastSuccess){var s=new Date(this.eventData.lastSuccess),o=new Date(a),l=(a-this.eventData.lastSuccess)/864e5;i=i||l>=1||l<-1||s.getDate()!==o.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(a,{"enabled.telemetry":!1},(function(t){t||(e.eventData.lastSuccess=a,e.eventData.tokenU=r)}),t)}},e}(Z)),nt=et.postTurnstileEvent.bind(et),rt=new tt,it=rt.postMapLoadEvent.bind(rt),at=500,st=50;function ot(){self.caches&&!Y&&(Y=self.caches.open("mapbox-tiles"))}function lt(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var ut,ct=1/0;function ht(){return null==ut&&(ut=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),ut}var dt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(dt);var pt,ft,mt=function(t){function e(e,n,r){401===n&&H(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,e),this.status=n,this.url=r,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),gt=C()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},yt=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(gt())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return function(t,e){var n,r=new self.AbortController,i=new self.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:gt(),signal:r.signal}),a=!1,s=!1,o=(n=i.url).indexOf("sku=")>0&&H(n);"json"===t.type&&i.headers.set("Accept","application/json");var l=function(n,r,a){if(!s){if(n&&"SecurityError"!==n.message&&x(n),r&&a)return u(r);var l=Date.now();self.fetch(i).then((function(n){if(n.ok){var r=o?n.clone():null;return u(n,r,l)}return e(new mt(n.statusText,n.status,t.url))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}},u=function(n,r,o){("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((function(t){s||(r&&o&&function(t,e,n){if(ot(),Y){var r={status:e.status,statusText:e.statusText,headers:new self.Headers};e.headers.forEach((function(t,e){return r.headers.set(e,t)}));var i=D(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&r.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===Q)try{new Response(new ReadableStream),Q=!0}catch(t){Q=!1}Q?e(t.body):t.blob().then(e)}(e,(function(e){var n=new self.Response(e,r);ot(),Y&&Y.then((function(e){return e.put(lt(t.url),n)})).catch((function(t){return x(t.message)}))})))}}(i,r,o),a=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(t){s||e(new Error(t.message))}))};return o?function(t,e){if(ot(),!Y)return e(null);var n=lt(t.url);Y.then((function(t){t.match(n).then((function(r){var i=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),n=D(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(r);t.delete(n),i&&t.put(n,r.clone()),e(null,r,i)})).catch(e)})).catch(e)}(i,l):l(null,null),{cancel:function(){s=!0,a||r.abort()}}}(t,e);if(C()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){var n=new self.XMLHttpRequest;for(var r in n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)n.setRequestHeader(r,t.headers[r]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var r=n.response;if("json"===t.type)try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new mt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:function(){return n.abort()}}}(t,e)},vt=function(t,e){return yt(c(t,{type:"arrayBuffer"}),e)},_t=function(t,e){return yt(c(t,{method:"POST"}),e)};pt=[],ft=0;var bt=function(t,e){if(z.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ft>=L.MAX_PARALLEL_IMAGE_REQUESTS){var n={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return pt.push(n),n}ft++;var r=!1,i=function(){if(!r)for(r=!0,ft--;pt.length&&ft<L.MAX_PARALLEL_IMAGE_REQUESTS;){var t=pt.shift();t.cancelled||(t.cancel=bt(t.requestParameters,t.callback).cancel)}},a=vt(t,(function(t,n,r,a){i(),t?e(t):n&&(ht()?function(t,e){var n=new self.Blob([new Uint8Array(t)],{type:"image/png"});self.createImageBitmap(n).then((function(t){e(null,t)})).catch((function(t){e(new Error("Could not load image because of "+t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(n,e):function(t,e,n,r){var i=new self.Image,a=self.URL;i.onload=function(){e(null,i),a.revokeObjectURL(i.src)},i.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new self.Blob([new Uint8Array(t)],{type:"image/png"});i.cacheControl=n,i.expires=r,i.src=t.byteLength?a.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(n,e,r,a))}));return{cancel:function(){a.cancel(),i()}}};function xt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function wt(t,e,n){if(n&&n[t]){var r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}var St=function(t,e){void 0===e&&(e={}),c(this,e),this.type=t},Ct=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",c({error:e},n))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(St),Dt=function(){};Dt.prototype.on=function(t,e){return this._listeners=this._listeners||{},xt(t,e,this._listeners),this},Dt.prototype.off=function(t,e){return wt(t,e,this._listeners),wt(t,e,this._oneTimeListeners),this},Dt.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},xt(t,e,this._oneTimeListeners),this},Dt.prototype.fire=function(t,e){"string"==typeof t&&(t=new St(t,e||{}));var n=t.type;if(this.listens(n)){t.target=this;for(var r=0,i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];r<i.length;r+=1)i[r].call(this,t);for(var a=0,s=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];a<s.length;a+=1){var o=s[a];wt(n,o,this._oneTimeListeners),o.call(this,t)}var l=this._eventedParent;l&&(c(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(t))}else t instanceof Ct&&console.error(t.error);return this},Dt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Dt.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var It={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},kt=function(t,e,n,r){this.message=(t?t+": ":"")+n,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)};function Et(t){var e=t.value;return e?[new kt(t.key,e,"constants have been deprecated as of v8")]:[]}function At(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var a=i[r];for(var s in a)t[s]=a[s]}return t}function Tt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Rt(t){if(Array.isArray(t))return t.map(Rt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var n in t)e[n]=Rt(t[n]);return e}return Tt(t)}var Mt=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),Nt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,r=e;n<r.length;n+=1){var i=r[n];this.bindings[i[0]]=i[1]}};Nt.prototype.concat=function(t){return new Nt(this,t)},Nt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Nt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Ot={kind:"null"},Pt={kind:"number"},Ft={kind:"string"},Lt={kind:"boolean"},zt={kind:"color"},$t={kind:"object"},Bt={kind:"value"},Wt={kind:"collator"},qt={kind:"formatted"},Vt={kind:"resolvedImage"};function Ut(t,e){return{kind:"array",itemType:t,N:e}}function jt(t){if("array"===t.kind){var e=jt(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Ht=[Ot,Pt,Ft,Lt,zt,qt,$t,Ut(Bt),Vt];function Gt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Gt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,r=Ht;n<r.length;n+=1)if(!Gt(r[n],e))return null}return"Expected "+jt(t)+" but found "+jt(e)+" instead."}function Jt(t,e){return e.some((function(e){return e.kind===t.kind}))}function Xt(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var Kt=e((function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return r("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function a(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function s(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,o=t.replace(/ /g,"").toLowerCase();if(o in n)return n[o].slice();if("#"===o[0])return 4===o.length?(e=parseInt(o.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===o.length&&(e=parseInt(o.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=o.indexOf("("),u=o.indexOf(")");if(-1!==l&&u+1===o.length){var c=o.substr(0,l),h=o.substr(l+1,u-(l+1)).split(","),d=1;switch(c){case"rgba":if(4!==h.length)return null;d=a(h.pop());case"rgb":return 3!==h.length?null:[i(h[0]),i(h[1]),i(h[2]),d];case"hsla":if(4!==h.length)return null;d=a(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,f=a(h[1]),m=a(h[2]),g=m<=.5?m*(f+1):m+f-m*f,y=2*m-g;return[r(255*s(y,g,p+1/3)),r(255*s(y,g,p)),r(255*s(y,g,p-1/3)),d];default:return null}}return null}}catch(t){}})).parseCSSColor,Zt=function(t,e,n,r){void 0===r&&(r=1),this.r=t,this.g=e,this.b=n,this.a=r};Zt.parse=function(t){if(t){if(t instanceof Zt)return t;if("string"==typeof t){var e=Kt(t);if(e)return new Zt(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Zt.prototype.toString=function(){var t=this.toArray(),e=t[1],n=t[2],r=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(n)+","+r+")"},Zt.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Zt.black=new Zt(0,0,0,1),Zt.white=new Zt(1,1,1,1),Zt.transparent=new Zt(0,0,0,0),Zt.red=new Zt(1,0,0,1);var Yt=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Yt.prototype.compare=function(t,e){return this.collator.compare(t,e)},Yt.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Qt=function(t,e,n,r,i){this.text=t,this.image=e,this.scale=n,this.fontStack=r,this.textColor=i},te=function(t){this.sections=t};te.fromString=function(t){return new te([new Qt(t,null,null,null,null)])},te.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},te.factory=function(t){return t instanceof te?t:te.fromString(t)},te.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},te.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];if(r.image)t.push(["image",r.image.name]);else{t.push(r.text);var i={};r.fontStack&&(i["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(i["font-scale"]=r.scale),r.textColor&&(i["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(i)}}return t};var ee=function(t){this.name=t.name,this.available=t.available};function ne(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value ["+[t,e,n,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function re(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Zt)return!0;if(t instanceof Yt)return!0;if(t instanceof te)return!0;if(t instanceof ee)return!0;if(Array.isArray(t)){for(var e=0,n=t;e<n.length;e+=1)if(!re(n[e]))return!1;return!0}if("object"==typeof t){for(var r in t)if(!re(t[r]))return!1;return!0}return!1}function ie(t){if(null===t)return Ot;if("string"==typeof t)return Ft;if("boolean"==typeof t)return Lt;if("number"==typeof t)return Pt;if(t instanceof Zt)return zt;if(t instanceof Yt)return Wt;if(t instanceof te)return qt;if(t instanceof ee)return Vt;if(Array.isArray(t)){for(var e,n=t.length,r=0,i=t;r<i.length;r+=1){var a=ie(i[r]);if(e){if(e===a)continue;e=Bt;break}e=a}return Ut(e||Bt,n)}return $t}function ae(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Zt||t instanceof te||t instanceof ee?t.toString():JSON.stringify(t)}ee.prototype.toString=function(){return this.name},ee.fromString=function(t){return t?new ee({name:t,available:!1}):null},ee.prototype.serialize=function(){return["image",this.name]};var se=function(t,e){this.type=t,this.value=e};se.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!re(t[1]))return e.error("invalid value");var n=t[1],r=ie(n),i=e.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new se(r,n)},se.prototype.evaluate=function(){return this.value},se.prototype.eachChild=function(){},se.prototype.outputDefined=function(){return!0},se.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Zt?["rgba"].concat(this.value.toArray()):this.value instanceof te?this.value.serialize():this.value};var oe=function(t){this.name="ExpressionEvaluationError",this.message=t};oe.prototype.toJSON=function(){return this.message};var le={string:Ft,number:Pt,boolean:Lt,object:$t},ue=function(t,e){this.type=t,this.args=e};ue.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,r=1,i=t[0];if("array"===i){var a,s;if(t.length>2){var o=t[1];if("string"!=typeof o||!(o in le)||"object"===o)return e.error('The item type argument of "array" must be one of string, number, boolean',1);a=le[o],r++}else a=Bt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);s=t[2],r++}n=Ut(a,s)}else n=le[i];for(var l=[];r<t.length;r++){var u=e.parse(t[r],r,Bt);if(!u)return null;l.push(u)}return new ue(n,l)},ue.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Gt(this.type,ie(n)))return n;if(e===this.args.length-1)throw new oe("Expected value to be of type "+jt(this.type)+", but found "+jt(ie(n))+" instead.")}return null},ue.prototype.eachChild=function(t){this.args.forEach(t)},ue.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},ue.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var ce=function(t){this.type=qt,this.sections=t};ce.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");for(var r=[],i=!1,a=1;a<=t.length-1;++a){var s=t[a];if(i&&"object"==typeof s&&!Array.isArray(s)){i=!1;var o=null;if(s["font-scale"]&&!(o=e.parse(s["font-scale"],1,Pt)))return null;var l=null;if(s["text-font"]&&!(l=e.parse(s["text-font"],1,Ut(Ft))))return null;var u=null;if(s["text-color"]&&!(u=e.parse(s["text-color"],1,zt)))return null;var c=r[r.length-1];c.scale=o,c.font=l,c.textColor=u}else{var h=e.parse(t[a],1,Bt);if(!h)return null;var d=h.type.kind;if("string"!==d&&"value"!==d&&"null"!==d&&"resolvedImage"!==d)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:h,scale:null,font:null,textColor:null})}}return new ce(r)},ce.prototype.evaluate=function(t){return new te(this.sections.map((function(e){var n=e.content.evaluate(t);return ie(n)===Vt?new Qt("",n,null,null,null):new Qt(ae(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},ce.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}},ce.prototype.outputDefined=function(){return!1},ce.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t.push(r.content.serialize());var i={};r.scale&&(i["font-scale"]=r.scale.serialize()),r.font&&(i["text-font"]=r.font.serialize()),r.textColor&&(i["text-color"]=r.textColor.serialize()),t.push(i)}return t};var he=function(t){this.type=Vt,this.input=t};he.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Ft);return n?new he(n):e.error("No image name provided.")},he.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=ee.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n},he.prototype.eachChild=function(t){t(this.input)},he.prototype.outputDefined=function(){return!1},he.prototype.serialize=function(){return["image",this.input.serialize()]};var de={"to-boolean":Lt,"to-color":zt,"to-number":Pt,"to-string":Ft},pe=function(t,e){this.type=t,this.args=e};pe.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var r=de[n],i=[],a=1;a<t.length;a++){var s=e.parse(t[a],a,Bt);if(!s)return null;i.push(s)}return new pe(r,i)},pe.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,r=0,i=this.args;r<i.length;r+=1){if(n=null,(e=i[r].evaluate(t))instanceof Zt)return e;if("string"==typeof e){var a=t.parseColor(e);if(a)return a}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":ne(e[0],e[1],e[2],e[3])))return new Zt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new oe(n||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var s=null,o=0,l=this.args;o<l.length;o+=1){if(null===(s=l[o].evaluate(t)))return 0;var u=Number(s);if(!isNaN(u))return u}throw new oe("Could not convert "+JSON.stringify(s)+" to number.")}return"formatted"===this.type.kind?te.fromString(ae(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?ee.fromString(ae(this.args[0].evaluate(t))):ae(this.args[0].evaluate(t))},pe.prototype.eachChild=function(t){this.args.forEach(t)},pe.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},pe.prototype.serialize=function(){if("formatted"===this.type.kind)return new ce([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new he(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var fe=["Unknown","Point","LineString","Polygon"],me=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};me.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},me.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?fe[this.feature.type]:this.feature.type:null},me.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},me.prototype.canonicalID=function(){return this.canonical},me.prototype.properties=function(){return this.feature&&this.feature.properties||{}},me.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Zt.parse(t)),e};var ge=function(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r};ge.prototype.evaluate=function(t){return this._evaluate(t,this.args)},ge.prototype.eachChild=function(t){this.args.forEach(t)},ge.prototype.outputDefined=function(){return!1},ge.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},ge.parse=function(t,e){var n,r=t[0],i=ge.definitions[r];if(!i)return e.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var a=Array.isArray(i)?i[0]:i.type,s=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,o=s.filter((function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1})),l=null,u=0,c=o;u<c.length;u+=1){var h=c[u],d=h[0],p=h[1];l=new ze(e.registry,e.path,null,e.scope);for(var f=[],m=!1,g=1;g<t.length;g++){var y=t[g],v=Array.isArray(d)?d[g-1]:d.type,_=l.parse(y,1+f.length,v);if(!_){m=!0;break}f.push(_)}if(!m)if(Array.isArray(d)&&d.length!==f.length)l.error("Expected "+d.length+" arguments, but found "+f.length+" instead.");else{for(var b=0;b<f.length;b++){var x=Array.isArray(d)?d[b]:d.type,w=f[b];l.concat(b+1).checkSubtype(x,w.type)}if(0===l.errors.length)return new ge(r,a,p,f)}}if(1===o.length)(n=e.errors).push.apply(n,l.errors);else{for(var S=(o.length?o:s).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(jt).join(", ")+")":"("+jt(e.type)+"...)"})).join(" | "),C=[],D=1;D<t.length;D++){var I=e.parse(t[D],1+C.length);if(!I)return null;C.push(jt(I.type))}e.error("Expected arguments of type "+S+", but found ("+C.join(", ")+") instead.")}return null},ge.register=function(t,e){for(var n in ge.definitions=e,e)t[n]=ge};var ye=function(t,e,n){this.type=Wt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function ve(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function _e(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function be(t,e){var n=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,i=Math.pow(2,e.z);return[Math.round(n*i*8192),Math.round(r*i*8192)]}function xe(t,e,n){return e[1]>t[1]!=n[1]>t[1]&&t[0]<(n[0]-e[0])*(t[1]-e[1])/(n[1]-e[1])+e[0]}function we(t,e){for(var n,r,i,a,s,o,l,u=!1,c=0,h=e.length;c<h;c++)for(var d=e[c],p=0,f=d.length;p<f-1;p++){if((a=(n=t)[0]-(r=d[p])[0])*(l=n[1]-(i=d[p+1])[1])-(o=n[0]-i[0])*(s=n[1]-r[1])==0&&a*o<=0&&s*l<=0)return!1;xe(t,d[p],d[p+1])&&(u=!u)}return u}function Se(t,e){for(var n=0;n<e.length;n++)if(we(t,e[n]))return!0;return!1}function Ce(t,e,n,r){var i=r[0]-n[0],a=r[1]-n[1],s=(t[0]-n[0])*a-i*(t[1]-n[1]),o=(e[0]-n[0])*a-i*(e[1]-n[1]);return s>0&&o<0||s<0&&o>0}function De(t,e,n){for(var r=0,i=n;r<i.length;r+=1)for(var a=i[r],s=0;s<a.length-1;++s)if(0!=(h=[(c=a[s+1])[0]-(u=a[s])[0],c[1]-u[1]])[0]*(d=[(l=e)[0]-(o=t)[0],l[1]-o[1]])[1]-h[1]*d[0]&&Ce(o,l,u,c)&&Ce(u,c,o,l))return!0;var o,l,u,c,h,d;return!1}function Ie(t,e){for(var n=0;n<t.length;++n)if(!we(t[n],e))return!1;for(var r=0;r<t.length-1;++r)if(De(t[r],t[r+1],e))return!1;return!0}function ke(t,e){for(var n=0;n<e.length;n++)if(Ie(t,e[n]))return!0;return!1}function Ee(t,e,n){for(var r=[],i=0;i<t.length;i++){for(var a=[],s=0;s<t[i].length;s++){var o=be(t[i][s],n);ve(e,o),a.push(o)}r.push(a)}return r}function Ae(t,e,n){for(var r=[],i=0;i<t.length;i++){var a=Ee(t[i],e,n);r.push(a)}return r}function Te(t,e,n,r){if(t[0]<n[0]||t[0]>n[2]){var i=.5*r,a=t[0]-n[0]>i?-r:n[0]-t[0]>i?r:0;0===a&&(a=t[0]-n[2]>i?-r:n[2]-t[0]>i?r:0),t[0]+=a}ve(e,t)}function Re(t,e,n,r){for(var i=8192*Math.pow(2,r.z),a=[8192*r.x,8192*r.y],s=[],o=0,l=t;o<l.length;o+=1)for(var u=0,c=l[o];u<c.length;u+=1){var h=c[u],d=[h.x+a[0],h.y+a[1]];Te(d,e,n,i),s.push(d)}return s}function Me(t,e,n,r){for(var i,a=8192*Math.pow(2,r.z),s=[8192*r.x,8192*r.y],o=[],l=0,u=t;l<u.length;l+=1){for(var c=[],h=0,d=u[l];h<d.length;h+=1){var p=d[h],f=[p.x+s[0],p.y+s[1]];ve(e,f),c.push(f)}o.push(c)}if(e[2]-e[0]<=a/2){(i=e)[0]=i[1]=1/0,i[2]=i[3]=-1/0;for(var m=0,g=o;m<g.length;m+=1)for(var y=0,v=g[m];y<v.length;y+=1)Te(v[y],e,n,a)}return o}ye.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Lt);if(!r)return null;var i=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Lt);if(!i)return null;var a=null;return n.locale&&!(a=e.parse(n.locale,1,Ft))?null:new ye(r,i,a)},ye.prototype.evaluate=function(t){return new Yt(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},ye.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},ye.prototype.outputDefined=function(){return!1},ye.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Ne=function(t,e){this.type=Lt,this.geojson=t,this.geometries=e};function Oe(t){if(t instanceof ge){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Ne)return!1;var e=!0;return t.eachChild((function(t){e&&!Oe(t)&&(e=!1)})),e}function Pe(t){if(t instanceof ge&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Pe(t)&&(e=!1)})),e}function Fe(t,e){if(t instanceof ge&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!Fe(t,e)&&(n=!1)})),n}Ne.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(re(t[1])){var n=t[1];if("FeatureCollection"===n.type)for(var r=0;r<n.features.length;++r){var i=n.features[r].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Ne(n,n.features[r].geometry)}else if("Feature"===n.type){var a=n.geometry.type;if("Polygon"===a||"MultiPolygon"===a)return new Ne(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new Ne(n,n)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ne.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var a=Ee(e.coordinates,r,i),s=Re(t.geometry(),n,r,i);if(!_e(n,r))return!1;for(var o=0,l=s;o<l.length;o+=1)if(!we(l[o],a))return!1}if("MultiPolygon"===e.type){var u=Ae(e.coordinates,r,i),c=Re(t.geometry(),n,r,i);if(!_e(n,r))return!1;for(var h=0,d=c;h<d.length;h+=1)if(!Se(d[h],u))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var a=Ee(e.coordinates,r,i),s=Me(t.geometry(),n,r,i);if(!_e(n,r))return!1;for(var o=0,l=s;o<l.length;o+=1)if(!Ie(l[o],a))return!1}if("MultiPolygon"===e.type){var u=Ae(e.coordinates,r,i),c=Me(t.geometry(),n,r,i);if(!_e(n,r))return!1;for(var h=0,d=c;h<d.length;h+=1)if(!ke(d[h],u))return!1}return!0}(t,this.geometries)}return!1},Ne.prototype.eachChild=function(){},Ne.prototype.outputDefined=function(){return!0},Ne.prototype.serialize=function(){return["within",this.geojson]};var Le=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Le.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Le(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Le.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Le.prototype.eachChild=function(){},Le.prototype.outputDefined=function(){return!1},Le.prototype.serialize=function(){return["var",this.name]};var ze=function(t,e,n,r,i){void 0===e&&(e=[]),void 0===r&&(r=new Nt),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=r,this.errors=i,this.expectedType=n};function $e(t,e){for(var n,r=t.length-1,i=0,a=r,s=0;i<=a;)if((n=t[s=Math.floor((i+a)/2)])<=e){if(s===r||e<t[s+1])return s;i=s+1}else{if(!(n>e))throw new oe("Input is not a number.");a=s-1}return 0}ze.prototype.parse=function(t,e,n,r,i){return void 0===i&&(i={}),e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)},ze.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new ue(e,[t]):"coerce"===n?new pe(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[r];if(i){var a=i.parse(t,this);if(!a)return null;if(this.expectedType){var s=this.expectedType,o=a.type;if("string"!==s.kind&&"number"!==s.kind&&"boolean"!==s.kind&&"object"!==s.kind&&"array"!==s.kind||"value"!==o.kind)if("color"!==s.kind&&"formatted"!==s.kind&&"resolvedImage"!==s.kind||"value"!==o.kind&&"string"!==o.kind){if(this.checkSubtype(s,o))return null}else a=n(a,s,e.typeAnnotation||"coerce");else a=n(a,s,e.typeAnnotation||"assert")}if(!(a instanceof se)&&"resolvedImage"!==a.type.kind&&function t(e){if(e instanceof Le)return t(e.boundExpression);if(e instanceof ge&&"error"===e.name)return!1;if(e instanceof ye)return!1;if(e instanceof Ne)return!1;var n=e instanceof pe||e instanceof ue,r=!0;return e.eachChild((function(e){r=n?r&&t(e):r&&e instanceof se})),!!r&&Oe(e)&&Fe(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(a)){var l=new me;try{a=new se(a.type,a.evaluate(l))}catch(t){return this.error(t.message),null}}return a}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},ze.prototype.concat=function(t,e,n){var r="number"==typeof t?this.path.concat(t):this.path,i=n?this.scope.concat(n):this.scope;return new ze(this.registry,r,e||null,i,this.errors)},ze.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new Mt(r,t))},ze.prototype.checkSubtype=function(t,e){var n=Gt(t,e);return n&&this.error(n),n};var Be=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var r=0,i=n;r<i.length;r+=1){var a=i[r],s=a[1];this.labels.push(a[0]),this.outputs.push(s)}};function We(t,e,n){return t*(1-n)+e*n}Be.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var n=e.parse(t[1],1,Pt);if(!n)return null;var r=[],i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var a=1;a<t.length;a+=2){var s=1===a?-1/0:t[a],o=t[a+1],l=a,u=a+1;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(r.length&&r[r.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var c=e.parse(o,u,i);if(!c)return null;i=i||c.type,r.push([s,c])}return new Be(i,n,r)},Be.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[$e(e,r)].evaluate(t)},Be.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Be.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},Be.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var qe=Object.freeze({__proto__:null,number:We,color:function(t,e,n){return new Zt(We(t.r,e.r,n),We(t.g,e.g,n),We(t.b,e.b,n),We(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,r){return We(t,e[r],n)}))}}),Ve=6/29*3*(6/29),Ue=Math.PI/180,je=180/Math.PI;function He(t){return t>.008856451679035631?Math.pow(t,1/3):t/Ve+4/29}function Ge(t){return t>6/29?t*t*t:Ve*(t-4/29)}function Je(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Xe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ke(t){var e=Xe(t.r),n=Xe(t.g),r=Xe(t.b),i=He((.4124564*e+.3575761*n+.1804375*r)/.95047),a=He((.2126729*e+.7151522*n+.072175*r)/1);return{l:116*a-16,a:500*(i-a),b:200*(a-He((.0193339*e+.119192*n+.9503041*r)/1.08883)),alpha:t.a}}function Ze(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=1*Ge(e),n=.95047*Ge(n),r=1.08883*Ge(r),new Zt(Je(3.2404542*n-1.5371385*e-.4985314*r),Je(-.969266*n+1.8760108*e+.041556*r),Je(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}function Ye(t,e,n){var r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}var Qe={forward:Ke,reverse:Ze,interpolate:function(t,e,n){return{l:We(t.l,e.l,n),a:We(t.a,e.a,n),b:We(t.b,e.b,n),alpha:We(t.alpha,e.alpha,n)}}},tn={forward:function(t){var e=Ke(t),n=e.l,r=e.a,i=e.b,a=Math.atan2(i,r)*je;return{h:a<0?a+360:a,c:Math.sqrt(r*r+i*i),l:n,alpha:t.a}},reverse:function(t){var e=t.h*Ue,n=t.c;return Ze({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:Ye(t.h,e.h,n),c:We(t.c,e.c,n),l:We(t.l,e.l,n),alpha:We(t.alpha,e.alpha,n)}}},en=Object.freeze({__proto__:null,lab:Qe,hcl:tn}),nn=function(t,e,n,r,i){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(var a=0,s=i;a<s.length;a+=1){var o=s[a],l=o[1];this.labels.push(o[0]),this.outputs.push(l)}};function rn(t,e,n,r){var i=r-n,a=t-n;return 0===i?0:1===e?a/i:(Math.pow(e,a)-1)/(Math.pow(e,i)-1)}nn.interpolationFactor=function(t,e,r,i){var a=0;if("exponential"===t.name)a=rn(e,t.base,r,i);else if("linear"===t.name)a=rn(e,1,r,i);else if("cubic-bezier"===t.name){var s=t.controlPoints;a=new n(s[0],s[1],s[2],s[3]).solve(rn(e,1,r,i))}return a},nn.parse=function(t,e){var n=t[0],r=t[1],i=t[2],a=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var s=r[1];if("number"!=typeof s)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:s}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var o=r.slice(1);if(4!==o.length||o.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:o}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,Pt)))return null;var l=[],u=null;"interpolate-hcl"===n||"interpolate-lab"===n?u=zt:e.expectedType&&"value"!==e.expectedType.kind&&(u=e.expectedType);for(var c=0;c<a.length;c+=2){var h=a[c],d=a[c+1],p=c+3,f=c+4;if("number"!=typeof h)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(l.length&&l[l.length-1][0]>=h)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var m=e.parse(d,f,u);if(!m)return null;u=u||m.type,l.push([h,m])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new nn(u,n,r,i,l):e.error("Type "+jt(u)+" is not interpolatable.")},nn.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;if(r>=e[i-1])return n[i-1].evaluate(t);var a=$e(e,r),s=nn.interpolationFactor(this.interpolation,r,e[a],e[a+1]),o=n[a].evaluate(t),l=n[a+1].evaluate(t);return"interpolate"===this.operator?qe[this.type.kind.toLowerCase()](o,l,s):"interpolate-hcl"===this.operator?tn.reverse(tn.interpolate(tn.forward(o),tn.forward(l),s)):Qe.reverse(Qe.interpolate(Qe.forward(o),Qe.forward(l),s))},nn.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},nn.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},nn.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var an=function(t,e){this.type=t,this.args=e};an.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,r=e.expectedType;r&&"value"!==r.kind&&(n=r);for(var i=[],a=0,s=t.slice(1);a<s.length;a+=1){var o=e.parse(s[a],1+i.length,n,void 0,{typeAnnotation:"omit"});if(!o)return null;n=n||o.type,i.push(o)}var l=r&&i.some((function(t){return Gt(r,t.type)}));return new an(l?Bt:n,i)},an.prototype.evaluate=function(t){for(var e,n=null,r=0,i=0,a=this.args;i<a.length&&(r++,(n=a[i].evaluate(t))&&n instanceof ee&&!n.available&&(e||(e=n.name),n=null,r===this.args.length&&(n=e)),null===n);i+=1);return n},an.prototype.eachChild=function(t){this.args.forEach(t)},an.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},an.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var sn=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};sn.prototype.evaluate=function(t){return this.result.evaluate(t)},sn.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},sn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],r=1;r<t.length-1;r+=2){var i=t[r];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);var a=e.parse(t[r+1],r+1);if(!a)return null;n.push([i,a])}var s=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return s?new sn(n,s):null},sn.prototype.outputDefined=function(){return this.result.outputDefined()},sn.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var r=n[e];t.push(r[0],r[1].serialize())}return t.push(this.result.serialize()),t};var on=function(t,e,n){this.type=t,this.index=e,this.input=n};on.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Pt),r=e.parse(t[2],2,Ut(e.expectedType||Bt));return n&&r?new on(r.type.itemType,n,r):null},on.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new oe("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new oe("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new oe("Array index must be an integer, but found "+e+" instead.");return n[e]},on.prototype.eachChild=function(t){t(this.index),t(this.input)},on.prototype.outputDefined=function(){return!1},on.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ln=function(t,e){this.type=Lt,this.needle=t,this.haystack=e};ln.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Bt),r=e.parse(t[2],2,Bt);return n&&r?Jt(n.type,[Lt,Ft,Pt,Ot,Bt])?new ln(n,r):e.error("Expected first argument to be of type boolean, string, number or null, but found "+jt(n.type)+" instead"):null},ln.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!Xt(e,["boolean","string","number","null"]))throw new oe("Expected first argument to be of type boolean, string, number or null, but found "+jt(ie(e))+" instead.");if(!Xt(n,["string","array"]))throw new oe("Expected second argument to be of type array or string, but found "+jt(ie(n))+" instead.");return n.indexOf(e)>=0},ln.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},ln.prototype.outputDefined=function(){return!0},ln.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var un=function(t,e,n){this.type=Pt,this.needle=t,this.haystack=e,this.fromIndex=n};un.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Bt),r=e.parse(t[2],2,Bt);if(!n||!r)return null;if(!Jt(n.type,[Lt,Ft,Pt,Ot,Bt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+jt(n.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,Pt);return i?new un(n,r,i):null}return new un(n,r)},un.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Xt(e,["boolean","string","number","null"]))throw new oe("Expected first argument to be of type boolean, string, number or null, but found "+jt(ie(e))+" instead.");if(!Xt(n,["string","array"]))throw new oe("Expected second argument to be of type array or string, but found "+jt(ie(n))+" instead.");if(this.fromIndex){var r=this.fromIndex.evaluate(t);return n.indexOf(e,r)}return n.indexOf(e)},un.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},un.prototype.outputDefined=function(){return!1},un.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var cn=function(t,e,n,r,i,a){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=i,this.otherwise=a};cn.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var i={},a=[],s=2;s<t.length-1;s+=2){var o=t[s],l=t[s+1];Array.isArray(o)||(o=[o]);var u=e.concat(s);if(0===o.length)return u.error("Expected at least one branch label.");for(var c=0,h=o;c<h.length;c+=1){var d=h[c];if("number"!=typeof d&&"string"!=typeof d)return u.error("Branch labels must be numbers or strings.");if("number"==typeof d&&Math.abs(d)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof d&&Math.floor(d)!==d)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,ie(d)))return null}else n=ie(d);if(void 0!==i[String(d)])return u.error("Branch labels must be unique.");i[String(d)]=a.length}var p=e.parse(l,s,r);if(!p)return null;r=r||p.type,a.push(p)}var f=e.parse(t[1],1,Bt);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,r);return m?"value"!==f.type.kind&&e.concat(1).checkSubtype(n,f.type)?null:new cn(n,r,f,i,a,m):null},cn.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(ie(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},cn.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},cn.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},cn.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],r={},i=0,a=Object.keys(this.cases).sort();i<a.length;i+=1){var s=a[i];void 0===(h=r[this.cases[s]])?(r[this.cases[s]]=n.length,n.push([this.cases[s],[s]])):n[h][1].push(s)}for(var o=function(e){return"number"===t.inputType.kind?Number(e):e},l=0,u=n;l<u.length;l+=1){var c=u[l],h=c[0],d=c[1];e.push(1===d.length?o(d[0]):d.map(o)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var hn=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};hn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var r=[],i=1;i<t.length-1;i+=2){var a=e.parse(t[i],i,Lt);if(!a)return null;var s=e.parse(t[i+1],i+1,n);if(!s)return null;r.push([a,s]),n=n||s.type}var o=e.parse(t[t.length-1],t.length-1,n);return o?new hn(n,r,o):null},hn.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[1];if(r[0].evaluate(t))return i.evaluate(t)}return this.otherwise.evaluate(t)},hn.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[1];t(r[0]),t(i)}t(this.otherwise)},hn.prototype.outputDefined=function(){return this.branches.every((function(t){return t[1].outputDefined()}))&&this.otherwise.outputDefined()},hn.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var dn=function(t,e,n,r){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=r};function pn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function fn(t,e,n,r){return 0===r.compare(e,n)}function mn(t,e,n){var r="=="!==t&&"!="!==t;return function(){function i(t,e,n){this.type=Lt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],a=e.parse(t[1],1,Bt);if(!a)return null;if(!pn(n,a.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+jt(a.type)+"'.");var s=e.parse(t[2],2,Bt);if(!s)return null;if(!pn(n,s.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+jt(s.type)+"'.");if(a.type.kind!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return e.error("Cannot compare types '"+jt(a.type)+"' and '"+jt(s.type)+"'.");r&&("value"===a.type.kind&&"value"!==s.type.kind?a=new ue(s.type,[a]):"value"!==a.type.kind&&"value"===s.type.kind&&(s=new ue(a.type,[s])));var o=null;if(4===t.length){if("string"!==a.type.kind&&"string"!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(o=e.parse(t[3],3,Wt)))return null}return new i(a,s,o)},i.prototype.evaluate=function(i){var a=this.lhs.evaluate(i),s=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){var o=ie(a),l=ie(s);if(o.kind!==l.kind||"string"!==o.kind&&"number"!==o.kind)throw new oe('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+o.kind+", "+l.kind+") instead.")}if(this.collator&&!r&&this.hasUntypedArgument){var u=ie(a),c=ie(s);if("string"!==u.kind||"string"!==c.kind)return e(i,a,s)}return this.collator?n(i,a,s,this.collator.evaluate(i)):e(i,a,s)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},i}()}dn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Bt),r=e.parse(t[2],2,Pt);if(!n||!r)return null;if(!Jt(n.type,[Ut(Bt),Ft,Bt]))return e.error("Expected first argument to be of type array or string, but found "+jt(n.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,Pt);return i?new dn(n.type,n,r,i):null}return new dn(n.type,n,r)},dn.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Xt(e,["string","array"]))throw new oe("Expected first argument to be of type array or string, but found "+jt(ie(e))+" instead.");if(this.endIndex){var r=this.endIndex.evaluate(t);return e.slice(n,r)}return e.slice(n)},dn.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},dn.prototype.outputDefined=function(){return!1},dn.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var gn=mn("==",(function(t,e,n){return e===n}),fn),yn=mn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,r){return!fn(0,e,n,r)})),vn=mn("<",(function(t,e,n){return e<n}),(function(t,e,n,r){return r.compare(e,n)<0})),_n=mn(">",(function(t,e,n){return e>n}),(function(t,e,n,r){return r.compare(e,n)>0})),bn=mn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,r){return r.compare(e,n)<=0})),xn=mn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,r){return r.compare(e,n)>=0})),wn=function(t,e,n,r,i){this.type=Ft,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=i};wn.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Pt);if(!n)return null;var r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");var i=null;if(r.locale&&!(i=e.parse(r.locale,1,Ft)))return null;var a=null;if(r.currency&&!(a=e.parse(r.currency,1,Ft)))return null;var s=null;if(r["min-fraction-digits"]&&!(s=e.parse(r["min-fraction-digits"],1,Pt)))return null;var o=null;return r["max-fraction-digits"]&&!(o=e.parse(r["max-fraction-digits"],1,Pt))?null:new wn(n,i,a,s,o)},wn.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},wn.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},wn.prototype.outputDefined=function(){return!1},wn.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Sn=function(t){this.type=Pt,this.input=t};Sn.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+jt(n.type)+" instead."):new Sn(n):null},Sn.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new oe("Expected value to be of type string or array, but found "+jt(ie(e))+" instead.")},Sn.prototype.eachChild=function(t){t(this.input)},Sn.prototype.outputDefined=function(){return!1},Sn.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Cn={"==":gn,"!=":yn,">":_n,"<":vn,">=":xn,"<=":bn,array:ue,at:on,boolean:ue,case:hn,coalesce:an,collator:ye,format:ce,image:he,in:ln,"index-of":un,interpolate:nn,"interpolate-hcl":nn,"interpolate-lab":nn,length:Sn,let:sn,literal:se,match:cn,number:ue,"number-format":wn,object:ue,slice:dn,step:Be,string:ue,"to-boolean":pe,"to-color":pe,"to-number":pe,"to-string":pe,var:Le,within:Ne};function Dn(t,e){var n=e[0],r=e[1],i=e[2],a=e[3];n=n.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);var s=a?a.evaluate(t):1,o=ne(n,r,i,s);if(o)throw new oe(o);return new Zt(n/255*s,r/255*s,i/255*s,s)}function In(t,e){return t in e}function kn(t,e){var n=e[t];return void 0===n?null:n}function En(t){return{type:t}}function An(t){return{result:"success",value:t}}function Tn(t){return{result:"error",value:t}}function Rn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Mn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Nn(t){return!!t.expression&&t.expression.interpolated}function On(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Pn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Fn(t){return t}function Ln(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function zn(t,e,n,r,i){return Ln(typeof n===i?r[n]:void 0,t.default,e.default)}function $n(t,e,n){if("number"!==On(n))return Ln(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var i=$e(t.stops.map((function(t){return t[0]})),n);return t.stops[i][1]}function Bn(t,e,n){var r=void 0!==t.base?t.base:1;if("number"!==On(n))return Ln(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var a=$e(t.stops.map((function(t){return t[0]})),n),s=function(t,e,n,r){var i=r-n,a=t-n;return 0===i?0:1===e?a/i:(Math.pow(e,a)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[a][0],t.stops[a+1][0]),o=t.stops[a][1],l=t.stops[a+1][1],u=qe[e.type]||Fn;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=en[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),s))}}return"function"==typeof o.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=o.evaluate.apply(void 0,t),r=l.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==r)return u(n,r,s)}}:u(o,l,s)}function Wn(t,e,n){return"color"===e.type?n=Zt.parse(n):"formatted"===e.type?n=te.fromString(n.toString()):"resolvedImage"===e.type?n=ee.fromString(n.toString()):On(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Ln(n,t.default,e.default)}ge.register(Cn,{error:[{kind:"error"},[Ft],function(t,e){throw new oe(e[0].evaluate(t))}],typeof:[Ft,[Bt],function(t,e){return jt(ie(e[0].evaluate(t)))}],"to-rgba":[Ut(Pt,4),[zt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[zt,[Pt,Pt,Pt],Dn],rgba:[zt,[Pt,Pt,Pt,Pt],Dn],has:{type:Lt,overloads:[[[Ft],function(t,e){return In(e[0].evaluate(t),t.properties())}],[[Ft,$t],function(t,e){var n=e[1];return In(e[0].evaluate(t),n.evaluate(t))}]]},get:{type:Bt,overloads:[[[Ft],function(t,e){return kn(e[0].evaluate(t),t.properties())}],[[Ft,$t],function(t,e){var n=e[1];return kn(e[0].evaluate(t),n.evaluate(t))}]]},"feature-state":[Bt,[Ft],function(t,e){return kn(e[0].evaluate(t),t.featureState||{})}],properties:[$t,[],function(t){return t.properties()}],"geometry-type":[Ft,[],function(t){return t.geometryType()}],id:[Bt,[],function(t){return t.id()}],zoom:[Pt,[],function(t){return t.globals.zoom}],"heatmap-density":[Pt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Pt,[],function(t){return t.globals.lineProgress||0}],accumulated:[Bt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Pt,En(Pt),function(t,e){for(var n=0,r=0,i=e;r<i.length;r+=1)n+=i[r].evaluate(t);return n}],"*":[Pt,En(Pt),function(t,e){for(var n=1,r=0,i=e;r<i.length;r+=1)n*=i[r].evaluate(t);return n}],"-":{type:Pt,overloads:[[[Pt,Pt],function(t,e){var n=e[1];return e[0].evaluate(t)-n.evaluate(t)}],[[Pt],function(t,e){return-e[0].evaluate(t)}]]},"/":[Pt,[Pt,Pt],function(t,e){var n=e[1];return e[0].evaluate(t)/n.evaluate(t)}],"%":[Pt,[Pt,Pt],function(t,e){var n=e[1];return e[0].evaluate(t)%n.evaluate(t)}],ln2:[Pt,[],function(){return Math.LN2}],pi:[Pt,[],function(){return Math.PI}],e:[Pt,[],function(){return Math.E}],"^":[Pt,[Pt,Pt],function(t,e){var n=e[1];return Math.pow(e[0].evaluate(t),n.evaluate(t))}],sqrt:[Pt,[Pt],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Pt,[Pt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Pt,[Pt],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Pt,[Pt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Pt,[Pt],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Pt,[Pt],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Pt,[Pt],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Pt,[Pt],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Pt,[Pt],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Pt,[Pt],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Pt,En(Pt),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[Pt,En(Pt),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[Pt,[Pt],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Pt,[Pt],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Pt,[Pt],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Pt,[Pt],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Lt,[Ft,Bt],function(t,e){var n=e[0],r=e[1];return t.properties()[n.value]===r.value}],"filter-id-==":[Lt,[Bt],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[Lt,[Ft],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[Lt,[Ft,Bt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],a=r.value;return typeof i==typeof a&&i<a}],"filter-id-<":[Lt,[Bt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[Lt,[Ft,Bt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],a=r.value;return typeof i==typeof a&&i>a}],"filter-id->":[Lt,[Bt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[Lt,[Ft,Bt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],a=r.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[Lt,[Bt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[Lt,[Ft,Bt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],a=r.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[Lt,[Bt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[Lt,[Bt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Lt,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Lt,[Ut(Ft)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Lt,[Ut(Bt)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Lt,[Ft,Ut(Bt)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[Lt,[Ft,Ut(Bt)],function(t,e){var n=e[0],r=e[1];return function(t,e,n,r){for(;n<=r;){var i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:Lt,overloads:[[[Lt,Lt],function(t,e){var n=e[1];return e[0].evaluate(t)&&n.evaluate(t)}],[En(Lt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(!r[n].evaluate(t))return!1;return!0}]]},any:{type:Lt,overloads:[[[Lt,Lt],function(t,e){var n=e[1];return e[0].evaluate(t)||n.evaluate(t)}],[En(Lt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(r[n].evaluate(t))return!0;return!1}]]},"!":[Lt,[Lt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Lt,[Ft],function(t,e){var n=t.globals&&t.globals.isSupportedScript;return!n||n(e[0].evaluate(t))}],upcase:[Ft,[Ft],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Ft,[Ft],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Ft,En(Bt),function(t,e){return e.map((function(e){return ae(e.evaluate(t))})).join("")}],"resolved-locale":[Ft,[Wt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var qn=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new me,this._defaultValue=e?function(t){return"color"===t.type&&Pn(t.default)?new Zt(0,0,0,0):"color"===t.type?Zt.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null};function Vn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Cn}function Un(t,e){var n=new ze(Cn,[],e?function(t){var e={color:zt,string:Ft,number:Pt,enum:Ft,boolean:Lt,formatted:qt,resolvedImage:Vt};return"array"===t.type?Ut(e[t.value]||Bt,t.length):e[t.type]}(e):void 0),r=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?An(new qn(r,e)):Tn(n.errors)}qn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)},qn.prototype.evaluate=function(t,e,n,r,i,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a||null;try{var s=this.expression.evaluate(this._evaluator);if(null==s||"number"==typeof s&&s!=s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new oe("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(s)+" instead.");return s}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var jn=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Pe(e.expression)};jn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,a)},jn.prototype.evaluate=function(t,e,n,r,i,a){return this._styleExpression.evaluate(t,e,n,r,i,a)};var Hn=function(t,e,n,r){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Pe(e.expression),this.interpolationType=r};function Gn(t,e){if("error"===(t=Un(t,e)).result)return t;var n=t.value.expression,r=Oe(n);if(!r&&!Rn(e))return Tn([new Mt("","data expressions not supported")]);var i=Fe(n,["zoom"]);if(!i&&!Mn(e))return Tn([new Mt("","zoom expressions not supported")]);var a=function t(e){var n=null;if(e instanceof sn)n=t(e.result);else if(e instanceof an)for(var r=0,i=e.args;r<i.length&&!(n=t(i[r]));r+=1);else(e instanceof Be||e instanceof nn)&&e.input instanceof ge&&"zoom"===e.input.name&&(n=e);return n instanceof Mt||e.eachChild((function(e){var r=t(e);r instanceof Mt?n=r:!n&&r?n=new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&r&&n!==r&&(n=new Mt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}(n);return a||i?a instanceof Mt?Tn([a]):a instanceof nn&&!Nn(e)?Tn([new Mt("",'"interpolate" expressions cannot be used with this property')]):An(a?new Hn(r?"camera":"composite",t.value,a.labels,a instanceof nn?a.interpolation:void 0):new jn(r?"constant":"source",t.value)):Tn([new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Hn.prototype.evaluateWithoutErrorHandling=function(t,e,n,r,i,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,a)},Hn.prototype.evaluate=function(t,e,n,r,i,a){return this._styleExpression.evaluate(t,e,n,r,i,a)},Hn.prototype.interpolationFactor=function(t,e,n){return this.interpolationType?nn.interpolationFactor(this.interpolationType,t,e,n):0};var Jn=function(t,e){this._parameters=t,this._specification=e,At(this,function t(e,n){var r,i,a,s="color"===n.type,o=e.stops&&"object"==typeof e.stops[0][0],l=o||!(o||void 0!==e.property),u=e.type||(Nn(n)?"exponential":"interval");if(s&&((e=At({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],Zt.parse(t[1])]}))),e.default=Zt.parse(e.default?e.default:n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!en[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===u)r=Bn;else if("interval"===u)r=$n;else if("categorical"===u){r=zn,i=Object.create(null);for(var c=0,h=e.stops;c<h.length;c+=1){var d=h[c];i[d[0]]=d[1]}a=typeof e.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'+u+'"');r=Wn}if(o){for(var p={},f=[],m=0;m<e.stops.length;m++){var g=e.stops[m],y=g[0].zoom;void 0===p[y]&&(p[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},f.push(y)),p[y].stops.push([g[0].value,g[1]])}for(var v=[],_=0,b=f;_<b.length;_+=1){var x=b[_];v.push([p[x].zoom,t(p[x],n)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:nn.interpolationFactor.bind(void 0,w),zoomStops:v.map((function(t){return t[0]})),evaluate:function(t,r){var i=t.zoom;return Bn({stops:v,base:e.base},n,i).evaluate(i,r)}}}if(l){var S="exponential"===u?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:nn.interpolationFactor.bind(void 0,S),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){return r(e,n,t.zoom,i,a)}}}return{kind:"source",evaluate:function(t,s){var o=s&&s.properties?s.properties[e.property]:void 0;return void 0===o?Ln(e.default,n.default):r(e,n,o,i,a)}}}(this._parameters,this._specification))};function Xn(t){var e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},a=t.style,s=t.styleSpec,o=[],l=On(n);if("object"!==l)return[new kt(e,n,"object expected, "+l+" found")];for(var u in n){var c=u.split(".")[0],h=r[c]||r["*"],d=void 0;if(i[c])d=i[c];else if(r[c])d=br;else if(i["*"])d=i["*"];else{if(!r["*"]){o.push(new kt(e,n[u],'unknown property "'+u+'"'));continue}d=br}o=o.concat(d({key:(e?e+".":e)+u,value:n[u],valueSpec:h,style:a,styleSpec:s,object:n,objectKey:u},n))}for(var p in r)i[p]||r[p].required&&void 0===r[p].default&&void 0===n[p]&&o.push(new kt(e,n,'missing required property "'+p+'"'));return o}function Kn(t){var e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,a=t.key,s=t.arrayElementValidator||br;if("array"!==On(e))return[new kt(a,e,"array expected, "+On(e)+" found")];if(n.length&&e.length!==n.length)return[new kt(a,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new kt(a,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var o={type:n.value,values:n.values};i.$version<7&&(o.function=n.function),"object"===On(n.value)&&(o=n.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(s({array:e,arrayIndex:u,value:e[u],valueSpec:o,style:r,styleSpec:i,key:a+"["+u+"]"}));return l}function Zn(t){var e=t.key,n=t.value,r=t.valueSpec,i=On(n);return"number"===i&&n!=n&&(i="NaN"),"number"!==i?[new kt(e,n,"number expected, "+i+" found")]:"minimum"in r&&n<r.minimum?[new kt(e,n,n+" is less than the minimum value "+r.minimum)]:"maximum"in r&&n>r.maximum?[new kt(e,n,n+" is greater than the maximum value "+r.maximum)]:[]}function Yn(t){var e,n,r,i=t.valueSpec,a=Tt(t.value.type),s={},o="categorical"!==a&&void 0===t.value.property,l=!o,u="array"===On(t.value.stops)&&"array"===On(t.value.stops[0])&&"object"===On(t.value.stops[0][0]),c=Xn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===a)return[new kt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(Kn({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===On(n)&&0===n.length&&e.push(new kt(t.key,n,"array must have at least one stop")),e},default:function(t){return br({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===a&&o&&c.push(new kt(t.key,t.value,'missing required property "property"')),"identity"===a||t.value.stops||c.push(new kt(t.key,t.value,'missing required property "stops"')),"exponential"===a&&t.valueSpec.expression&&!Nn(t.valueSpec)&&c.push(new kt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Rn(t.valueSpec)?c.push(new kt(t.key,t.value,"property functions not supported")):o&&!Mn(t.valueSpec)&&c.push(new kt(t.key,t.value,"zoom functions not supported"))),"categorical"!==a&&!u||void 0!==t.value.property||c.push(new kt(t.key,t.value,'"property" property is required')),c;function h(t){var e=[],a=t.value,o=t.key;if("array"!==On(a))return[new kt(o,a,"array expected, "+On(a)+" found")];if(2!==a.length)return[new kt(o,a,"array length 2 expected, length "+a.length+" found")];if(u){if("object"!==On(a[0]))return[new kt(o,a,"object expected, "+On(a[0])+" found")];if(void 0===a[0].zoom)return[new kt(o,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new kt(o,a,"object stop key must have value")];if(r&&r>Tt(a[0].zoom))return[new kt(o,a[0].zoom,"stop zoom values must appear in ascending order")];Tt(a[0].zoom)!==r&&(r=Tt(a[0].zoom),n=void 0,s={}),e=e.concat(Xn({key:o+"[0]",value:a[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Zn,value:d}}))}else e=e.concat(d({key:o+"[0]",value:a[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},a));return Vn(Rt(a[1]))?e.concat([new kt(o+"[1]",a[1],"expressions are not allowed in function stops.")]):e.concat(br({key:o+"[1]",value:a[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function d(t,r){var o=On(t.value),l=Tt(t.value),u=null!==t.value?t.value:r;if(e){if(o!==e)return[new kt(t.key,u,o+" stop domain type must match previous stop domain type "+e)]}else e=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return[new kt(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==a){var c="number expected, "+o+" found";return Rn(i)&&void 0===a&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kt(t.key,u,c)]}return"categorical"!==a||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==a&&"number"===o&&void 0!==n&&l<n?[new kt(t.key,u,"stop domain values must appear in ascending order")]:(n=l,"categorical"===a&&l in s?[new kt(t.key,u,"stop domain values must be unique")]:(s[l]=!0,[])):[new kt(t.key,u,"integer expected, found "+l)]}}function Qn(t){var e=("property"===t.expressionContext?Gn:Un)(Rt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new kt(""+t.key+e.key,t.value,e.message)}));var n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new kt(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Pe(n))return[new kt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Pe(n))return[new kt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Fe(n,["zoom","feature-state"]))return[new kt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Oe(n))return[new kt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function tr(t){var e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(Tt(n))&&i.push(new kt(e,n,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(r.values).indexOf(Tt(n))&&i.push(new kt(e,n,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(n)+" found")),i}function er(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var r=n[e];if(!er(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}Jn.deserialize=function(t){return new Jn(t._parameters,t._specification)},Jn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var nr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rr(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};er(t)||(t=ar(t));var e=Un(t,nr);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return{filter:function(t,n,r){return e.value.evaluate(t,n,{},r)},needGeometry:function t(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var n=1;n<e.length;n++)if(t(e[n]))return!0;return!1}(t)}}function ir(t,e){return t<e?-1:t>e?1:0}function ar(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?sr(t[1],t[2],"=="):"!="===n?ur(sr(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?sr(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(ar))):"all"===n?["all"].concat(t.slice(1).map(ar)):"none"===n?["all"].concat(t.slice(1).map(ar).map(ur)):"in"===n?or(t[1],t.slice(2)):"!in"===n?ur(or(t[1],t.slice(2))):"has"===n?lr(t[1]):"!has"===n?ur(lr(t[1])):"within"!==n||t}function sr(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function or(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(ir)]]:["filter-in-small",t,["literal",e]]}}function lr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function ur(t){return["!",t]}function cr(t){return er(Rt(t.value))?Qn(At({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,r=e.key;if("array"!==On(n))return[new kt(r,n,"array expected, "+On(n)+" found")];var i,a=e.styleSpec,s=[];if(n.length<1)return[new kt(r,n,"filter array must have at least 1 element")];switch(s=s.concat(tr({key:r+"[0]",value:n[0],valueSpec:a.filter_operator,style:e.style,styleSpec:e.styleSpec})),Tt(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===Tt(n[1])&&s.push(new kt(r,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&s.push(new kt(r,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(i=On(n[1]))&&s.push(new kt(r+"[1]",n[1],"string expected, "+i+" found"));for(var o=2;o<n.length;o++)i=On(n[o]),"$type"===Tt(n[1])?s=s.concat(tr({key:r+"["+o+"]",value:n[o],valueSpec:a.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&s.push(new kt(r+"["+o+"]",n[o],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var l=1;l<n.length;l++)s=s.concat(t({key:r+"["+l+"]",value:n[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=On(n[1]),2!==n.length?s.push(new kt(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==i&&s.push(new kt(r+"[1]",n[1],"string expected, "+i+" found"));break;case"within":i=On(n[1]),2!==n.length?s.push(new kt(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"object"!==i&&s.push(new kt(r+"[1]",n[1],"object expected, "+i+" found"))}return s}(t)}function hr(t,e){var n=t.key,r=t.style,i=t.styleSpec,a=t.value,s=t.objectKey,o=i[e+"_"+t.layerType];if(!o)return[];var l=s.match(/^(.*)-transition$/);if("paint"===e&&l&&o[l[1]]&&o[l[1]].transition)return br({key:n,value:a,valueSpec:i.transition,style:r,styleSpec:i});var u,c=t.valueSpec||o[s];if(!c)return[new kt(n,a,'unknown property "'+s+'"')];if("string"===On(a)&&Rn(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(a)))return[new kt(n,a,'"'+s+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var h=[];return"symbol"===t.layerType&&("text-field"===s&&r&&!r.glyphs&&h.push(new kt(n,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&Pn(Rt(a))&&"identity"===Tt(a.type)&&h.push(new kt(n,a,'"text-font" does not support identity functions'))),h.concat(br({key:t.key,value:a,valueSpec:c,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:s}))}function dr(t){return hr(t,"paint")}function pr(t){return hr(t,"layout")}function fr(t){var e=[],n=t.value,r=t.key,i=t.style,a=t.styleSpec;n.type||n.ref||e.push(new kt(r,n,'either "type" or "ref" is required'));var s,o=Tt(n.type),l=Tt(n.ref);if(n.id)for(var u=Tt(n.id),c=0;c<t.arrayIndex;c++){var h=i.layers[c];Tt(h.id)===u&&e.push(new kt(r,n.id,'duplicate layer id "'+n.id+'", previously used at line '+h.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(t){t in n&&e.push(new kt(r,n[t],'"'+t+'" is prohibited for ref layers'))})),i.layers.forEach((function(t){Tt(t.id)===l&&(s=t)})),s?s.ref?e.push(new kt(r,n.ref,"ref cannot reference another ref layer")):o=Tt(s.type):e.push(new kt(r,n.ref,'ref layer "'+l+'" not found'));else if("background"!==o)if(n.source){var d=i.sources&&i.sources[n.source],p=d&&Tt(d.type);d?"vector"===p&&"raster"===o?e.push(new kt(r,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===p&&"raster"!==o?e.push(new kt(r,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==p||n["source-layer"]?"raster-dem"===p&&"hillshade"!==o?e.push(new kt(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!n.paint||!n.paint["line-gradient"]||"geojson"===p&&d.lineMetrics||e.push(new kt(r,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new kt(r,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new kt(r,n.source,'source "'+n.source+'" not found'))}else e.push(new kt(r,n,'missing required property "source"'));return e=e.concat(Xn({key:r,value:n,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return br({key:r+".type",value:n.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:cr,layout:function(t){return Xn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return pr(At({layerType:o},t))}}})},paint:function(t){return Xn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return dr(At({layerType:o},t))}}})}}}))}function mr(t){var e=t.value,n=t.key,r=On(e);return"string"!==r?[new kt(n,e,"string expected, "+r+" found")]:[]}var gr={promoteId:function(t){var e=t.key,n=t.value;if("string"===On(n))return mr({key:e,value:n});var r=[];for(var i in n)r.push.apply(r,mr({key:e+"."+i,value:n[i]}));return r}};function yr(t){var e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new kt(n,e,'"type" is required')];var a,s=Tt(e.type);switch(s){case"vector":case"raster":case"raster-dem":return Xn({key:n,value:e,valueSpec:r["source_"+s.replace("-","_")],style:t.style,styleSpec:r,objectElementValidators:gr});case"geojson":if(a=Xn({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r,objectElementValidators:gr}),e.cluster)for(var o in e.clusterProperties){var l=e.clusterProperties[o],u=l[0],c="string"==typeof u?[u,["accumulated"],["get",o]]:u;a.push.apply(a,Qn({key:n+"."+o+".map",value:l[1],expressionContext:"cluster-map"})),a.push.apply(a,Qn({key:n+"."+o+".reduce",value:c,expressionContext:"cluster-reduce"}))}return a;case"video":return Xn({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return Xn({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return[new kt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return tr({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function vr(t){var e=t.value,n=t.styleSpec,r=n.light,i=t.style,a=[],s=On(e);if(void 0===e)return a;if("object"!==s)return a.concat([new kt("light",e,"object expected, "+s+" found")]);for(var o in e){var l=o.match(/^(.*)-transition$/);a=a.concat(l&&r[l[1]]&&r[l[1]].transition?br({key:o,value:e[o],valueSpec:n.transition,style:i,styleSpec:n}):r[o]?br({key:o,value:e[o],valueSpec:r[o],style:i,styleSpec:n}):[new kt(o,e[o],'unknown property "'+o+'"')])}return a}var _r={"*":function(){return[]},array:Kn,boolean:function(t){var e=t.value,n=t.key,r=On(e);return"boolean"!==r?[new kt(n,e,"boolean expected, "+r+" found")]:[]},number:Zn,color:function(t){var e=t.key,n=t.value,r=On(n);return"string"!==r?[new kt(e,n,"color expected, "+r+" found")]:null===Kt(n)?[new kt(e,n,'color expected, "'+n+'" found')]:[]},constants:Et,enum:tr,filter:cr,function:Yn,layer:fr,object:Xn,source:yr,light:vr,string:mr,formatted:function(t){return 0===mr(t).length?[]:Qn(t)},resolvedImage:function(t){return 0===mr(t).length?[]:Qn(t)}};function br(t){var e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&Pn(Tt(e))?Yn(t):n.expression&&Vn(Rt(e))?Qn(t):n.type&&_r[n.type]?_r[n.type](t):Xn(At({},t,{valueSpec:n.type?r[n.type]:n}))}function xr(t){var e=t.value,n=t.key,r=mr(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new kt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new kt(n,e,'"glyphs" url must include a "{range}" token'))),r}function wr(t,e){void 0===e&&(e=It);var n=[];return n=n.concat(br({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:xr,"*":function(){return[]}}})),t.constants&&(n=n.concat(Et({key:"constants",value:t.constants,style:t,styleSpec:e}))),Sr(n)}function Sr(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function Cr(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return Sr(t.apply(this,e))}}wr.source=Cr(yr),wr.light=Cr(vr),wr.layer=Cr(fr),wr.filter=Cr(cr),wr.paintProperty=Cr(dr),wr.layoutProperty=Cr(pr);var Dr=wr,Ir=Dr.light,kr=Dr.paintProperty,Er=Dr.layoutProperty;function Ar(t,e){var n=!1;if(e&&e.length)for(var r=0,i=e;r<i.length;r+=1)t.fire(new Ct(new Error(i[r].message))),n=!0;return n}var Tr=Rr;function Rr(t,e,n){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],this.d=(e=i[1])+2*(n=i[2]);for(var a=0;a<this.d*this.d;a++){var s=i[3+a],o=i[3+a+1];r.push(s===o?null:i.subarray(s,o))}var l=i[3+r.length+1];this.keys=i.subarray(i[3+r.length],l),this.bboxes=i.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var u=0;u<this.d*this.d;u++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var c=n/e*t;this.min=-c,this.max=t+c}Rr.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Rr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Rr.prototype._insertCell=function(t,e,n,r,i,a){this.cells[i].push(a)},Rr.prototype.query=function(t,e,n,r,i){var a=this.min,s=this.max;if(t<=a&&e<=a&&s<=n&&s<=r&&!i)return Array.prototype.slice.call(this.keys);var o=[];return this._forEachCell(t,e,n,r,this._queryCell,o,{},i),o},Rr.prototype._queryCell=function(t,e,n,r,i,a,s,o){var l=this.cells[i];if(null!==l)for(var u=this.keys,c=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===s[d]){var p=4*d;(o?o(c[p+0],c[p+1],c[p+2],c[p+3]):t<=c[p+2]&&e<=c[p+3]&&n>=c[p+0]&&r>=c[p+1])?(s[d]=!0,a.push(u[d])):s[d]=!1}}},Rr.prototype._forEachCell=function(t,e,n,r,i,a,s,o){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),h=this._convertToCellCoord(r),d=l;d<=c;d++)for(var p=u;p<=h;p++){var f=this.d*p+d;if((!o||o(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&i.call(this,t,e,n,r,f,a,s,o))return}},Rr.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Rr.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Rr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var a=e,s=0;s<t.length;s++){var o=t[s];i[3+s]=a,i.set(o,a),a+=o.length}return i[3+t.length]=a,i.set(this.keys,a),i[3+t.length+1]=a+=this.keys.length,i.set(this.bboxes,a),a+=this.bboxes.length,i.buffer};var Mr=self.ImageData,Nr=self.ImageBitmap,Or={};function Pr(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Or[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var Fr in Pr("Object",Object),Tr.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Tr.deserialize=function(t){return new Tr(t.buffer)},Pr("Grid",Tr),Pr("Color",Zt),Pr("Error",Error),Pr("ResolvedImage",ee),Pr("StylePropertyFunction",Jn),Pr("StyleExpression",qn,{omit:["_evaluator"]}),Pr("ZoomDependentExpression",Hn),Pr("ZoomConstantExpression",jn),Pr("CompoundExpression",ge,{omit:["_evaluate"]}),Cn)Cn[Fr]._classRegistryKey||Pr("Expression_"+Fr,Cn[Fr]);function Lr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function zr(t){return Nr&&t instanceof Nr}function $r(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Lr(t)||zr(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof Mr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var r=[],i=0,a=t;i<a.length;i+=1)r.push($r(a[i],e));return r}if("object"==typeof t){var s=t.constructor,o=s._classRegistryKey;if(!o)throw new Error("can't serialize object of unregistered class");var l=s.serialize?s.serialize(t,e):{};if(!s.serialize){for(var u in t)if(t.hasOwnProperty(u)&&!(Or[o].omit.indexOf(u)>=0)){var c=t[u];l[u]=Or[o].shallow.indexOf(u)>=0?c:$r(c,e)}t instanceof Error&&(l.message=t.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==o&&(l.$name=o),l}throw new Error("can't serialize object of type "+typeof t)}function Br(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Lr(t)||zr(t)||ArrayBuffer.isView(t)||t instanceof Mr)return t;if(Array.isArray(t))return t.map(Br);if("object"==typeof t){var e=t.$name||"Object",n=Or[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var r=Object.create(n.prototype),i=0,a=Object.keys(t);i<a.length;i+=1){var s=a[i];if("$name"!==s){var o=t[s];r[s]=Or[e].shallow.indexOf(s)>=0?o:Br(o)}}return r}throw new Error("can't deserialize object of type "+typeof t)}var Wr=function(){this.first=!0};Wr.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var qr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Vr(t){for(var e=0,n=t;e<n.length;e+=1)if(Ur(n[e].charCodeAt(0)))return!0;return!1}function Ur(t){return!(746!==t&&747!==t&&(t<4352||!(qr["Bopomofo Extended"](t)||qr.Bopomofo(t)||qr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||qr["CJK Compatibility Ideographs"](t)||qr["CJK Compatibility"](t)||qr["CJK Radicals Supplement"](t)||qr["CJK Strokes"](t)||!(!qr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||qr["CJK Unified Ideographs Extension A"](t)||qr["CJK Unified Ideographs"](t)||qr["Enclosed CJK Letters and Months"](t)||qr["Hangul Compatibility Jamo"](t)||qr["Hangul Jamo Extended-A"](t)||qr["Hangul Jamo Extended-B"](t)||qr["Hangul Jamo"](t)||qr["Hangul Syllables"](t)||qr.Hiragana(t)||qr["Ideographic Description Characters"](t)||qr.Kanbun(t)||qr["Kangxi Radicals"](t)||qr["Katakana Phonetic Extensions"](t)||qr.Katakana(t)&&12540!==t||!(!qr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!qr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||qr["Unified Canadian Aboriginal Syllabics"](t)||qr["Unified Canadian Aboriginal Syllabics Extended"](t)||qr["Vertical Forms"](t)||qr["Yijing Hexagram Symbols"](t)||qr["Yi Syllables"](t)||qr["Yi Radicals"](t))))}function jr(t){return!(Ur(t)||function(t){return!!(qr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||qr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||qr["Letterlike Symbols"](t)||qr["Number Forms"](t)||qr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||qr["Control Pictures"](t)&&9251!==t||qr["Optical Character Recognition"](t)||qr["Enclosed Alphanumerics"](t)||qr["Geometric Shapes"](t)||qr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qr["CJK Symbols and Punctuation"](t)||qr.Katakana(t)||qr["Private Use Area"](t)||qr["CJK Compatibility Forms"](t)||qr["Small Form Variants"](t)||qr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Hr(t){return t>=1424&&t<=2303||qr["Arabic Presentation Forms-A"](t)||qr["Arabic Presentation Forms-B"](t)}function Gr(t,e){return!(!e&&Hr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||qr.Khmer(t))}function Jr(t){for(var e=0,n=t;e<n.length;e+=1)if(Hr(n[e].charCodeAt(0)))return!0;return!1}var Xr=null,Kr="unavailable",Zr=null,Yr=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Kr="error"),Xr&&Xr(t)};function Qr(){ti.fire(new St("pluginStateChange",{pluginStatus:Kr,pluginURL:Zr}))}var ti=new Dt,ei=function(){return Kr},ni=function(){if("deferred"!==Kr||!Zr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Kr="loading",Qr(),Zr&&vt({url:Zr},(function(t){t?Yr(t):(Kr="loaded",Qr())}))},ri={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Kr||null!=ri.applyArabicShaping},isLoading:function(){return"loading"===Kr},setState:function(t){Kr=t.pluginStatus,Zr=t.pluginURL},isParsed:function(){return null!=ri.applyArabicShaping&&null!=ri.processBidirectionalText&&null!=ri.processStyledBidirectionalText},getPluginURL:function(){return Zr}},ii=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Wr,this.transition={})};ii.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,r=t;n<r.length;n+=1)if(!Gr(r[n].charCodeAt(0),e))return!1;return!0}(t,ri.isLoaded())},ii.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ii.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}};var ai=function(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Pn(t))return new Jn(t,e);if(Vn(t)){var n=Gn(t,e);if("error"===n.result)throw new Error(n.value.map((function(t){return t.key+": "+t.message})).join(", "));return n.value}var r=t;return"string"==typeof t&&"color"===e.type&&(r=Zt.parse(t)),{kind:"constant",evaluate:function(){return r}}}(void 0===e?t.specification.default:e,t.specification)};ai.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ai.prototype.possiblyEvaluate=function(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)};var si=function(t){this.property=t,this.value=new ai(t,void 0)};si.prototype.transitioned=function(t,e){return new li(this.property,this.value,e,c({},t.transition,this.transition),t.now)},si.prototype.untransitioned=function(){return new li(this.property,this.value,null,{},0)};var oi=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};oi.prototype.getValue=function(t){return _(this._values[t].value.value)},oi.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new si(this._values[t].property)),this._values[t].value=new ai(this._values[t].property,null===e?void 0:_(e))},oi.prototype.getTransition=function(t){return _(this._values[t].transition)},oi.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new si(this._values[t].property)),this._values[t].transition=_(e)||void 0},oi.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i);var a=this.getTransition(r);void 0!==a&&(t[r+"-transition"]=a)}return t},oi.prototype.transitioned=function(t,e){for(var n=new ui(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var a=i[r];n._values[a]=this._values[a].transitioned(t,e._values[a])}return n},oi.prototype.untransitioned=function(){for(var t=new ui(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e];t._values[r]=this._values[r].untransitioned()}return t};var li=function(t,e,n,r,i){this.property=t,this.value=e,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)};li.prototype.possiblyEvaluate=function(t,e,n){var r=t.now||0,i=this.value.possiblyEvaluate(t,e,n),a=this.prior;if(a){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return a.possiblyEvaluate(t,e,n);var s=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,n),i,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(s))}return i};var ui=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};ui.prototype.possiblyEvaluate=function(t,e,n){for(var r=new di(this._properties),i=0,a=Object.keys(this._values);i<a.length;i+=1){var s=a[i];r._values[s]=this._values[s].possiblyEvaluate(t,e,n)}return r},ui.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var ci=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};ci.prototype.getValue=function(t){return _(this._values[t].value)},ci.prototype.setValue=function(t,e){this._values[t]=new ai(this._values[t].property,null===e?void 0:_(e))},ci.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i)}return t},ci.prototype.possiblyEvaluate=function(t,e,n){for(var r=new di(this._properties),i=0,a=Object.keys(this._values);i<a.length;i+=1){var s=a[i];r._values[s]=this._values[s].possiblyEvaluate(t,e,n)}return r};var hi=function(t,e,n){this.property=t,this.value=e,this.parameters=n};hi.prototype.isConstant=function(){return"constant"===this.value.kind},hi.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},hi.prototype.evaluate=function(t,e,n,r){return this.property.evaluate(this.value,this.parameters,t,e,n,r)};var di=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};di.prototype.get=function(t){return this._values[t]};var pi=function(t){this.specification=t};pi.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},pi.prototype.interpolate=function(t,e,n){var r=qe[this.specification.type];return r?r(t,e,n):t};var fi=function(t,e){this.specification=t,this.overrides=e};fi.prototype.possiblyEvaluate=function(t,e,n,r){return new hi(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,r)}:t.expression,e)},fi.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new hi(this,{kind:"constant",value:void 0},t.parameters);var r=qe[this.specification.type];return r?new hi(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t},fi.prototype.evaluate=function(t,e,n,r,i,a){return"constant"===t.kind?t.value:t.evaluate(e,n,r,i,a)};var mi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(t,e,n,r){if(void 0===t.value)return new hi(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},n,r),a="resolvedImage"===t.property.specification.type&&"string"!=typeof i?i.name:i,s=this._calculate(a,a,a,e);return new hi(this,{kind:"constant",value:s},e)}if("camera"===t.expression.kind){var o=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new hi(this,{kind:"constant",value:o},e)}return new hi(this,t.expression,e)},e.prototype.evaluate=function(t,e,n,r,i,a){if("source"===t.kind){var s=t.evaluate(e,n,r,i,a);return this._calculate(s,s,s,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value},e.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},e.prototype.interpolate=function(t){return t},e}(fi),gi=function(t){this.specification=t};gi.prototype.possiblyEvaluate=function(t,e,n,r){if(void 0!==t.value){if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},n,r);return this._calculate(i,i,i,e)}return this._calculate(t.expression.evaluate(new ii(Math.floor(e.zoom-1),e)),t.expression.evaluate(new ii(Math.floor(e.zoom),e)),t.expression.evaluate(new ii(Math.floor(e.zoom+1),e)),e)}},gi.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},gi.prototype.interpolate=function(t){return t};var yi=function(t){this.specification=t};yi.prototype.possiblyEvaluate=function(t,e,n,r){return!!t.expression.evaluate(e,null,{},n,r)},yi.prototype.interpolate=function(){return!1};var vi=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var n=t[e];n.specification.overridable&&this.overridableProperties.push(e);var r=this.defaultPropertyValues[e]=new ai(n,void 0),i=this.defaultTransitionablePropertyValues[e]=new si(n);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}};Pr("DataDrivenProperty",fi),Pr("DataConstantProperty",pi),Pr("CrossFadedDataDrivenProperty",mi),Pr("CrossFadedProperty",gi),Pr("ColorRampProperty",yi);var _i=function(t){function e(e,n){if(t.call(this),this.id=e.id,this.type=e.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new ci(n.layout)),n.paint)){for(var r in this._transitionablePaint=new oi(n.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new di(n.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){void 0===n&&(n={}),null!=e&&this._validate(Er,"layers."+this.id+".layout."+t,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)},e.prototype.getPaintProperty=function(t){return g(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(void 0===n&&(n={}),null!=e&&this._validate(kr,"layers."+this.id+".paint."+t,t,e,n))return!1;if(g(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var r=this._transitionablePaint._values[t],i="cross-faded-data-driven"===r.property.specification["property-type"],a=r.value.isDataDriven(),s=r.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var o=this._transitionablePaint._values[t].value;return o.isDataDriven()||a||i||this._handleOverridablePaintPropertyUpdate(t,s,o)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype._handleOverridablePaintPropertyUpdate=function(t,e,n){return!1},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),v(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},e.prototype._validate=function(t,e,n,r,i){return void 0===i&&(i={}),(!i||!1!==i.validate)&&Ar(this,t.call(Dr,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:It,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof hi&&Rn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(Dt),bi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},xi=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},wi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Si(t,e){void 0===e&&(e=1);var n=0,r=0;return{members:t.map((function(t){var i=bi[t.type].BYTES_PER_ELEMENT,a=n=Ci(n,Math.max(e,i)),s=t.components||1;return r=Math.max(r,i),n+=i*s,{name:t.name,type:t.type,components:s,offset:a}})),size:Ci(n,Math.max(r,e)),alignment:e}}function Ci(t,e){return Math.ceil(t/e)*e}wi.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},wi.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},wi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},wi.prototype.clear=function(){this.length=0},wi.prototype.resize=function(t){this.reserve(t),this.length=t},wi.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},wi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Di=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t},e}(wi);Di.prototype.bytesPerElement=4,Pr("StructArrayLayout2i4",Di);var Ii=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var a=4*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=r,this.int16[a+3]=i,t},e}(wi);Ii.prototype.bytesPerElement=8,Pr("StructArrayLayout4i8",Ii);var ki=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a){var s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,r,i,a)},e.prototype.emplace=function(t,e,n,r,i,a,s){var o=6*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,this.int16[o+4]=a,this.int16[o+5]=s,t},e}(wi);ki.prototype.bytesPerElement=12,Pr("StructArrayLayout2i4i12",ki);var Ei=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a){var s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,r,i,a)},e.prototype.emplace=function(t,e,n,r,i,a,s){var o=4*t,l=8*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.uint8[l+4]=r,this.uint8[l+5]=i,this.uint8[l+6]=a,this.uint8[l+7]=s,t},e}(wi);Ei.prototype.bytesPerElement=8,Pr("StructArrayLayout2i4ub8",Ei);var Ai=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a,s,o,l,u){var c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,r,i,a,s,o,l,u)},e.prototype.emplace=function(t,e,n,r,i,a,s,o,l,u,c){var h=9*t,d=18*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=r,this.uint16[h+3]=i,this.uint16[h+4]=a,this.uint16[h+5]=s,this.uint16[h+6]=o,this.uint16[h+7]=l,this.uint8[d+16]=u,this.uint8[d+17]=c,t},e}(wi);Ai.prototype.bytesPerElement=18,Pr("StructArrayLayout8ui2ub18",Ai);var Ti=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a,s,o,l,u,c,h){var d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,r,i,a,s,o,l,u,c,h)},e.prototype.emplace=function(t,e,n,r,i,a,s,o,l,u,c,h,d){var p=12*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=r,this.int16[p+3]=i,this.uint16[p+4]=a,this.uint16[p+5]=s,this.uint16[p+6]=o,this.uint16[p+7]=l,this.int16[p+8]=u,this.int16[p+9]=c,this.int16[p+10]=h,this.int16[p+11]=d,t},e}(wi);Ti.prototype.bytesPerElement=24,Pr("StructArrayLayout4i4ui4i24",Ti);var Ri=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t},e}(wi);Ri.prototype.bytesPerElement=12,Pr("StructArrayLayout3f12",Ri);var Mi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint32[1*t+0]=e,t},e}(wi);Mi.prototype.bytesPerElement=4,Pr("StructArrayLayout1ul4",Mi);var Ni=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a,s,o,l){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,r,i,a,s,o,l)},e.prototype.emplace=function(t,e,n,r,i,a,s,o,l,u){var c=10*t,h=5*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.int16[c+4]=a,this.int16[c+5]=s,this.uint32[h+3]=o,this.uint16[c+8]=l,this.uint16[c+9]=u,t},e}(wi);Ni.prototype.bytesPerElement=20,Pr("StructArrayLayout6i1ul2ui20",Ni);var Oi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a){var s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,r,i,a)},e.prototype.emplace=function(t,e,n,r,i,a,s){var o=6*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,this.int16[o+4]=a,this.int16[o+5]=s,t},e}(wi);Oi.prototype.bytesPerElement=12,Pr("StructArrayLayout2i2i2i12",Oi);var Pi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i)},e.prototype.emplace=function(t,e,n,r,i,a){var s=4*t,o=8*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=r,this.int16[o+6]=i,this.int16[o+7]=a,t},e}(wi);Pi.prototype.bytesPerElement=16,Pr("StructArrayLayout2f1f2i16",Pi);var Fi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var a=12*t,s=3*t;return this.uint8[a+0]=e,this.uint8[a+1]=n,this.float32[s+1]=r,this.float32[s+2]=i,t},e}(wi);Fi.prototype.bytesPerElement=12,Pr("StructArrayLayout2ub2f12",Fi);var Li=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t},e}(wi);Li.prototype.bytesPerElement=6,Pr("StructArrayLayout3ui6",Li);var zi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g){var y=this.length;return this.resize(y+1),this.emplace(y,t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g)},e.prototype.emplace=function(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g,y){var v=24*t,_=12*t,b=48*t;return this.int16[v+0]=e,this.int16[v+1]=n,this.uint16[v+2]=r,this.uint16[v+3]=i,this.uint32[_+2]=a,this.uint32[_+3]=s,this.uint32[_+4]=o,this.uint16[v+10]=l,this.uint16[v+11]=u,this.uint16[v+12]=c,this.float32[_+7]=h,this.float32[_+8]=d,this.uint8[b+36]=p,this.uint8[b+37]=f,this.uint8[b+38]=m,this.uint32[_+10]=g,this.int16[v+22]=y,t},e}(wi);zi.prototype.bytesPerElement=48,Pr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",zi);var $i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g,y,v,_,b,x,w,S,C,D,I,k){var E=this.length;return this.resize(E+1),this.emplace(E,t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g,y,v,_,b,x,w,S,C,D,I,k)},e.prototype.emplace=function(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g,y,v,_,b,x,w,S,C,D,I,k,E){var A=34*t,T=17*t;return this.int16[A+0]=e,this.int16[A+1]=n,this.int16[A+2]=r,this.int16[A+3]=i,this.int16[A+4]=a,this.int16[A+5]=s,this.int16[A+6]=o,this.int16[A+7]=l,this.uint16[A+8]=u,this.uint16[A+9]=c,this.uint16[A+10]=h,this.uint16[A+11]=d,this.uint16[A+12]=p,this.uint16[A+13]=f,this.uint16[A+14]=m,this.uint16[A+15]=g,this.uint16[A+16]=y,this.uint16[A+17]=v,this.uint16[A+18]=_,this.uint16[A+19]=b,this.uint16[A+20]=x,this.uint16[A+21]=w,this.uint16[A+22]=S,this.uint32[T+12]=C,this.float32[T+13]=D,this.float32[T+14]=I,this.float32[T+15]=k,this.float32[T+16]=E,t},e}(wi);$i.prototype.bytesPerElement=68,Pr("StructArrayLayout8i15ui1ul4f68",$i);var Bi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.float32[1*t+0]=e,t},e}(wi);Bi.prototype.bytesPerElement=4,Pr("StructArrayLayout1f4",Bi);var Wi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t},e}(wi);Wi.prototype.bytesPerElement=6,Pr("StructArrayLayout3i6",Wi);var qi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=4*t;return this.uint32[2*t+0]=e,this.uint16[i+2]=n,this.uint16[i+3]=r,t},e}(wi);qi.prototype.bytesPerElement=8,Pr("StructArrayLayout1ul2ui8",qi);var Vi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t},e}(wi);Vi.prototype.bytesPerElement=4,Pr("StructArrayLayout2ui4",Vi);var Ui=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint16[1*t+0]=e,t},e}(wi);Ui.prototype.bytesPerElement=2,Pr("StructArrayLayout1ui2",Ui);var ji=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t},e}(wi);ji.prototype.bytesPerElement=8,Pr("StructArrayLayout2f8",ji);var Hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var a=4*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=r,this.float32[a+3]=i,t},e}(wi);Hi.prototype.bytesPerElement=16,Pr("StructArrayLayout4f16",Hi);var Gi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(xi);Gi.prototype.size=20;var Ji=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Gi(this,t)},e}(Ni);Pr("CollisionBoxArray",Ji);var Xi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},n.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},n.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,n),e}(xi);Xi.prototype.size=48;var Ki=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Xi(this,t)},e}(zi);Pr("PlacedSymbolArray",Ki);var Zi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},n.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},n.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},n.key.get=function(){return this._structArray.uint16[this._pos2+8]},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},n.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},n.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},n.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},n.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},n.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},n.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},n.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+12]=t},n.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},n.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},n.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},n.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,n),e}(xi);Zi.prototype.size=68;var Yi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Zi(this,t)},e}($i);Pr("SymbolInstanceArray",Yi);var Qi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e}(Bi);Pr("GlyphOffsetArray",Qi);var ta=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e}(Wi);Pr("SymbolLineVertexArray",ta);var ea=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,n),e}(xi);ea.prototype.size=8;var na=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new ea(this,t)},e}(qi);Pr("FeatureIndexArray",na);var ra=Si([{name:"a_pos",components:2,type:"Int16"}],4).members,ia=function(t){void 0===t&&(t=[]),this.segments=t};function aa(t,e){return 256*(t=l(Math.floor(t),0,255))+l(Math.floor(e),0,255)}ia.prototype.prepareSegment=function(t,e,n,r){var i=this.segments[this.segments.length-1];return t>ia.MAX_VERTEX_ARRAY_LENGTH&&x("Max vertices per segment is "+ia.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!i||i.vertexLength+t>ia.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i},ia.prototype.get=function(){return this.segments},ia.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var r in n.vaos)n.vaos[r].destroy()}},ia.simpleSegment=function(t,e,n,r){return new ia([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])},ia.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pr("SegmentVector",ia);var sa=Si([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),oa=e((function(t){t.exports=function(t,e){var n,r,i,a,s,o,l,u;for(r=t.length-(n=3&t.length),i=e,s=3432918353,o=461845907,u=0;u<r;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,i=27492+(65535&(a=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}})),la=e((function(t){t.exports=function(t,e){for(var n,r=t.length,i=e^r,a=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++a;switch(r){case 3:i^=(255&t.charCodeAt(a+2))<<16;case 2:i^=(255&t.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(a)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}})),ua=oa,ca=la;ua.murmur3=oa,ua.murmur2=ca;var ha=function(){this.ids=[],this.positions=[],this.indexed=!1};ha.prototype.add=function(t,e,n,r){this.ids.push(pa(t)),this.positions.push(e,n,r)},ha.prototype.getPositions=function(t){for(var e=pa(t),n=0,r=this.ids.length-1;n<r;){var i=n+r>>1;this.ids[i]>=e?r=i:n=i+1}for(var a=[];this.ids[n]===e;)a.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return a},ha.serialize=function(t,e){var n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return function t(e,n,r,i){for(;r<i;){for(var a=e[r+i>>1],s=r-1,o=i+1;;){do{s++}while(e[s]<a);do{o--}while(e[o]>a);if(s>=o)break;fa(e,s,o),fa(n,3*s,3*o),fa(n,3*s+1,3*o+1),fa(n,3*s+2,3*o+2)}o-r<i-o?(t(e,n,r,o),r=o+1):(t(e,n,o+1,i),i=o)}}(n,r,0,n.length-1),e&&e.push(n.buffer,r.buffer),{ids:n,positions:r}},ha.deserialize=function(t){var e=new ha;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var da=Math.pow(2,53)-1;function pa(t){var e=+t;return!isNaN(e)&&e<=da?e:ua(String(t))}function fa(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}Pr("FeaturePositionMap",ha);var ma=function(t,e){this.gl=t.gl,this.location=e},ga=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(ma),ya=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(ma),va=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(ma),_a=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(ma),ba=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(ma),xa=function(t){function e(e,n){t.call(this,e,n),this.current=Zt.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(ma),wa=new Float32Array(16),Sa=function(t){function e(e,n){t.call(this,e,n),this.current=wa}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(ma);function Ca(t){return[aa(255*t.r,255*t.g),aa(255*t.b,255*t.a)]}var Da=function(t,e,n){this.value=t,this.uniformNames=e.map((function(t){return"u_"+t})),this.type=n};Da.prototype.setUniform=function(t,e,n){t.set(n.constantOr(this.value))},Da.prototype.getBinding=function(t,e,n){return"color"===this.type?new xa(t,e):new ya(t,e)};var Ia=function(t,e){this.uniformNames=e.map((function(t){return"u_"+t})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ia.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},Ia.prototype.setUniform=function(t,e,n,r){var i="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;i&&t.set(i)},Ia.prototype.getBinding=function(t,e,n){return"u_pattern"===n.substr(0,9)?new ba(t,e):new ya(t,e)};var ka=function(t,e,n,r){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new r};ka.prototype.populatePaintArray=function(t,e,n,r,i){var a=this.paintVertexArray.length,s=this.expression.evaluate(new ii(0),e,{},r,[],i);this.paintVertexArray.resize(t),this._setPaintValue(a,t,s)},ka.prototype.updatePaintArray=function(t,e,n,r){var i=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(t,e,i)},ka.prototype._setPaintValue=function(t,e,n){if("color"===this.type)for(var r=Ca(n),i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1]);else{for(var a=t;a<e;a++)this.paintVertexArray.emplace(a,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}},ka.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ka.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ea=function(t,e,n,r,i,a){this.expression=t,this.uniformNames=e.map((function(t){return"u_"+t+"_t"})),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new a};Ea.prototype.populatePaintArray=function(t,e,n,r,i){var a=this.expression.evaluate(new ii(this.zoom),e,{},r,[],i),s=this.expression.evaluate(new ii(this.zoom+1),e,{},r,[],i),o=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(o,t,a,s)},Ea.prototype.updatePaintArray=function(t,e,n,r){var i=this.expression.evaluate({zoom:this.zoom},n,r),a=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(t,e,i,a)},Ea.prototype._setPaintValue=function(t,e,n,r){if("color"===this.type)for(var i=Ca(n),a=Ca(r),s=t;s<e;s++)this.paintVertexArray.emplace(s,i[0],i[1],a[0],a[1]);else{for(var o=t;o<e;o++)this.paintVertexArray.emplace(o,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}},Ea.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ea.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ea.prototype.setUniform=function(t,e){var n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=l(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(r)},Ea.prototype.getBinding=function(t,e,n){return new ya(t,e)};var Aa=function(t,e,n,r,i,a){this.expression=t,this.type=e,this.useIntegerZoom=n,this.zoom=r,this.layerId=a,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i};Aa.prototype.populatePaintArray=function(t,e,n){var r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],n)},Aa.prototype.updatePaintArray=function(t,e,n,r,i){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],i)},Aa.prototype._setPaintValues=function(t,e,n,r){if(r&&n){var i=r[n.min],a=r[n.mid],s=r[n.max];if(i&&a&&s)for(var o=t;o<e;o++)this.zoomInPaintVertexArray.emplace(o,a.tl[0],a.tl[1],a.br[0],a.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],a.pixelRatio,i.pixelRatio),this.zoomOutPaintVertexArray.emplace(o,a.tl[0],a.tl[1],a.br[0],a.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],a.pixelRatio,s.pixelRatio)}},Aa.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,sa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,sa.members,this.expression.isStateDependent))},Aa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ta=function(t,e,n,r){this.binders={},this.layoutAttributes=r,this._buffers=[];var i=[];for(var a in t.paint._values)if(n(a)){var s=t.paint.get(a);if(s instanceof hi&&Rn(s.property.specification)){var o=Ma(a,t.type),l=s.value,u=s.property.specification.type,c=s.property.useIntegerZoom,h=s.property.specification["property-type"],d="cross-faded"===h||"cross-faded-data-driven"===h;if("constant"===l.kind)this.binders[a]=d?new Ia(l.value,o):new Da(l.value,o,u),i.push("/u_"+a);else if("source"===l.kind||d){var p=Na(a,u,"source");this.binders[a]=d?new Aa(l,u,c,e,p,t.id):new ka(l,o,u,p),i.push("/a_"+a)}else{var f=Na(a,u,"composite");this.binders[a]=new Ea(l,o,u,c,e,f),i.push("/z_"+a)}}}this.cacheKey=i.sort().join("")};Ta.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof ka||e instanceof Ea?e.maxValue:0},Ta.prototype.populatePaintArrays=function(t,e,n,r,i){for(var a in this.binders){var s=this.binders[a];(s instanceof ka||s instanceof Ea||s instanceof Aa)&&s.populatePaintArray(t,e,n,r,i)}},Ta.prototype.setConstantPatternPositions=function(t,e){for(var n in this.binders){var r=this.binders[n];r instanceof Ia&&r.setConstantPatternPositions(t,e)}},Ta.prototype.updatePaintArrays=function(t,e,n,r,i){var a=!1;for(var s in t)for(var o=0,l=e.getPositions(s);o<l.length;o+=1){var u=l[o],c=n.feature(u.index);for(var h in this.binders){var d=this.binders[h];if((d instanceof ka||d instanceof Ea||d instanceof Aa)&&!0===d.expression.isStateDependent){var p=r.paint.get(h);d.expression=p.value,d.updatePaintArray(u.start,u.end,c,t[s],i),a=!0}}}return a},Ta.prototype.defines=function(){var t=[];for(var e in this.binders){var n=this.binders[e];(n instanceof Da||n instanceof Ia)&&t.push.apply(t,n.uniformNames.map((function(t){return"#define HAS_UNIFORM_"+t})))}return t},Ta.prototype.getPaintVertexBuffers=function(){return this._buffers},Ta.prototype.getUniforms=function(t,e){var n=[];for(var r in this.binders){var i=this.binders[r];if(i instanceof Da||i instanceof Ia||i instanceof Ea)for(var a=0,s=i.uniformNames;a<s.length;a+=1){var o=s[a];if(e[o]){var l=i.getBinding(t,e[o],o);n.push({name:o,property:r,binding:l})}}}return n},Ta.prototype.setUniforms=function(t,e,n,r){for(var i=0,a=e;i<a.length;i+=1){var s=a[i],o=s.name,l=s.property;this.binders[l].setUniform(s.binding,r,n.get(l),o)}},Ta.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var n=this.binders[e];if(t&&n instanceof Aa){var r=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;r&&this._buffers.push(r)}else(n instanceof ka||n instanceof Ea)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}},Ta.prototype.upload=function(t){for(var e in this.binders){var n=this.binders[e];(n instanceof ka||n instanceof Ea||n instanceof Aa)&&n.upload(t)}this.updatePaintBuffers()},Ta.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof ka||e instanceof Ea||e instanceof Aa)&&e.destroy()}};var Ra=function(t,e,n,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var i=0,a=e;i<a.length;i+=1){var s=a[i];this.programConfigurations[s.id]=new Ta(s,n,r,t)}this.needsUpload=!1,this._featureMap=new ha,this._bufferOffset=0};function Ma(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Na(t,e,n){var r={color:{source:ji,composite:Hi},number:{source:Bi,composite:ji}},i=function(t){return{"line-pattern":{source:Ai,composite:Ai},"fill-pattern":{source:Ai,composite:Ai},"fill-extrusion-pattern":{source:Ai,composite:Ai}}[t]}(t);return i&&i[n]||r[e][n]}Ra.prototype.populatePaintArrays=function(t,e,n,r,i,a){for(var s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(t,e,r,i,a);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Ra.prototype.updatePaintArrays=function(t,e,n,r){for(var i=0,a=n;i<a.length;i+=1){var s=a[i];this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(t,this._featureMap,e,s,r)||this.needsUpload}},Ra.prototype.get=function(t){return this.programConfigurations[t]},Ra.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Ra.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Pr("ConstantBinder",Da),Pr("CrossFadedConstantBinder",Ia),Pr("SourceExpressionBinder",ka),Pr("CrossFadedCompositeBinder",Aa),Pr("CompositeExpressionBinder",Ea),Pr("ProgramConfiguration",Ta,{omit:["_buffers"]}),Pr("ProgramConfigurationSet",Ra);var Oa={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1};function Pa(t){for(var e=8192/t.extent,n=t.loadGeometry(),r=0;r<n.length;r++)for(var i=n[r],a=0;a<i.length;a++){var s=i[a];s.x=Math.round(s.x*e),s.y=Math.round(s.y*e),(s.x<Oa.min||s.x>Oa.max||s.y<Oa.min||s.y>Oa.max)&&(x("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s.x=l(s.x,Oa.min,Oa.max),s.y=l(s.y,Oa.min,Oa.max))}return n}function Fa(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}var La=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Di,this.indexArray=new Li,this.segments=new ia,this.programConfigurations=new Ra(ra,t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function za(t,e){for(var n=0;n<t.length;n++)if(Ga(e,t[n]))return!0;for(var r=0;r<e.length;r++)if(Ga(t,e[r]))return!0;return!!qa(t,e)}function $a(t,e,n){return!!Ga(t,e)||!!Ua(e,t,n)}function Ba(t,e){if(1===t.length)return Ha(e,t[0]);for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<r.length;i++)if(Ga(t,r[i]))return!0;for(var a=0;a<t.length;a++)if(Ha(e,t[a]))return!0;for(var s=0;s<e.length;s++)if(qa(t,e[s]))return!0;return!1}function Wa(t,e,n){if(t.length>1){if(qa(t,e))return!0;for(var r=0;r<e.length;r++)if(Ua(e[r],t,n))return!0}for(var i=0;i<t.length;i++)if(Ua(t[i],e,n))return!0;return!1}function qa(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var r=t[n],i=t[n+1],a=0;a<e.length-1;a++)if(Va(r,i,e[a],e[a+1]))return!0;return!1}function Va(t,e,n,r){return w(t,n,r)!==w(e,n,r)&&w(t,e,n)!==w(t,e,r)}function Ua(t,e,n){var r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(var i=1;i<e.length;i++)if(ja(t,e[i-1],e[i])<r)return!0;return!1}function ja(t,e,n){var r=e.distSqr(n);if(0===r)return t.distSqr(e);var i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return t.distSqr(i<0?e:i>1?n:n.sub(e)._mult(i)._add(e))}function Ha(t,e){for(var n,r,i,a=!1,s=0;s<t.length;s++)for(var o=0,l=(n=t[s]).length-1;o<n.length;l=o++)(r=n[o]).y>e.y!=(i=n[l]).y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(a=!a);return a}function Ga(t,e){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var a=t[r],s=t[i];a.y>e.y!=s.y>e.y&&e.x<(s.x-a.x)*(e.y-a.y)/(s.y-a.y)+a.x&&(n=!n)}return n}function Ja(t,e,n){var r=n[0],i=n[2];if(t.x<r.x&&e.x<r.x||t.x>i.x&&e.x>i.x||t.y<r.y&&e.y<r.y||t.y>i.y&&e.y>i.y)return!1;var a=w(t,e,n[0]);return a!==w(t,e,n[1])||a!==w(t,e,n[2])||a!==w(t,e,n[3])}function Xa(t,e,n){var r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).getMaxValue(t)}function Ka(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Za(t,e,n,r,a){if(!e[0]&&!e[1])return t;var s=i.convert(e)._mult(a);"viewport"===n&&s._rotate(-r);for(var o=[],l=0;l<t.length;l++)o.push(t[l].sub(s));return o}La.prototype.populate=function(t,e,n){var r=this.layers[0],i=[],a=null;"circle"===r.type&&(a=r.layout.get("circle-sort-key"));for(var s=0,o=t;s<o.length;s+=1){var l=o[s],u=l.feature,c=l.id,h=l.index,d=l.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,f={type:u.type,id:c,properties:u.properties,geometry:p?Pa(u):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),f,n)){p||(f.geometry=Pa(u));var m=a?a.evaluate(f,{},n):void 0;i.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:d,index:h,geometry:f.geometry,patterns:{},sortKey:m})}}a&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var g=0,y=i;g<y.length;g+=1){var v=y[g],_=v.geometry,b=v.index,x=v.sourceLayerIndex,w=t[b].feature;this.addFeature(v,_,b,n),e.featureIndex.insert(w,_,b,x,this.index)}},La.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},La.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},La.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},La.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ra),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},La.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},La.prototype.addFeature=function(t,e,n,r){for(var i=0,a=e;i<a.length;i+=1)for(var s=0,o=a[i];s<o.length;s+=1){var l=o[s],u=l.x,c=l.y;if(!(u<0||u>=8192||c<0||c>=8192)){var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),d=h.vertexLength;Fa(this.layoutVertexArray,u,c,-1,-1),Fa(this.layoutVertexArray,u,c,1,-1),Fa(this.layoutVertexArray,u,c,1,1),Fa(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(d,d+1,d+2),this.indexArray.emplaceBack(d,d+3,d+2),h.vertexLength+=4,h.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},r)},Pr("CircleBucket",La,{omit:["layers"]});var Ya=new vi({"circle-sort-key":new fi(It.layout_circle["circle-sort-key"])}),Qa={paint:new vi({"circle-radius":new fi(It.paint_circle["circle-radius"]),"circle-color":new fi(It.paint_circle["circle-color"]),"circle-blur":new fi(It.paint_circle["circle-blur"]),"circle-opacity":new fi(It.paint_circle["circle-opacity"]),"circle-translate":new pi(It.paint_circle["circle-translate"]),"circle-translate-anchor":new pi(It.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pi(It.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pi(It.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new fi(It.paint_circle["circle-stroke-width"]),"circle-stroke-color":new fi(It.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new fi(It.paint_circle["circle-stroke-opacity"])}),layout:Ya},ts="undefined"!=typeof Float32Array?Float32Array:Array;function es(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ns(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*r+b*o+x*h+w*m,t[1]=_*i+b*l+x*d+w*g,t[2]=_*a+b*u+x*p+w*y,t[3]=_*s+b*c+x*f+w*v,t[4]=(_=n[4])*r+(b=n[5])*o+(x=n[6])*h+(w=n[7])*m,t[5]=_*i+b*l+x*d+w*g,t[6]=_*a+b*u+x*p+w*y,t[7]=_*s+b*c+x*f+w*v,t[8]=(_=n[8])*r+(b=n[9])*o+(x=n[10])*h+(w=n[11])*m,t[9]=_*i+b*l+x*d+w*g,t[10]=_*a+b*u+x*p+w*y,t[11]=_*s+b*c+x*f+w*v,t[12]=(_=n[12])*r+(b=n[13])*o+(x=n[14])*h+(w=n[15])*m,t[13]=_*i+b*l+x*d+w*g,t[14]=_*a+b*u+x*p+w*y,t[15]=_*s+b*c+x*f+w*v,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,n=arguments.length;n--;)e+=t[n]*t[n];return Math.sqrt(e)});var rs,is=ns;function as(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*s,t}rs=new ts(3),ts!=Float32Array&&(rs[0]=0,rs[1]=0,rs[2]=0),function(){var t=new ts(4);ts!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var ss=(function(){var t=new ts(2);ts!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(e){t.call(this,e,Qa)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new La(t)},e.prototype.queryRadius=function(t){var e=t;return Xa("circle-radius",this,e)+Xa("circle-stroke-width",this,e)+Ka(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,a,s,o){for(var l=Za(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),c="map"===this.paint.get("circle-pitch-alignment"),h=c?l:function(t,e){return t.map((function(t){return os(t,e)}))}(l,o),d=c?u*s:u,p=0,f=r;p<f.length;p+=1)for(var m=0,g=f[p];m<g.length;m+=1){var y=g[m],v=c?y:os(y,o),_=d,b=as([],[y.x,y.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=a.cameraToCenterDistance/b[3]),$a(h,v,_))return!0}return!1},e}(_i));function os(t,e){var n=as([],[t.x,t.y,0,1],e);return new i(n[0]/n[3],n[1]/n[3])}var ls=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(La);function us(t,e,n,r){var i=e.width,a=e.height;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==i*a*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*a*n);return t.width=i,t.height=a,t.data=r,t}function cs(t,e,n){var r=e.width,i=e.height;if(r!==t.width||i!==t.height){var a=us({},{width:r,height:i},n);hs(t,a,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,i)},n),t.width=r,t.height=i,t.data=a.data}}function hs(t,e,n,r,i,a){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var s=t.data,o=e.data,l=0;l<i.height;l++)for(var u=((n.y+l)*t.width+n.x)*a,c=((r.y+l)*e.width+r.x)*a,h=0;h<i.width*a;h++)o[c+h]=s[u+h];return e}Pr("HeatmapBucket",ls,{omit:["layers"]});var ds=function(t,e){us(this,t,1,e)};ds.prototype.resize=function(t){cs(this,t,1)},ds.prototype.clone=function(){return new ds({width:this.width,height:this.height},new Uint8Array(this.data))},ds.copy=function(t,e,n,r,i){hs(t,e,n,r,i,1)};var ps=function(t,e){us(this,t,4,e)};ps.prototype.resize=function(t){cs(this,t,4)},ps.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},ps.prototype.clone=function(){return new ps({width:this.width,height:this.height},new Uint8Array(this.data))},ps.copy=function(t,e,n,r,i){hs(t,e,n,r,i,4)},Pr("AlphaImage",ds),Pr("RGBAImage",ps);var fs={paint:new vi({"heatmap-radius":new fi(It.paint_heatmap["heatmap-radius"]),"heatmap-weight":new fi(It.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pi(It.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yi(It.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pi(It.paint_heatmap["heatmap-opacity"])})};function ms(t,e){for(var n=new Uint8Array(1024),r={},i=0,a=0;i<256;i++,a+=4){r[e]=i/255;var s=t.evaluate(r);n[a+0]=Math.floor(255*s.r/s.a),n[a+1]=Math.floor(255*s.g/s.a),n[a+2]=Math.floor(255*s.b/s.a),n[a+3]=Math.floor(255*s.a)}return new ps({width:256,height:1},n)}var gs=function(t){function e(e){t.call(this,e,fs),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new ls(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=ms(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(_i),ys={paint:new vi({"hillshade-illumination-direction":new pi(It.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new pi(It.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pi(It.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pi(It.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pi(It.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pi(It.paint_hillshade["hillshade-accent-color"])})},vs=function(t){function e(e){t.call(this,e,ys)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(_i),_s=Si([{name:"a_pos",components:2,type:"Int16"}],4).members,bs=ws,xs=ws;function ws(t,e,n){n=n||2;var r,i,a,s,o,l,u,c=e&&e.length,h=c?e[0]*n:t.length,d=Ss(t,0,h,n,!0),p=[];if(!d||d.next===d.prev)return p;if(c&&(d=function(t,e,n,r){var i,a,s,o=[];for(i=0,a=e.length;i<a;i++)(s=Ss(t,e[i]*r,i<a-1?e[i+1]*r:t.length,r,!1))===s.next&&(s.steiner=!0),o.push(Os(s));for(o.sort(Ts),i=0;i<o.length;i++)Rs(o[i],n),n=Cs(n,n.next);return n}(t,e,d,n)),t.length>80*n){r=a=t[0],i=s=t[1];for(var f=n;f<h;f+=n)(o=t[f])<r&&(r=o),(l=t[f+1])<i&&(i=l),o>a&&(a=o),l>s&&(s=l);u=0!==(u=Math.max(a-r,s-i))?1/u:0}return Ds(d,p,n,r,i,u),p}function Ss(t,e,n,r,i){var a,s;if(i===Gs(t,e,n,r)>0)for(a=e;a<n;a+=r)s=Us(a,t[a],t[a+1],s);else for(a=n-r;a>=e;a-=r)s=Us(a,t[a],t[a+1],s);return s&&zs(s,s.next)&&(js(s),s=s.next),s}function Cs(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!zs(r,r.next)&&0!==Ls(r.prev,r,r.next))r=r.next;else{if(js(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ds(t,e,n,r,i,a,s){if(t){!s&&a&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=Ns(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,a,s,o,l,u=1;do{for(n=t,t=null,a=null,s=0;n;){for(s++,r=n,o=0,e=0;e<u&&(o++,r=r.nextZ);e++);for(l=u;o>0||l>0&&r;)0!==o&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,u*=2}while(s>1)}(i)}(t,r,i,a);for(var o,l,u=t;t.prev!==t.next;)if(o=t.prev,l=t.next,a?ks(t,r,i,a):Is(t))e.push(o.i/n),e.push(t.i/n),e.push(l.i/n),js(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?Ds(t=Es(Cs(t),e,n),e,n,r,i,a,2):2===s&&As(t,e,n,r,i,a):Ds(Cs(t),e,n,r,i,a,1);break}}}function Is(t){var e=t.prev,n=t,r=t.next;if(Ls(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Ps(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Ls(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ks(t,e,n,r){var i=t.prev,a=t,s=t.next;if(Ls(i,a,s)>=0)return!1;for(var o=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,l=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,u=Ns(i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,e,n,r),c=Ns(o,l,e,n,r),h=t.prevZ,d=t.nextZ;h&&h.z>=u&&d&&d.z<=c;){if(h!==t.prev&&h!==t.next&&Ps(i.x,i.y,a.x,a.y,s.x,s.y,h.x,h.y)&&Ls(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==t.prev&&d!==t.next&&Ps(i.x,i.y,a.x,a.y,s.x,s.y,d.x,d.y)&&Ls(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=u;){if(h!==t.prev&&h!==t.next&&Ps(i.x,i.y,a.x,a.y,s.x,s.y,h.x,h.y)&&Ls(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=c;){if(d!==t.prev&&d!==t.next&&Ps(i.x,i.y,a.x,a.y,s.x,s.y,d.x,d.y)&&Ls(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Es(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!zs(i,a)&&$s(i,r,r.next,a)&&qs(i,a)&&qs(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),js(r),js(r.next),r=t=a),r=r.next}while(r!==t);return Cs(r)}function As(t,e,n,r,i,a){var s=t;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&Fs(s,o)){var l=Vs(s,o);return s=Cs(s,s.next),l=Cs(l,l.next),Ds(s,e,n,r,i,a),void Ds(l,e,n,r,i,a)}o=o.next}s=s.next}while(s!==t)}function Ts(t,e){return t.x-e.x}function Rs(t,e){if(e=function(t,e){var n,r=e,i=t.x,a=t.y,s=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var o=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=i&&o>s){if(s=o,o===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n;var l,u=n,c=n.x,h=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&Ps(a<h?i:s,a,c,h,a<h?s:i,a,r.x,r.y)&&(l=Math.abs(a-r.y)/(i-r.x),qs(r,t)&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&Ms(n,r)))&&(n=r,d=l)),r=r.next}while(r!==u);return n}(t,e)){var n=Vs(e,t);Cs(e,e.next),Cs(n,n.next)}}function Ms(t,e){return Ls(t.prev,t,e.prev)<0&&Ls(e.next,t,t.next)<0}function Ns(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Os(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Ps(t,e,n,r,i,a,s,o){return(i-s)*(e-o)-(t-s)*(a-o)>=0&&(t-s)*(r-o)-(n-s)*(e-o)>=0&&(n-s)*(a-o)-(i-s)*(r-o)>=0}function Fs(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&$s(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(qs(t,e)&&qs(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(Ls(t.prev,t,e.prev)||Ls(t,e.prev,e))||zs(t,e)&&Ls(t.prev,t,t.next)>0&&Ls(e.prev,e,e.next)>0)}function Ls(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function zs(t,e){return t.x===e.x&&t.y===e.y}function $s(t,e,n,r){var i=Ws(Ls(t,e,n)),a=Ws(Ls(t,e,r)),s=Ws(Ls(n,r,t)),o=Ws(Ls(n,r,e));return i!==a&&s!==o||!(0!==i||!Bs(t,n,e))||!(0!==a||!Bs(t,r,e))||!(0!==s||!Bs(n,t,r))||!(0!==o||!Bs(n,e,r))}function Bs(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ws(t){return t>0?1:t<0?-1:0}function qs(t,e){return Ls(t.prev,t,t.next)<0?Ls(t,e,t.next)>=0&&Ls(t,t.prev,e)>=0:Ls(t,e,t.prev)<0||Ls(t,t.next,e)<0}function Vs(t,e){var n=new Hs(t.i,t.x,t.y),r=new Hs(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Us(t,e,n,r){var i=new Hs(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function js(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Hs(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gs(t,e,n,r){for(var i=0,a=e,s=n-r;a<n;a+=r)i+=(t[s]-t[a])*(t[a+1]+t[s+1]),s=a;return i}function Js(t,e,n,r,i){!function t(e,n,r,i,a){for(;i>r;){if(i-r>600){var s=i-r+1,o=n-r+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(o-s/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-o*u/s+c)),Math.min(i,Math.floor(n+(s-o)*u/s+c)),a)}var h=e[n],d=r,p=i;for(Xs(e,r,n),a(e[i],h)>0&&Xs(e,r,i);d<p;){for(Xs(e,d,p),d++,p--;a(e[d],h)<0;)d++;for(;a(e[p],h)>0;)p--}0===a(e[r],h)?Xs(e,r,p):Xs(e,++p,i),p<=n&&(r=p+1),n<=p&&(i=p-1)}}(t,e,n||0,r||t.length-1,i||Ks)}function Xs(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Ks(t,e){return t<e?-1:t>e?1:0}function Zs(t,e){var n=t.length;if(n<=1)return[t];for(var r,i,a=[],s=0;s<n;s++){var o=S(t[s]);0!==o&&(t[s].area=Math.abs(o),void 0===i&&(i=o<0),i===o<0?(r&&a.push(r),r=[t[s]]):r.push(t[s]))}if(r&&a.push(r),e>1)for(var l=0;l<a.length;l++)a[l].length<=e||(Js(a[l],e,1,a[l].length-1,Ys),a[l]=a[l].slice(0,e));return a}function Ys(t,e){return e.area-t.area}function Qs(t,e,n){for(var r=n.patternDependencies,i=!1,a=0,s=e;a<s.length;a+=1){var o=s[a].paint.get(t+"-pattern");o.isConstant()||(i=!0);var l=o.constantOr(null);l&&(i=!0,r[l.to]=!0,r[l.from]=!0)}return i}function to(t,e,n,r,i){for(var a=i.patternDependencies,s=0,o=e;s<o.length;s+=1){var l=o[s],u=l.paint.get(t+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:r-1},n,{},i.availableImages),h=u.evaluate({zoom:r},n,{},i.availableImages),d=u.evaluate({zoom:r+1},n,{},i.availableImages);h=h&&h.name?h.name:h,d=d&&d.name?d.name:d,a[c=c&&c.name?c.name:c]=!0,a[h]=!0,a[d]=!0,n.patterns[l.id]={min:c,mid:h,max:d}}}return n}ws.deviation=function(t,e,n,r){var i=e&&e.length,a=Math.abs(Gs(t,0,i?e[0]*n:t.length,n));if(i)for(var s=0,o=e.length;s<o;s++)a-=Math.abs(Gs(t,e[s]*n,s<o-1?e[s+1]*n:t.length,n));var l=0;for(s=0;s<r.length;s+=3){var u=r[s]*n,c=r[s+1]*n,h=r[s+2]*n;l+=Math.abs((t[u]-t[h])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[h+1]-t[u+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},ws.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var s=0;s<e;s++)n.vertices.push(t[i][a][s]);i>0&&n.holes.push(r+=t[i-1].length)}return n},bs.default=xs;var eo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Di,this.indexArray=new Li,this.indexArray2=new Vi,this.programConfigurations=new Ra(_s,t.layers,t.zoom),this.segments=new ia,this.segments2=new ia,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};eo.prototype.populate=function(t,e,n){this.hasPattern=Qs("fill",this.layers,e);for(var r=this.layers[0].layout.get("fill-sort-key"),i=[],a=0,s=t;a<s.length;a+=1){var o=s[a],l=o.feature,u=o.id,c=o.index,h=o.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,p={type:l.type,id:u,properties:l.properties,geometry:d?Pa(l):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),p,n)){d||(p.geometry=Pa(l));var f=r?r.evaluate(p,{},n,e.availableImages):void 0;i.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:h,index:c,geometry:p.geometry,patterns:{},sortKey:f})}}r&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,g=i;m<g.length;m+=1){var y=g[m],v=y.geometry,_=y.index,b=y.sourceLayerIndex;if(this.hasPattern){var x=to("fill",this.layers,y,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(y,v,_,n,{});e.featureIndex.insert(t[_].feature,v,_,b,this.index)}},eo.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},eo.prototype.addFeatures=function(t,e,n){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var a=i[r];this.addFeature(a,a.geometry,a.index,e,n)}},eo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},eo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},eo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_s),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},eo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},eo.prototype.addFeature=function(t,e,n,r,i){for(var a=0,s=Zs(e,500);a<s.length;a+=1){for(var o=s[a],l=0,u=0,c=o;u<c.length;u+=1)l+=c[u].length;for(var h=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),d=h.vertexLength,p=[],f=[],m=0,g=o;m<g.length;m+=1){var y=g[m];if(0!==y.length){y!==o[0]&&f.push(p.length/2);var v=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),_=v.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(_+y.length-1,_),p.push(y[0].x),p.push(y[0].y);for(var b=1;b<y.length;b++)this.layoutVertexArray.emplaceBack(y[b].x,y[b].y),this.indexArray2.emplaceBack(_+b-1,_+b),p.push(y[b].x),p.push(y[b].y);v.vertexLength+=y.length,v.primitiveLength+=y.length}}for(var x=bs(p,f),w=0;w<x.length;w+=3)this.indexArray.emplaceBack(d+x[w],d+x[w+1],d+x[w+2]);h.vertexLength+=l,h.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)},Pr("FillBucket",eo,{omit:["layers","patternFeatures"]});var no=new vi({"fill-sort-key":new fi(It.layout_fill["fill-sort-key"])}),ro={paint:new vi({"fill-antialias":new pi(It.paint_fill["fill-antialias"]),"fill-opacity":new fi(It.paint_fill["fill-opacity"]),"fill-color":new fi(It.paint_fill["fill-color"]),"fill-outline-color":new fi(It.paint_fill["fill-outline-color"]),"fill-translate":new pi(It.paint_fill["fill-translate"]),"fill-translate-anchor":new pi(It.paint_fill["fill-translate-anchor"]),"fill-pattern":new mi(It.paint_fill["fill-pattern"])}),layout:no},io=function(t){function e(e){t.call(this,e,ro)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new eo(t)},e.prototype.queryRadius=function(){return Ka(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,a,s){return Ba(Za(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s),r)},e.prototype.isTileClipped=function(){return!0},e}(_i),ao=Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,so=oo;function oo(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(lo,this,e)}function lo(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function uo(t){for(var e,n,r=0,i=0,a=t.length,s=a-1;i<a;s=i++)r+=((n=t[s]).x-(e=t[i]).x)*(e.y+n.y);return r}oo.types=["Unknown","Point","LineString","Polygon"],oo.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,a=0,s=0,o=0,l=[];t.pos<n;){if(a<=0){var u=t.readVarint();r=7&u,a=u>>3}if(a--,1===r||2===r)s+=t.readSVarint(),o+=t.readSVarint(),1===r&&(e&&l.push(e),e=[]),e.push(new i(s,o));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&l.push(e),l},oo.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,a=0,s=1/0,o=-1/0,l=1/0,u=-1/0;t.pos<e;){if(r<=0){var c=t.readVarint();n=7&c,r=c>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<s&&(s=i),i>o&&(o=i),(a+=t.readSVarint())<l&&(l=a),a>u&&(u=a);else if(7!==n)throw new Error("unknown command "+n)}return[s,l,o,u]},oo.prototype.toGeoJSON=function(t,e,n){var r,i,a=this.extent*Math.pow(2,n),s=this.extent*t,o=this.extent*e,l=this.loadGeometry(),u=oo.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+s)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+o)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(r=0;r<l.length;r++)h[r]=l[r][0];c(l=h);break;case 2:for(r=0;r<l.length;r++)c(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],a=0;a<e;a++){var s=uo(t[a]);0!==s&&(void 0===r&&(r=s<0),r===s<0?(n&&i.push(n),n=[t[a]]):n.push(t[a]))}return n&&i.push(n),i}(l),r=0;r<l.length;r++)for(i=0;i<l[r].length;i++)c(l[r][i])}1===l.length?l=l[0]:u="Multi"+u;var d={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var co=ho;function ho(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(po,this,e),this.length=this._features.length}function po(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}function fo(t,e,n){if(3===t){var r=new co(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}ho.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new so(this._pbf,e,this.extent,this._keys,this._values)};var mo={VectorTile:function(t,e){this.layers=t.readFields(fo,{},e)},VectorTileFeature:so,VectorTileLayer:co},go=mo.VectorTileFeature.types,yo=Math.pow(2,13);function vo(t,e,n,r,i,a,s,o){t.emplaceBack(e,n,2*Math.floor(r*yo)+s,i*yo*2,a*yo*2,Math.round(o))}var _o=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ki,this.indexArray=new Li,this.programConfigurations=new Ra(ao,t.layers,t.zoom),this.segments=new ia,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function bo(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}_o.prototype.populate=function(t,e,n){this.features=[],this.hasPattern=Qs("fill-extrusion",this.layers,e);for(var r=0,i=t;r<i.length;r+=1){var a=i[r],s=a.feature,o=a.id,l=a.index,u=a.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,h={type:s.type,id:o,properties:s.properties,geometry:c?Pa(s):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),h,n)){var d={id:o,sourceLayerIndex:u,index:l,geometry:c?h.geometry:Pa(s),properties:s.properties,type:s.type,patterns:{}};void 0!==s.id&&(d.id=s.id),this.hasPattern?this.features.push(to("fill-extrusion",this.layers,d,this.zoom,e)):this.addFeature(d,d.geometry,l,n,{}),e.featureIndex.insert(s,d.geometry,l,u,this.index,!0)}}},_o.prototype.addFeatures=function(t,e,n){for(var r=0,i=this.features;r<i.length;r+=1){var a=i[r];this.addFeature(a,a.geometry,a.index,e,n)}},_o.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},_o.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},_o.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},_o.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ao),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},_o.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},_o.prototype.addFeature=function(t,e,n,r,i){for(var a=0,s=Zs(e,500);a<s.length;a+=1){for(var o=s[a],l=0,u=0,c=o;u<c.length;u+=1)l+=c[u].length;for(var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),d=0,p=o;d<p.length;d+=1){var f=p[d];if(0!==f.length&&!((M=f).every((function(t){return t.x<0}))||M.every((function(t){return t.x>8192}))||M.every((function(t){return t.y<0}))||M.every((function(t){return t.y>8192}))))for(var m=0,g=0;g<f.length;g++){var y=f[g];if(g>=1){var v=f[g-1];if(!bo(y,v)){h.vertexLength+4>ia.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=y.sub(v)._perp()._unit(),b=v.dist(y);m+b>32768&&(m=0),vo(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,0,m),vo(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,1,m),vo(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,m+=b),vo(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,m);var x=h.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),h.vertexLength+=4,h.primitiveLength+=2}}}}if(h.vertexLength+l>ia.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===go[t.type]){for(var w=[],S=[],C=h.vertexLength,D=0,I=o;D<I.length;D+=1){var k=I[D];if(0!==k.length){k!==o[0]&&S.push(w.length/2);for(var E=0;E<k.length;E++){var A=k[E];vo(this.layoutVertexArray,A.x,A.y,0,0,1,1,0),w.push(A.x),w.push(A.y)}}}for(var T=bs(w,S),R=0;R<T.length;R+=3)this.indexArray.emplaceBack(C+T[R],C+T[R+2],C+T[R+1]);h.primitiveLength+=T.length/3,h.vertexLength+=l}}var M;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)},Pr("FillExtrusionBucket",_o,{omit:["layers","features"]});var xo={paint:new vi({"fill-extrusion-opacity":new pi(It["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new fi(It["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pi(It["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pi(It["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new mi(It["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new fi(It["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new fi(It["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pi(It["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},wo=function(t){function e(e){t.call(this,e,xo)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new _o(t)},e.prototype.queryRadius=function(){return Ka(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(t,e,n,r,a,s,o,l){var u=Za(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,o),c=this.paint.get("fill-extrusion-height").evaluate(e,n),h=this.paint.get("fill-extrusion-base").evaluate(e,n),d=function(t,e,n,r){for(var a=[],s=0,o=t;s<o.length;s+=1){var l=o[s],u=[l.x,l.y,0,1];as(u,u,e),a.push(new i(u[0]/u[3],u[1]/u[3]))}return a}(u,l),p=function(t,e,n,r){for(var a=[],s=[],o=r[8]*e,l=r[9]*e,u=r[10]*e,c=r[11]*e,h=r[8]*n,d=r[9]*n,p=r[10]*n,f=r[11]*n,m=0,g=t;m<g.length;m+=1){for(var y=[],v=[],_=0,b=g[m];_<b.length;_+=1){var x=b[_],w=x.x,S=x.y,C=r[0]*w+r[4]*S+r[12],D=r[1]*w+r[5]*S+r[13],I=r[2]*w+r[6]*S+r[14],k=r[3]*w+r[7]*S+r[15],E=I+u,A=k+c,T=C+h,R=D+d,M=I+p,N=k+f,O=new i((C+o)/A,(D+l)/A);O.z=E/A,y.push(O);var P=new i(T/N,R/N);P.z=M/N,v.push(P)}a.push(y),s.push(v)}return[a,s]}(r,h,c,l);return function(t,e,n){var r=1/0;Ba(n,e)&&(r=Co(n,e[0]));for(var i=0;i<e.length;i++)for(var a=e[i],s=t[i],o=0;o<a.length-1;o++){var l=a[o],u=[l,a[o+1],s[o+1],s[o],l];za(n,u)&&(r=Math.min(r,Co(n,u)))}return r!==1/0&&r}(p[0],p[1],d)},e}(_i);function So(t,e){return t.x*e.x+t.y*e.y}function Co(t,e){if(1===t.length){for(var n,r=0,i=e[r++];!n||i.equals(n);)if(!(n=e[r++]))return 1/0;for(;r<e.length;r++){var a=e[r],s=t[0],o=n.sub(i),l=a.sub(i),u=s.sub(i),c=So(o,o),h=So(o,l),d=So(l,l),p=So(u,o),f=So(u,l),m=c*d-h*h,g=(d*p-h*f)/m,y=(c*f-h*p)/m,v=i.z*(1-g-y)+n.z*g+a.z*y;if(isFinite(v))return v}return 1/0}for(var _=1/0,b=0,x=e;b<x.length;b+=1)_=Math.min(_,x[b].z);return _}var Do=Si([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Io=mo.VectorTileFeature.types,ko=Math.cos(Math.PI/180*37.5),Eo=Math.pow(2,14)/.5,Ao=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ei,this.indexArray=new Li,this.programConfigurations=new Ra(Do,t.layers,t.zoom),this.segments=new ia,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};Ao.prototype.populate=function(t,e,n){this.hasPattern=Qs("line",this.layers,e);for(var r=this.layers[0].layout.get("line-sort-key"),i=[],a=0,s=t;a<s.length;a+=1){var o=s[a],l=o.feature,u=o.id,c=o.index,h=o.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,p={type:l.type,id:u,properties:l.properties,geometry:d?Pa(l):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),p,n)){d||(p.geometry=Pa(l));var f=r?r.evaluate(p,{},n):void 0;i.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:h,index:c,geometry:p.geometry,patterns:{},sortKey:f})}}r&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,g=i;m<g.length;m+=1){var y=g[m],v=y.geometry,_=y.index,b=y.sourceLayerIndex;if(this.hasPattern){var x=to("line",this.layers,y,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(y,v,_,n,{});e.featureIndex.insert(t[_].feature,v,_,b,this.index)}},Ao.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Ao.prototype.addFeatures=function(t,e,n){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var a=i[r];this.addFeature(a,a.geometry,a.index,e,n)}},Ao.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ao.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ao.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Do),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Ao.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ao.prototype.addFeature=function(t,e,n,r,i){for(var a=this.layers[0].layout,s=a.get("line-join").evaluate(t,{}),o=a.get("line-cap"),l=a.get("line-miter-limit"),u=a.get("line-round-limit"),c=0,h=e;c<h.length;c+=1)this.addLine(h[c],t,s,o,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)},Ao.prototype.addLine=function(t,e,n,r,i,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var s=0;s<t.length-1;s++)this.totalDistance+=t[s].dist(t[s+1]);this.updateScaledDistance()}for(var o="Polygon"===Io[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var u=0;u<l-1&&t[u].equals(t[u+1]);)u++;if(!(l<(o?3:2))){"bevel"===n&&(i=1.05);var c,h=this.overscaling<=16?122880/(512*this.overscaling):0,d=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),p=void 0,f=void 0,m=void 0,g=void 0;this.e1=this.e2=-1,o&&(g=t[u].sub(c=t[l-2])._unit()._perp());for(var y=u;y<l;y++)if(!(f=y===l-1?o?t[u+1]:void 0:t[y+1])||!t[y].equals(f)){g&&(m=g),c&&(p=c),c=t[y],g=f?f.sub(c)._unit()._perp():m;var v=(m=m||g).add(g);0===v.x&&0===v.y||v._unit();var _=m.x*g.x+m.y*g.y,b=v.x*g.x+v.y*g.y,x=0!==b?1/b:1/0,w=2*Math.sqrt(2-2*b),S=b<ko&&p&&f,C=m.x*g.y-m.y*g.x>0;if(S&&y>u){var D=c.dist(p);if(D>2*h){var I=c.sub(c.sub(p)._mult(h/D)._round());this.updateDistance(p,I),this.addCurrentVertex(I,m,0,0,d),p=I}}var k=p&&f,E=k?n:o?"butt":r;if(k&&"round"===E&&(x<a?E="miter":x<=2&&(E="fakeround")),"miter"===E&&x>i&&(E="bevel"),"bevel"===E&&(x>2&&(E="flipbevel"),x<i&&(E="miter")),p&&this.updateDistance(p,c),"miter"===E)v._mult(x),this.addCurrentVertex(c,v,0,0,d);else if("flipbevel"===E){if(x>100)v=g.mult(-1);else{var A=x*m.add(g).mag()/m.sub(g).mag();v._perp()._mult(A*(C?-1:1))}this.addCurrentVertex(c,v,0,0,d),this.addCurrentVertex(c,v.mult(-1),0,0,d)}else if("bevel"===E||"fakeround"===E){var T=-Math.sqrt(x*x-1),R=C?T:0,M=C?0:T;if(p&&this.addCurrentVertex(c,m,R,M,d),"fakeround"===E)for(var N=Math.round(180*w/Math.PI/20),O=1;O<N;O++){var P=O/N;if(.5!==P){var F=P-.5;P+=P*F*(P-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*F*F+(.848013+_*(.215638*_-1.06021)))}var L=g.sub(m)._mult(P)._add(m)._unit()._mult(C?-1:1);this.addHalfVertex(c,L.x,L.y,!1,C,0,d)}f&&this.addCurrentVertex(c,g,-R,-M,d)}else if("butt"===E)this.addCurrentVertex(c,v,0,0,d);else if("square"===E){var z=p?1:-1;this.addCurrentVertex(c,v,z,z,d)}else"round"===E&&(p&&(this.addCurrentVertex(c,m,0,0,d),this.addCurrentVertex(c,m,1,1,d,!0)),f&&(this.addCurrentVertex(c,g,-1,-1,d,!0),this.addCurrentVertex(c,g,0,0,d)));if(S&&y<l-1){var $=c.dist(f);if($>2*h){var B=c.add(f.sub(c)._mult(h/$)._round());this.updateDistance(c,B),this.addCurrentVertex(B,g,0,0,d),c=B}}}}},Ao.prototype.addCurrentVertex=function(t,e,n,r,i,a){void 0===a&&(a=!1);var s=e.y*r-e.x,o=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,a,!1,n,i),this.addHalfVertex(t,s,o,a,!0,-r,i),this.distance>Eo/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,n,r,i,a))},Ao.prototype.addHalfVertex=function(t,e,n,r,i,a,s){var o=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((t.x<<1)+(r?1:0),(t.y<<1)+(i?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1)|(63&o)<<2,o>>6);var l=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),s.primitiveLength++),i?this.e2=l:this.e1=l},Ao.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Eo-1):this.distance},Ao.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},Pr("LineBucket",Ao,{omit:["layers","patternFeatures"]});var To=new vi({"line-cap":new pi(It.layout_line["line-cap"]),"line-join":new fi(It.layout_line["line-join"]),"line-miter-limit":new pi(It.layout_line["line-miter-limit"]),"line-round-limit":new pi(It.layout_line["line-round-limit"]),"line-sort-key":new fi(It.layout_line["line-sort-key"])}),Ro={paint:new vi({"line-opacity":new fi(It.paint_line["line-opacity"]),"line-color":new fi(It.paint_line["line-color"]),"line-translate":new pi(It.paint_line["line-translate"]),"line-translate-anchor":new pi(It.paint_line["line-translate-anchor"]),"line-width":new fi(It.paint_line["line-width"]),"line-gap-width":new fi(It.paint_line["line-gap-width"]),"line-offset":new fi(It.paint_line["line-offset"]),"line-blur":new fi(It.paint_line["line-blur"]),"line-dasharray":new gi(It.paint_line["line-dasharray"]),"line-pattern":new mi(It.paint_line["line-pattern"]),"line-gradient":new yi(It.paint_line["line-gradient"])}),layout:To},Mo=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new ii(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,r,i){return n=c({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,r,i)},e}(fi))(Ro.paint.properties["line-width"].specification);Mo.useIntegerZoom=!0;var No=function(t){function e(e){t.call(this,e,Ro)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){this.gradient=ms(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n),this.paint._values["line-floorwidth"]=Mo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new Ao(t)},e.prototype.queryRadius=function(t){var e=t,n=Oo(Xa("line-width",this,e),Xa("line-gap-width",this,e)),r=Xa("line-offset",this,e);return n/2+Math.abs(r)+Ka(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,a,s,o){var l=Za(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,o),u=o/2*Oo(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),c=this.paint.get("line-offset").evaluate(e,n);return c&&(r=function(t,e){for(var n=[],r=new i(0,0),a=0;a<t.length;a++){for(var s=t[a],o=[],l=0;l<s.length;l++){var u=s[l],c=s[l+1],h=0===l?r:u.sub(s[l-1])._unit()._perp(),d=l===s.length-1?r:c.sub(u)._unit()._perp(),p=h._add(d)._unit();p._mult(1/(p.x*d.x+p.y*d.y)),o.push(p._mult(e)._add(u))}n.push(o)}return n}(r,c*o)),function(t,e,n){for(var r=0;r<e.length;r++){var i=e[r];if(t.length>=3)for(var a=0;a<i.length;a++)if(Ga(t,i[a]))return!0;if(Wa(t,i,n))return!0}return!1}(l,r,u)},e.prototype.isTileClipped=function(){return!0},e}(_i);function Oo(t,e){return e>0?e+2*t:t}var Po=Si([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Fo=Si([{name:"a_projected_pos",components:3,type:"Float32"}],4),Lo=(Si([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Si([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),zo=(Si([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),$o=Si([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Bo(t,e,n){return t.sections.forEach((function(t){t.text=function(t,e,n){var r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),ri.applyArabicShaping&&(t=ri.applyArabicShaping(t)),t}(t.text,e,n)})),t}Si([{name:"triangle",components:3,type:"Uint16"}]),Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Si([{type:"Float32",name:"offsetX"}]),Si([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Wo={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},qo=function(t,e,n,r,i){var a,s,o=8*i-r-1,l=(1<<o)-1,u=l>>1,c=-7,h=n?i-1:0,d=n?-1:1,p=t[e+h];for(h+=d,a=p&(1<<-c)-1,p>>=-c,c+=o;c>0;a=256*a+t[e+h],h+=d,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=d,c-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),a-=u}return(p?-1:1)*s*Math.pow(2,a-r)},Vo=function(t,e,n,r,i,a){var s,o,l,u=8*a-i-1,c=(1<<u)-1,h=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(o=0,s=c):s+h>=1?(o=(e*l-1)*Math.pow(2,i),s+=h):(o=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&o,p+=f,o/=256,i-=8);for(s=s<<i|o,u+=i;u>0;t[n+p]=255&s,p+=f,s/=256,u-=8);t[n+p-f]|=128*m},Uo=jo;function jo(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}jo.Varint=0,jo.Fixed64=1,jo.Bytes=2,jo.Fixed32=5;var Ho="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Go(t){return t.type===jo.Bytes?t.readVarint()+t.pos:t.pos+1}function Jo(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Xo(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function Ko(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Zo(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Yo(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Qo(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function tl(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function el(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function nl(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function rl(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function il(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function al(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function sl(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function ol(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ll(t,e,n){1===t&&n.readMessage(ul,e)}function ul(t,e,n){if(3===t){var r=n.readMessage(cl,{}),i=r.width,a=r.height,s=r.left,o=r.top,l=r.advance;e.push({id:r.id,bitmap:new ds({width:i+6,height:a+6},r.bitmap),metrics:{width:i,height:a,left:s,top:o,advance:l}})}}function cl(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function hl(t){for(var e=0,n=0,r=0,i=t;r<i.length;r+=1){var a=i[r];e+=a.w*a.h,n=Math.max(n,a.w)}t.sort((function(t,e){return e.h-t.h}));for(var s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],o=0,l=0,u=0,c=t;u<c.length;u+=1)for(var h=c[u],d=s.length-1;d>=0;d--){var p=s[d];if(!(h.w>p.w||h.h>p.h)){if(h.x=p.x,h.y=p.y,l=Math.max(l,h.y+h.h),o=Math.max(o,h.x+h.w),h.w===p.w&&h.h===p.h){var f=s.pop();d<s.length&&(s[d]=f)}else h.h===p.h?(p.x+=h.w,p.w-=h.w):h.w===p.w?(p.y+=h.h,p.h-=h.h):(s.push({x:p.x+h.w,y:p.y,w:p.w-h.w,h:h.h}),p.y+=h.h,p.h-=h.h);break}}return{w:o,h:l,fill:e/(o*l)||0}}jo.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,a=this.pos;this.type=7&r,t(i,e,this),this.pos===a&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=al(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=ol(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=al(this.buf,this.pos)+4294967296*al(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=al(this.buf,this.pos)+4294967296*ol(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=qo(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=qo(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,a=n.buf;if(r=(112&(i=a[n.pos++]))>>4,i<128)return Jo(t,r,e);if(r|=(127&(i=a[n.pos++]))<<3,i<128)return Jo(t,r,e);if(r|=(127&(i=a[n.pos++]))<<10,i<128)return Jo(t,r,e);if(r|=(127&(i=a[n.pos++]))<<17,i<128)return Jo(t,r,e);if(r|=(127&(i=a[n.pos++]))<<24,i<128)return Jo(t,r,e);if(r|=(1&(i=a[n.pos++]))<<31,i<128)return Jo(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Ho?function(t,e,n){return Ho.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var a,s,o,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(a=t[i+1]))&&(u=(31&l)<<6|63&a)<=127&&(u=null):3===c?(s=t[i+2],128==(192&(a=t[i+1]))&&128==(192&s)&&((u=(15&l)<<12|(63&a)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(s=t[i+2],o=t[i+3],128==(192&(a=t[i+1]))&&128==(192&s)&&128==(192&o)&&((u=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==jo.Bytes)return t.push(this.readVarint(e));var n=Go(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==jo.Bytes)return t.push(this.readSVarint());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==jo.Bytes)return t.push(this.readBoolean());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==jo.Bytes)return t.push(this.readFloat());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==jo.Bytes)return t.push(this.readDouble());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==jo.Bytes)return t.push(this.readFixed32());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==jo.Bytes)return t.push(this.readSFixed32());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==jo.Bytes)return t.push(this.readFixed64());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==jo.Bytes)return t.push(this.readSFixed64());var e=Go(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===jo.Varint)for(;this.buf[this.pos++]>127;);else if(e===jo.Bytes)this.pos=this.readVarint()+this.pos;else if(e===jo.Fixed32)this.pos+=4;else{if(e!==jo.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),sl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),sl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),sl(this.buf,-1&t,this.pos),sl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),sl(this.buf,-1&t,this.pos),sl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,a=0;a<e.length;a++){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){r>56319||a+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Xo(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Vo(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Vo(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Xo(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,jo.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Ko,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Zo,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,tl,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Yo,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Qo,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,el,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,nl,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,rl,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,il,e)},writeBytesField:function(t,e){this.writeTag(t,jo.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,jo.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,jo.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,jo.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,jo.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,jo.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,jo.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,jo.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,jo.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,jo.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var dl=function(t,e){var n=e.pixelRatio,r=e.version,i=e.stretchX,a=e.stretchY,s=e.content;this.paddedRect=t,this.pixelRatio=n,this.stretchX=i,this.stretchY=a,this.content=s,this.version=r},pl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};pl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},pl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},pl.tlbr.get=function(){return this.tl.concat(this.br)},pl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(dl.prototype,pl);var fl=function(t,e){var n={},r={};this.haveRenderCallbacks=[];var i=[];this.addImages(t,n,i),this.addImages(e,r,i);var a=hl(i),s=new ps({width:a.w||1,height:a.h||1});for(var o in t){var l=t[o],u=n[o].paddedRect;ps.copy(l.data,s,{x:0,y:0},{x:u.x+1,y:u.y+1},l.data)}for(var c in e){var h=e[c],d=r[c].paddedRect,p=d.x+1,f=d.y+1,m=h.data.width,g=h.data.height;ps.copy(h.data,s,{x:0,y:0},{x:p,y:f},h.data),ps.copy(h.data,s,{x:0,y:g-1},{x:p,y:f-1},{width:m,height:1}),ps.copy(h.data,s,{x:0,y:0},{x:p,y:f+g},{width:m,height:1}),ps.copy(h.data,s,{x:m-1,y:0},{x:p-1,y:f},{width:1,height:g}),ps.copy(h.data,s,{x:0,y:0},{x:p+m,y:f},{width:1,height:g})}this.image=s,this.iconPositions=n,this.patternPositions=r};fl.prototype.addImages=function(t,e,n){for(var r in t){var i=t[r],a={x:0,y:0,w:i.data.width+2,h:i.data.height+2};n.push(a),e[r]=new dl(a,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}},fl.prototype.patchUpdatedImages=function(t,e){for(var n in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)},fl.prototype.patchUpdatedImage=function(t,e,n){if(t&&e&&t.version!==e.version){t.version=e.version;var r=t.tl;n.update(e.data,void 0,{x:r[0],y:r[1]})}},Pr("ImagePosition",dl),Pr("ImageAtlas",fl);var ml={horizontal:1,vertical:2,horizontalOnly:3},gl=function(){this.scale=1,this.fontStack="",this.imageName=null};gl.forText=function(t,e){var n=new gl;return n.scale=t||1,n.fontStack=e,n},gl.forImage=function(t){var e=new gl;return e.imageName=t,e};var yl=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function vl(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m){var g,y=yl.fromFeature(t,i);h===ml.vertical&&y.verticalizePunctuation();var v=ri.processBidirectionalText,_=ri.processStyledBidirectionalText;if(v&&1===y.sections.length){g=[];for(var b=0,x=v(y.toString(),Dl(y,u,a,e,r,p,f));b<x.length;b+=1){var w=x[b],S=new yl;S.text=w,S.sections=y.sections;for(var C=0;C<w.length;C++)S.sectionIndex.push(0);g.push(S)}}else if(_){g=[];for(var D=0,I=_(y.text,y.sectionIndex,Dl(y,u,a,e,r,p,f));D<I.length;D+=1){var k=I[D],E=new yl;E.text=k[0],E.sectionIndex=k[1],E.sections=y.sections,g.push(E)}}else g=function(t,e){for(var n=[],r=t.text,i=0,a=0,s=e;a<s.length;a+=1){var o=s[a];n.push(t.substring(i,o)),i=o}return i<r.length&&n.push(t.substring(i,r.length)),n}(y,Dl(y,u,a,e,r,p,f));var A=[],T={positionedLines:A,text:y.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,e,n,r,i,a,s,o,l,u,c,h){for(var d=0,p=-17,f=0,m=0,g="right"===o?1:"left"===o?0:.5,y=0,v=0,_=i;v<_.length;v+=1){var b=_[v];b.trim();var x=b.getMaxScale(),w=24*(x-1),S={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=S;var C=S.positionedGlyphs,D=0;if(b.length()){for(var I=0;I<b.length();I++){var k=b.getSection(I),E=b.getSectionIndex(I),A=b.getCharCode(I),T=0,R=null,M=null,N=null,O=24,P=!(l===ml.horizontal||!c&&!Ur(A)||c&&(_l[A]||(U=A,qr.Arabic(U)||qr["Arabic Supplement"](U)||qr["Arabic Extended-A"](U)||qr["Arabic Presentation Forms-A"](U)||qr["Arabic Presentation Forms-B"](U))));if(k.imageName){var F=r[k.imageName];if(!F)continue;N=k.imageName,t.iconsInText=t.iconsInText||!0,M=F.paddedRect;var L=F.displaySize;k.scale=24*k.scale/h,T=w+(24-L[1]*k.scale),O=(R={width:L[0],height:L[1],left:1,top:-3,advance:P?L[1]:L[0]}).advance;var z=P?L[0]*k.scale-24*x:L[1]*k.scale-24*x;z>0&&z>D&&(D=z)}else{var $=n[k.fontStack],B=$&&$[A];if(B&&B.rect)M=B.rect,R=B.metrics;else{var W=e[k.fontStack],q=W&&W[A];if(!q)continue;R=q.metrics}T=24*(x-k.scale)}P?(t.verticalizable=!0,C.push({glyph:A,imageName:N,x:d,y:p+T,vertical:P,scale:k.scale,fontStack:k.fontStack,sectionIndex:E,metrics:R,rect:M}),d+=O*k.scale+u):(C.push({glyph:A,imageName:N,x:d,y:p+T,vertical:P,scale:k.scale,fontStack:k.fontStack,sectionIndex:E,metrics:R,rect:M}),d+=R.advance*k.scale+u)}0!==C.length&&(f=Math.max(d-u,f),kl(C,0,C.length-1,g,D)),d=0;var V=a*x+D;S.lineOffset=Math.max(D,w),p+=V,m=Math.max(V,m),++y}else p+=a,++y}var U,j=p- -17,H=Il(s),G=H.horizontalAlign,J=H.verticalAlign;(function(t,e,n,r,i,a,s,o,l){var u,c=(e-n)*i;u=a!==s?-o*r- -17:(-r*l+.5)*s;for(var h=0,d=t;h<d.length;h+=1)for(var p=0,f=d[h].positionedGlyphs;p<f.length;p+=1){var m=f[p];m.x+=c,m.y+=u}})(t.positionedLines,g,G,J,f,m,a,j,i.length),t.top+=-J*j,t.bottom=t.top+j,t.left+=-G*f,t.right=t.left+f}(T,e,n,r,g,s,o,l,h,u,d,m),!function(t){for(var e=0,n=t;e<n.length;e+=1)if(0!==n[e].positionedGlyphs.length)return!1;return!0}(A)&&T}yl.fromFeature=function(t,e){for(var n=new yl,r=0;r<t.sections.length;r++){var i=t.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,e)}return n},yl.prototype.length=function(){return this.text.length},yl.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},yl.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},yl.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},yl.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n+1)||null,i=t.charCodeAt(n-1)||null;e+=r&&jr(r)&&!Wo[t[n+1]]||i&&jr(i)&&!Wo[t[n-1]]||!Wo[t[n]]?t[n]:Wo[t[n]]}return e}(this.text)},yl.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&_l[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,r=this.text.length-1;r>=0&&r>=t&&_l[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)},yl.prototype.substring=function(t,e){var n=new yl;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n},yl.prototype.toString=function(){return this.text},yl.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce((function(e,n){return Math.max(e,t.sections[n].scale)}),0)},yl.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(gl.forText(t.scale,t.fontStack||e));for(var n=this.sections.length-1,r=0;r<t.text.length;++r)this.sectionIndex.push(n)},yl.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(gl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):x("Reached maximum number of images 6401")}else x("Can't add FormattedSection with an empty image.")},yl.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var _l={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},bl={};function xl(t,e,n,r,i,a){if(e.imageName){var s=r[e.imageName];return s?s.displaySize[0]*e.scale*24/a+i:0}var o=n[e.fontStack],l=o&&o[t];return l?l.metrics.advance*e.scale+i:0}function wl(t,e,n,r){var i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function Sl(t,e,n){var r=0;return 10===t&&(r-=1e4),n&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function Cl(t,e,n,r,i,a){for(var s=null,o=wl(e,n,i,a),l=0,u=r;l<u.length;l+=1){var c=u[l],h=wl(e-c.x,n,i,a)+c.badness;h<=o&&(s=c,o=h)}return{index:t,x:e,priorBreak:s,badness:o}}function Dl(t,e,n,r,i,a,s){if("point"!==a)return[];if(!t)return[];for(var o,l=[],u=function(t,e,n,r,i,a){for(var s=0,o=0;o<t.length();o++){var l=t.getSection(o);s+=xl(t.getCharCode(o),l,r,i,e,a)}return s/Math.max(1,Math.ceil(s/n))}(t,e,n,r,i,s),c=t.text.indexOf("\u200b")>=0,h=0,d=0;d<t.length();d++){var p=t.getSection(d),f=t.getCharCode(d);if(_l[f]||(h+=xl(f,p,r,i,e,s)),d<t.length()-1){var m=!((o=f)<11904||!(qr["Bopomofo Extended"](o)||qr.Bopomofo(o)||qr["CJK Compatibility Forms"](o)||qr["CJK Compatibility Ideographs"](o)||qr["CJK Compatibility"](o)||qr["CJK Radicals Supplement"](o)||qr["CJK Strokes"](o)||qr["CJK Symbols and Punctuation"](o)||qr["CJK Unified Ideographs Extension A"](o)||qr["CJK Unified Ideographs"](o)||qr["Enclosed CJK Letters and Months"](o)||qr["Halfwidth and Fullwidth Forms"](o)||qr.Hiragana(o)||qr["Ideographic Description Characters"](o)||qr["Kangxi Radicals"](o)||qr["Katakana Phonetic Extensions"](o)||qr.Katakana(o)||qr["Vertical Forms"](o)||qr["Yi Radicals"](o)||qr["Yi Syllables"](o)));(bl[f]||m||p.imageName)&&l.push(Cl(d+1,h,u,l,Sl(f,t.getCharCode(d+1),m&&c),!1))}}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Cl(t.length(),h,u,l,0,!0))}function Il(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function kl(t,e,n,r,i){if(r||i)for(var a=t[n],s=(t[n].x+a.metrics.advance*a.scale)*r,o=e;o<=n;o++)t[o].x-=s,t[o].y+=i}function El(t,e,n,r,i,a){var s,o=t.image;if(o.content){var l=o.content,u=o.pixelRatio||1;s=[l[0]/u,l[1]/u,o.displaySize[0]-l[2]/u,o.displaySize[1]-l[3]/u]}var c,h,d,p,f=e.left*a,m=e.right*a;"width"===n||"both"===n?(p=i[0]+f-r[3],h=i[0]+m+r[1]):h=(p=i[0]+(f+m-o.displaySize[0])/2)+o.displaySize[0];var g=e.top*a,y=e.bottom*a;return"height"===n||"both"===n?(c=i[1]+g-r[0],d=i[1]+y+r[2]):d=(c=i[1]+(g+y-o.displaySize[1])/2)+o.displaySize[1],{image:o,top:c,right:h,bottom:d,left:p,collisionPadding:s}}bl[10]=!0,bl[32]=!0,bl[38]=!0,bl[40]=!0,bl[41]=!0,bl[43]=!0,bl[45]=!0,bl[47]=!0,bl[173]=!0,bl[183]=!0,bl[8203]=!0,bl[8208]=!0,bl[8211]=!0,bl[8231]=!0;var Al=function(t){function e(e,n,r,i){t.call(this,e,n),this.angle=r,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(i);function Tl(t,e){var n=e.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new ii(t+1))};if("source"===n.kind)return{kind:"source"};for(var r=n.zoomStops,i=n.interpolationType,a=0;a<r.length&&r[a]<=t;)a++;for(var s=a=Math.max(0,a-1);s<r.length&&r[s]<t+1;)s++;s=Math.min(r.length-1,s);var o=r[a],l=r[s];return"composite"===n.kind?{kind:"composite",minZoom:o,maxZoom:l,interpolationType:i}:{kind:"camera",minZoom:o,maxZoom:l,minSize:n.evaluate(new ii(o)),maxSize:n.evaluate(new ii(l)),interpolationType:i}}function Rl(t,e,n){var r=e.uSize,i=n.lowerSize;return"source"===t.kind?i/128:"composite"===t.kind?We(i/128,n.upperSize/128,e.uSizeT):r}function Ml(t,e){var n=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){var i=t.interpolationType,a=i?l(nn.interpolationFactor(i,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?r=We(t.minSize,t.maxSize,a):n=a}return{uSizeT:n,uSize:r}}Pr("Anchor",Al);var Nl=Object.freeze({__proto__:null,getSizeData:Tl,evaluateSizeForFeature:Rl,evaluateSizeForZoom:Ml,SIZE_PACK_FACTOR:128});function Ol(t,e,n,r,i){if(void 0===e.segment)return!0;for(var a=e,s=e.segment+1,o=0;o>-n/2;){if(--s<0)return!1;o-=t[s].dist(a),a=t[s]}o+=t[s].dist(t[s+1]),s++;for(var l=[],u=0;o<n/2;){var c=t[s],h=t[s+1];if(!h)return!1;var d=t[s-1].angleTo(c)-c.angleTo(h);for(d=Math.abs((d+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:o,angleDelta:d}),u+=d;o-l[0].distance>r;)u-=l.shift().angleDelta;if(u>i)return!1;s++,o+=c.dist(h)}return!0}function Pl(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Fl(t,e,n){return t?.6*e*n:0}function Ll(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function zl(t,e,n,r,i,a){for(var s=Fl(n,i,a),o=Ll(n,r)*a,l=0,u=Pl(t)/2,c=0;c<t.length-1;c++){var h=t[c],d=t[c+1],p=h.dist(d);if(l+p>u){var f=(u-l)/p,m=We(h.x,d.x,f),g=We(h.y,d.y,f),y=new Al(m,g,d.angleTo(h),c);return y._round(),!s||Ol(t,y,o,s,e)?y:void 0}l+=p}}function $l(t,e,n,r,i,a,s,o,l){var u=Fl(r,a,s),c=Ll(r,i),h=c*s,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),function t(e,n,r,i,a,s,o,l,u){for(var c=s/2,h=Pl(e),d=0,p=n-r,f=[],m=0;m<e.length-1;m++){for(var g=e[m],y=e[m+1],v=g.dist(y),_=y.angleTo(g);p+r<d+v;){var b=((p+=r)-d)/v,x=We(g.x,y.x,b),w=We(g.y,y.y,b);if(x>=0&&x<u&&w>=0&&w<u&&p-c>=0&&p+c<=h){var S=new Al(x,w,_,m);S._round(),i&&!Ol(e,S,s,i,a)||f.push(S)}}d+=v}return l||f.length||o||(f=t(e,d/2,r,i,a,s,o,!0,u)),f}(t,d?e/2*o%e:(c/2+2*a)*s*o%e,e,u,n,h,d,!1,l)}function Bl(t,e,n,r,a){for(var s=[],o=0;o<t.length;o++)for(var l=t[o],u=void 0,c=0;c<l.length-1;c++){var h=l[c],d=l[c+1];h.x<e&&d.x<e||(h.x<e?h=new i(e,h.y+(e-h.x)/(d.x-h.x)*(d.y-h.y))._round():d.x<e&&(d=new i(e,h.y+(e-h.x)/(d.x-h.x)*(d.y-h.y))._round()),h.y<n&&d.y<n||(h.y<n?h=new i(h.x+(n-h.y)/(d.y-h.y)*(d.x-h.x),n)._round():d.y<n&&(d=new i(h.x+(n-h.y)/(d.y-h.y)*(d.x-h.x),n)._round()),h.x>=r&&d.x>=r||(h.x>=r?h=new i(r,h.y+(r-h.x)/(d.x-h.x)*(d.y-h.y))._round():d.x>=r&&(d=new i(r,h.y+(r-h.x)/(d.x-h.x)*(d.y-h.y))._round()),h.y>=a&&d.y>=a||(h.y>=a?h=new i(h.x+(a-h.y)/(d.y-h.y)*(d.x-h.x),a)._round():d.y>=a&&(d=new i(h.x+(a-h.y)/(d.y-h.y)*(d.x-h.x),a)._round()),u&&h.equals(u[u.length-1])||s.push(u=[h]),u.push(d)))))}return s}function Wl(t,e,n,r){var a=[],s=t.image,o=s.pixelRatio,l=s.paddedRect.w-2,u=s.paddedRect.h-2,c=t.right-t.left,h=t.bottom-t.top,d=s.stretchX||[[0,l]],p=s.stretchY||[[0,u]],f=function(t,e){return t+e[1]-e[0]},m=d.reduce(f,0),g=p.reduce(f,0),y=l-m,v=u-g,_=0,b=m,x=0,w=g,S=0,C=y,D=0,I=v;if(s.content&&r){var k=s.content;_=ql(d,0,k[0]),x=ql(p,0,k[1]),b=ql(d,k[0],k[2]),w=ql(p,k[1],k[3]),S=k[0]-_,D=k[1]-x,C=k[2]-k[0]-b,I=k[3]-k[1]-w}var E=function(r,a,l,u){var d=Ul(r.stretch-_,b,c,t.left),p=jl(r.fixed-S,C,r.stretch,m),f=Ul(a.stretch-x,w,h,t.top),y=jl(a.fixed-D,I,a.stretch,g),v=Ul(l.stretch-_,b,c,t.left),k=jl(l.fixed-S,C,l.stretch,m),E=Ul(u.stretch-x,w,h,t.top),A=jl(u.fixed-D,I,u.stretch,g),T=new i(d,f),R=new i(v,f),M=new i(v,E),N=new i(d,E),O=new i(p/o,y/o),P=new i(k/o,A/o),F=e*Math.PI/180;if(F){var L=Math.sin(F),z=Math.cos(F),$=[z,-L,L,z];T._matMult($),R._matMult($),N._matMult($),M._matMult($)}var B=r.stretch+r.fixed,W=a.stretch+a.fixed;return{tl:T,tr:R,bl:N,br:M,tex:{x:s.paddedRect.x+1+B,y:s.paddedRect.y+1+W,w:l.stretch+l.fixed-B,h:u.stretch+u.fixed-W},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:O,pixelOffsetBR:P,minFontScaleX:C/o/c,minFontScaleY:I/o/h,isSDF:n}};if(r&&(s.stretchX||s.stretchY))for(var A=Vl(d,y,m),T=Vl(p,v,g),R=0;R<A.length-1;R++)for(var M=A[R],N=A[R+1],O=0;O<T.length-1;O++)a.push(E(M,T[O],N,T[O+1]));else a.push(E({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:u+1}));return a}function ql(t,e,n){for(var r=0,i=0,a=t;i<a.length;i+=1){var s=a[i];r+=Math.max(e,Math.min(n,s[1]))-Math.max(e,Math.min(n,s[0]))}return r}function Vl(t,e,n){for(var r=[{fixed:-1,stretch:0}],i=0,a=t;i<a.length;i+=1){var s=a[i],o=s[0],l=s[1],u=r[r.length-1];r.push({fixed:o-u.stretch,stretch:u.stretch}),r.push({fixed:o-u.stretch,stretch:u.stretch+(l-o)})}return r.push({fixed:e+1,stretch:n}),r}function Ul(t,e,n,r){return t/e*n+r}function jl(t,e,n,r){return t-e*n/r}var Hl=function(t,e,n,r,a,s,o,l,u,c){if(this.boxStartIndex=t.length,u){var h=s.top,d=s.bottom,p=s.collisionPadding;p&&(h-=p[1],d+=p[3]);var f=d-h;f>0&&(f=Math.max(10,f),this.circleDiameter=f)}else{var m=s.top*o-l,g=s.bottom*o+l,y=s.left*o-l,v=s.right*o+l,_=s.collisionPadding;if(_&&(y-=_[0]*o,m-=_[1]*o,v+=_[2]*o,g+=_[3]*o),c){var b=new i(y,m),x=new i(v,m),w=new i(y,g),S=new i(v,g),C=c*Math.PI/180;b._rotate(C),x._rotate(C),w._rotate(C),S._rotate(C),y=Math.min(b.x,x.x,w.x,S.x),v=Math.max(b.x,x.x,w.x,S.x),m=Math.min(b.y,x.y,w.y,S.y),g=Math.max(b.y,x.y,w.y,S.y)}t.emplaceBack(e.x,e.y,y,m,v,g,n,r,a)}this.boxEndIndex=t.length},Gl=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=Jl),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};function Jl(t,e){return t<e?-1:t>e?1:0}function Xl(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);for(var r=1/0,a=1/0,s=-1/0,o=-1/0,l=t[0],u=0;u<l.length;u++){var c=l[u];(!u||c.x<r)&&(r=c.x),(!u||c.y<a)&&(a=c.y),(!u||c.x>s)&&(s=c.x),(!u||c.y>o)&&(o=c.y)}var h=Math.min(s-r,o-a),d=h/2,p=new Gl([],Kl);if(0===h)return new i(r,a);for(var f=r;f<s;f+=h)for(var m=a;m<o;m+=h)p.push(new Zl(f+d,m+d,d,t));for(var g=function(t){for(var e=0,n=0,r=0,i=t[0],a=0,s=i.length,o=s-1;a<s;o=a++){var l=i[a],u=i[o],c=l.x*u.y-u.x*l.y;n+=(l.x+u.x)*c,r+=(l.y+u.y)*c,e+=3*c}return new Zl(n/e,r/e,0,t)}(t),y=p.length;p.length;){var v=p.pop();(v.d>g.d||!g.d)&&(g=v,n&&console.log("found best %d after %d probes",Math.round(1e4*v.d)/1e4,y)),v.max-g.d<=e||(p.push(new Zl(v.p.x-(d=v.h/2),v.p.y-d,d,t)),p.push(new Zl(v.p.x+d,v.p.y-d,d,t)),p.push(new Zl(v.p.x-d,v.p.y+d,d,t)),p.push(new Zl(v.p.x+d,v.p.y+d,d,t)),y+=4)}return n&&(console.log("num probes: "+y),console.log("best distance: "+g.d)),g.p}function Kl(t,e){return e.max-t.max}function Zl(t,e,n,r){this.p=new i(t,e),this.h=n,this.d=function(t,e){for(var n=!1,r=1/0,i=0;i<e.length;i++)for(var a=e[i],s=0,o=a.length,l=o-1;s<o;l=s++){var u=a[s],c=a[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(n=!n),r=Math.min(r,ja(t,u,c))}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}Gl.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Gl.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},Gl.prototype.peek=function(){return this.data[0]},Gl.prototype._up=function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,a=e[i];if(n(r,a)>=0)break;e[t]=a,t=i}e[t]=r},Gl.prototype._down=function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var a=1+(t<<1),s=e[a],o=a+1;if(o<this.length&&n(e[o],s)<0&&(a=o,s=e[o]),n(s,i)>=0)break;e[t]=s,t=a}e[t]=i};var Yl=Number.POSITIVE_INFINITY;function Ql(t,e){return e[1]!==Yl?function(t,e,n){var r=0,i=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":i=n-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-n}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,i]}(t,e[0],e[1]):function(t,e){var n=0,r=0;e<0&&(e=0);var i=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":r=i-7;break;case"bottom-right":case"bottom-left":r=7-i;break;case"bottom":r=7-e;break;case"top":r=e-7}switch(t){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=e;break;case"right":n=-e}return[n,r]}(t,e[0])}function tu(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function eu(t,e,n,r,a,s,o,l,u,c,h,d,p,f,m){var g=function(t,e,n,r,a,s,o,l){for(var u=r.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,c=[],h=0,d=e.positionedLines;h<d.length;h+=1)for(var p=d[h],f=0,m=p.positionedGlyphs;f<m.length;f+=1){var g=m[f];if(g.rect){var y=g.rect||{},v=4,_=!0,b=1,x=0,w=(a||l)&&g.vertical,S=g.metrics.advance*g.scale/2;if(l&&e.verticalizable&&(x=p.lineOffset/2-(g.imageName?-(24-g.metrics.width*g.scale)/2:24*(g.scale-1))),g.imageName){var C=o[g.imageName];_=C.sdf,v=1/(b=C.pixelRatio)}var D=a?[g.x+S,g.y]:[0,0],I=a?[0,0]:[g.x+S+n[0],g.y+n[1]-x],k=[0,0];w&&(k=I,I=[0,0]);var E=(g.metrics.left-v)*g.scale-S+I[0],A=(-g.metrics.top-v)*g.scale+I[1],T=E+y.w*g.scale/b,R=A+y.h*g.scale/b,M=new i(E,A),N=new i(T,A),O=new i(E,R),P=new i(T,R);if(w){var F=new i(-S,S- -17),L=-Math.PI/2,z=12-S,$=new i(22-z,-(g.imageName?z:0)),B=new(Function.prototype.bind.apply(i,[null].concat(k)));M._rotateAround(L,F)._add($)._add(B),N._rotateAround(L,F)._add($)._add(B),O._rotateAround(L,F)._add($)._add(B),P._rotateAround(L,F)._add($)._add(B)}if(u){var W=Math.sin(u),q=Math.cos(u),V=[q,-W,W,q];M._matMult(V),N._matMult(V),O._matMult(V),P._matMult(V)}var U=new i(0,0),j=new i(0,0);c.push({tl:M,tr:N,bl:O,br:P,tex:y,writingMode:e.writingMode,glyphOffset:D,sectionIndex:g.sectionIndex,isSDF:_,pixelOffsetTL:U,pixelOffsetBR:j,minFontScaleX:0,minFontScaleY:0})}}return c}(0,n,l,a,s,o,r,t.allowVerticalPlacement),y=t.textSizeData,v=null;"source"===y.kind?(v=[128*a.layout.get("text-size").evaluate(o,{})])[0]>32640&&x(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===y.kind&&((v=[128*f.compositeTextSizes[0].evaluate(o,{},m),128*f.compositeTextSizes[1].evaluate(o,{},m)])[0]>32640||v[1]>32640)&&x(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,g,v,l,s,o,c,e,u.lineStartIndex,u.lineLength,p,m);for(var _=0,b=h;_<b.length;_+=1)d[b[_]]=t.text.placedSymbolArray.length-1;return 4*g.length}function nu(t){for(var e in t)return t[e];return null}function ru(t,e,n,r){var i=t.compareText;if(e in i){for(var a=i[e],s=a.length-1;s>=0;s--)if(r.dist(a[s])<n)return!0}else i[e]=[];return i[e].push(r),!1}var iu=mo.VectorTileFeature.types,au=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function su(t,e,n,r,i,a,s,o,l,u,c,h,d){var p=o?Math.min(32640,Math.round(o[0])):0,f=o?Math.min(32640,Math.round(o[1])):0;t.emplaceBack(e,n,Math.round(32*r),Math.round(32*i),a,s,(p<<1)+(l?1:0),f,16*u,16*c,256*h,256*d)}function ou(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function lu(t){for(var e=0,n=t.sections;e<n.length;e+=1)if(Jr(n[e].text))return!0;return!1}var uu=function(t){this.layoutVertexArray=new Ti,this.indexArray=new Li,this.programConfigurations=t,this.segments=new ia,this.dynamicLayoutVertexArray=new Ri,this.opacityVertexArray=new Mi,this.placedSymbolArray=new Ki};uu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},uu.prototype.upload=function(t,e,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Po.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Fo.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,au,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t))},uu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Pr("SymbolBuffers",uu);var cu=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new ia,this.collisionVertexArray=new Fi};cu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Lo.members,!0)},cu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Pr("CollisionBuffers",cu);var hu=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=es([]),this.placementViewportMatrix=es([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Tl(this.zoom,e["text-size"]),this.iconSizeData=Tl(this.zoom,e["icon-size"]);var n=this.layers[0].layout,r=n.get("symbol-sort-key"),i=n.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==i&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")),"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((function(t){return ml[t]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=t.sourceID};hu.prototype.createArrays=function(){this.text=new uu(new Ra(Po.members,this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new uu(new Ra(Po.members,this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.glyphOffsetArray=new Qi,this.lineVertexArray=new ta,this.symbolInstances=new Yi},hu.prototype.calculateGlyphDependencies=function(t,e,n,r,i){for(var a=0;a<t.length;a++)if(e[t.charCodeAt(a)]=!0,(n||r)&&i){var s=Wo[t.charAt(a)];s&&(e[s.charCodeAt(0)]=!0)}},hu.prototype.populate=function(t,e,n){var r=this.layers[0],i=r.layout,a=i.get("text-font"),s=i.get("text-field"),o=i.get("icon-image"),l=("constant"!==s.value.kind||s.value.value instanceof te&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),u="constant"!==o.value.kind||!!o.value.value||Object.keys(o.parameters).length>0,c=i.get("symbol-sort-key");if(this.features=[],l||u){for(var h=e.iconDependencies,d=e.glyphDependencies,p=e.availableImages,f=new ii(this.zoom),m=0,g=t;m<g.length;m+=1){var y=g[m],v=y.feature,_=y.id,b=y.index,x=y.sourceLayerIndex,w=r._featureFilter.needGeometry,S={type:v.type,id:_,properties:v.properties,geometry:w?Pa(v):[]};if(r._featureFilter.filter(f,S,n)){w||(S.geometry=Pa(v));var C=void 0;if(l){var D=r.getValueAndResolveTokens("text-field",S,n,p),I=te.factory(D);lu(I)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ei()||this.hasRTLText&&ri.isParsed())&&(C=Bo(I,r,S))}var k=void 0;if(u){var E=r.getValueAndResolveTokens("icon-image",S,n,p);k=E instanceof ee?E:ee.fromString(E)}if(C||k){var A=this.sortFeaturesByKey?c.evaluate(S,{},n):void 0,T={id:_,text:C,icon:k,index:b,sourceLayerIndex:x,geometry:Pa(v),properties:v.properties,type:iu[v.type],sortKey:A};if(this.features.push(T),k&&(h[k.name]=!0),C){var R=a.evaluate(S,{},n).join(","),M="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ml.vertical)>=0;for(var N=0,O=C.sections;N<O.length;N+=1){var P=O[N];if(P.image)h[P.image.name]=!0;else{var F=Vr(C.toString()),L=P.fontStack||R,z=d[L]=d[L]||{};this.calculateGlyphDependencies(P.text,z,M,this.allowVerticalPlacement,F)}}}}}}"line"===i.get("symbol-placement")&&(this.features=function(t){var e={},n={},r=[],i=0;function a(e){r.push(t[e]),i++}function s(t,e,i){var a=n[t];return delete n[t],n[e]=a,r[a].geometry[0].pop(),r[a].geometry[0]=r[a].geometry[0].concat(i[0]),a}function o(t,n,i){var a=e[n];return delete e[n],e[t]=a,r[a].geometry[0].shift(),r[a].geometry[0]=i[0].concat(r[a].geometry[0]),a}function l(t,e,n){var r=n?e[0][e[0].length-1]:e[0][0];return t+":"+r.x+":"+r.y}for(var u=0;u<t.length;u++){var c=t[u],h=c.geometry,d=c.text?c.text.toString():null;if(d){var p=l(d,h),f=l(d,h,!0);if(p in n&&f in e&&n[p]!==e[f]){var m=o(p,f,h),g=s(p,f,r[m].geometry);delete e[p],delete n[f],n[l(d,r[g].geometry,!0)]=g,r[m].geometry=null}else p in n?s(p,f,h):f in e?o(p,f,h):(a(u),e[p]=i-1,n[f]=i-1)}else a(u)}return r.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}},hu.prototype.update=function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))},hu.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},hu.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},hu.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},hu.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},hu.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},hu.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var r=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),a={},s=t.segment+1;s<e.length;s++)a[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:r},s<e.length-1&&(r+=e[s+1].dist(e[s]));for(var o=t.segment||0;o>=0;o--)a[o]={x:e[o].x,y:e[o].y,tileUnitDistanceFromAnchor:i},o>0&&(i+=e[o-1].dist(e[o]));for(var l=0;l<e.length;l++){var u=a[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},hu.prototype.addSymbols=function(t,e,n,r,i,a,s,o,l,u,c,h){for(var d=t.indexArray,p=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,p,d,a.sortKey),m=this.glyphOffsetArray.length,g=f.vertexLength,y=this.allowVerticalPlacement&&s===ml.vertical?Math.PI/2:0,v=a.text&&a.text.sections,_=0;_<e.length;_++){var b=e[_],x=b.tl,w=b.tr,S=b.bl,C=b.br,D=b.tex,I=b.pixelOffsetTL,k=b.pixelOffsetBR,E=b.minFontScaleX,A=b.minFontScaleY,T=b.glyphOffset,R=b.isSDF,M=b.sectionIndex,N=f.vertexLength,O=T[1];su(p,o.x,o.y,x.x,O+x.y,D.x,D.y,n,R,I.x,I.y,E,A),su(p,o.x,o.y,w.x,O+w.y,D.x+D.w,D.y,n,R,k.x,I.y,E,A),su(p,o.x,o.y,S.x,O+S.y,D.x,D.y+D.h,n,R,I.x,k.y,E,A),su(p,o.x,o.y,C.x,O+C.y,D.x+D.w,D.y+D.h,n,R,k.x,k.y,E,A),ou(t.dynamicLayoutVertexArray,o,y),d.emplaceBack(N,N+1,N+2),d.emplaceBack(N+1,N+2,N+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(T[0]),_!==e.length-1&&M===e[_+1].sectionIndex||t.programConfigurations.populatePaintArrays(p.length,a,a.index,{},h,v&&v[M])}t.placedSymbolArray.emplaceBack(o.x,o.y,m,this.glyphOffsetArray.length-m,g,l,u,o.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],s,0,!1,0,c)},hu.prototype._addCollisionDebugVertex=function(t,e,n,r,i,a){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,r,i,Math.round(a.x),Math.round(a.y))},hu.prototype.addCollisionDebugVertices=function(t,e,n,r,a,s,o){var l=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),u=l.vertexLength,c=a.layoutVertexArray,h=a.collisionVertexArray,d=o.anchorX,p=o.anchorY;this._addCollisionDebugVertex(c,h,s,d,p,new i(t,e)),this._addCollisionDebugVertex(c,h,s,d,p,new i(n,e)),this._addCollisionDebugVertex(c,h,s,d,p,new i(n,r)),this._addCollisionDebugVertex(c,h,s,d,p,new i(t,r)),l.vertexLength+=4;var f=a.indexArray;f.emplaceBack(u,u+1),f.emplaceBack(u+1,u+2),f.emplaceBack(u+2,u+3),f.emplaceBack(u+3,u),l.primitiveLength+=4},hu.prototype.addDebugCollisionBoxes=function(t,e,n,r){for(var i=t;i<e;i++){var a=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(a.x1,a.y1,a.x2,a.y2,r?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,n)}},hu.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cu(Oi,zo.members,Vi),this.iconCollisionBox=new cu(Oi,zo.members,Vi);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},hu.prototype._deserializeCollisionBoxesForSymbol=function(t,e,n,r,i,a,s,o,l){for(var u={},c=e;c<n;c++){var h=t.get(c);u.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},u.textFeatureIndex=h.featureIndex;break}for(var d=r;d<i;d++){var p=t.get(d);u.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},u.verticalTextFeatureIndex=p.featureIndex;break}for(var f=a;f<s;f++){var m=t.get(f);u.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},u.iconFeatureIndex=m.featureIndex;break}for(var g=o;g<l;g++){var y=t.get(g);u.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},u.verticalIconFeatureIndex=y.featureIndex;break}return u},hu.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}},hu.prototype.hasTextData=function(){return this.text.segments.get().length>0},hu.prototype.hasIconData=function(){return this.icon.segments.get().length>0},hu.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},hu.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},hu.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},hu.prototype.addIndicesForPlacedSymbol=function(t,e){for(var n=t.placedSymbolArray.get(e),r=n.vertexStartIndex+4*n.numGlyphs,i=n.vertexStartIndex;i<r;i+=4)t.indexArray.emplaceBack(i,i+1,i+2),t.indexArray.emplaceBack(i+1,i+2,i+3)},hu.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),n=Math.cos(t),r=[],i=[],a=[],s=0;s<this.symbolInstances.length;++s){a.push(s);var o=this.symbolInstances.get(s);r.push(0|Math.round(e*o.anchorX+n*o.anchorY)),i.push(o.featureIndex)}return a.sort((function(t,e){return r[t]-r[e]||i[e]-i[t]})),a},hu.prototype.addToSortKeyRanges=function(t,e){var n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},hu.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var n=0,r=this.symbolInstanceIndexes;n<r.length;n+=1){var i=this.symbolInstances.get(r[n]);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((function(t,n,r){t>=0&&r.indexOf(t)===n&&e.addIndicesForPlacedSymbol(e.text,t)})),i.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,i.verticalPlacedTextSymbolIndex),i.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.placedIconSymbolIndex),i.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Pr("SymbolBucket",hu,{omit:["layers","collisionBoxArray","features","compareText"]}),hu.MAX_GLYPHS=65535,hu.addDynamicAttributes=ou;var du=new vi({"symbol-placement":new pi(It.layout_symbol["symbol-placement"]),"symbol-spacing":new pi(It.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pi(It.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new fi(It.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pi(It.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pi(It.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new pi(It.layout_symbol["icon-ignore-placement"]),"icon-optional":new pi(It.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pi(It.layout_symbol["icon-rotation-alignment"]),"icon-size":new fi(It.layout_symbol["icon-size"]),"icon-text-fit":new pi(It.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pi(It.layout_symbol["icon-text-fit-padding"]),"icon-image":new fi(It.layout_symbol["icon-image"]),"icon-rotate":new fi(It.layout_symbol["icon-rotate"]),"icon-padding":new pi(It.layout_symbol["icon-padding"]),"icon-keep-upright":new pi(It.layout_symbol["icon-keep-upright"]),"icon-offset":new fi(It.layout_symbol["icon-offset"]),"icon-anchor":new fi(It.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pi(It.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pi(It.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pi(It.layout_symbol["text-rotation-alignment"]),"text-field":new fi(It.layout_symbol["text-field"]),"text-font":new fi(It.layout_symbol["text-font"]),"text-size":new fi(It.layout_symbol["text-size"]),"text-max-width":new fi(It.layout_symbol["text-max-width"]),"text-line-height":new pi(It.layout_symbol["text-line-height"]),"text-letter-spacing":new fi(It.layout_symbol["text-letter-spacing"]),"text-justify":new fi(It.layout_symbol["text-justify"]),"text-radial-offset":new fi(It.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pi(It.layout_symbol["text-variable-anchor"]),"text-anchor":new fi(It.layout_symbol["text-anchor"]),"text-max-angle":new pi(It.layout_symbol["text-max-angle"]),"text-writing-mode":new pi(It.layout_symbol["text-writing-mode"]),"text-rotate":new fi(It.layout_symbol["text-rotate"]),"text-padding":new pi(It.layout_symbol["text-padding"]),"text-keep-upright":new pi(It.layout_symbol["text-keep-upright"]),"text-transform":new fi(It.layout_symbol["text-transform"]),"text-offset":new fi(It.layout_symbol["text-offset"]),"text-allow-overlap":new pi(It.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new pi(It.layout_symbol["text-ignore-placement"]),"text-optional":new pi(It.layout_symbol["text-optional"])}),pu={paint:new vi({"icon-opacity":new fi(It.paint_symbol["icon-opacity"]),"icon-color":new fi(It.paint_symbol["icon-color"]),"icon-halo-color":new fi(It.paint_symbol["icon-halo-color"]),"icon-halo-width":new fi(It.paint_symbol["icon-halo-width"]),"icon-halo-blur":new fi(It.paint_symbol["icon-halo-blur"]),"icon-translate":new pi(It.paint_symbol["icon-translate"]),"icon-translate-anchor":new pi(It.paint_symbol["icon-translate-anchor"]),"text-opacity":new fi(It.paint_symbol["text-opacity"]),"text-color":new fi(It.paint_symbol["text-color"],{runtimeType:zt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new fi(It.paint_symbol["text-halo-color"]),"text-halo-width":new fi(It.paint_symbol["text-halo-width"]),"text-halo-blur":new fi(It.paint_symbol["text-halo-blur"]),"text-translate":new pi(It.paint_symbol["text-translate"]),"text-translate-anchor":new pi(It.paint_symbol["text-translate-anchor"])}),layout:du},fu=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ot,this.defaultValue=t};fu.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},fu.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},fu.prototype.outputDefined=function(){return!1},fu.prototype.serialize=function(){return null},Pr("FormatSectionOverride",fu,{omit:["defaultValue"]});var mu=function(t){function e(e){t.call(this,e,pu)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){if(t.prototype.recalculate.call(this,e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var i=[],a=0,s=r;a<s.length;a+=1){var o=s[a];i.indexOf(o)<0&&i.push(o)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(t,e,n,r){var i=this.layout.get(t).evaluate(e,{},n,r),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||Vn(a.value)||!i?i:function(t,e){return e.replace(/{([^{}]+)}/g,(function(e,n){return n in t?String(t[n]):""}))}(e.properties,i)},e.prototype.createBucket=function(t){return new hu(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var t=0,n=pu.paint.overridableProperties;t<n.length;t+=1){var r=n[t];if(e.hasPaintOverride(this.layout,r)){var i,a=this.paint.get(r),s=new fu(a),o=new qn(s,a.property.specification);i="constant"===a.value.kind||"source"===a.value.kind?new jn("source",o):new Hn("composite",o,a.value.zoomStops,a.value._interpolationType),this.paint._values[r]=new hi(a.property,i,a.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(t,n,r){return!(!this.layout||n.isDataDriven()||r.isDataDriven())&&e.hasPaintOverride(this.layout,t)},e.hasPaintOverride=function(t,e){var n=t.get("text-field"),r=pu.paint.properties[e],i=!1,a=function(t){for(var e=0,n=t;e<n.length;e+=1)if(r.overrides&&r.overrides.hasOverride(n[e]))return void(i=!0)};if("constant"===n.value.kind&&n.value.value instanceof te)a(n.value.value.sections);else if("source"===n.value.kind){var s=function(t){i||(t instanceof se&&ie(t.value)===qt?a(t.value.sections):t instanceof ce?a(t.sections):t.eachChild(s))},o=n.value;o._styleExpression&&s(o._styleExpression.expression)}return i},e}(_i),gu={paint:new vi({"background-color":new pi(It.paint_background["background-color"]),"background-pattern":new gi(It.paint_background["background-pattern"]),"background-opacity":new pi(It.paint_background["background-opacity"])})},yu=function(t){function e(e){t.call(this,e,gu)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(_i),vu={paint:new vi({"raster-opacity":new pi(It.paint_raster["raster-opacity"]),"raster-hue-rotate":new pi(It.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pi(It.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pi(It.paint_raster["raster-brightness-max"]),"raster-saturation":new pi(It.paint_raster["raster-saturation"]),"raster-contrast":new pi(It.paint_raster["raster-contrast"]),"raster-resampling":new pi(It.paint_raster["raster-resampling"]),"raster-fade-duration":new pi(It.paint_raster["raster-fade-duration"])})},_u=function(t){function e(e){t.call(this,e,vu)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(_i),bu=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},e}(_i),xu={circle:ss,heatmap:gs,hillshade:vs,fill:io,"fill-extrusion":wo,line:No,symbol:mu,background:yu,raster:_u},wu=self.HTMLImageElement,Su=self.HTMLCanvasElement,Cu=self.HTMLVideoElement,Du=self.ImageData,Iu=self.ImageBitmap,ku=function(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)};ku.prototype.update=function(t,e,n){var r=t.width,i=t.height,a=!(this.size&&this.size[0]===r&&this.size[1]===i||n),s=this.context,o=s.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),o.bindTexture(o.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===o.RGBA&&(!e||!1!==e.premultiply)),a)this.size=[r,i],t instanceof wu||t instanceof Su||t instanceof Cu||t instanceof Du||Iu&&t instanceof Iu?o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,o.UNSIGNED_BYTE,t):o.texImage2D(o.TEXTURE_2D,0,this.format,r,i,0,this.format,o.UNSIGNED_BYTE,t.data);else{var l=n||{x:0,y:0},u=l.x,c=l.y;t instanceof wu||t instanceof Su||t instanceof Cu||t instanceof Du||Iu&&t instanceof Iu?o.texSubImage2D(o.TEXTURE_2D,0,u,c,o.RGBA,o.UNSIGNED_BYTE,t):o.texSubImage2D(o.TEXTURE_2D,0,u,c,r,i,o.RGBA,o.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&o.generateMipmap(o.TEXTURE_2D)},ku.prototype.bind=function(t,e,n){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)},ku.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ku.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Eu=function(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Eu.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))},Eu.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Au=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},m(["receive","process"],this),this.invoker=new Eu(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=C()?t:self};function Tu(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}Au.prototype.send=function(t,e,n,r,i){var a=this;void 0===i&&(i=!1);var s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[s]=n);var o=k(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:t,hasCallback:!!n,targetMapId:r,mustQueue:i,sourceMapId:this.mapId,data:$r(e,o)},o),{cancel:function(){n&&delete a.callbacks[s],a.target.postMessage({id:s,type:"<cancel>",targetMapId:r,sourceMapId:a.mapId})}}},Au.prototype.receive=function(t){var e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[n];var r=this.cancelCallbacks[n];delete this.cancelCallbacks[n],r&&r()}else C()||e.mustQueue?(this.tasks[n]=e,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,e)},Au.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Au.prototype.processTask=function(t,e){var n=this;if("<response>"===e.type){var r=this.callbacks[t];delete this.callbacks[t],r&&(e.error?r(Br(e.error)):r(null,Br(e.data)))}else{var i=!1,a=k(this.globalScope)?void 0:[],s=e.hasCallback?function(e,r){i=!0,delete n.cancelCallbacks[t],n.target.postMessage({id:t,type:"<response>",sourceMapId:n.mapId,error:e?$r(e):null,data:$r(r,a)},a)}:function(t){i=!0},o=null,l=Br(e.data);if(this.parent[e.type])o=this.parent[e.type](e.sourceMapId,l,s);else if(this.parent.getWorkerSource){var u=e.type.split(".");o=this.parent.getWorkerSource(e.sourceMapId,u[0],l.source)[u[1]](l,s)}else s(new Error("Could not find function "+e.type));!i&&o&&o.cancel&&(this.cancelCallbacks[t]=o.cancel)}},Au.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ru=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Ru.prototype.setNorthEast=function(t){return this._ne=t instanceof Mu?new Mu(t.lng,t.lat):Mu.convert(t),this},Ru.prototype.setSouthWest=function(t){return this._sw=t instanceof Mu?new Mu(t.lng,t.lat):Mu.convert(t),this},Ru.prototype.extend=function(t){var e,n,r=this._sw,i=this._ne;if(t instanceof Mu)e=t,n=t;else{if(!(t instanceof Ru))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ru.convert(t)):this.extend(Mu.convert(t)):this;if(n=t._ne,!(e=t._sw)||!n)return this}return r||i?(r.lng=Math.min(e.lng,r.lng),r.lat=Math.min(e.lat,r.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new Mu(e.lng,e.lat),this._ne=new Mu(n.lng,n.lat)),this},Ru.prototype.getCenter=function(){return new Mu((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ru.prototype.getSouthWest=function(){return this._sw},Ru.prototype.getNorthEast=function(){return this._ne},Ru.prototype.getNorthWest=function(){return new Mu(this.getWest(),this.getNorth())},Ru.prototype.getSouthEast=function(){return new Mu(this.getEast(),this.getSouth())},Ru.prototype.getWest=function(){return this._sw.lng},Ru.prototype.getSouth=function(){return this._sw.lat},Ru.prototype.getEast=function(){return this._ne.lng},Ru.prototype.getNorth=function(){return this._ne.lat},Ru.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ru.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ru.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ru.prototype.contains=function(t){var e=Mu.convert(t),n=e.lng,r=e.lat,i=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&i},Ru.convert=function(t){return!t||t instanceof Ru?t:new Ru(t)};var Mu=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Mu.prototype.wrap=function(){return new Mu(u(this.lng,-180,180),this.lat)},Mu.prototype.toArray=function(){return[this.lng,this.lat]},Mu.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Mu.prototype.distanceTo=function(t){var e=Math.PI/180,n=this.lat*e,r=t.lat*e,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(i,1))},Mu.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Ru(new Mu(this.lng-n,this.lat-e),new Mu(this.lng+n,this.lat+e))},Mu.convert=function(t){if(t instanceof Mu)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Mu(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Mu(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Nu=2*Math.PI*6371008.8;function Ou(t){return Nu*Math.cos(t*Math.PI/180)}function Pu(t){return(180+t)/360}function Fu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Lu(t,e){return t/Ou(e)}function zu(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var $u=function(t,e,n){void 0===n&&(n=0),this.x=+t,this.y=+e,this.z=+n};$u.fromLngLat=function(t,e){void 0===e&&(e=0);var n=Mu.convert(t);return new $u(Pu(n.lng),Fu(n.lat),Lu(e,n.lat))},$u.prototype.toLngLat=function(){return new Mu(360*this.x-180,zu(this.y))},$u.prototype.toAltitude=function(){return this.z*Ou(zu(this.y))},$u.prototype.meterInMercatorCoordinateUnits=function(){return 1/Nu*(t=zu(this.y),1/Math.cos(t*Math.PI/180));var t};var Bu=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Vu(0,t,t,e,n)};Bu.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Bu.prototype.url=function(t,e){var n,r,i,a,s,o=(r=this.y,i=this.z,a=Tu(256*(n=this.x),256*(r=Math.pow(2,i)-r-1),i),s=Tu(256*(n+1),256*(r+1),i),a[0]+","+a[1]+","+s[0]+","+s[1]),l=function(t,e,n){for(var r,i="",a=t;a>0;a--)i+=(e&(r=1<<a-1)?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",o)},Bu.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new i(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Bu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Wu=function(t,e){this.wrap=t,this.canonical=e,this.key=Vu(t,e.z,e.z,e.x,e.y)},qu=function(t,e,n,r,i){this.overscaledZ=t,this.wrap=e,this.canonical=new Bu(n,+r,+i),this.key=Vu(e,t,n,r,i)};function Vu(t,e,n,r,i){(t*=2)<0&&(t=-1*t-1);var a=1<<n;return(a*a*t+a*i+r).toString(36)+n.toString(36)+e.toString(36)}qu.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},qu.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new qu(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new qu(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},qu.prototype.calculateScaledKey=function(t,e){var n=this.canonical.z-t;return t>this.canonical.z?Vu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Vu(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)},qu.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},qu.prototype.children=function(t){if(this.overscaledZ>=t)return[new qu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new qu(e,this.wrap,e,n,r),new qu(e,this.wrap,e,n+1,r),new qu(e,this.wrap,e,n,r+1),new qu(e,this.wrap,e,n+1,r+1)]},qu.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},qu.prototype.wrapped=function(){return new qu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},qu.prototype.unwrapTo=function(t){return new qu(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},qu.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},qu.prototype.toUnwrapped=function(){return new Wu(this.wrap,this.canonical)},qu.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},qu.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new $u(t.x-this.wrap,t.y))},Pr("CanonicalTileID",Bu),Pr("OverscaledTileID",qu,{omit:["posMatrix"]});var Uu=function(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return x('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var r=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox";for(var i=0;i<r;i++)this.data[this._idx(-1,i)]=this.data[this._idx(0,i)],this.data[this._idx(r,i)]=this.data[this._idx(r-1,i)],this.data[this._idx(i,-1)]=this.data[this._idx(i,0)],this.data[this._idx(i,r)]=this.data[this._idx(i,r-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(r,-1)]=this.data[this._idx(r-1,0)],this.data[this._idx(-1,r)]=this.data[this._idx(0,r-1)],this.data[this._idx(r,r)]=this.data[this._idx(r-1,r-1)]};Uu.prototype.get=function(t,e){var n=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[r],n[r+1],n[r+2])},Uu.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Uu.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Uu.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},Uu.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},Uu.prototype.getPixels=function(){return new ps({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Uu.prototype.backfillBorder=function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var r=e*this.dim,i=e*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:a=s-1;break;case 1:s=a+1}for(var o=-e*this.dim,l=-n*this.dim,u=a;u<s;u++)for(var c=r;c<i;c++)this.data[this._idx(c,u)]=t.data[this._idx(c+o,u+l)]},Pr("DEMData",Uu);var ju=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};ju.prototype.encode=function(t){return this._stringToNumber[t]},ju.prototype.decode=function(t){return this._numberToString[t]};var Hu=function(t,e,n,r,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=r,this.properties=t.properties,this.id=i},Gu={geometry:{configurable:!0}};Gu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Gu.geometry.set=function(t){this._geometry=t},Hu.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Hu.prototype,Gu);var Ju=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ju.prototype.updateState=function(t,e,n){var r=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},c(this.stateChanges[t][r],n),null===this.deletedStates[t])for(var i in this.deletedStates[t]={},this.state[t])i!==r&&(this.deletedStates[t][i]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][r])for(var a in this.deletedStates[t][r]={},this.state[t][r])n[a]||(this.deletedStates[t][r][a]=null);else for(var s in n)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][s]&&delete this.deletedStates[t][r][s]},Ju.prototype.removeFeatureState=function(t,e,n){if(null!==this.deletedStates[t]){var r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(n in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][n]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}},Ju.prototype.getState=function(t,e){var n=String(e),r=c({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var i=this.deletedStates[t][e];if(null===i)return{};for(var a in i)delete r[a]}return r},Ju.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Ju.prototype.coalesceChanges=function(t,e){var n={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var i={};for(var a in this.stateChanges[r])this.state[r][a]||(this.state[r][a]={}),c(this.state[r][a],this.stateChanges[r][a]),i[a]=this.state[r][a];n[r]=i}for(var s in this.deletedStates){this.state[s]=this.state[s]||{};var o={};if(null===this.deletedStates[s])for(var l in this.state[s])o[l]={},this.state[s][l]={};else for(var u in this.deletedStates[s]){if(null===this.deletedStates[s][u])this.state[s][u]={};else for(var h=0,d=Object.keys(this.deletedStates[s][u]);h<d.length;h+=1)delete this.state[s][u][d[h]];o[u]=this.state[s][u]}n[s]=n[s]||{},c(n[s],o)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(var p in t)t[p].setFeatureState(n,e)};var Xu=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Tr(8192,16,0),this.grid3D=new Tr(8192,16,0),this.featureIndexArray=new na,this.promoteId=e};function Ku(t,e,n,r,i){return y(t,(function(t,a){var s=e instanceof di?e.get(a):null;return s&&s.evaluate?s.evaluate(n,r,i):s}))}function Zu(t){for(var e=1/0,n=1/0,r=-1/0,i=-1/0,a=0,s=t;a<s.length;a+=1){var o=s[a];e=Math.min(e,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x),i=Math.max(i,o.y)}return{minX:e,minY:n,maxX:r,maxY:i}}function Yu(t,e){return e-t}Xu.prototype.insert=function(t,e,n,r,i,a){var s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);for(var o=a?this.grid3D:this.grid,l=0;l<e.length;l++){for(var u=e[l],c=[1/0,1/0,-1/0,-1/0],h=0;h<u.length;h++){var d=u[h];c[0]=Math.min(c[0],d.x),c[1]=Math.min(c[1],d.y),c[2]=Math.max(c[2],d.x),c[3]=Math.max(c[3],d.y)}c[0]<8192&&c[1]<8192&&c[2]>=0&&c[3]>=0&&o.insert(s,c[0],c[1],c[2],c[3])}},Xu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new mo.VectorTile(new Uo(this.rawTileData)).layers,this.sourceLayerCoder=new ju(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Xu.prototype.query=function(t,e,n,r){var a=this;this.loadVTLayers();for(var s=t.params||{},o=8192/t.tileSize/t.scale,l=rr(s.filter),u=t.queryGeometry,c=t.queryPadding*o,h=Zu(u),d=this.grid.query(h.minX-c,h.minY-c,h.maxX+c,h.maxY+c),p=Zu(t.cameraQueryGeometry),f=0,m=this.grid3D.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c,(function(e,n,r,a){return function(t,e,n,r,a){for(var s=0,o=t;s<o.length;s+=1){var l=o[s];if(e<=l.x&&n<=l.y&&r>=l.x&&a>=l.y)return!0}var u=[new i(e,n),new i(e,a),new i(r,a),new i(r,n)];if(t.length>2)for(var c=0,h=u;c<h.length;c+=1)if(Ga(t,h[c]))return!0;for(var d=0;d<t.length-1;d++)if(Ja(t[d],t[d+1],u))return!0;return!1}(t.cameraQueryGeometry,e-c,n-c,r+c,a+c)}));f<m.length;f+=1)d.push(m[f]);d.sort(Yu);for(var g,y={},v=function(i){var c=d[i];if(c!==g){g=c;var h=a.featureIndexArray.get(c),p=null;a.loadMatchingFeature(y,h.bucketIndex,h.sourceLayerIndex,h.featureIndex,l,s.layers,s.availableImages,e,n,r,(function(e,n,r){return p||(p=Pa(e)),n.queryIntersectsFeature(u,e,r,p,a.z,t.transform,o,t.pixelPosMatrix)}))}},_=0;_<d.length;_++)v(_);return y},Xu.prototype.loadMatchingFeature=function(t,e,n,r,i,a,s,o,l,u,c){var h=this.bucketLayerIDs[e];if(!a||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(a,h)){var d=this.sourceLayerCoder.decode(n),p=this.vtLayers[d].feature(r);if(i.filter(new ii(this.tileID.overscaledZ),p))for(var f=this.getId(p,d),m=0;m<h.length;m++){var g=h[m];if(!(a&&a.indexOf(g)<0)){var y=o[g];if(y){var v={};void 0!==f&&u&&(v=u.getState(y.sourceLayer||"_geojsonTileLayer",f));var _=l[g];_.paint=Ku(_.paint,y.paint,p,v,s),_.layout=Ku(_.layout,y.layout,p,v,s);var b=!c||c(p,y,v);if(b){var x=new Hu(p,this.z,this.x,this.y,f);x.layer=_;var w=t[g];void 0===w&&(w=t[g]=[]),w.push({featureIndex:r,feature:x,intersectionZ:b})}}}}}},Xu.prototype.lookupSymbolFeatures=function(t,e,n,r,i,a,s,o){var l={};this.loadVTLayers();for(var u=rr(i),c=0,h=t;c<h.length;c+=1)this.loadMatchingFeature(l,n,r,h[c],u,a,s,o,e);return l},Xu.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var r=0,i=n[e];r<i.length;r+=1)if(t===i[r])return!0;return!1},Xu.prototype.getId=function(t,e){var n=t.id;return this.promoteId&&"boolean"==typeof(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(n=Number(n)),n},Pr("FeatureIndex",Xu,{omit:["rawTileData","sourceLayerCoder"]});var Qu=function(t,e){this.tileID=t,this.uid=d(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Qu.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<F.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Qu.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Qu.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var r in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var r=function(){var t=a[i],r=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==r.length){t.layers=r,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return r.filter((function(e){return e.id===t}))[0]})));for(var s=0,o=r;s<o.length;s+=1)n[o[s].id]=t}},i=0,a=t;i<a.length;i+=1)r();return n}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[r];if(i instanceof hu){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var a in this.buckets){var s=this.buckets[a];if(s instanceof hu&&s.hasRTLText){this.hasRTLText=!0,ri.isLoading()||ri.isLoaded()||"deferred"!==ei()||ni();break}}for(var o in this.queryPadding=0,this.buckets){var l=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(o).queryRadius(l))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Ji},Qu.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Qu.prototype.getBucket=function(t){return this.buckets[t.id]},Qu.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ku(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ku(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},Qu.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Qu.prototype.queryRenderedFeatures=function(t,e,n,r,i,a,s,o,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:i,scale:a,tileSize:this.tileSize,pixelPosMatrix:u,transform:o,params:s,queryPadding:this.queryPadding*l},t,e,n):{}},Qu.prototype.querySourceFeatures=function(t,e){var n=this.latestFeatureIndex;if(n&&n.rawTileData){var r=n.loadVTLayers(),i=e?e.sourceLayer:"",a=r._geojsonTileLayer||r[i];if(a)for(var s=rr(e&&e.filter),o=this.tileID.canonical,l=o.z,u=o.x,c=o.y,h={z:l,x:u,y:c},d=0;d<a.length;d++){var p=a.feature(d);if(s.filter(new ii(this.tileID.overscaledZ),p)){var f=n.getId(p,i),m=new Hu(p,l,u,c,f);m.tile=h,t.push(m)}}}},Qu.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Qu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Qu.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=D(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var r=Date.now(),i=!1;if(this.expirationTime>r)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var a=this.expirationTime-e;a?this.expirationTime=r+Math.max(a,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Qu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Qu.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets)if(e.style.hasLayer(r)){var i=this.buckets[r],a=i.layers[0].sourceLayer||"_geojsonTileLayer",s=n[a],o=t[a];if(s&&o&&0!==Object.keys(o).length){i.update(o,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=e&&e.style&&e.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(i)))}}}},Qu.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Qu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()},Qu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Qu.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=F.now()+t},Qu.prototype.setDependencies=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1)n[i[r]]=!0;this.dependencies[t]=n},Qu.prototype.hasDependency=function(t,e){for(var n=0,r=t;n<r.length;n+=1){var i=this.dependencies[r[n]];if(i)for(var a=0,s=e;a<s.length;a+=1)if(i[s[a]])return!0}return!1};var tc=self.performance,ec=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},tc.mark(this._marks.start)};ec.prototype.finish=function(){tc.mark(this._marks.end);var t=tc.getEntriesByName(this._marks.measure);return 0===t.length&&(tc.measure(this._marks.measure,this._marks.start,this._marks.end),t=tc.getEntriesByName(this._marks.measure),tc.clearMarks(this._marks.start),tc.clearMarks(this._marks.end),tc.clearMeasures(this._marks.measure)),t},t.Actor=Au,t.AlphaImage=ds,t.CanonicalTileID=Bu,t.CollisionBoxArray=Ji,t.Color=Zt,t.DEMData=Uu,t.DataConstantProperty=pi,t.DictionaryCoder=ju,t.EXTENT=8192,t.ErrorEvent=Ct,t.EvaluationParameters=ii,t.Event=St,t.Evented=Dt,t.FeatureIndex=Xu,t.FillBucket=eo,t.FillExtrusionBucket=_o,t.ImageAtlas=fl,t.ImagePosition=dl,t.LineBucket=Ao,t.LngLat=Mu,t.LngLatBounds=Ru,t.MercatorCoordinate=$u,t.ONE_EM=24,t.OverscaledTileID=qu,t.Point=i,t.Point$1=i,t.Properties=vi,t.Protobuf=Uo,t.RGBAImage=ps,t.RequestManager=V,t.RequestPerformance=ec,t.ResourceType=dt,t.SegmentVector=ia,t.SourceFeatureState=Ju,t.StructArrayLayout1ui2=Ui,t.StructArrayLayout2f1f2i16=Pi,t.StructArrayLayout2i4=Di,t.StructArrayLayout3ui6=Li,t.StructArrayLayout4i8=Ii,t.SymbolBucket=hu,t.Texture=ku,t.Tile=Qu,t.Transitionable=oi,t.Uniform1f=ya,t.Uniform1i=ga,t.Uniform2f=va,t.Uniform3f=_a,t.Uniform4f=ba,t.UniformColor=xa,t.UniformMatrix4f=Sa,t.UnwrappedTileID=Wu,t.ValidationError=kt,t.WritingMode=ml,t.ZoomHistory=Wr,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=ou,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var r=t.length,i=new Array(t.length),a=null;t.forEach((function(t,s){e(t,(function(t,e){t&&(a=t),i[s]=e,0==--r&&n(a,i)}))}))},t.bezier=s,t.bindAll=m,t.browser=F,t.cacheEntryPossiblyAdded=function(t){++ct>st&&(t.getActor().send("enforceCacheSizeLimit",at),ct=0)},t.clamp=l,t.clearTileCache=function(t){var e=self.caches.delete("mapbox-tiles");t&&e.catch(t).then((function(){return t()}))},t.clipLine=Bl,t.clone=function(t){var e=new ts(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=_,t.clone$2=function(t){var e=new ts(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=$o,t.config=L,t.create=function(){var t=new ts(16);return ts!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new ts(9);return ts!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new ts(4);return ts!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Un,t.createLayout=Si,t.createStyleLayer=function(t){return"custom"===t.type?new bu(t):new xu[t.type](t)},t.cross=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=n[0],o=n[1],l=n[2];return t[0]=i*l-a*o,t[1]=a*s-r*l,t[2]=r*o-i*s,t},t.deepEqual=function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r],n[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var i in e)if(!t(e[i],n[i]))return!1;return!0}return e===n},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=o,t.emitValidationErrors=Ar,t.endsWith=g,t.enforceCacheSizeLimit=function(t){ot(),Y&&Y.then((function(e){e.keys().then((function(n){for(var r=0;r<n.length-t;r++)e.delete(n[r])}))}))},t.evaluateSizeForFeature=Rl,t.evaluateSizeForZoom=Ml,t.evaluateVariableOffset=Ql,t.evented=ti,t.extend=c,t.featureFilter=rr,t.filterObject=v,t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=Il,t.getAnchorJustification=tu,t.getArrayBuffer=vt,t.getImage=bt,t.getJSON=function(t,e){return yt(c(t,{type:"json"}),e)},t.getRTLTextPluginStatus=ei,t.getReferrer=gt,t.getVideo=function(t,e){var n,r,i=self.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var a=0;a<t.length;a++){var s=self.document.createElement("source");n=t[a],r=void 0,(r=self.document.createElement("a")).href=n,(r.protocol!==self.document.location.protocol||r.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),s.src=t[a],i.appendChild(s)}return{cancel:function(){}}},t.identity=es,t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=n*o-r*s,_=n*l-i*s,b=n*u-a*s,x=r*l-i*o,w=r*u-a*o,S=i*u-a*l,C=c*m-h*f,D=c*g-d*f,I=c*y-p*f,k=h*g-d*m,E=h*y-p*m,A=d*y-p*g,T=v*A-_*E+b*k+x*I-w*D+S*C;return T?(t[0]=(o*A-l*E+u*k)*(T=1/T),t[1]=(i*E-r*A-a*k)*T,t[2]=(m*S-g*w+y*x)*T,t[3]=(d*w-h*S-p*x)*T,t[4]=(l*I-s*A-u*D)*T,t[5]=(n*A-i*I+a*D)*T,t[6]=(g*b-f*S-y*_)*T,t[7]=(c*S-d*b+p*_)*T,t[8]=(s*E-o*I+u*C)*T,t[9]=(r*I-n*E-a*C)*T,t[10]=(f*w-m*b+y*v)*T,t[11]=(h*b-c*w-p*v)*T,t[12]=(o*D-s*k-l*C)*T,t[13]=(n*k-r*D+i*C)*T,t[14]=(m*_-f*x-g*v)*T,t[15]=(c*x-h*_+d*v)*T,t):null},t.isChar=qr,t.isMapboxURL=U,t.keysDifference=function(t,e){var n=[];for(var r in t)r in e||n.push(r);return n},t.makeRequest=yt,t.mapObject=y,t.mercatorXfromLng=Pu,t.mercatorYfromLat=Fu,t.mercatorZfromAltitude=Lu,t.mul=is,t.multiply=ns,t.mvt=mo,t.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t},t.number=We,t.offscreenCanvasSupported=ht,t.ortho=function(t,e,n,r,i,a,s){var o=1/(e-n),l=1/(r-i),u=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*l,t[14]=(s+a)*u,t[15]=1,t},t.parseGlyphPBF=function(t){return new Uo(t).readFields(ll,[])},t.pbf=Uo,t.performSymbolLayout=function(t,e,n,r,i,a,s){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var o=t.layers[0].layout,l=t.layers[0]._unevaluatedLayout._values,u={};if("composite"===t.textSizeData.kind){var c=t.textSizeData,h=c.maxZoom;u.compositeTextSizes=[l["text-size"].possiblyEvaluate(new ii(c.minZoom),s),l["text-size"].possiblyEvaluate(new ii(h),s)]}if("composite"===t.iconSizeData.kind){var d=t.iconSizeData,p=d.maxZoom;u.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new ii(d.minZoom),s),l["icon-size"].possiblyEvaluate(new ii(p),s)]}u.layoutTextSize=l["text-size"].possiblyEvaluate(new ii(t.zoom+1),s),u.layoutIconSize=l["icon-size"].possiblyEvaluate(new ii(t.zoom+1),s),u.textMaxSize=l["text-size"].possiblyEvaluate(new ii(18));for(var f=24*o.get("text-line-height"),m="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement"),g=o.get("text-keep-upright"),y=o.get("text-size"),v=function(){var a=b[_],l=o.get("text-font").evaluate(a,{},s).join(","),c=y.evaluate(a,{},s),h=u.layoutTextSize.evaluate(a,{},s),d=u.layoutIconSize.evaluate(a,{},s),p={horizontal:{},vertical:void 0},v=a.text,w=[0,0];if(v){var S=v.toString(),C=24*o.get("text-letter-spacing").evaluate(a,{},s),D=function(t){for(var e=0,n=t;e<n.length;e+=1)if(r=n[e].charCodeAt(0),qr.Arabic(r)||qr["Arabic Supplement"](r)||qr["Arabic Extended-A"](r)||qr["Arabic Presentation Forms-A"](r)||qr["Arabic Presentation Forms-B"](r))return!1;var r;return!0}(S)?C:0,I=o.get("text-anchor").evaluate(a,{},s),k=o.get("text-variable-anchor");if(!k){var E=o.get("text-radial-offset").evaluate(a,{},s);w=E?Ql(I,[24*E,Yl]):o.get("text-offset").evaluate(a,{},s).map((function(t){return 24*t}))}var A=m?"center":o.get("text-justify").evaluate(a,{},s),T=o.get("symbol-placement"),R="point"===T?24*o.get("text-max-width").evaluate(a,{},s):0,M=function(){t.allowVerticalPlacement&&Vr(S)&&(p.vertical=vl(v,e,n,i,l,R,f,I,"left",D,w,ml.vertical,!0,T,h,c))};if(!m&&k){for(var N="auto"===A?k.map((function(t){return tu(t)})):[A],O=!1,P=0;P<N.length;P++){var F=N[P];if(!p.horizontal[F])if(O)p.horizontal[F]=p.horizontal[0];else{var L=vl(v,e,n,i,l,R,f,"center",F,D,w,ml.horizontal,!1,T,h,c);L&&(p.horizontal[F]=L,O=1===L.positionedLines.length)}}M()}else{"auto"===A&&(A=tu(I));var z=vl(v,e,n,i,l,R,f,I,A,D,w,ml.horizontal,!1,T,h,c);z&&(p.horizontal[A]=z),M(),Vr(S)&&m&&g&&(p.vertical=vl(v,e,n,i,l,R,f,I,A,D,w,ml.vertical,!1,T,h,c))}}var $=void 0,B=!1;if(a.icon&&a.icon.name){var W=r[a.icon.name];W&&($=function(t,e,n){var r=Il(n),i=e[0]-t.displaySize[0]*r.horizontalAlign,a=e[1]-t.displaySize[1]*r.verticalAlign;return{image:t,top:a,bottom:a+t.displaySize[1],left:i,right:i+t.displaySize[0]}}(i[a.icon.name],o.get("icon-offset").evaluate(a,{},s),o.get("icon-anchor").evaluate(a,{},s)),B=W.sdf,void 0===t.sdfIcons?t.sdfIcons=W.sdf:t.sdfIcons!==W.sdf&&x("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(W.pixelRatio!==t.pixelRatio||0!==o.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var q=nu(p.horizontal)||p.vertical;t.iconsInText=!!q&&q.iconsInText,(q||$)&&function(t,e,n,r,i,a,s,o,l,u,c){var h=a.textMaxSize.evaluate(e,{});void 0===h&&(h=s);var d,p=t.layers[0].layout,f=p.get("icon-offset").evaluate(e,{},c),m=nu(n.horizontal),g=s/24,y=t.tilePixelRatio*g,v=t.tilePixelRatio*h/24,_=t.tilePixelRatio*o,b=t.tilePixelRatio*p.get("symbol-spacing"),w=p.get("text-padding")*t.tilePixelRatio,S=p.get("icon-padding")*t.tilePixelRatio,C=p.get("text-max-angle")/180*Math.PI,D="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),I="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),k=p.get("symbol-placement"),E=b/2,A=p.get("icon-text-fit");r&&"none"!==A&&(t.allowVerticalPlacement&&n.vertical&&(d=El(r,n.vertical,A,p.get("icon-text-fit-padding"),f,g)),m&&(r=El(r,m,A,p.get("icon-text-fit-padding"),f,g)));var T=function(o,h){h.x<0||h.x>=8192||h.y<0||h.y>=8192||function(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g,y,v,_,b,w,S,C,D){var I,k,E,A,T,R=t.addToLineVertexArray(e,n),M=0,N=0,O=0,P=0,F=-1,L=-1,z={},$=ua(""),B=0,W=0;if(void 0===o._unevaluatedLayout.getValue("text-radial-offset")?(B=(I=o.layout.get("text-offset").evaluate(b,{},C).map((function(t){return 24*t})))[0],W=I[1]):(B=24*o.layout.get("text-radial-offset").evaluate(b,{},C),W=Yl),t.allowVerticalPlacement&&r.vertical){var q=o.layout.get("text-rotate").evaluate(b,{},C)+90;A=new Hl(l,e,u,c,h,r.vertical,d,p,f,q),s&&(T=new Hl(l,e,u,c,h,s,g,y,f,q))}if(i){var V=o.layout.get("icon-rotate").evaluate(b,{}),U="none"!==o.layout.get("icon-text-fit"),j=Wl(i,V,S,U),H=s?Wl(s,V,S,U):void 0;E=new Hl(l,e,u,c,h,i,g,y,!1,V),M=4*j.length;var G=t.iconSizeData,J=null;"source"===G.kind?(J=[128*o.layout.get("icon-size").evaluate(b,{})])[0]>32640&&x(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===G.kind&&((J=[128*w.compositeIconSizes[0].evaluate(b,{},C),128*w.compositeIconSizes[1].evaluate(b,{},C)])[0]>32640||J[1]>32640)&&x(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),t.addSymbols(t.icon,j,J,_,v,b,!1,e,R.lineStartIndex,R.lineLength,-1,C),F=t.icon.placedSymbolArray.length-1,H&&(N=4*H.length,t.addSymbols(t.icon,H,J,_,v,b,ml.vertical,e,R.lineStartIndex,R.lineLength,-1,C),L=t.icon.placedSymbolArray.length-1)}for(var X in r.horizontal){var K=r.horizontal[X];if(!k){$=ua(K.text);var Z=o.layout.get("text-rotate").evaluate(b,{},C);k=new Hl(l,e,u,c,h,K,d,p,f,Z)}var Y=1===K.positionedLines.length;if(O+=eu(t,e,K,a,o,f,b,m,R,r.vertical?ml.horizontal:ml.horizontalOnly,Y?Object.keys(r.horizontal):[X],z,F,w,C),Y)break}r.vertical&&(P+=eu(t,e,r.vertical,a,o,f,b,m,R,ml.vertical,["vertical"],z,L,w,C));var Q=k?k.boxStartIndex:t.collisionBoxArray.length,tt=k?k.boxEndIndex:t.collisionBoxArray.length,et=A?A.boxStartIndex:t.collisionBoxArray.length,nt=A?A.boxEndIndex:t.collisionBoxArray.length,rt=E?E.boxStartIndex:t.collisionBoxArray.length,it=E?E.boxEndIndex:t.collisionBoxArray.length,at=T?T.boxStartIndex:t.collisionBoxArray.length,st=T?T.boxEndIndex:t.collisionBoxArray.length,ot=-1,lt=function(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e};ot=lt(k,ot),ot=lt(A,ot),ot=lt(E,ot);var ut=(ot=lt(T,ot))>-1?1:0;ut&&(ot*=D/24),t.glyphOffsetArray.length>=hu.MAX_GLYPHS&&x("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,z.right>=0?z.right:-1,z.center>=0?z.center:-1,z.left>=0?z.left:-1,z.vertical||-1,F,L,$,Q,tt,et,nt,rt,it,at,st,u,O,P,M,N,ut,0,d,B,W,ot)}(t,h,o,n,r,i,d,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,y,w,D,l,_,S,I,f,e,a,u,c,s)};if("line"===k)for(var R=0,M=Bl(e.geometry,0,0,8192,8192);R<M.length;R+=1)for(var N=M[R],O=0,P=$l(N,b,C,n.vertical||m,r,24,v,t.overscaling,8192);O<P.length;O+=1){var F=P[O];m&&ru(t,m.text,E,F)||T(N,F)}else if("line-center"===k)for(var L=0,z=e.geometry;L<z.length;L+=1){var $=z[L];if($.length>1){var B=zl($,C,n.vertical||m,r,24,v);B&&T($,B)}}else if("Polygon"===e.type)for(var W=0,q=Zs(e.geometry,0);W<q.length;W+=1){var V=q[W],U=Xl(V,16);T(V[0],new Al(U.x,U.y,0))}else if("LineString"===e.type)for(var j=0,H=e.geometry;j<H.length;j+=1){var G=H[j];T(G,new Al(G[0].x,G[0].y,0))}else if("Point"===e.type)for(var J=0,X=e.geometry;J<X.length;J+=1)for(var K=0,Z=X[J];K<Z.length;K+=1){var Y=Z[K];T([Y],new Al(Y.x,Y.y,0))}}(t,a,p,$,r,u,h,d,w,B,s)},_=0,b=t.features;_<b.length;_+=1)v();a&&t.generateCollisionDebugBuffers()},t.perspective=function(t,e,n,r,i){var a,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+r)*(a=1/(r-i)),t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r];i in t&&(n[i]=t[i])}return n},t.plugin=ri,t.polygonIntersectsPolygon=za,t.postMapLoadEvent=it,t.postTurnstileEvent=nt,t.potpack=hl,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=Pr,t.registerForPluginStateChange=function(t){return t({pluginStatus:Kr,pluginURL:Zr}),ti.on("pluginStateChange",t),t},t.rotate=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),l=Math.cos(n);return t[0]=r*l+a*o,t[1]=i*l+s*o,t[2]=r*-o+a*l,t[3]=i*-o+s*l,t},t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+u*r,t[5]=s*i+c*r,t[6]=o*i+h*r,t[7]=l*i+d*r,t[8]=u*i-a*r,t[9]=c*i-s*r,t[10]=h*i-o*r,t[11]=d*i-l*r,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],s=e[1],o=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+u*r,t[1]=s*i+c*r,t[2]=o*i+h*r,t[3]=l*i+d*r,t[4]=u*i-a*r,t[5]=c*i-s*r,t[6]=h*i-o*r,t[7]=d*i-l*r,t},t.scale=function(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.scale$2=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.setCacheLimits=function(t,e){at=t,st=e},t.setRTLTextPlugin=function(t,e,n){if(void 0===n&&(n=!1),"deferred"===Kr||"loading"===Kr||"loaded"===Kr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Zr=F.resolveURL(t),Kr="deferred",Xr=e,Qr(),n||ni()},t.sphericalToCartesian=function(t){var e=t[0],n=t[1],r=t[2];return n+=90,n*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(r),y:e*Math.sin(n)*Math.sin(r),z:e*Math.cos(r)}},t.sqrLen=function(t){var e=t[0],n=t[1];return e*e+n*n},t.styleSpec=It,t.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},t.symbolSize=Nl,t.transformMat3=function(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t},t.transformMat4=as,t.translate=function(t,e,n){var r,i,a,s,o,l,u,c,h,d,p,f,m=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=r=e[0],t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=r*m+o*g+h*y+e[12],t[13]=i*m+l*g+d*y+e[13],t[14]=a*m+u*g+p*y+e[14],t[15]=s*m+c*g+f*y+e[15]),t},t.triggerPluginCompletionEvent=Yr,t.uniqueId=d,t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers."+n+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+n+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=Ir,t.validateStyle=Dr,t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.vectorTile=mo,t.version="1.10.1",t.warnOnce=x,t.webpSupported=z,t.window=self,t.wrap=u})),r(0,(function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",i=0,a=t;i<a.length;i+=1)r+=e(a[i])+",";return r+"]"}for(var s=Object.keys(t).sort(),o="{",l=0;l<s.length;l++)o+=JSON.stringify(s[l])+":"+e(t[s[l]])+",";return o+"}"}function n(n){for(var r="",i=0,a=t.refProperties;i<a.length;i+=1)r+="/"+e(n[a[i]]);return r}var r=function(t){this.keyCache={},t&&this.replace(t)};r.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},r.prototype.update=function(e,r){for(var i=this,a=0,s=e;a<s.length;a+=1){var o=s[a];this._layerConfigs[o.id]=o;var l=this._layers[o.id]=t.createStyleLayer(o);l._featureFilter=t.featureFilter(l.filter),this.keyCache[o.id]&&delete this.keyCache[o.id]}for(var u=0,c=r;u<c.length;u+=1){var h=c[u];delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h]}this.familiesBySource={};for(var d=0,p=function(t,e){for(var r={},i=0;i<t.length;i++){var a=e&&e[t[i].id]||n(t[i]);e&&(e[t[i].id]=a);var s=r[a];s||(s=r[a]=[]),s.push(t[i])}var o=[];for(var l in r)o.push(r[l]);return o}(t.values(this._layerConfigs),this.keyCache);d<p.length;d+=1){var f=p[d].map((function(t){return i._layers[t.id]})),m=f[0];if("none"!==m.visibility){var g=m.source||"",y=this.familiesBySource[g];y||(y=this.familiesBySource[g]={});var v=m.sourceLayer||"_geojsonTileLayer",_=y[v];_||(_=y[v]=[]),_.push(f)}}};var i=function(e){var n={},r=[];for(var i in e){var a=e[i],s=n[i]={};for(var o in a){var l=a[+o];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var u={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};r.push(u),s[o]={rect:u,metrics:l.metrics}}}}var c=t.potpack(r),h=new t.AlphaImage({width:c.w||1,height:c.h||1});for(var d in e){var p=e[d];for(var f in p){var m=p[+f];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var g=n[d][f].rect;t.AlphaImage.copy(m.bitmap,h,{x:0,y:0},{x:g.x+1,y:g.y+1},m.bitmap)}}}this.image=h,this.positions=n};t.register("GlyphAtlas",i);var a=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId};function s(e,n,r){for(var i=new t.EvaluationParameters(n),a=0,s=e;a<s.length;a+=1)s[a].recalculate(i,r)}function o(e,n){var r=t.getArrayBuffer(e.request,(function(e,r,i,a){e?n(e):r&&n(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(r)),rawData:r,cacheControl:i,expires:a})}));return function(){r.cancel(),n()}}a.prototype.parse=function(e,n,r,a,o){var l=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var u=new t.DictionaryCoder(Object.keys(e.layers).sort()),c=new t.FeatureIndex(this.tileID,this.promoteId);c.bucketLayerIDs=[];var h,d,p,f,m={},g={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:r},y=n.familiesBySource[this.source];for(var v in y){var _=e.layers[v];if(_){1===_.version&&t.warnOnce('Vector tile source "'+this.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var b=u.encode(v),x=[],w=0;w<_.length;w++){var S=_.feature(w),C=c.getId(S,v);x.push({feature:S,id:C,index:w,sourceLayerIndex:b})}for(var D=0,I=y[v];D<I.length;D+=1){var k=I[D],E=k[0];E.minzoom&&this.zoom<Math.floor(E.minzoom)||E.maxzoom&&this.zoom>=E.maxzoom||"none"!==E.visibility&&(s(k,this.zoom,r),(m[E.id]=E.createBucket({index:c.bucketLayerIDs.length,layers:k,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(x,g,this.tileID.canonical),c.bucketLayerIDs.push(k.map((function(t){return t.id}))))}}}var A=t.mapObject(g.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(A).length?a.send("getGlyphs",{uid:this.uid,stacks:A},(function(t,e){h||(h=t,d=e,M.call(l))})):d={};var T=Object.keys(g.iconDependencies);T.length?a.send("getImages",{icons:T,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){h||(h=t,p=e,M.call(l))})):p={};var R=Object.keys(g.patternDependencies);function M(){if(h)return o(h);if(d&&p&&f){var e=new i(d),n=new t.ImageAtlas(p,f);for(var a in m){var l=m[a];l instanceof t.SymbolBucket?(s(l.layers,this.zoom,r),t.performSymbolLayout(l,d,e.positions,p,n.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):l.hasPattern&&(l instanceof t.LineBucket||l instanceof t.FillBucket||l instanceof t.FillExtrusionBucket)&&(s(l.layers,this.zoom,r),l.addFeatures(g,this.tileID.canonical,n.patternPositions))}this.status="done",o(null,{buckets:t.values(m).filter((function(t){return!t.isEmpty()})),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?p:null,glyphPositions:this.returnDependencies?e.positions:null})}}R.length?a.send("getImages",{icons:R,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){h||(h=t,f=e,M.call(l))})):f={},M.call(this)};var l=function(t,e,n,r){this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=r||o,this.loading={},this.loaded={}};l.prototype.loadTile=function(e,n){var r=this,i=e.uid;this.loading||(this.loading={});var s=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),o=this.loading[i]=new a(e);o.abort=this.loadVectorData(e,(function(e,a){if(delete r.loading[i],e||!a)return o.status="done",r.loaded[i]=o,n(e);var l=a.rawData,u={};a.expires&&(u.expires=a.expires),a.cacheControl&&(u.cacheControl=a.cacheControl);var c={};if(s){var h=s.finish();h&&(c.resourceTiming=JSON.parse(JSON.stringify(h)))}o.vectorTile=a.vectorTile,o.parse(a.vectorTile,r.layerIndex,r.availableImages,r.actor,(function(e,r){if(e||!r)return n(e);n(null,t.extend({rawTileData:l.slice(0)},r,u,c))})),r.loaded=r.loaded||{},r.loaded[i]=o}))},l.prototype.reloadTile=function(t,e){var n=this,r=this.loaded,i=t.uid,a=this;if(r&&r[i]){var s=r[i];s.showCollisionBoxes=t.showCollisionBoxes;var o=function(t,r){var i=s.reloadCallback;i&&(delete s.reloadCallback,s.parse(s.vectorTile,a.layerIndex,n.availableImages,a.actor,i)),e(t,r)};"parsing"===s.status?s.reloadCallback=o:"done"===s.status&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,o):o())}},l.prototype.abortTile=function(t,e){var n=this.loading,r=t.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),e()},l.prototype.removeTile=function(t,e){var n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()};var u=t.window.ImageBitmap,c=function(){this.loaded={}};function h(t,e){if(0!==t.length){d(t[0],e);for(var n=1;n<t.length;n++)d(t[n],!e)}}function d(t,e){for(var n=0,r=0,i=t.length,a=i-1;r<i;a=r++)n+=(t[r][0]-t[a][0])*(t[a][1]+t[r][1]);n>=0!=!!e&&t.reverse()}c.prototype.loadTile=function(e,n){var r=e.uid,i=e.encoding,a=e.rawImageData,s=u&&a instanceof u?this.getImageData(a):a,o=new t.DEMData(r,s,i);this.loaded=this.loaded||{},this.loaded[r]=o,n(null,o)},c.prototype.getImageData=function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var n=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:n.width,height:n.height},n.data)},c.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var p=t.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};f.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,r=this._feature.geometry;n<r.length;n+=1){var i=r[n];e.push([new t.Point$1(i[0],i[1])])}return e}for(var a=[],s=0,o=this._feature.geometry;s<o.length;s+=1){for(var l=[],u=0,c=o[s];u<c.length;u+=1){var h=c[u];l.push(new t.Point$1(h[0],h[1]))}a.push(l)}return a},f.prototype.toGeoJSON=function(t,e,n){return p.call(this,t,e,n)};var m=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};m.prototype.feature=function(t){return new f(this._features[t])};var g=t.vectorTile.VectorTileFeature,y=v;function v(t,e){this.options=e||{},this.features=t,this.length=t.length}function _(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}v.prototype.feature=function(t){return new _(this.features[t],this.options.extent)},_.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var r=e[n],i=[],a=0;a<r.length;a++)i.push(new t.Point$1(r[a][0],r[a][1]));this.geometry.push(i)}return this.geometry},_.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,a=0;a<t.length;a++)for(var s=t[a],o=0;o<s.length;o++){var l=s[o];e=Math.min(e,l.x),n=Math.max(n,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y)}return[e,r,n,i]},_.prototype.toGeoJSON=g.prototype.toGeoJSON;var b=w,x=y;function w(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,S,t.layers[n])}(e,n),n.finish()}function S(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,C,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var a=r.values;for(n=0;n<a.length;n++)e.writeMessage(4,A,a[n])}function C(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,D,t),e.writeVarintField(3,n.type),e.writeMessage(4,E,n)}function D(t,e){var n=t.feature,r=t.keys,i=t.values,a=t.keycache,s=t.valuecache;for(var o in n.properties){var l=a[o];void 0===l&&(r.push(o),a[o]=l=r.length-1),e.writeVarint(l);var u=n.properties[o],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,d=s[h];void 0===d&&(i.push(u),s[h]=d=i.length-1),e.writeVarint(d)}}function I(t,e){return(e<<3)+(7&t)}function k(t){return t<<1^t>>31}function E(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,a=0,s=n.length,o=0;o<s;o++){var l=n[o],u=1;1===r&&(u=l.length),e.writeVarint(I(1,u));for(var c=3===r?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==r&&e.writeVarint(I(2,c-1));var d=l[h].x-i,p=l[h].y-a;e.writeVarint(k(d)),e.writeVarint(k(p)),i+=d,a+=p}3===r&&e.writeVarint(I(7,1))}}function A(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function T(t,e,n,r){R(t,n,r),R(e,2*n,2*r),R(e,2*n+1,2*r+1)}function R(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function M(t,e,n,r){var i=t-n,a=e-r;return i*i+a*a}b.fromVectorTileJs=w,b.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new y(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return w({layers:n})},b.GeoJSONWrapper=x;var N=function(t){return t[0]},O=function(t){return t[1]},P=function(t,e,n,r,i){void 0===e&&(e=N),void 0===n&&(n=O),void 0===r&&(r=64),void 0===i&&(i=Float64Array),this.nodeSize=r,this.points=t;for(var a=t.length<65536?Uint16Array:Uint32Array,s=this.ids=new a(t.length),o=this.coords=new i(2*t.length),l=0;l<t.length;l++)s[l]=l,o[2*l]=e(t[l]),o[2*l+1]=n(t[l]);!function t(e,n,r,i,a,s){if(!(a-i<=r)){var o=i+a>>1;!function t(e,n,r,i,a,s){for(;a>i;){if(a-i>600){var o=a-i+1,l=r-i+1,u=Math.log(o),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(o-c)/o)*(l-o/2<0?-1:1);t(e,n,r,Math.max(i,Math.floor(r-l*c/o+h)),Math.min(a,Math.floor(r+(o-l)*c/o+h)),s)}var d=n[2*r+s],p=i,f=a;for(T(e,n,i,r),n[2*a+s]>d&&T(e,n,i,a);p<f;){for(T(e,n,p,f),p++,f--;n[2*p+s]<d;)p++;for(;n[2*f+s]>d;)f--}n[2*i+s]===d?T(e,n,i,f):T(e,n,++f,a),f<=r&&(i=f+1),r<=f&&(a=f-1)}}(e,n,o,i,a,s%2),t(e,n,r,i,o-1,s+1),t(e,n,r,o+1,a,s+1)}}(s,o,r,0,s.length-1,0)};P.prototype.range=function(t,e,n,r){return function(t,e,n,r,i,a,s){for(var o,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),d=u.pop(),p=u.pop();if(d-p<=s)for(var f=p;f<=d;f++)l=e[2*f+1],(o=e[2*f])>=n&&o<=i&&l>=r&&l<=a&&c.push(t[f]);else{var m=Math.floor((p+d)/2);l=e[2*m+1],(o=e[2*m])>=n&&o<=i&&l>=r&&l<=a&&c.push(t[m]);var g=(h+1)%2;(0===h?n<=o:r<=l)&&(u.push(p),u.push(m-1),u.push(g)),(0===h?i>=o:a>=l)&&(u.push(m+1),u.push(d),u.push(g))}}return c}(this.ids,this.coords,t,e,n,r,this.nodeSize)},P.prototype.within=function(t,e,n){return function(t,e,n,r,i,a){for(var s=[0,t.length-1,0],o=[],l=i*i;s.length;){var u=s.pop(),c=s.pop(),h=s.pop();if(c-h<=a)for(var d=h;d<=c;d++)M(e[2*d],e[2*d+1],n,r)<=l&&o.push(t[d]);else{var p=Math.floor((h+c)/2),f=e[2*p],m=e[2*p+1];M(f,m,n,r)<=l&&o.push(t[p]);var g=(u+1)%2;(0===u?n-i<=f:r-i<=m)&&(s.push(h),s.push(p-1),s.push(g)),(0===u?n+i>=f:r+i>=m)&&(s.push(p+1),s.push(c),s.push(g))}}return o}(this.ids,this.coords,t,e,n,this.nodeSize)};var F={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},L=function(t){this.options=U(Object.create(F),t),this.trees=new Array(this.options.maxZoom+1)};function z(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function $(t,e){var n=t.geometry.coordinates,r=n[1];return{x:q(n[0]),y:V(r),zoom:1/0,index:e,parentId:-1}}function B(t){return{type:"Feature",id:t.id,properties:W(t),geometry:{type:"Point",coordinates:[(r=t.x,360*(r-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,r}function W(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return U(U({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function q(t){return t/360+.5}function V(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function U(t,e){for(var n in e)t[n]=e[n];return t}function j(t){return t.x}function H(t){return t.y}function G(t,e,n,r,i,a){var s=i-n,o=a-r;if(0!==s||0!==o){var l=((t-n)*s+(e-r)*o)/(s*s+o*o);l>1?(n=i,r=a):l>0&&(n+=s*l,r+=o*l)}return(s=t-n)*s+(o=e-r)*o}function J(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)X(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)X(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)X(t,e[r][i])}(i),i}function X(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function K(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,a=e.geometry.type,s=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),o=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=r||0),"Point"===a)Z(i,o);else if("MultiPoint"===a)for(var u=0;u<i.length;u++)Z(i[u],o);else if("LineString"===a)Y(i,o,s,!1);else if("MultiLineString"===a){if(n.lineMetrics){for(u=0;u<i.length;u++)Y(i[u],o=[],s,!1),t.push(J(l,"LineString",o,e.properties));return}Q(i,o,s,!1)}else if("Polygon"===a)Q(i,o,s,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(u=0;u<e.geometry.geometries.length;u++)K(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<i.length;u++){var c=[];Q(i[u],c,s,!0),o.push(c)}}t.push(J(l,a,o,e.properties))}}function Z(t,e){e.push(tt(t[0])),e.push(et(t[1])),e.push(0)}function Y(t,e,n,r){for(var i,a,s=0,o=0;o<t.length;o++){var l=tt(t[o][0]),u=et(t[o][1]);e.push(l),e.push(u),e.push(0),o>0&&(s+=r?(i*u-l*a)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(u-a,2))),i=l,a=u}var c=e.length-3;e[2]=1,function t(e,n,r,i){for(var a,s=i,o=r-n>>1,l=r-n,u=e[n],c=e[n+1],h=e[r],d=e[r+1],p=n+3;p<r;p+=3){var f=G(e[p],e[p+1],u,c,h,d);if(f>s)a=p,s=f;else if(f===s){var m=Math.abs(p-o);m<l&&(a=p,l=m)}}s>i&&(a-n>3&&t(e,n,a,i),e[a+2]=s,r-a>3&&t(e,a,r,i))}(e,0,c,n),e[c+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function Q(t,e,n,r){for(var i=0;i<t.length;i++){var a=[];Y(t[i],a,n,r),e.push(a)}}function tt(t){return t/360+.5}function et(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function nt(t,e,n,r,i,a,s,o){if(r/=e,a>=(n/=e)&&s<r)return t;if(s<n||a>=r)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,d=c.type,p=0===i?c.minX:c.minY,f=0===i?c.maxX:c.maxY;if(p>=n&&f<r)l.push(c);else if(!(f<n||p>=r)){var m=[];if("Point"===d||"MultiPoint"===d)rt(h,m,n,r,i);else if("LineString"===d)it(h,m,n,r,i,!1,o.lineMetrics);else if("MultiLineString"===d)st(h,m,n,r,i,!1);else if("Polygon"===d)st(h,m,n,r,i,!0);else if("MultiPolygon"===d)for(var g=0;g<h.length;g++){var y=[];st(h[g],y,n,r,i,!0),y.length&&m.push(y)}if(m.length){if(o.lineMetrics&&"LineString"===d){for(g=0;g<m.length;g++)l.push(J(c.id,d,m[g],c.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===m.length?(d="LineString",m=m[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===m.length?"Point":"MultiPoint"),l.push(J(c.id,d,m,c.tags))}}}return l.length?l:null}function rt(t,e,n,r,i){for(var a=0;a<t.length;a+=3){var s=t[a+i];s>=n&&s<=r&&(e.push(t[a]),e.push(t[a+1]),e.push(t[a+2]))}}function it(t,e,n,r,i,a,s){for(var o,l,u=at(t),c=0===i?lt:ut,h=t.start,d=0;d<t.length-3;d+=3){var p=t[d],f=t[d+1],m=t[d+2],g=t[d+3],y=t[d+4],v=0===i?p:f,_=0===i?g:y,b=!1;s&&(o=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-y,2))),v<n?_>n&&(l=c(u,p,f,g,y,n),s&&(u.start=h+o*l)):v>r?_<r&&(l=c(u,p,f,g,y,r),s&&(u.start=h+o*l)):ot(u,p,f,m),_<n&&v>=n&&(l=c(u,p,f,g,y,n),b=!0),_>r&&v<=r&&(l=c(u,p,f,g,y,r),b=!0),!a&&b&&(s&&(u.end=h+o*l),e.push(u),u=at(t)),s&&(h+=o)}var x=t.length-3;p=t[x],f=t[x+1],m=t[x+2],(v=0===i?p:f)>=n&&v<=r&&ot(u,p,f,m),x=u.length-3,a&&x>=3&&(u[x]!==u[0]||u[x+1]!==u[1])&&ot(u,u[0],u[1],u[2]),u.length&&e.push(u)}function at(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function st(t,e,n,r,i,a){for(var s=0;s<t.length;s++)it(t[s],e,n,r,i,a,!1)}function ot(t,e,n,r){t.push(e),t.push(n),t.push(r)}function lt(t,e,n,r,i,a){var s=(a-e)/(r-e);return t.push(a),t.push(n+(i-n)*s),t.push(1),s}function ut(t,e,n,r,i,a){var s=(a-n)/(i-n);return t.push(e+(r-e)*s),t.push(a),t.push(1),s}function ct(t,e){for(var n=[],r=0;r<t.length;r++){var i,a=t[r],s=a.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)i=ht(a.geometry,e);else if("MultiLineString"===s||"Polygon"===s){i=[];for(var o=0;o<a.geometry.length;o++)i.push(ht(a.geometry[o],e))}else if("MultiPolygon"===s)for(i=[],o=0;o<a.geometry.length;o++){for(var l=[],u=0;u<a.geometry[o].length;u++)l.push(ht(a.geometry[o][u],e));i.push(l)}n.push(J(a.id,s,i,a.tags))}return n}function ht(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function dt(t,e){if(t.transformed)return t;var n,r,i,a=1<<t.z,s=t.x,o=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(r=0;r<u.length;r+=2)l.geometry.push(pt(u[r],u[r+1],e,a,s,o));else for(r=0;r<u.length;r++){var h=[];for(i=0;i<u[r].length;i+=2)h.push(pt(u[r][i],u[r][i+1],e,a,s,o));l.geometry.push(h)}}return t.transformed=!0,t}function pt(t,e,n,r,i,a){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-a))]}function ft(t,e,n,r,i){for(var a=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},o=0;o<t.length;o++){s.numFeatures++,mt(s,t[o],a,i);var l=t[o].minX,u=t[o].minY,c=t[o].maxX,h=t[o].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),c>s.maxX&&(s.maxX=c),h>s.maxY&&(s.maxY=h)}return s}function mt(t,e,n,r){var i=e.geometry,a=e.type,s=[];if("Point"===a||"MultiPoint"===a)for(var o=0;o<i.length;o+=3)s.push(i[o]),s.push(i[o+1]),t.numPoints++,t.numSimplified++;else if("LineString"===a)gt(s,i,t,n,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(o=0;o<i.length;o++)gt(s,i[o],t,n,"Polygon"===a,0===o);else if("MultiPolygon"===a)for(var l=0;l<i.length;l++){var u=i[l];for(o=0;o<u.length;o++)gt(s,u[o],t,n,!0,0===o)}if(s.length){var c=e.tags||null;if("LineString"===a&&r.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var d={geometry:s,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:c};null!==e.id&&(d.id=e.id),t.features.push(d)}}function gt(t,e,n,r,i,a){var s=r*r;if(r>0&&e.size<(i?s:r))n.numPoints+=e.length/3;else{for(var o=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>s)&&(n.numSimplified++,o.push(e[l]),o.push(e[l+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,a=i-2;r<i;a=r,r+=2)n+=(t[r]-t[a])*(t[r+1]+t[a+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var s=t[r],o=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=s,t[i-1-r]=o}}(o,a),t.push(o)}}function yt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)K(n,t.features[r],e,r);else K(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(t,e){var n=e.buffer/e.extent,r=t,i=nt(t,1,-1-n,n,0,-1,2,e),a=nt(t,1,1-n,2+n,0,-1,2,e);return(i||a)&&(r=nt(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=ct(i,1).concat(r)),a&&(r=r.concat(ct(a,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vt(t,e,n){return 32*((1<<t)*n+e)+t}function _t(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);var i=new m(r.features),a=b(i);0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),e(null,{vectorTile:i,rawData:a.buffer})}L.prototype.load=function(t){var e=this.options,n=e.log,r=e.minZoom,i=e.maxZoom,a=e.nodeSize;n&&console.time("total time");var s="prepare "+t.length+" points";n&&console.time(s),this.points=t;for(var o=[],l=0;l<t.length;l++)t[l].geometry&&o.push($(t[l],l));this.trees[i+1]=new P(o,j,H,a,Float32Array),n&&console.timeEnd(s);for(var u=i;u>=r;u--){var c=+Date.now();o=this._cluster(o,u),this.trees[u]=new P(o,j,H,a,Float32Array),n&&console.log("z%d: %d clusters in %dms",u,o.length,+Date.now()-c)}return n&&console.timeEnd("total time"),this},L.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var s=this.getClusters([n,r,180,a],e),o=this.getClusters([-180,r,i,a],e);return s.concat(o)}for(var l=this.trees[this._limitZoom(e)],u=[],c=0,h=l.range(q(n),V(a),q(i),V(r));c<h.length;c+=1){var d=l.points[h[c]];u.push(d.numPoints?B(d):this.points[d.index])}return u},L.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var a=i.points[e];if(!a)throw new Error(r);for(var s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),o=[],l=0,u=i.within(a.x,a.y,s);l<u.length;l+=1){var c=i.points[u[l]];c.parentId===t&&o.push(c.numPoints?B(c):this.points[c.index])}if(0===o.length)throw new Error(r);return o},L.prototype.getLeaves=function(t,e,n){var r=[];return this._appendLeaves(r,t,e=e||10,n=n||0,0),r},L.prototype.getTile=function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),a=this.options,s=a.radius/a.extent,o=(n-s)/i,l=(n+1+s)/i,u={features:[]};return this._addTileFeatures(r.range((e-s)/i,o,(e+1+s)/i,l),r.points,e,n,i,u),0===e&&this._addTileFeatures(r.range(1-s/i,o,1,l),r.points,i,n,i,u),e===i-1&&this._addTileFeatures(r.range(0,o,s/i,l),r.points,-1,n,i,u),u.features.length?u:null},L.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},L.prototype._appendLeaves=function(t,e,n,r,i){for(var a=0,s=this.getChildren(e);a<s.length;a+=1){var o=s[a],l=o.properties;if(l&&l.cluster?i+l.point_count<=r?i+=l.point_count:i=this._appendLeaves(t,l.cluster_id,n,r,i):i<r?i++:t.push(o),t.length===n)break}return i},L.prototype._addTileFeatures=function(t,e,n,r,i,a){for(var s=0,o=t;s<o.length;s+=1){var l=e[o[s]],u=l.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(l.x*i-n)),Math.round(this.options.extent*(l.y*i-r))]],tags:u?W(l):this.points[l.index].properties},h=void 0;u?h=l.id:this.options.generateId?h=l.index:this.points[l.index].id&&(h=this.points[l.index].id),void 0!==h&&(c.id=h),a.features.push(c)}},L.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},L.prototype._cluster=function(t,e){for(var n=[],r=this.options,i=r.reduce,a=r.radius/(r.extent*Math.pow(2,e)),s=0;s<t.length;s++){var o=t[s];if(!(o.zoom<=e)){o.zoom=e;for(var l=this.trees[e+1],u=l.within(o.x,o.y,a),c=o.numPoints||1,h=o.x*c,d=o.y*c,p=i&&c>1?this._map(o,!0):null,f=(s<<5)+(e+1)+this.points.length,m=0,g=u;m<g.length;m+=1){var y=l.points[g[m]];if(!(y.zoom<=e)){y.zoom=e;var v=y.numPoints||1;h+=y.x*v,d+=y.y*v,c+=v,y.parentId=f,i&&(p||(p=this._map(o,!0)),i(p,this._map(y)))}}1===c?n.push(o):(o.parentId=f,n.push(z(h/c,d/c,f,c,p)))}}return n},L.prototype._getOriginId=function(t){return t-this.points.length>>5},L.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},L.prototype._map=function(t,e){if(t.numPoints)return e?U({},t.properties):t.properties;var n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?U({},r):r},yt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yt.prototype.splitTile=function(t,e,n,r,i,a,s){for(var o=[t,e,n,r],l=this.options,u=l.debug;o.length;){r=o.pop(),n=o.pop(),e=o.pop(),t=o.pop();var c=1<<e,h=vt(e,n,r),d=this.tiles[h];if(!d&&(u>1&&console.time("creation"),d=this.tiles[h]=ft(t,e,n,r,l),this.tileCoords.push({z:e,x:n,y:r}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=t,i){if(e===l.maxZoom||e===i)continue;var f=1<<i-e;if(n!==Math.floor(a/f)||r!==Math.floor(s/f))continue}else if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==t.length){u>1&&console.time("clipping");var m,g,y,v,_,b,x=.5*l.buffer/l.extent,w=.5-x,S=.5+x,C=1+x;m=g=y=v=null,_=nt(t,c,n-x,n+S,0,d.minX,d.maxX,l),b=nt(t,c,n+w,n+C,0,d.minX,d.maxX,l),t=null,_&&(m=nt(_,c,r-x,r+S,1,d.minY,d.maxY,l),g=nt(_,c,r+w,r+C,1,d.minY,d.maxY,l),_=null),b&&(y=nt(b,c,r-x,r+S,1,d.minY,d.maxY,l),v=nt(b,c,r+w,r+C,1,d.minY,d.maxY,l),b=null),u>1&&console.timeEnd("clipping"),o.push(m||[],e+1,2*n,2*r),o.push(g||[],e+1,2*n,2*r+1),o.push(y||[],e+1,2*n+1,2*r),o.push(v||[],e+1,2*n+1,2*r+1)}}},yt.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,a=r.debug;if(t<0||t>24)return null;var s=1<<t,o=vt(t,e=(e%s+s)%s,n);if(this.tiles[o])return dt(this.tiles[o],i);a>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,h=n;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[vt(u,c,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",u,c,h),a>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,n),a>1&&console.timeEnd("drilling down"),this.tiles[o]?dt(this.tiles[o],i):null):null};var bt=function(e){function n(t,n,r,i){e.call(this,t,n,r,_t),i&&(this.loadGeoJSON=i)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var n=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var i=!!(r&&r.request&&r.request.collectResourceTiming)&&new t.RequestPerformance(r.request);this.loadGeoJSON(r,(function(a,s){if(a||!s)return n(a);if("object"!=typeof s)return n(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."));!function t(e,n){var r,i=e&&e.type;if("FeatureCollection"===i)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===i)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===i)t(e.geometry,n);else if("Polygon"===i)h(e.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<e.coordinates.length;r++)h(e.coordinates[r],n);return e}(s,!0);try{e._geoJSONIndex=r.cluster?new L(function(e){var n=e.superclusterOptions,r=e.clusterProperties;if(!r||!n)return n;for(var i={},a={},s={accumulated:null,zoom:0},o={properties:null},l=Object.keys(r),u=0,c=l;u<c.length;u+=1){var h=c[u],d=r[h],p=d[0],f=t.createExpression(d[1]),m=t.createExpression("string"==typeof p?[p,["accumulated"],["get",h]]:p);i[h]=f.value,a[h]=m.value}return n.map=function(t){o.properties=t;for(var e={},n=0,r=l;n<r.length;n+=1){var a=r[n];e[a]=i[a].evaluate(s,o)}return e},n.reduce=function(t,e){o.properties=e;for(var n=0,r=l;n<r.length;n+=1){var i=r[n];s.accumulated=t[i],t[i]=a[i].evaluate(s,o)}},n}(r)).load(s.features):function(t,e){return new yt(t,e)}(s,r.geojsonVtOptions)}catch(a){return n(a)}e.loaded={};var o={};if(i){var l=i.finish();l&&(o.resourceTiming={},o.resourceTiming[r.source]=JSON.parse(JSON.stringify(l)))}n(null,o)}))}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var r=this.loaded;return r&&r[t.uid]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n.prototype.getClusterExpansionZoom=function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterChildren=function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterLeaves=function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}},n}(l),xt=function(e){var n=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:bt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return xt.prototype.setReferrer=function(t,e){this.referrer=e},xt.prototype.setImages=function(t,e,n){for(var r in this.availableImages[t]=e,this.workerSources[t]){var i=this.workerSources[t][r];for(var a in i)i[a].availableImages=e}n()},xt.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},xt.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},xt.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},xt.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},xt.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},xt.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},xt.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},xt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},xt.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}},xt.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},xt.prototype.syncRTLPluginState=function(e,n,r){try{t.plugin.setState(n);var i=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=i){this.self.importScripts(i);var a=t.plugin.isParsed();r(a?void 0:new Error("RTL Text Plugin failed to import scripts from "+i),a)}}catch(t){r(t.toString())}},xt.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e||(e=[]),e},xt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e},xt.prototype.getWorkerSource=function(t,e,n){var r=this;return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][n]||(this.workerSources[t][e][n]=new this.workerSourceTypes[e]({send:function(e,n,i){r.actor.send(e,n,i,t)}},this.getLayerIndex(t),this.getAvailableImages(t))),this.workerSources[t][e][n]},xt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new c),this.demWorkerSources[t][e]},xt.prototype.enforceCacheSizeLimit=function(e,n){t.enforceCacheSizeLimit(n)},"undefined"!=typeof WorkerGlobalScope&&void 0!==t.window&&t.window instanceof WorkerGlobalScope&&(t.window.worker=new xt(t.window)),xt})),r(0,(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!n(t)}function n(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===r[n=t&&t.failIfMajorPerformanceCaveat]&&(r[n]=function(t){var n=function(t){var n=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",r)||n.probablySupportsContext("experimental-webgl",r):n.supportsContext?n.supportsContext("webgl",r)||n.supportsContext("experimental-webgl",r):n.getContext("webgl",r)||n.getContext("experimental-webgl",r)}(t);if(!n)return!1;var r=n.createShader(n.VERTEX_SHADER);return!(!r||n.isContextLost())&&(n.shaderSource(r,"void main() {}"),n.compileShader(r),!0===n.getShaderParameter(r,n.COMPILE_STATUS))}(n)),r[n]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var n}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=n);var r={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),n={create:function(e,n,r){var i=t.window.document.createElement(e);return void 0!==n&&(i.className=n),r&&r.appendChild(i),i},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},r=t.window.document.documentElement.style;function i(t){if(!r)return t[0];for(var e=0;e<t.length;e++)if(t[e]in r)return t[e];return t[0]}var a,s=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){r&&s&&(a=r[s],r[s]="none")},n.enableDrag=function(){r&&s&&(r[s]=a)};var o=i(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[o]=e};var l=!1;try{var u=Object.defineProperty({},"passive",{get:function(){l=!0}});t.window.addEventListener("test",u,u),t.window.removeEventListener("test",u,u)}catch(t){l=!1}n.addEventListener=function(t,e,n,r){void 0===r&&(r={}),t.addEventListener(e,n,"passive"in r&&l?r:r.capture)},n.removeEventListener=function(t,e,n,r){void 0===r&&(r={}),t.removeEventListener(e,n,"passive"in r&&l?r:r.capture)};var c=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",c,!0)};function h(t){var e=t.userImage;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}n.suppressClick=function(){t.window.addEventListener("click",c,!0),t.window.setTimeout((function(){t.window.removeEventListener("click",c,!0)}),0)},n.mousePos=function(e,n){var r=e.getBoundingClientRect();return new t.Point(n.clientX-r.left-e.clientLeft,n.clientY-r.top-e.clientTop)},n.touchPos=function(e,n){for(var r=e.getBoundingClientRect(),i=[],a=0;a<n.length;a++)i.push(new t.Point(n[a].clientX-r.left-e.clientLeft,n[a].clientY-r.top-e.clientTop));return i},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var d=function(e){function n(){e.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.isLoaded=function(){return this.loaded},n.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var r=n[e];this._notify(r.ids,r.callback)}this.requestors=[]}},n.prototype.getImage=function(t){return this.images[t]},n.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},n.prototype._validate=function(e,n){var r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchX" value'))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchY" value'))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "content" value'))),r=!1),r},n.prototype._validateStretch=function(t,e){if(!t)return!0;for(var n=0,r=0,i=t;r<i.length;r+=1){var a=i[r];if(a[0]<n||a[1]<a[0]||e<a[1])return!1;n=a[1]}return!0},n.prototype._validateContent=function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))},n.prototype.updateImage=function(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0},n.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},n.prototype.listImages=function(){return Object.keys(this.images)},n.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var r=0,i=t;r<i.length;r+=1)this.images[i[r]]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},n.prototype._notify=function(e,n){for(var r={},i=0,a=e;i<a.length;i+=1){var s=a[i];this.images[s]||this.fire(new t.Event("styleimagemissing",{id:s}));var o=this.images[s];o?r[s]={data:o.data.clone(),pixelRatio:o.pixelRatio,sdf:o.sdf,version:o.version,stretchX:o.stretchX,stretchY:o.stretchY,content:o.content,hasRenderCallback:Boolean(o.userImage&&o.userImage.render)}:t.warnOnce('Image "'+s+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}n(null,r)},n.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},n.prototype.getPattern=function(e){var n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},a=new t.ImagePosition(i,r);this.patterns[e]={bin:i,position:a}}return this._updatePatternAtlas(),this.patterns[e].position},n.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},n.prototype._updatePatternAtlas=function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var r=t.potpack(e),i=r.w,a=r.h,s=this.atlasImage;for(var o in s.resize({width:i||1,height:a||1}),this.patterns){var l=this.patterns[o].bin,u=l.x+1,c=l.y+1,h=this.images[o].data,d=h.width,p=h.height;t.RGBAImage.copy(h,s,{x:0,y:0},{x:u,y:c},{width:d,height:p}),t.RGBAImage.copy(h,s,{x:0,y:p-1},{x:u,y:c-1},{width:d,height:1}),t.RGBAImage.copy(h,s,{x:0,y:0},{x:u,y:c+p},{width:d,height:1}),t.RGBAImage.copy(h,s,{x:d-1,y:0},{x:u-1,y:c},{width:1,height:p}),t.RGBAImage.copy(h,s,{x:0,y:0},{x:u+d,y:c},{width:1,height:p})}this.dirty=!0},n.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},n.prototype.dispatchRenderCallbacks=function(t){for(var e=0,n=t;e<n.length;e+=1){var r=n[e];if(!this.callbackDispatchedThisFrame[r]){this.callbackDispatchedThisFrame[r]=!0;var i=this.images[r];h(i)&&this.updateImage(r,i)}}},n}(t.Evented),p=g,f=g,m=1e20;function g(t,e,n,r,i,a){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=a||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.d=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Int16Array(s),this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function y(t,e,n,r,i,a,s){for(var o=0;o<e;o++){for(var l=0;l<n;l++)r[l]=t[l*e+o];for(v(r,i,a,s,n),l=0;l<n;l++)t[l*e+o]=i[l]}for(l=0;l<n;l++){for(o=0;o<e;o++)r[o]=t[l*e+o];for(v(r,i,a,s,e),o=0;o<e;o++)t[l*e+o]=Math.sqrt(i[o])}}function v(t,e,n,r,i){n[0]=0,r[0]=-m,r[1]=+m;for(var a=1,s=0;a<i;a++){for(var o=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);o<=r[s];)s--,o=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);n[++s]=a,r[s]=o,r[s+1]=+m}for(a=0,s=0;a<i;a++){for(;r[s+1]<a;)s++;e[a]=(a-n[s])*(a-n[s])+t[n[s]]}}g.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var i=e.data[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?m:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?m:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(y(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),y(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++)n[r]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[r]-this.gridInner[r])/this.radius+this.cutoff))));return n},p.default=f;var _=function(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}};_.prototype.setURL=function(t){this.url=t},_.prototype.getGlyphs=function(e,n){var r=this,i=[];for(var a in e)for(var s=0,o=e[a];s<o.length;s+=1)i.push({stack:a,id:o[s]});t.asyncAll(i,(function(t,e){var n=t.stack,i=t.id,a=r.entries[n];a||(a=r.entries[n]={glyphs:{},requests:{},ranges:{}});var s=a.glyphs[i];if(void 0===s){if(s=r._tinySDF(a,n,i))return a.glyphs[i]=s,void e(null,{stack:n,id:i,glyph:s});var o=Math.floor(i/256);if(256*o>65535)e(new Error("glyphs > 65535 not supported"));else if(a.ranges[o])e(null,{stack:n,id:i,glyph:s});else{var l=a.requests[o];l||(l=a.requests[o]=[],_.loadGlyphRange(n,o,r.url,r.requestManager,(function(t,e){if(e){for(var n in e)r._doesCharSupportLocalGlyph(+n)||(a.glyphs[+n]=e[+n]);a.ranges[o]=!0}for(var i=0,s=l;i<s.length;i+=1)(0,s[i])(t,e);delete a.requests[o]}))),l.push((function(t,r){t?e(t):r&&e(null,{stack:n,id:i,glyph:r[i]||null})}))}}else e(null,{stack:n,id:i,glyph:s})}),(function(t,e){if(t)n(t);else if(e){for(var r={},i=0,a=e;i<a.length;i+=1){var s=a[i],o=s.stack,l=s.id,u=s.glyph;(r[o]||(r[o]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}n(null,r)}}))},_.prototype._doesCharSupportLocalGlyph=function(e){return!!this.localIdeographFontFamily&&(t.isChar["CJK Unified Ideographs"](e)||t.isChar["Hangul Syllables"](e)||t.isChar.Hiragana(e)||t.isChar.Katakana(e))},_.prototype._tinySDF=function(e,n,r){var i=this.localIdeographFontFamily;if(i&&this._doesCharSupportLocalGlyph(r)){var a=e.tinySDF;if(!a){var s="400";/bold/i.test(n)?s="900":/medium/i.test(n)?s="500":/light/i.test(n)&&(s="200"),a=e.tinySDF=new _.TinySDF(24,3,8,.25,i,s)}return{id:r,bitmap:new t.AlphaImage({width:30,height:30},a.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(e,n,r,i,a){var s=256*n,o=s+255,l=i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",s+"-"+o),t.ResourceType.Glyphs);t.getArrayBuffer(l,(function(e,n){if(e)a(e);else if(n){for(var r={},i=0,s=t.parseGlyphPBF(n);i<s.length;i+=1){var o=s[i];r[o.id]=o}a(null,r)}}))},_.TinySDF=p;var b=function(){this.specification=t.styleSpec.light.position};b.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},b.prototype.interpolate=function(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r)}};var x=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new b,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),w=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(x),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e,n){if(void 0===n&&(n={}),!this._validate(t.validateLight,e,n))for(var r in e){var i=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),i):this._transitionable.setValue(r,i)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},n}(t.Evented),S=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};S.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]},S.prototype.getDashRanges=function(t,e,n){var r=[],i=t.length%2==1?-t[t.length-1]*n:0,a=t[0]*n,s=!0;r.push({left:i,right:a,isDash:s,zeroLength:0===t[0]});for(var o=t[0],l=1;l<t.length;l++){var u=t[l];r.push({left:i=o*n,right:a=(o+=u)*n,isDash:s=!s,zeroLength:0===u})}return r},S.prototype.addRoundDash=function(t,e,n){for(var r=e/2,i=-n;i<=n;i++)for(var a=this.width*(this.nextRow+n+i),s=0,o=t[s],l=0;l<this.width;l++){l/o.right>1&&(o=t[++s]);var u=Math.abs(l-o.left),c=Math.abs(l-o.right),h=Math.min(u,c),d=void 0,p=i/n*(r+1);if(o.isDash){var f=r-Math.abs(p);d=Math.sqrt(h*h+f*f)}else d=r-Math.sqrt(h*h+p*p);this.data[a+l]=Math.max(0,Math.min(255,d+128))}},S.prototype.addRegularDash=function(t){for(var e=t.length-1;e>=0;--e){var n=t[e],r=t[e+1];n.zeroLength?t.splice(e,1):r&&r.isDash===n.isDash&&(r.left=n.left,t.splice(e,1))}var i=t[0],a=t[t.length-1];i.isDash===a.isDash&&(i.left=a.left-this.width,a.right=i.right+this.width);for(var s=this.width*this.nextRow,o=0,l=t[o],u=0;u<this.width;u++){u/l.right>1&&(l=t[++o]);var c=Math.abs(u-l.left),h=Math.abs(u-l.right),d=Math.min(c,h);this.data[s+u]=Math.max(0,Math.min(255,(l.isDash?d:-d)+128))}},S.prototype.addDash=function(e,n){var r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var a=0,s=0;s<e.length;s++)a+=e[s];if(0!==a){var o=this.width/a,l=this.getDashRanges(e,this.width,o);n?this.addRoundDash(l,o,r):this.addRegularDash(l)}var u={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:a};return this.nextRow+=i,this.dirty=!0,u},S.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))};var C=function e(n,r){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),a=0;a<i.length;a++){var s=new e.Actor(i[a],r,this.id);s.name="Worker "+a,this.actors.push(s)}};function D(e,n,r){var i=function(i,a){if(i)return r(i);if(a){var s=t.pick(t.extend(a,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);a.vector_layers&&(s.vectorLayers=a.vector_layers,s.vectorLayerIds=s.vectorLayers.map((function(t){return t.id}))),s.tiles=n.canonicalizeTileset(s,e.url),r(null,s)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),i):t.browser.frame((function(){return i(null,e)}))}C.prototype.broadcast=function(e,n,r){t.asyncAll(this.actors,(function(t,r){t.send(e,n,r)}),r=r||function(){})},C.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},C.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},C.Actor=t.Actor;var I=function(e,n,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=r||24};I.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},I.prototype.contains=function(e){var n=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),i=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),a=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),s=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=r&&e.x<a&&e.y>=i&&e.y<s};var k=function(e){function n(n,r,i,a){if(e.call(this),this.id=n,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(r,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(a)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new I(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles,e.map._requestManager._customAccessToken),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken,e.map._requestManager._customAccessToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function a(r,i){return delete e.request,e.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",i,a.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",i,a.bind(this)))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),E=function(e){function n(n,r,i,a){e.call(this),this.id=n,this.dispatcher=i,this.setEventedParent(a),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._requestManager,(function(n,r){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new I(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var r=this,i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),(function(i,a){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(a){r.map._refreshExpiredTiles&&e.setExpiryData(a),delete a.cacheControl,delete a.expires;var s=r.map.painter.context,o=s.gl;e.texture=r.map.painter.getTileTexture(a.width),e.texture?e.texture.update(a,{useMipmap:!0}):(e.texture=new t.Texture(s,a,o.RGBA,{useMipmap:!0}),e.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),s.extTextureFilterAnisotropic&&o.texParameterf(o.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(r.dispatcher),n(null)}}))},n.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),A=function(e){function n(n,r,i,a){e.call(this,n,r,i,a),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function i(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),(function(r,a){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(a){this.map._refreshExpiredTiles&&e.setExpiryData(a),delete a.cacheControl,delete a.expires;var s=t.window.ImageBitmap&&a instanceof t.window.ImageBitmap&&t.offscreenCanvasSupported()?a:t.browser.getImageData(a,1),o={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:s,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",o,i.bind(this)))}}).bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,a=0===n.x?e.wrap-1:e.wrap,s=(n.x+1+r)%r,o=n.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,a,n.z,i,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,o,n.z,s,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,a,n.z,i,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,o,n.z,s,n.y-1).key]={backfilled:!1}),n.y+1<r&&(l[new t.OverscaledTileID(e.overscaledZ,a,n.z,i,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,o,n.z,s,n.y+1).key]={backfilled:!1}),l},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},n}(E),T=function(e){function n(n,r,i,a){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(a),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;var s=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*s,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*s,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.EXTENT,radius:(r.clusterRadius||50)*s,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties},r.workerOptions)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(n){if(n)e.fire(new t.ErrorEvent(n));else{var r={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(r.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",r))}}))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)n.fire(new t.ErrorEvent(e));else{var r={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(r.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",r))}})),this},n.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},n.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},n.prototype.getClusterLeaves=function(t,e,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r),this},n.prototype._updateWorkerData=function(e){var n=this;this._loaded=!1;var r=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(r.request=this.map._requestManager.transformRequest(t.browser.resolveURL(i),t.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this.actor.send(this.type+".loadData",r,(function(t,i){n._removed||i&&i.abandoned||(n._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[n.id]&&(n._resourceTiming=i.resourceTiming[n.id].slice(0)),n.actor.send(n.type+".coalesce",{source:r.source},null),e(t))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.loadTile=function(e,n){var r=this,i=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(i,{type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(t,a){return delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(a,r.map.painter,"reloadTile"===i),n(null))}))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},n.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),R=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),M=function(e){function n(t,n,r,i){e.call(this),this.id=t,this.dispatcher=r,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(e,n){var r=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(i,a){r._loaded=!0,i?r.fire(new t.ErrorEvent(i)):a&&(r.image=a,e&&(r.coordinates=e),n&&n(),r._finishLoading())}))},n.prototype.loaded=function(){return this._loaded},n.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null})),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){var n=this;this.coordinates=e;var r=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){for(var n=1/0,r=1/0,i=-1/0,a=-1/0,s=0,o=e;s<o.length;s+=1){var l=o[s];n=Math.min(n,l.x),r=Math.min(r,l.y),i=Math.max(i,l.x),a=Math.max(a,l.y)}var u=Math.max(i-n,a-r),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),h=Math.pow(2,c);return new t.CanonicalTileID(c,Math.floor((n+i)/2*h),Math.floor((r+a)/2*h))}(r),this.minzoom=this.maxzoom=this.tileID.z;var i=r.map((function(t){return n.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,R.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),N=function(e){function n(t,n,r,i){e.call(this,t,n,r,i),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1;var n=this.options;this.urls=[];for(var r=0,i=n.urls;r<i.length;r+=1)this.urls.push(this.map._requestManager.transformRequest(i[r],t.ResourceType.Source).url);t.getVideo(this.urls,(function(n,r){e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))},n.prototype.pause=function(){this.video&&this.video.pause()},n.prototype.play=function(){this.video&&this.video.play()},n.prototype.seek=function(e){if(this.video){var n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+n.start(0)+" and "+n.end(0)+"-second mark."))):this.video.currentTime=e}},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,R.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(M),O=function(e){function n(n,r,i,a){e.call(this,n,r,i,a),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,r=n.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,R.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var a=this.tiles[i];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(M),P={vector:k,raster:E,"raster-dem":A,geojson:T,video:N,image:M,canvas:O};function F(e,n){var r=t.identity([]);return t.translate(r,r,[1,1,0]),t.scale(r,r,[.5*e.width,.5*e.height,1]),t.multiply(r,r,e.calculatePosMatrix(n.toUnwrapped()))}function L(t,e,n,r,i,a){var s=function(t,e,n){if(t)for(var r=0,i=t;r<i.length;r+=1){var a=e[i[r]];if(a&&a.source===n&&"fill-extrusion"===a.type)return!0}else for(var s in e){var o=e[s];if(o.source===n&&"fill-extrusion"===o.type)return!0}return!1}(i&&i.layers,e,t.id),o=a.maxPitchScaleFactor(),l=t.tilesIn(r,o,s);l.sort(z);for(var u=[],c=0,h=l;c<h.length;c+=1){var d=h[c];u.push({wrappedTileID:d.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(e,n,t._state,d.queryGeometry,d.cameraQueryGeometry,d.scale,i,a,o,F(t.transform,d.tileID))})}var p=function(t){for(var e={},n={},r=0,i=t;r<i.length;r+=1){var a=i[r],s=a.queryResults,o=a.wrappedTileID,l=n[o]=n[o]||{};for(var u in s)for(var c=s[u],h=l[u]=l[u]||{},d=e[u]=e[u]||[],p=0,f=c;p<f.length;p+=1){var m=f[p];h[m.featureIndex]||(h[m.featureIndex]=!0,d.push(m))}}return e}(u);for(var f in p)p[f].forEach((function(e){var n=e.feature,r=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return p}function z(t,e){var n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}var $=function(t,e){this.max=t,this.onRemove=e,this.reset()};$.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var r=n[e];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},$.prototype.add=function(t,e,n){var r=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var a={value:e,timeout:void 0};if(void 0!==n&&(a.timeout=setTimeout((function(){r.remove(t,a)}),n)),this.data[i].push(a),this.order.push(i),this.order.length>this.max){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},$.prototype.has=function(t){return t.wrapped().key in this.data},$.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},$.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},$.prototype.getByKey=function(t){var e=this.data[t];return e?e[0].value:null},$.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},$.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this},$.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},$.prototype.filter=function(t){var e=[];for(var n in this.data)for(var r=0,i=this.data[n];r<i.length;r+=1){var a=i[r];t(a.value)||e.push(a)}for(var s=0,o=e;s<o.length;s+=1){var l=o[s];this.remove(l.value.tileID,l)}};var B=function(t,e,n){this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};B.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},B.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},B.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var W={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},q=function(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;var i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};q.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},q.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},q.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var r=e.attributes[this.attributes[n].name];void 0!==r&&t.enableVertexAttribArray(r)}},q.prototype.setVertexAttribPointers=function(t,e,n){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],a=e.attributes[i.name];void 0!==a&&t.vertexAttribPointer(a,i.components,t[W[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}},q.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var V=function(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};V.prototype.get=function(){return this.current},V.prototype.set=function(t){},V.prototype.getDefault=function(){return this.default},V.prototype.setDefault=function(){this.set(this.default)};var U=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(V),j=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},e}(V),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},e}(V),G=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(V),J=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)},e}(V),X=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},e}(V),K=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},e}(V),Z=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},e}(V),Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},e}(V),Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},e}(V),tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},e}(V),et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},e}(V),nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},e}(V),rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},e}(V),it=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(V),at=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},e}(V),st=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},e}(V),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)},e}(V),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)},e}(V),ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)},e}(V),ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},e}(V),ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(V),dt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},e}(V),pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(V),ft=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},e}(V),mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},e}(V),gt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},e}(V),yt=function(t){function e(e){t.call(this,e),this.vao=e.extVertexArrayObject}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},e}(V),vt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},e}(V),_t=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},e}(V),bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},e}(V),xt=function(t){function e(e,n){t.call(this,e),this.context=e,this.parent=n}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e}(V),wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e}(xt),St=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(xt),Ct=function(t,e,n,r){this.context=t,this.width=e,this.height=n;var i=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new wt(t,i),r&&(this.depthAttachment=new St(t,i))};Ct.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n)}t.deleteFramebuffer(this.framebuffer)};var Dt=function(t,e,n){this.func=t,this.mask=e,this.range=n};Dt.ReadOnly=!1,Dt.ReadWrite=!0,Dt.disabled=new Dt(519,Dt.ReadOnly,[0,1]);var It=function(t,e,n,r,i,a){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=i,this.pass=a};It.disabled=new It({func:519,mask:0},0,0,7680,7680,7680);var kt=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};kt.disabled=new kt(kt.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),kt.unblended=new kt(kt.Replace,t.Color.transparent,[!0,!0,!0,!0]),kt.alphaBlended=new kt([1,771],t.Color.transparent,[!0,!0,!0,!0]);var Et=function(t,e,n){this.enable=t,this.mode=e,this.frontFace=n};Et.disabled=new Et(!1,1029,2305),Et.backCCW=new Et(!0,1029,2305);var At=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new U(this),this.clearDepth=new j(this),this.clearStencil=new H(this),this.colorMask=new G(this),this.depthMask=new J(this),this.stencilMask=new X(this),this.stencilFunc=new K(this),this.stencilOp=new Z(this),this.stencilTest=new Y(this),this.depthRange=new Q(this),this.depthTest=new tt(this),this.depthFunc=new et(this),this.blend=new nt(this),this.blendFunc=new rt(this),this.blendColor=new it(this),this.blendEquation=new at(this),this.cullFace=new st(this),this.cullFaceSide=new ot(this),this.frontFace=new lt(this),this.program=new ut(this),this.activeTexture=new ct(this),this.viewport=new ht(this),this.bindFramebuffer=new dt(this),this.bindRenderbuffer=new pt(this),this.bindTexture=new ft(this),this.bindVertexBuffer=new mt(this),this.bindElementBuffer=new gt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new yt(this),this.pixelStoreUnpack=new vt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new bt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query")};At.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},At.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},At.prototype.createIndexBuffer=function(t,e){return new B(this,t,e)},At.prototype.createVertexBuffer=function(t,e,n){return new q(this,t,e,n)},At.prototype.createRenderbuffer=function(t,e,n){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i},At.prototype.createFramebuffer=function(t,e,n){return new Ct(this,t,e,n)},At.prototype.clear=function(t){var e=t.color,n=t.depth,r=this.gl,i=0;e&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),r.clear(i)},At.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},At.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},At.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},At.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,kt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},At.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Tt=function(e){function n(n,r,i){var a=this;e.call(this),this.id=n,this.dispatcher=i,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(a._sourceLoaded=!0),a._sourceLoaded&&!a._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(a.reload(),a.transform&&a.update(a.transform))})),this.on("error",(function(){a._sourceErrored=!0})),this._source=function(e,n,r,i){var a=new P[n.type](e,n,r,i);if(a.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+a.id);return t.bindAll(["load","abort","unload","serialize","prepare"],a),a}(n,r,i,this),this._tiles={},this._cache=new $(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}},n.prototype.getIds=function(){return t.values(this._tiles).map((function(t){return t.tileID})).sort(Rt).map((function(t){return t.key}))},n.prototype.getRenderableIds=function(e){var n=this,r=[];for(var i in this._tiles)this._isIdRenderable(i,e)&&r.push(this._tiles[i]);return e?r.sort((function(e,r){var i=e.tileID,a=r.tileID,s=new t.Point(i.canonical.x,i.canonical.y)._rotate(n.transform.angle),o=new t.Point(a.canonical.x,a.canonical.y)._rotate(n.transform.angle);return i.overscaledZ-a.overscaledZ||o.y-s.y||o.x-s.x})).map((function(t){return t.tileID.key})):r.map((function(t){return t.tileID})).sort(Rt).map((function(t){return t.key}))},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,r,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){var i=this.getTileByID(r);a(t,i),a(i,t)}}function a(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),a=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[a]&&(t.neighboringTiles[a].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype._retainLoadedChildren=function(t,e,n,r){for(var i in this._tiles){var a=this._tiles[i];if(!(r[i]||!a.hasData()||a.tileID.overscaledZ<=e||a.tileID.overscaledZ>n)){for(var s=a.tileID;a&&a.tileID.overscaledZ>e+1;){var o=a.tileID.scaledTo(a.tileID.overscaledZ-1);(a=this._tiles[o.key])&&a.hasData()&&(s=o)}for(var l=s;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){r[s.key]=s;break}}}},n.prototype.findLoadedParent=function(t,e){if(t.key in this._loadedParentTiles){var n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(var r=t.overscaledZ-1;r>=e;r--){var i=t.scaledTo(r),a=this._getLoadedTile(i);if(a)return a}},n.prototype._getLoadedTile=function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)},n.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,n=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(e*n*5),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(i)},n.prototype.handleWrapJump=function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var n={};for(var r in this._tiles){var i=this._tiles[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),n[i.tileID.key]=i}for(var a in this._tiles=n,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles)this._setTileReloadTimer(s,this._tiles[s])}},n.prototype.update=function(e){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter((function(t){return r._source.hasTile(t)})))):i=[];var a=e.coveringZoomLevel(this._source),s=Math.max(a-n.maxOverzooming,this._source.minzoom),o=Math.max(a+n.maxUnderzooming,this._source.minzoom),l=this._updateRetainedTiles(i,a);if(Mt(this._source.type)){for(var u={},c={},h=0,d=Object.keys(l);h<d.length;h+=1){var p=d[h],f=l[p],m=this._tiles[p];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=t.browser.now())){var g=this.findLoadedParent(f,s);g&&(this._addTile(g.tileID),u[g.tileID.key]=g.tileID),c[p]=f}}for(var y in this._retainLoadedChildren(c,a,o,l),u)l[y]||(this._coveredTiles[y]=!0,l[y]=u[y])}for(var v in l)this._tiles[v].clearFadeHold();for(var _=0,b=t.keysDifference(this._tiles,l);_<b.length;_+=1){var x=b[_],w=this._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(x)}this._updateLoadedParentTileCache()}},n.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},n.prototype._updateRetainedTiles=function(t,e){for(var r={},i={},a=Math.max(e-n.maxOverzooming,this._source.minzoom),s=Math.max(e+n.maxUnderzooming,this._source.minzoom),o={},l=0,u=t;l<u.length;l+=1){var c=u[l],h=this._addTile(c);r[c.key]=c,h.hasData()||e<this._source.maxzoom&&(o[c.key]=c)}this._retainLoadedChildren(o,e,s,r);for(var d=0,p=t;d<p.length;d+=1){var f=p[d],m=this._tiles[f.key];if(!m.hasData()){if(e+1>this._source.maxzoom){var g=f.children(this._source.maxzoom)[0],y=this.getTile(g);if(y&&y.hasData()){r[g.key]=g;continue}}else{var v=f.children(this._source.maxzoom);if(r[v[0].key]&&r[v[1].key]&&r[v[2].key]&&r[v[3].key])continue}for(var _=m.wasRequested(),b=f.overscaledZ-1;b>=a;--b){var x=f.scaledTo(b);if(i[x.key])break;if(i[x.key]=!0,!(m=this.getTile(x))&&_&&(m=this._addTile(x)),m&&(r[x.key]=x,_=m.wasRequested(),m.hasData()))break}}}return r},n.prototype._updateLoadedParentTileCache=function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],n=void 0,r=this._tiles[t].tileID;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}e.push(r.key);var i=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(i))break;r=i}for(var a=0,s=e;a<s.length;a+=1)this._loadedParentTiles[s[a]]=n}},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var r=Boolean(n);return r||(n=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout((function(){n._reloadTile(t,"expired"),delete n._timers[t]}),r))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n,r){var i=this,a=[],s=this.transform;if(!s)return a;for(var o=r?s.getCameraQueryGeometry(e):e,l=e.map((function(t){return s.pointCoordinate(t)})),u=o.map((function(t){return s.pointCoordinate(t)})),c=this.getIds(),h=1/0,d=1/0,p=-1/0,f=-1/0,m=0,g=u;m<g.length;m+=1){var y=g[m];h=Math.min(h,y.x),d=Math.min(d,y.y),p=Math.max(p,y.x),f=Math.max(f,y.y)}for(var v=function(e){var r=i._tiles[c[e]];if(!r.holdingForFade()){var o=r.tileID,m=Math.pow(2,s.zoom-r.tileID.overscaledZ),g=n*r.queryPadding*t.EXTENT/r.tileSize/m,y=[o.getTilePoint(new t.MercatorCoordinate(h,d)),o.getTilePoint(new t.MercatorCoordinate(p,f))];if(y[0].x-g<t.EXTENT&&y[0].y-g<t.EXTENT&&y[1].x+g>=0&&y[1].y+g>=0){var v=l.map((function(t){return o.getTilePoint(t)})),_=u.map((function(t){return o.getTilePoint(t)}));a.push({tile:r,tileID:o,queryGeometry:v,cameraQueryGeometry:_,scale:m})}}},_=0;_<c.length;_++)v(_);return a},n.prototype.getVisibleCoordinates=function(t){for(var e=this,n=this.getRenderableIds(t).map((function(t){return e._tiles[t].tileID})),r=0,i=n;r<i.length;r+=1){var a=i[r];a.posMatrix=this.transform.calculatePosMatrix(a.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Mt(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.browser.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)},n.prototype.removeFeatureState=function(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)},n.prototype.getFeatureState=function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)},n.prototype.setDependencies=function(t,e,n){var r=this._tiles[t];r&&r.setDependencies(e,n)},n.prototype.reloadTilesForDependencies=function(t,e){for(var n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((function(n){return!n.hasDependency(t,e)}))},n}(t.Evented);function Rt(t,e){var n=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Mt(t){return"raster"===t||"image"===t||"video"===t}function Nt(){return new t.window.Worker(Hi.workerUrl)}Tt.maxOverzooming=10,Tt.maxUnderzooming=3;var Ot="mapboxgl_preloaded_worker_pool",Pt=function(){this.active={}};Pt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Pt.workerCount;)this.workers.push(new Nt);return this.active[t]=!0,this.workers.slice()},Pt.prototype.release=function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)},Pt.prototype.isPreloaded=function(){return!!this.active[Ot]},Pt.prototype.numActive=function(){return Object.keys(this.active).length};var Ft,Lt=Math.floor(t.browser.hardwareConcurrency/2);function zt(){return Ft||(Ft=new Pt),Ft}function $t(e,n){var r={};for(var i in e)"ref"!==i&&(r[i]=e[i]);return t.refProperties.forEach((function(t){t in n&&(r[t]=n[t])})),r}function Bt(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=$t(t[r],e[t[r].ref]));return t}Pt.workerCount=Math.max(Math.min(Lt,6),1);var Wt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function qt(t,e,n){n.push({command:Wt.addSource,args:[t,e[t]]})}function Vt(t,e,n){e.push({command:Wt.removeSource,args:[t]}),n[t]=!0}function Ut(t,e,n,r){Vt(t,n,r),qt(t,e,n)}function jt(e,n,r){var i;for(i in e[r])if(e[r].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[r][i],n[r][i]))return!1;for(i in n[r])if(n[r].hasOwnProperty(i)&&"data"!==i&&!t.deepEqual(e[r][i],n[r][i]))return!1;return!0}function Ht(e,n,r,i,a,s){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(t.deepEqual(e[o],n[o])||r.push({command:s,args:[i,o,n[o],a]}));for(o in n)n.hasOwnProperty(o)&&!e.hasOwnProperty(o)&&(t.deepEqual(e[o],n[o])||r.push({command:s,args:[i,o,n[o],a]}))}function Gt(t){return t.id}function Jt(t,e){return t[e.id]=e,t}var Xt=function(t,e){this.reset(t,e)};Xt.prototype.reset=function(t,e){this.points=t||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Xt.prototype.lerp=function(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);for(var n=1,r=this._distances[n],i=e*this.paddedLength+this.padding;r<i&&n<this._distances.length;)r=this._distances[++n];var a=n-1,s=this._distances[a],o=r-s,l=o>0?(i-s)/o:0;return this.points[a].mult(1-l).add(this.points[n].mult(l))};var Kt=function(t,e,n){var r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var a=0;a<this.xCellCount*this.yCellCount;a++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};function Zt(e,n,r,i,a){var s=t.create();return n?(t.scale(s,s,[1/a,1/a,1]),r||t.rotateZ(s,s,i.angle)):t.multiply(s,i.labelPlaneMatrix,e),s}function Yt(e,n,r,i,a){if(n){var s=t.clone(e);return t.scale(s,s,[a,a,1]),r||t.rotateZ(s,s,-i.angle),s}return i.glCoordMatrix}function Qt(e,n){var r=[e.x,e.y,0,1];ce(r,r,n);var i=r[3];return{point:new t.Point(r[0]/i,r[1]/i),signedDistanceFromCamera:i}}function te(t,e){return.5+t/e*.5}function ee(t,e){var n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function ne(e,n,r,i,a,s,o,l){var u=i?e.textSizeData:e.iconSizeData,c=t.evaluateSizeForZoom(u,r.transform.zoom),h=[256/r.width*2+1,256/r.height*2+1],d=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;d.clear();for(var p=e.lineVertexArray,f=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=r.transform.width/r.transform.height,g=!1,y=0;y<f.length;y++){var v=f.get(y);if(v.hidden||v.writingMode===t.WritingMode.vertical&&!g)ue(v.numGlyphs,d);else{g=!1;var _=[v.anchorX,v.anchorY,0,1];if(t.transformMat4(_,_,n),ee(_,h)){var b=te(r.transform.cameraToCenterDistance,_[3]),x=t.evaluateSizeForFeature(u,c,v),w=o?x/b:x*b,S=new t.Point(v.anchorX,v.anchorY),C=Qt(S,a).point,D={},I=ae(v,w,!1,l,n,a,s,e.glyphOffsetArray,p,d,C,S,D,m);g=I.useVertical,(I.notEnoughRoom||g||I.needsFlipping&&ae(v,w,!0,l,n,a,s,e.glyphOffsetArray,p,d,C,S,D,m).notEnoughRoom)&&ue(v.numGlyphs,d)}else ue(v.numGlyphs,d)}}i?e.text.dynamicLayoutVertexBuffer.updateData(d):e.icon.dynamicLayoutVertexBuffer.updateData(d)}function re(t,e,n,r,i,a,s,o,l,u,c){var h=o.glyphStartIndex+o.numGlyphs,d=o.lineStartIndex,p=o.lineStartIndex+o.lineLength,f=e.getoffsetX(o.glyphStartIndex),m=e.getoffsetX(h-1),g=oe(t*f,n,r,i,a,s,o.segment,d,p,l,u,c);if(!g)return null;var y=oe(t*m,n,r,i,a,s,o.segment,d,p,l,u,c);return y?{first:g,last:y}:null}function ie(e,n,r,i){return e===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function ae(e,n,r,i,a,s,o,l,u,c,h,d,p,f){var m,g=n/24,y=e.lineOffsetX*g,v=e.lineOffsetY*g;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=re(g,l,y,v,r,h,d,e,u,s,p);if(!w)return{notEnoughRoom:!0};var S=Qt(w.first.point,o).point,C=Qt(w.last.point,o).point;if(i&&!r){var D=ie(e.writingMode,S,C,f);if(D)return D}m=[w.first];for(var I=e.glyphStartIndex+1;I<_-1;I++)m.push(oe(g*l.getoffsetX(I),y,v,r,h,d,e.segment,b,x,u,s,p));m.push(w.last)}else{if(i&&!r){var k=Qt(d,a).point,E=e.lineStartIndex+e.segment+1,A=new t.Point(u.getx(E),u.gety(E)),T=Qt(A,a),R=T.signedDistanceFromCamera>0?T.point:se(d,A,k,1,a),M=ie(e.writingMode,k,R,f);if(M)return M}var N=oe(g*l.getoffsetX(e.glyphStartIndex),y,v,r,h,d,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,s,p);if(!N)return{notEnoughRoom:!0};m=[N]}for(var O=0,P=m;O<P.length;O+=1){var F=P[O];t.addDynamicAttributes(c,F.point,F.angle)}return{}}function se(t,e,n,r,i){var a=Qt(t.add(t.sub(e)._unit()),i).point,s=n.sub(a);return n.add(s._mult(r/s.mag()))}function oe(e,n,r,i,a,s,o,l,u,c,h,d){var p=i?e-n:e+n,f=p>0?1:-1,m=0;i&&(f*=-1,m=Math.PI),f<0&&(m+=Math.PI);for(var g=f>0?l+o:l+o+1,y=a,v=a,_=0,b=0,x=Math.abs(p),w=[];_+b<=x;){if((g+=f)<l||g>=u)return null;if(v=y,w.push(y),void 0===(y=d[g])){var S=new t.Point(c.getx(g),c.gety(g)),C=Qt(S,h);if(C.signedDistanceFromCamera>0)y=d[g]=C.point;else{var D=g-f;y=se(0===_?s:new t.Point(c.getx(D),c.gety(D)),S,v,x-_+1,h)}}_+=b,b=v.dist(y)}var I=(x-_)/b,k=y.sub(v),E=k.mult(I)._add(v);E._add(k._unit()._perp()._mult(r*f));var A=m+Math.atan2(y.y-v.y,y.x-v.x);return w.push(E),{point:E,angle:A,path:w}}Kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Kt.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Kt.prototype.insertCircle=function(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)},Kt.prototype._insertBoxCell=function(t,e,n,r,i,a){this.boxCells[i].push(a)},Kt.prototype._insertCircleCell=function(t,e,n,r,i,a){this.circleCells[i].push(a)},Kt.prototype._query=function(t,e,n,r,i,a){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];var s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var o=0;o<this.boxKeys.length;o++)s.push({key:this.boxKeys[o],x1:this.bboxes[4*o],y1:this.bboxes[4*o+1],x2:this.bboxes[4*o+2],y2:this.bboxes[4*o+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];s.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return a?s.filter(a):s}return this._forEachCell(t,e,n,r,this._queryCell,s,{hitTest:i,seenUids:{box:{},circle:{}}},a),i?s.length>0:s},Kt.prototype._queryCircle=function(t,e,n,r,i){var a=t-n,s=t+n,o=e-n,l=e+n;if(s<0||a>this.width||l<0||o>this.height)return!r&&[];var u=[];return this._forEachCell(a,o,s,l,this._queryCellCircle,u,{hitTest:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},i),r?u.length>0:u},Kt.prototype.query=function(t,e,n,r,i){return this._query(t,e,n,r,!1,i)},Kt.prototype.hitTest=function(t,e,n,r,i){return this._query(t,e,n,r,!0,i)},Kt.prototype.hitTestCircle=function(t,e,n,r){return this._queryCircle(t,e,n,!0,r)},Kt.prototype._queryCell=function(t,e,n,r,i,a,s,o){var l=s.seenUids,u=this.boxCells[i];if(null!==u)for(var c=this.bboxes,h=0,d=u;h<d.length;h+=1){var p=d[h];if(!l.box[p]){l.box[p]=!0;var f=4*p;if(t<=c[f+2]&&e<=c[f+3]&&n>=c[f+0]&&r>=c[f+1]&&(!o||o(this.boxKeys[p]))){if(s.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[p],x1:c[f],y1:c[f+1],x2:c[f+2],y2:c[f+3]})}}}var m=this.circleCells[i];if(null!==m)for(var g=this.circles,y=0,v=m;y<v.length;y+=1){var _=v[y];if(!l.circle[_]){l.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(g[b],g[b+1],g[b+2],t,e,n,r)&&(!o||o(this.circleKeys[_]))){if(s.hitTest)return a.push(!0),!0;var x=g[b],w=g[b+1],S=g[b+2];a.push({key:this.circleKeys[_],x1:x-S,y1:w-S,x2:x+S,y2:w+S})}}}},Kt.prototype._queryCellCircle=function(t,e,n,r,i,a,s,o){var l=s.circle,u=s.seenUids,c=this.boxCells[i];if(null!==c)for(var h=this.bboxes,d=0,p=c;d<p.length;d+=1){var f=p[d];if(!u.box[f]){u.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,h[m+0],h[m+1],h[m+2],h[m+3])&&(!o||o(this.boxKeys[f])))return a.push(!0),!0}}var g=this.circleCells[i];if(null!==g)for(var y=this.circles,v=0,_=g;v<_.length;v+=1){var b=_[v];if(!u.circle[b]){u.circle[b]=!0;var x=3*b;if(this._circlesCollide(y[x],y[x+1],y[x+2],l.x,l.y,l.radius)&&(!o||o(this.circleKeys[b])))return a.push(!0),!0}}},Kt.prototype._forEachCell=function(t,e,n,r,i,a,s,o){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),h=this._convertToYCellCoord(r),d=l;d<=c;d++)for(var p=u;p<=h;p++)if(i.call(this,t,e,n,r,this.xCellCount*p+d,a,s,o))return},Kt.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Kt.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Kt.prototype._circlesCollide=function(t,e,n,r,i,a){var s=r-t,o=i-e,l=n+a;return l*l>s*s+o*o},Kt.prototype._circleAndRectCollide=function(t,e,n,r,i,a,s){var o=(a-r)/2,l=Math.abs(t-(r+o));if(l>o+n)return!1;var u=(s-i)/2,c=Math.abs(e-(i+u));if(c>u+n)return!1;if(l<=o||c<=u)return!0;var h=l-o,d=c-u;return h*h+d*d<=n*n};var le=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ue(t,e){for(var n=0;n<t;n++){var r=e.length;e.resize(r+4),e.float32.set(le,3*r)}}function ce(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}var he=function(t,e,n){void 0===e&&(e=new Kt(t.width+200,t.height+200,25)),void 0===n&&(n=new Kt(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function de(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}he.prototype.placeCollisionBox=function(t,e,n,r,i){var a=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY),s=n*a.perspectiveRatio,o=t.x1*s+a.point.x,l=t.y1*s+a.point.y,u=t.x2*s+a.point.x,c=t.y2*s+a.point.y;return!this.isInsideGrid(o,l,u,c)||!e&&this.grid.hitTest(o,l,u,c,i)?{box:[],offscreen:!1}:{box:[o,l,u,c],offscreen:this.isOffscreen(o,l,u,c)}},he.prototype.placeCollisionCircles=function(e,n,r,i,a,s,o,l,u,c,h,d,p){var f=[],m=new t.Point(n.anchorX,n.anchorY),g=Qt(m,s),y=te(this.transform.cameraToCenterDistance,g.signedDistanceFromCamera),v=(c?a/y:a*y)/t.ONE_EM,_=Qt(m,o).point,b=re(v,i,n.lineOffsetX*v,n.lineOffsetY*v,!1,_,m,n,r,o,{}),x=!1,w=!1,S=!0;if(b){for(var C=.5*d*y+p,D=new t.Point(-100,-100),I=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),k=new Xt,E=b.first,A=b.last,T=[],R=E.path.length-1;R>=1;R--)T.push(E.path[R]);for(var M=1;M<A.path.length;M++)T.push(A.path[M]);var N=2.5*C;if(l){var O=T.map((function(t){return Qt(t,l)}));T=O.some((function(t){return t.signedDistanceFromCamera<=0}))?[]:O.map((function(t){return t.point}))}var P=[];if(T.length>0){for(var F=T[0].clone(),L=T[0].clone(),z=1;z<T.length;z++)F.x=Math.min(F.x,T[z].x),F.y=Math.min(F.y,T[z].y),L.x=Math.max(L.x,T[z].x),L.y=Math.max(L.y,T[z].y);P=F.x>=D.x&&L.x<=I.x&&F.y>=D.y&&L.y<=I.y?[T]:L.x<D.x||F.x>I.x||L.y<D.y||F.y>I.y?[]:t.clipLine([T],D.x,D.y,I.x,I.y)}for(var $=0,B=P;$<B.length;$+=1){var W;k.reset(B[$],.25*C),W=k.length<=.5*C?1:Math.ceil(k.paddedLength/N)+1;for(var q=0;q<W;q++){var V=q/Math.max(W-1,1),U=k.lerp(V),j=U.x+100,H=U.y+100;f.push(j,H,C,0);var G=j-C,J=H-C,X=j+C,K=H+C;if(S=S&&this.isOffscreen(G,J,X,K),w=w||this.isInsideGrid(G,J,X,K),!e&&this.grid.hitTestCircle(j,H,C,h)&&(x=!0,!u))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!u&&x||!w?[]:f,offscreen:S,collisionDetected:x}},he.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],r=1/0,i=1/0,a=-1/0,s=-1/0,o=0,l=e;o<l.length;o+=1){var u=l[o],c=new t.Point(u.x+100,u.y+100);r=Math.min(r,c.x),i=Math.min(i,c.y),a=Math.max(a,c.x),s=Math.max(s,c.y),n.push(c)}for(var h={},d={},p=0,f=this.grid.query(r,i,a,s).concat(this.ignoredGrid.query(r,i,a,s));p<f.length;p+=1){var m=f[p],g=m.key;if(void 0===h[g.bucketInstanceId]&&(h[g.bucketInstanceId]={}),!h[g.bucketInstanceId][g.featureIndex]){var y=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(n,y)&&(h[g.bucketInstanceId][g.featureIndex]=!0,void 0===d[g.bucketInstanceId]&&(d[g.bucketInstanceId]=[]),d[g.bucketInstanceId].push(g.featureIndex))}}return d},he.prototype.insertCollisionBox=function(t,e,n,r,i){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:i},t[0],t[1],t[2],t[3])},he.prototype.insertCollisionCircles=function(t,e,n,r,i){for(var a=e?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:r,collisionGroupID:i},o=0;o<t.length;o+=4)a.insertCircle(s,t[o],t[o+1],t[o+2])},he.prototype.projectAndGetPerspectiveRatio=function(e,n,r){var i=[n,r,0,1];return ce(i,i,e),{point:new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},he.prototype.isOffscreen=function(t,e,n,r){return n<100||t>=this.screenRightBoundary||r<100||e>this.screenBottomBoundary},he.prototype.isInsideGrid=function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary},he.prototype.getViewportMatrix=function(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e};var pe=function(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n};pe.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var fe=function(t,e,n,r,i){this.text=new pe(t?t.text:null,e,n,i),this.icon=new pe(t?t.icon:null,e,r,i)};fe.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var me=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},ge=function(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]},ye=function(t,e,n,r,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i},ve=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};function _e(e,n,r,i,a){var s=t.getAnchorAlignment(e),o=-(s.horizontalAlign-.5)*n,l=-(s.verticalAlign-.5)*r,u=t.evaluateVariableOffset(e,i);return new t.Point(o+u[0]*a,l+u[1]*a)}function be(e,n,r,i,a,s){var o=e.x1,l=e.x2,u=e.y1,c=e.y2,h=e.anchorPointX,d=e.anchorPointY,p=new t.Point(n,r);return i&&p._rotate(a?s:-s),{x1:o+p.x,y1:u+p.y,x2:l+p.x,y2:c+p.y,anchorPointX:h,anchorPointY:d}}ve.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var xe=function(t,e,n,r){this.transform=t.clone(),this.collisionIndex=new he(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new ve(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}};function we(t,e,n,r,i){t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0)}xe.prototype.getBucketParts=function(e,n,r,i){var a=r.getBucket(n),s=r.latestFeatureIndex;if(a&&s&&n.id===a.layerIds[0]){var o=r.collisionBoxArray,l=a.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),d="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),f=de(r,1,this.transform.zoom),m=Zt(h,d,p,this.transform,f),g=null;if(d){var y=Yt(h,d,p,this.transform,f);g=t.multiply([],this.transform.labelPlaneMatrix,y)}this.retainedQueryData[a.bucketInstanceId]=new ye(a.bucketInstanceId,s,a.sourceLayerIndex,a.index,r.tileID);var v={bucket:a,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:u,textPixelRatio:c,holdingForFade:r.holdingForFade(),collisionBoxArray:o,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(i)for(var _=0,b=a.sortKeyRanges;_<b.length;_+=1){var x=b[_];e.push({sortKey:x.sortKey,symbolInstanceStart:x.symbolInstanceStart,symbolInstanceEnd:x.symbolInstanceEnd,parameters:v})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:v})}},xe.prototype.attemptAnchorPlacement=function(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f){var m,g=[h.textOffset0,h.textOffset1],y=_e(t,n,r,g,i),v=this.collisionIndex.placeCollisionBox(be(e,y.x,y.y,a,s,this.transform.angle),c,o,l,u.predicate);if(!f||0!==this.collisionIndex.placeCollisionBox(be(f,y.x,y.y,a,s,this.transform.angle),c,o,l,u.predicate).box.length)return v.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(m=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:g,width:n,height:r,anchor:t,textBoxScale:i,prevAnchor:m},this.markUsedJustification(d,t,h,p),d.allowVerticalPlacement&&(this.markUsedOrientation(d,p,h),this.placedOrientations[h.crossTileID]=p),{shift:y,placedGlyphBoxes:v}):void 0},xe.prototype.placeLayerBucketPart=function(e,n,r){var i=this,a=e.parameters,s=a.bucket,o=a.layout,l=a.posMatrix,u=a.textLabelPlaneMatrix,c=a.labelToScreenMatrix,h=a.textPixelRatio,d=a.holdingForFade,p=a.collisionBoxArray,f=a.partiallyEvaluatedTextSize,m=a.collisionGroup,g=o.get("text-optional"),y=o.get("icon-optional"),v=o.get("text-allow-overlap"),_=o.get("icon-allow-overlap"),b="map"===o.get("text-rotation-alignment"),x="map"===o.get("text-pitch-alignment"),w="none"!==o.get("icon-text-fit"),S="viewport-y"===o.get("symbol-z-order"),C=v&&(_||!s.hasIconData()||y),D=_&&(v||!s.hasTextData()||g);!s.collisionArrays&&p&&s.deserializeCollisionBoxes(p);var I=function(e,a){if(!n[e.crossTileID])if(d)i.placements[e.crossTileID]=new me(!1,!1,!1);else{var p,S=!1,I=!1,k=!0,E=null,A={box:null,offscreen:null},T={box:null,offscreen:null},R=null,M=null,N=0,O=0,P=0;a.textFeatureIndex?N=a.textFeatureIndex:e.useRuntimeCollisionCircles&&(N=e.featureIndex),a.verticalTextFeatureIndex&&(O=a.verticalTextFeatureIndex);var F=a.textBox;if(F){var L=function(n){var r=t.WritingMode.horizontal;if(s.allowVerticalPlacement&&!n&&i.prevPlacement){var a=i.prevPlacement.placedOrientations[e.crossTileID];a&&(i.placedOrientations[e.crossTileID]=a,i.markUsedOrientation(s,r=a,e))}return r},z=function(n,r){if(s.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&a.verticalTextBox)for(var i=0,o=s.writingModes;i<o.length&&(o[i]===t.WritingMode.vertical?(A=r(),T=A):A=n(),!(A&&A.box&&A.box.length));i+=1);else A=n()};if(o.get("text-variable-anchor")){var $=o.get("text-variable-anchor");if(i.prevPlacement&&i.prevPlacement.variableOffsets[e.crossTileID]){var B=i.prevPlacement.variableOffsets[e.crossTileID];$.indexOf(B.anchor)>0&&($=$.filter((function(t){return t!==B.anchor}))).unshift(B.anchor)}var W=function(t,n,r){for(var a=t.x2-t.x1,o=t.y2-t.y1,u=e.textBoxScale,c=w&&!_?n:null,d={box:[],offscreen:!1},p=v?2*$.length:$.length,f=0;f<p;++f){var g=i.attemptAnchorPlacement($[f%$.length],t,a,o,u,b,x,h,l,m,f>=$.length,e,s,r,c);if(g&&(d=g.placedGlyphBoxes)&&d.box&&d.box.length){S=!0,E=g.shift;break}}return d};z((function(){return W(F,a.iconBox,t.WritingMode.horizontal)}),(function(){var n=a.verticalTextBox;return s.allowVerticalPlacement&&!(A&&A.box&&A.box.length)&&e.numVerticalGlyphVertices>0&&n?W(n,a.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),A&&(S=A.box,k=A.offscreen);var q=L(A&&A.box);if(!S&&i.prevPlacement){var V=i.prevPlacement.variableOffsets[e.crossTileID];V&&(i.variableOffsets[e.crossTileID]=V,i.markUsedJustification(s,V.anchor,e,q))}}else{var U=function(t,n){var r=i.collisionIndex.placeCollisionBox(t,v,h,l,m.predicate);return r&&r.box&&r.box.length&&(i.markUsedOrientation(s,n,e),i.placedOrientations[e.crossTileID]=n),r};z((function(){return U(F,t.WritingMode.horizontal)}),(function(){var n=a.verticalTextBox;return s.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?U(n,t.WritingMode.vertical):{box:null,offscreen:null}})),L(A&&A.box&&A.box.length)}}if(S=(p=A)&&p.box&&p.box.length>0,k=p&&p.offscreen,e.useRuntimeCollisionCircles){var j=s.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),H=t.evaluateSizeForFeature(s.textSizeData,f,j),G=o.get("text-padding");R=i.collisionIndex.placeCollisionCircles(v,j,s.lineVertexArray,s.glyphOffsetArray,H,l,u,c,r,x,m.predicate,e.collisionCircleDiameter,G),S=v||R.circles.length>0&&!R.collisionDetected,k=k&&R.offscreen}if(a.iconFeatureIndex&&(P=a.iconFeatureIndex),a.iconBox){var J=function(t){var e=w&&E?be(t,E.x,E.y,b,x,i.transform.angle):t;return i.collisionIndex.placeCollisionBox(e,_,h,l,m.predicate)};I=T&&T.box&&T.box.length&&a.verticalIconBox?(M=J(a.verticalIconBox)).box.length>0:(M=J(a.iconBox)).box.length>0,k=k&&M.offscreen}var X=g||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,K=y||0===e.numIconVertices;if(X||K?K?X||(I=I&&S):S=I&&S:I=S=I&&S,S&&p&&p.box&&i.collisionIndex.insertCollisionBox(p.box,o.get("text-ignore-placement"),s.bucketInstanceId,T&&T.box&&O?O:N,m.ID),I&&M&&i.collisionIndex.insertCollisionBox(M.box,o.get("icon-ignore-placement"),s.bucketInstanceId,P,m.ID),R&&(S&&i.collisionIndex.insertCollisionCircles(R.circles,o.get("text-ignore-placement"),s.bucketInstanceId,N,m.ID),r)){var Z=s.bucketInstanceId,Y=i.collisionCircleArrays[Z];void 0===Y&&(Y=i.collisionCircleArrays[Z]=new ge);for(var Q=0;Q<R.circles.length;Q+=4)Y.circles.push(R.circles[Q+0]),Y.circles.push(R.circles[Q+1]),Y.circles.push(R.circles[Q+2]),Y.circles.push(R.collisionDetected?1:0)}i.placements[e.crossTileID]=new me(S||C,I||D,k||s.justReloaded),n[e.crossTileID]=!0}};if(S)for(var k=s.getSortedSymbolIndexes(this.transform.angle),E=k.length-1;E>=0;--E){var A=k[E];I(s.symbolInstances.get(A),s.collisionArrays[A])}else for(var T=e.symbolInstanceStart;T<e.symbolInstanceEnd;T++)I(s.symbolInstances.get(T),s.collisionArrays[T]);if(r&&s.bucketInstanceId in this.collisionCircleArrays){var R=this.collisionCircleArrays[s.bucketInstanceId];t.invert(R.invProjMatrix,l),R.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=!1},xe.prototype.markUsedJustification=function(e,n,r,i){var a;a=i===t.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];for(var s=0,o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];s<o.length;s+=1){var l=o[s];l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=a>=0&&l!==a?0:r.crossTileID)}},xe.prototype.markUsedOrientation=function(e,n,r){for(var i=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,a=n===t.WritingMode.vertical?n:0,s=0,o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];s<o.length;s+=1)e.text.placedSymbolArray.get(o[s]).placedOrientation=i;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=a)},xe.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var r=e?e.symbolFadeChange(t):1,i=e?e.opacities:{},a=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(var o in this.placements){var l=this.placements[o],u=i[o];u?(this.opacities[o]=new fe(u,r,l.text,l.icon),n=n||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[o]=new fe(null,r,l.text,l.icon,l.skipFade),n=n||l.text||l.icon)}for(var c in i){var h=i[c];if(!this.opacities[c]){var d=new fe(h,r,!1,!1);d.isHidden()||(this.opacities[c]=d,n=n||h.text.placed||h.icon.placed)}}for(var p in a)this.variableOffsets[p]||!this.opacities[p]||this.opacities[p].isHidden()||(this.variableOffsets[p]=a[p]);for(var f in s)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=s[f]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},xe.prototype.updateLayerOpacities=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1){var a=i[r],s=a.getBucket(t);s&&a.latestFeatureIndex&&t.id===s.layerIds[0]&&this.updateBucketOpacities(s,n,a.collisionBoxArray)}},xe.prototype.updateBucketOpacities=function(e,n,r){var i=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var a=e.layers[0].layout,s=new fe(null,0,!1,!1,!0),o=a.get("text-allow-overlap"),l=a.get("icon-allow-overlap"),u=a.get("text-variable-anchor"),c="map"===a.get("text-rotation-alignment"),h="map"===a.get("text-pitch-alignment"),d="none"!==a.get("icon-text-fit"),p=new fe(null,0,o&&(l||!e.hasIconData()||a.get("icon-optional")),l&&(o||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);for(var f=function(t,e,n){for(var r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(n)},m=function(r){var a=e.symbolInstances.get(r),o=a.numHorizontalGlyphVertices,l=a.numVerticalGlyphVertices,m=a.crossTileID,g=i.opacities[m];n[m]?g=s:g||(i.opacities[m]=g=p),n[m]=!0;var y=a.numIconVertices>0,v=i.placedOrientations[a.crossTileID],_=v===t.WritingMode.vertical,b=v===t.WritingMode.horizontal||v===t.WritingMode.horizontalOnly;if(o>0||l>0){var x=Te(g.text);f(e.text,o,_?Re:x),f(e.text,l,b?Re:x);var w=g.text.isHidden();[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((function(t){t>=0&&(e.text.placedSymbolArray.get(t).hidden=w||_?1:0)})),a.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden=w||b?1:0);var S=i.variableOffsets[a.crossTileID];S&&i.markUsedJustification(e,S.anchor,a,v);var C=i.placedOrientations[a.crossTileID];C&&(i.markUsedJustification(e,"left",a,C),i.markUsedOrientation(e,C,a))}if(y){var D=Te(g.icon),I=!(d&&a.verticalPlacedIconSymbolIndex&&_);a.placedIconSymbolIndex>=0&&(f(e.icon,a.numIconVertices,I?D:Re),e.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden=g.icon.isHidden()),a.verticalPlacedIconSymbolIndex>=0&&(f(e.icon,a.numVerticalIconVertices,I?Re:D),e.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){var k=e.collisionArrays[r];if(k){var E=new t.Point(0,0);if(k.textBox||k.verticalTextBox){var A=!0;if(u){var T=i.variableOffsets[m];T?(E=_e(T.anchor,T.width,T.height,T.textOffset,T.textBoxScale),c&&E._rotate(h?i.transform.angle:-i.transform.angle)):A=!1}k.textBox&&we(e.textCollisionBox.collisionVertexArray,g.text.placed,!A||_,E.x,E.y),k.verticalTextBox&&we(e.textCollisionBox.collisionVertexArray,g.text.placed,!A||b,E.x,E.y)}var R=Boolean(!b&&k.verticalIconBox);k.iconBox&&we(e.iconCollisionBox.collisionVertexArray,g.icon.placed,R,d?E.x:0,d?E.y:0),k.verticalIconBox&&we(e.iconCollisionBox.collisionVertexArray,g.icon.placed,!R,d?E.x:0,d?E.y:0)}}},g=0;g<e.symbolInstances.length;g++)m(g);if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){var y=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=y.invProjMatrix,e.placementViewportMatrix=y.viewportMatrix,e.collisionCircleArray=y.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}},xe.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},xe.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},xe.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},xe.prototype.stillRecent=function(t,e){var n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t},xe.prototype.setStale=function(){this.stale=!0};var Se=Math.pow(2,25),Ce=Math.pow(2,24),De=Math.pow(2,17),Ie=Math.pow(2,16),ke=Math.pow(2,9),Ee=Math.pow(2,8),Ae=Math.pow(2,1);function Te(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Se+e*Ce+n*De+e*Ie+n*ke+e*Ee+n*Ae+e}var Re=0,Me=function(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Me.prototype.continuePlacement=function(t,e,n,r,i){for(var a=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(a,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((function(t,e){return t.sortKey-e.sortKey})));this._currentPartIndex<a.length;)if(e.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,i())return!0;return!1};var Ne=function(t,e,n,r,i,a,s){this.placement=new xe(t,i,a,s),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1};Ne.prototype.isDone=function(){return this._done},Ne.prototype.continuePlacement=function(e,n,r){for(var i=this,a=t.browser.now(),s=function(){var e=t.browser.now()-a;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var o=n[e[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===o.type&&(!o.minzoom||o.minzoom<=l)&&(!o.maxzoom||o.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new Me(o)),this._inProgressLayer.continuePlacement(r[o.source],this.placement,this._showCollisionBoxes,o,s))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ne.prototype.commit=function(t){return this.placement.commit(t),this.placement};var Oe=512/t.EXTENT/2,Pe=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var r=0;r<e.length;r++){var i=e.get(r),a=i.key;this.indexedSymbolInstances[a]||(this.indexedSymbolInstances[a]=[]),this.indexedSymbolInstances[a].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};Pe.prototype.getScaledCoordinates=function(e,n){var r=Oe/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*r),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*r)}},Pe.prototype.findMatches=function(t,e,n){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0;i<t.length;i++){var a=t.get(i);if(!a.crossTileID){var s=this.indexedSymbolInstances[a.key];if(s)for(var o=this.getScaledCoordinates(a,e),l=0,u=s;l<u.length;l+=1){var c=u[l];if(Math.abs(c.coord.x-o.x)<=r&&Math.abs(c.coord.y-o.y)<=r&&!n[c.crossTileID]){n[c.crossTileID]=!0,a.crossTileID=c.crossTileID;break}}}}};var Fe=function(){this.maxCrossTileID=0};Fe.prototype.generate=function(){return++this.maxCrossTileID};var Le=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Le.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var r=this.indexes[n],i={};for(var a in r){var s=r[a];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+e),i[s.tileID.key]=s}this.indexes[n]=i}this.lng=t},Le.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var a in this.indexes){var s=this.indexes[a];if(Number(a)>t.overscaledZ)for(var o in s){var l=s[o];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,i)}else{var u=s[t.scaledTo(Number(a)).key];u&&u.findMatches(e.symbolInstances,t,i)}}for(var c=0;c<e.symbolInstances.length;c++){var h=e.symbolInstances.get(c);h.crossTileID||(h.crossTileID=n.generate(),i[h.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Pe(t,e.symbolInstances,e.bucketInstanceId),!0},Le.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var r=0,i=e.indexedSymbolInstances[n];r<i.length;r+=1)delete this.usedCrossTileIDs[t][i[r].crossTileID]},Le.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var r=this.indexes[n];for(var i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e};var ze=function(){this.layerIndexes={},this.crossTileIDs=new Fe,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ze.prototype.addLayer=function(t,e,n){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Le);var i=!1,a={};r.handleWrapJump(n);for(var s=0,o=e;s<o.length;s+=1){var l=o[s],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(l.tileID,u,this.crossTileIDs)&&(i=!0),a[u.bucketInstanceId]=!0)}return r.removeStaleBuckets(a)&&(i=!0),i},ze.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var $e=function(e,n){return t.emitValidationErrors(e,n&&n.filter((function(t){return"source.canvas"!==t.identifier})))},Be=t.pick(Wt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),We=t.pick(Wt,["setCenter","setZoom","setBearing","setPitch"]),qe=function(){var e={},n=t.styleSpec.$version;for(var r in t.styleSpec.$root){var i,a=t.styleSpec.$root[r];a.required&&null!=(i="version"===r?n:"array"===a.type?[]:{})&&(e[r]=i)}return e}(),Ve=function(e){function n(r,i){var a=this;void 0===i&&(i={}),e.call(this),this.map=r,this.dispatcher=new C(zt(),this),this.imageManager=new d,this.imageManager.setEventedParent(this),this.glyphManager=new _(r._requestManager,i.localIdeographFontFamily),this.lineAtlas=new S(256,512),this.crossTileSymbolIndex=new ze,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var s=this;this._rtlTextPluginCallback=n.registerForPluginStateChange((function(e){s.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(function(e,n){if(t.triggerPluginCompletionEvent(e),n&&n.every((function(t){return t})))for(var r in s.sourceCaches)s.sourceCaches[r].reload()}))})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=a.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var r in a._layers){var i=a._layers[r];i.source===n.id&&a._validateLayer(i)}}}}))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadURL=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);var a=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(a,(function(e,n){r._request=null,e?r.fire(new t.ErrorEvent(e)):n&&r._load(n,i)}))},n.prototype.loadJSON=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame((function(){r._request=null,r._load(e,!1!==n.validate)}))},n.prototype.loadEmpty=function(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(qe,!1)},n.prototype._load=function(e,n){if(!n||!$e(this,t.validateStyle(e))){for(var r in this._loaded=!0,this.stylesheet=e,e.sources)this.addSource(r,e.sources[r],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var i=Bt(this.stylesheet.layers);this._order=i.map((function(t){return t.id})),this._layers={},this._serializedLayers={};for(var a=0,s=i;a<s.length;a+=1){var o=s[a];(o=t.createStyleLayer(o)).setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=o,this._serializedLayers[o.id]=o.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._loadSprite=function(e){var n=this;this._spriteRequest=function(e,n,r){var i,a,s,o=t.browser.devicePixelRatio>1?"@2x":"",l=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,o,".json"),t.ResourceType.SpriteJSON),(function(t,e){l=null,s||(s=t,i=e,c())})),u=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,o,".png"),t.ResourceType.SpriteImage),(function(t,e){u=null,s||(s=t,a=e,c())}));function c(){if(s)r(s);else if(i&&a){var e=t.browser.getImageData(a),n={};for(var o in i){var l=i[o],u=l.width,c=l.height,h=l.x,d=l.y,p=l.sdf,f=l.pixelRatio,m=l.stretchX,g=l.stretchY,y=l.content,v=new t.RGBAImage({width:u,height:c});t.RGBAImage.copy(e,v,{x:h,y:d},{x:0,y:0},{width:u,height:c}),n[o]={data:v,pixelRatio:f,sdf:p,stretchX:m,stretchY:g,content:y}}r(null,n)}}return{cancel:function(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(e,this.map._requestManager,(function(e,r){if(n._spriteRequest=null,e)n.fire(new t.ErrorEvent(e));else if(r)for(var i in r)n.imageManager.addImage(i,r[i]);n.imageManager.setLoaded(!0),n._availableImages=n.imageManager.listImages(),n.dispatcher.broadcast("setImages",n._availableImages),n.fire(new t.Event("data",{dataType:"style"}))}))},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var r=e.sourceLayer;if(r){var i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+i.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){for(var e=[],n=0,r=t;n<r.length;n+=1){var i=this._layers[r[n]];"custom"!==i.type&&e.push(i.serialize())}return e},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){var n=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var a in(r.length||i.length)&&this._updateWorkerLayers(r,i),this._updatedSources){var s=this._updatedSources[a];"reload"===s?this._reloadSource(a):"clear"===s&&this._clearSource(a)}for(var o in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}for(var l in this.sourceCaches)this.sourceCaches[l].used=!1;for(var u=0,c=this._order;u<c.length;u+=1){var h=this._layers[c[u]];h.recalculate(e,this._availableImages),!h.isHidden(e.zoom)&&h.source&&(this.sourceCaches[h.source].used=!0)}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}},n.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),$e(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=Bt(e.layers);var r=function(e,n){if(!e)return[{command:Wt.setStyle,args:[n]}];var r=[];try{if(!t.deepEqual(e.version,n.version))return[{command:Wt.setStyle,args:[n]}];t.deepEqual(e.center,n.center)||r.push({command:Wt.setCenter,args:[n.center]}),t.deepEqual(e.zoom,n.zoom)||r.push({command:Wt.setZoom,args:[n.zoom]}),t.deepEqual(e.bearing,n.bearing)||r.push({command:Wt.setBearing,args:[n.bearing]}),t.deepEqual(e.pitch,n.pitch)||r.push({command:Wt.setPitch,args:[n.pitch]}),t.deepEqual(e.sprite,n.sprite)||r.push({command:Wt.setSprite,args:[n.sprite]}),t.deepEqual(e.glyphs,n.glyphs)||r.push({command:Wt.setGlyphs,args:[n.glyphs]}),t.deepEqual(e.transition,n.transition)||r.push({command:Wt.setTransition,args:[n.transition]}),t.deepEqual(e.light,n.light)||r.push({command:Wt.setLight,args:[n.light]});var i={},a=[];!function(e,n,r,i){var a;for(a in n=n||{},e=e||{})e.hasOwnProperty(a)&&(n.hasOwnProperty(a)||Vt(a,r,i));for(a in n)n.hasOwnProperty(a)&&(e.hasOwnProperty(a)?t.deepEqual(e[a],n[a])||("geojson"===e[a].type&&"geojson"===n[a].type&&jt(e,n,a)?r.push({command:Wt.setGeoJSONSourceData,args:[a,n[a].data]}):Ut(a,n,r,i)):qt(a,n,r))}(e.sources,n.sources,a,i);var s=[];e.layers&&e.layers.forEach((function(t){i[t.source]?r.push({command:Wt.removeLayer,args:[t.id]}):s.push(t)})),r=r.concat(a),function(e,n,r){n=n||[];var i,a,s,o,l,u,c,h=(e=e||[]).map(Gt),d=n.map(Gt),p=e.reduce(Jt,{}),f=n.reduce(Jt,{}),m=h.slice(),g=Object.create(null);for(i=0,a=0;i<h.length;i++)f.hasOwnProperty(s=h[i])?a++:(r.push({command:Wt.removeLayer,args:[s]}),m.splice(m.indexOf(s,a),1));for(i=0,a=0;i<d.length;i++)m[m.length-1-i]!==(s=d[d.length-1-i])&&(p.hasOwnProperty(s)?(r.push({command:Wt.removeLayer,args:[s]}),m.splice(m.lastIndexOf(s,m.length-a),1)):a++,r.push({command:Wt.addLayer,args:[f[s],u=m[m.length-i]]}),m.splice(m.length-i,0,s),g[s]=!0);for(i=0;i<d.length;i++)if(o=p[s=d[i]],l=f[s],!g[s]&&!t.deepEqual(o,l))if(t.deepEqual(o.source,l.source)&&t.deepEqual(o["source-layer"],l["source-layer"])&&t.deepEqual(o.type,l.type)){for(c in Ht(o.layout,l.layout,r,s,null,Wt.setLayoutProperty),Ht(o.paint,l.paint,r,s,null,Wt.setPaintProperty),t.deepEqual(o.filter,l.filter)||r.push({command:Wt.setFilter,args:[s,l.filter]}),t.deepEqual(o.minzoom,l.minzoom)&&t.deepEqual(o.maxzoom,l.maxzoom)||r.push({command:Wt.setLayerZoomRange,args:[s,l.minzoom,l.maxzoom]}),o)o.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ht(o[c],l[c],r,s,c.slice(6),Wt.setPaintProperty):t.deepEqual(o[c],l[c])||r.push({command:Wt.setLayerProperty,args:[s,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!o.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Ht(o[c],l[c],r,s,c.slice(6),Wt.setPaintProperty):t.deepEqual(o[c],l[c])||r.push({command:Wt.setLayerProperty,args:[s,c,l[c]]}))}else r.push({command:Wt.removeLayer,args:[s]}),u=m[m.lastIndexOf(s)+1],r.push({command:Wt.addLayer,args:[l,u]})}(s,n.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:Wt.setStyle,args:[n]}]}return r}(this.serialize(),e).filter((function(t){return!(t.command in We)}));if(0===r.length)return!1;var i=r.filter((function(t){return!(t.command in Be)}));if(i.length>0)throw new Error("Unimplemented: "+i.map((function(t){return t.command})).join(", ")+".");return r.forEach((function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)})),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(e,n,r){var i=this;if(void 0===r&&(r={}),this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,r))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var a=this.sourceCaches[e]=new Tt(e,n,this.dispatcher);a.style=this,a.setEventedParent(this,(function(){return{isSourceLoaded:i.loaded(),source:a.serialize(),sourceId:e}})),a.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,r){void 0===r&&(r={}),this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var a;if("custom"===e.type){if($e(this,t.validateCustomStyleLayer(e)))return;a=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone$1(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},r))return;a=t.createStyleLayer(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[a.id]=a.serialize()}var s=n?this._order.indexOf(n):this._order.length;if(n&&-1===s)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(s,0,i),this._layerOrderChanged=!0,this._layers[i]=a,this._removedLayers[i]&&a.source&&"custom"!==a.type){var o=this._removedLayers[i];delete this._removedLayers[i],o.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var r=this._order.indexOf(e);this._order.splice(r,1);var i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.hasLayer=function(t){return t in this._layers},n.prototype.setLayerZoomRange=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n,r){void 0===r&&(r={}),this._checkLoaded();var i=this.getLayer(e);if(i){if(!t.deepEqual(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateStyle.filter,"layers."+i.id+".filter",n,null,r)||(i.filter=t.clone$1(n),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone$1(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,r,i){void 0===i&&(i={}),this._checkLoaded();var a=this.getLayer(e);a?t.deepEqual(a.getLayoutProperty(n),r)||(a.setLayoutProperty(n,r,i),this._updateLayer(a)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(e,n){var r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style.")))},n.prototype.setPaintProperty=function(e,n,r,i){void 0===i&&(i={}),this._checkLoaded();var a=this.getLayer(e);a?t.deepEqual(a.getPaintProperty(n),r)||(a.setPaintProperty(n,r,i)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.setFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=e.sourceLayer,a=this.sourceCaches[r];if(void 0!==a){var s=a.getSource().type;"geojson"===s&&i?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==s||i?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),a.setFeatureState(i,e.id,n)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.removeFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=this.sourceCaches[r];if(void 0!==i){var a=i.getSource().type,s="vector"===a?e.sourceLayer:void 0;"vector"!==a||s?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):i.removeFeatureState(s,e.id,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,r=e.sourceLayer,i=this.sourceCaches[n];if(void 0!==i){if("vector"!==i.getSource().type||r)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),i.getFeatureState(r,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,n=function(t){return"fill-extrusion"===e._layers[t].type},r={},i=[],a=this._order.length-1;a>=0;a--){var s=this._order[a];if(n(s)){r[s]=a;for(var o=0,l=t;o<l.length;o+=1){var u=l[o][s];if(u)for(var c=0,h=u;c<h.length;c+=1)i.push(h[c])}}}i.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var d=[],p=this._order.length-1;p>=0;p--){var f=this._order[p];if(n(f))for(var m=i.length-1;m>=0;m--){var g=i[m].feature;if(r[g.layer.id]<p)break;d.push(g),i.pop()}else for(var y=0,v=t;y<v.length;y+=1){var _=v[y][f];if(_)for(var b=0,x=_;b<x.length;b+=1)d.push(x[b].feature)}}return d},n.prototype.queryRenderedFeatures=function(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);var i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var a=0,s=n.layers;a<s.length;a+=1){var o=s[a],l=this._layers[o];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be queried for features."))),[];i[l.source]=!0}}var u=[];for(var c in n.availableImages=this._availableImages,this.sourceCaches)n.layers&&!i[c]||u.push(L(this.sourceCaches[c],this._layers,this._serializedLayers,e,n,r));return this.placement&&u.push(function(t,e,n,r,i,a,s){for(var o={},l=a.queryRenderedSymbols(r),u=[],c=0,h=Object.keys(l).map(Number);c<h.length;c+=1)u.push(s[h[c]]);u.sort(z);for(var d=function(){var n=f[p],r=n.featureIndex.lookupSymbolFeatures(l[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,i.filter,i.layers,i.availableImages,t);for(var a in r){var s=o[a]=o[a]||[],u=r[a];u.sort((function(t,e){var r=n.featureSortOrder;if(r){var i=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));for(var c=0,h=u;c<h.length;c+=1)s.push(h[c])}},p=0,f=u;p<f.length;p+=1)d();var m=function(e){o[e].forEach((function(r){var i=r.feature,a=n[t[e].source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=a}))};for(var g in o)m(g);return o}(this._layers,this._serializedLayers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);var r=this.sourceCaches[e];return r?function(t,e){for(var n=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),r=[],i={},a=0;a<n.length;a++){var s=n[a],o=s.tileID.canonical.key;i[o]||(i[o]=!0,s.querySourceFeatures(r,e))}return r}(r,n):[]},n.prototype.addSourceType=function(t,e,r){return n.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e,n){void 0===n&&(n={}),this._checkLoaded();var r=this.light.getLight(),i=!1;for(var a in e)if(!t.deepEqual(e[a],r[a])){i=!0;break}if(i){var s={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(s)}},n.prototype._validate=function(e,n,r,i,a){return void 0===a&&(a={}),(!a||!1!==a.validate)&&$e(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.styleSpec},i)))},n.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var n in this.sourceCaches)this.sourceCaches[n].clearTiles(),this.sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(e,n,r,i,a){void 0===a&&(a=!1);for(var s=!1,o=!1,l={},u=0,c=this._order;u<c.length;u+=1){var h=this._layers[c[u]];if("symbol"===h.type){if(!l[h.source]){var d=this.sourceCaches[h.source];l[h.source]=d.getRenderableIds(!0).map((function(t){return d.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var p=this.crossTileSymbolIndex.addLayer(h,l[h.source],e.center.lng);s=s||p}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((a=a||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now(),e.zoom))&&(this.pauseablePlacement=new Ne(e,this._order,a,n,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.browser.now()),o=!0),s&&this.pauseablePlacement.placement.setStale()),o||s)for(var f=0,m=this._order;f<m.length;f+=1){var g=this._layers[m[f]];"symbol"===g.type&&this.placement.updateLayerOpacities(g,l[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();var r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n.prototype.getResource=function(e,n,r){return t.makeRequest(n,r)},n}(t.Evented);Ve.getSourceType=function(t){return P[t]},Ve.setSourceType=function(t,e){P[t]=e},Ve.registerForPluginStateChange=t.registerForPluginStateChange;var Ue=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),je=vn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),He=vn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ge=vn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Je=vn("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Xe=vn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ke=vn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Ze=vn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ye=vn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Qe=vn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),tn=vn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),en=vn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),nn=vn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),rn=vn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),an=vn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),sn=vn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),on=vn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),ln=vn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),un=vn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),cn=vn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),hn=vn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),dn=vn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),pn=vn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),fn=vn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),mn=vn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),gn=vn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),yn=vn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function vn(t,e){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r={};return{fragmentSource:t=t.replace(n,(function(t,e,n,i,a){return r[a]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+a+"\nvarying "+n+" "+i+" "+a+";\n#else\nuniform "+n+" "+i+" u_"+a+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+a+"\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n"})),vertexSource:e=e.replace(n,(function(t,e,n,i,a){var s="float"===i?"vec2":"vec4",o=a.match(/color/)?"color":s;return r[a]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float u_"+a+"_t;\nattribute "+n+" "+s+" a_"+a+";\nvarying "+n+" "+i+" "+a+";\n#else\nuniform "+n+" "+i+" u_"+a+";\n#endif\n":"vec4"===o?"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+a+" = a_"+a+";\n#else\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+a+" = unpack_mix_"+o+"(a_"+a+", u_"+a+"_t);\n#else\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float u_"+a+"_t;\nattribute "+n+" "+s+" a_"+a+";\n#else\nuniform "+n+" "+i+" u_"+a+";\n#endif\n":"vec4"===o?"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+n+" "+i+" "+a+" = a_"+a+";\n#else\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+n+" "+i+" "+a+" = unpack_mix_"+o+"(a_"+a+", u_"+a+"_t);\n#else\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n"}))}}var _n=Object.freeze({__proto__:null,prelude:je,background:He,backgroundPattern:Ge,circle:Je,clippingMask:Xe,heatmap:Ke,heatmapTexture:Ze,collisionBox:Ye,collisionCircle:Qe,debug:tn,fill:en,fillOutline:nn,fillOutlinePattern:rn,fillPattern:an,fillExtrusion:sn,fillExtrusionPattern:on,hillshadePrepare:ln,hillshade:un,line:cn,lineGradient:hn,linePattern:dn,lineSDF:pn,raster:fn,symbolIcon:mn,symbolSDF:gn,symbolTextAndIcon:yn}),bn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};bn.prototype.bind=function(t,e,n,r,i,a,s,o){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==r.length,u=0;!l&&u<r.length;u++)this.boundPaintVertexBuffers[u]!==r[u]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!l&&this.boundIndexBuffer===i&&this.boundVertexOffset===a&&this.boundDynamicVertexBuffer===s&&this.boundDynamicVertexBuffer2===o?(t.bindVertexArrayOES.set(this.vao),s&&s.bind(),i&&i.dynamicDraw&&i.bind(),o&&o.bind()):this.freshBind(e,n,r,i,a,s,o)},bn.prototype.freshBind=function(t,e,n,r,i,a,s){var o,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),o=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=s;else{o=u.currentNumAttributes||0;for(var h=l;h<o;h++)c.disableVertexAttribArray(h)}e.enableAttributes(c,t);for(var d=0,p=n;d<p.length;d+=1)p[d].enableAttributes(c,t);a&&a.enableAttributes(c,t),s&&s.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,i);for(var f=0,m=n;f<m.length;f+=1){var g=m[f];g.bind(),g.setVertexAttribPointers(c,t,i)}a&&(a.bind(),a.setVertexAttribPointers(c,t,i)),r&&r.bind(),s&&(s.bind(),s.setVertexAttribPointers(c,t,i)),u.currentNumAttributes=l},bn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var xn=function(t,e,n,r,i){var a=t.gl;this.program=a.createProgram();var s=n?n.defines():[];i&&s.push("#define OVERDRAW_INSPECTOR;");var o=s.concat(je.fragmentSource,e.fragmentSource).join("\n"),l=s.concat(je.vertexSource,e.vertexSource).join("\n"),u=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(u,o),a.compileShader(u),a.attachShader(this.program,u);var c=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(c,l),a.compileShader(c),a.attachShader(this.program,c);for(var h=n?n.layoutAttributes:[],d=0;d<h.length;d++)a.bindAttribLocation(this.program,d,h[d].name);a.linkProgram(this.program),a.deleteShader(c),a.deleteShader(u),this.numAttributes=a.getProgramParameter(this.program,a.ACTIVE_ATTRIBUTES),this.attributes={};for(var p={},f=0;f<this.numAttributes;f++){var m=a.getActiveAttrib(this.program,f);m&&(this.attributes[m.name]=a.getAttribLocation(this.program,m.name))}for(var g=a.getProgramParameter(this.program,a.ACTIVE_UNIFORMS),y=0;y<g;y++){var v=a.getActiveUniform(this.program,y);v&&(p[v.name]=a.getUniformLocation(this.program,v.name))}this.fixedUniforms=r(t,p),this.binderUniforms=n?n.getUniforms(t,p):[]}}};function wn(t,e,n){var r=1/de(n,1,e.transform.tileZoom),i=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,e.transform.tileZoom)/i,s=a*(n.tileID.canonical.x+n.tileID.wrap*i),o=a*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[s>>16,o>>16],u_pixel_coord_lower:[65535&s,65535&o]}}xn.prototype.draw=function(t,e,n,r,i,a,s,o,l,u,c,h,d,p,f,m){var g,y=t.gl;if(!this.failedToCreate){for(var v in t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(a),this.fixedUniforms)this.fixedUniforms[v].set(s[v]);p&&p.setUniforms(t,this.binderUniforms,h,{zoom:d});for(var _=(g={},g[y.LINES]=2,g[y.TRIANGLES]=3,g[y.LINE_STRIP]=1,g)[e],b=0,x=c.get();b<x.length;b+=1){var w=x[b],S=w.vaos||(w.vaos={});(S[o]||(S[o]=new bn)).bind(t,this,l,p?p.getPaintVertexBuffers():[],u,w.vertexOffset,f,m),y.drawElements(e,w.primitiveLength*_,y.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var Sn=function(e,n,r,i){var a=n.style.light,s=a.properties.get("position"),o=[s.x,s.y,s.z],l=t.create$1();"viewport"===a.properties.get("anchor")&&t.fromRotation(l,-n.transform.angle),t.transformMat3(o,o,l);var u=a.properties.get("color");return{u_matrix:e,u_lightpos:o,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:i}},Cn=function(e,n,r,i,a,s,o){return t.extend(Sn(e,n,r,i),wn(s,n,o),{u_height_factor:-Math.pow(2,a.overscaledZ)/o.tileSize/8})},Dn=function(t){return{u_matrix:t}},In=function(e,n,r,i){return t.extend(Dn(e),wn(r,n,i))},kn=function(t,e){return{u_matrix:t,u_world:e}},En=function(e,n,r,i,a){return t.extend(In(e,n,r,i),{u_world:a})},An=function(e,n,r,i){var a,s,o=e.transform;if("map"===i.paint.get("circle-pitch-alignment")){var l=de(r,1,o.zoom);a=!0,s=[l,l]}else a=!1,s=o.pixelsToGLUnits;return{u_camera_to_center_distance:o.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(n.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.browser.devicePixelRatio,u_extrude_scale:s}},Tn=function(t,e,n){var r=de(n,1,e.zoom),i=Math.pow(2,e.zoom-n.tileID.overscaledZ),a=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*i),e.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:a}},Rn=function(t,e,n){return{u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}},Mn=function(t,e,n){return void 0===n&&(n=1),{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}},Nn=function(t){return{u_matrix:t}},On=function(t,e,n,r){return{u_matrix:t,u_extrude_scale:de(e,1,n),u_intensity:r}},Pn=function(e,n,r){var i=e.transform;return{u_matrix:Bn(e,n,r),u_ratio:1/de(n,1,i.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Fn=function(e,n,r){return t.extend(Pn(e,n,r),{u_image:0})},Ln=function(e,n,r,i){var a=e.transform,s=$n(n,a);return{u_matrix:Bn(e,n,r),u_texsize:n.imageAtlasTexture.size,u_ratio:1/de(n,1,a.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_image:0,u_scale:[s,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},zn=function(e,n,r,i,a){var s=e.lineAtlas,o=$n(n,e.transform),l="round"===r.layout.get("line-cap"),u=s.getDash(i.from,l),c=s.getDash(i.to,l),h=u.width*a.fromScale,d=c.width*a.toScale;return t.extend(Pn(e,n,r),{u_patternscale_a:[o/h,-u.height/2],u_patternscale_b:[o/d,-c.height/2],u_sdfgamma:s.width/(256*Math.min(h,d)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:c.y,u_mix:a.t})};function $n(t,e){return 1/de(t,1,e.tileZoom)}function Bn(t,e,n){return t.translatePosMatrix(e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Wn=function(t,e,n,r,i){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(s=i.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(a=i.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:qn(i.paint.get("raster-hue-rotate"))};var a,s};function qn(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}var Vn,Un=function(t,e,n,r,i,a,s,o,l,u){var c=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:c.width/c.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:s,u_coord_matrix:o,u_is_text:+l,u_pitch_with_map:+r,u_texsize:u,u_texture:0}},jn=function(e,n,r,i,a,s,o,l,u,c,h){var d=a.transform;return t.extend(Un(e,n,r,i,a,s,o,l,u,c),{u_gamma_scale:i?Math.cos(d._pitch)*d.cameraToCenterDistance:1,u_device_pixel_ratio:t.browser.devicePixelRatio,u_is_halo:+h})},Hn=function(e,n,r,i,a,s,o,l,u,c){return t.extend(jn(e,n,r,i,a,s,o,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1})},Gn=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},Jn=function(e,n,r,i,a,s){return t.extend(function(t,e,n,r){var i=n.imageManager.getPattern(t.from.toString()),a=n.imageManager.getPattern(t.to.toString()),s=n.imageManager.getPixelSize(),o=s.width,l=s.height,u=Math.pow(2,r.tileID.overscaledZ),c=r.tileSize*Math.pow(2,n.transform.tileZoom)/u,h=c*(r.tileID.canonical.x+r.tileID.wrap*u),d=c*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,l],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/de(r,1,n.transform.tileZoom),u_pixel_coord_upper:[h>>16,d>>16],u_pixel_coord_lower:[65535&h,65535&d]}}(i,s,r,a),{u_matrix:e,u_opacity:n})},Xn={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},collisionCircle:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}},debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_maxzoom:new t.Uniform1f(e,n.u_maxzoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},symbolTextAndIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}}};function Kn(e,n,r,i,a,s,o){for(var l=e.context,u=l.gl,c=e.useProgram("collisionBox"),h=[],d=0,p=0,f=0;f<i.length;f++){var m=i[f],g=n.getTile(m),y=g.getBucket(r);if(y){var v=m.posMatrix;0===a[0]&&0===a[1]||(v=e.translatePosMatrix(m.posMatrix,g,a,s));var _=o?y.textCollisionBox:y.iconCollisionBox,b=y.collisionCircleArray;if(b.length>0){var x=t.create(),w=v;t.mul(x,y.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(x,x,y.placementViewportMatrix),h.push({circleArray:b,circleOffset:p,transform:w,invTransform:x}),p=d+=b.length/4}_&&c.draw(l,u.LINES,Dt.disabled,It.disabled,e.colorModeForRenderPass(),Et.disabled,Tn(v,e.transform,g),r.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}if(o&&h.length){var S=e.useProgram("collisionCircle"),C=new t.StructArrayLayout2f1f2i16;C.resize(4*d),C._trim();for(var D=0,I=0,k=h;I<k.length;I+=1)for(var E=k[I],A=0;A<E.circleArray.length/4;A++){var T=4*A,R=E.circleArray[T+0],M=E.circleArray[T+1],N=E.circleArray[T+2],O=E.circleArray[T+3];C.emplace(D++,R,M,N,O,0),C.emplace(D++,R,M,N,O,1),C.emplace(D++,R,M,N,O,2),C.emplace(D++,R,M,N,O,3)}(!Vn||Vn.length<2*d)&&(Vn=function(e){var n=2*e,r=new t.StructArrayLayout3ui6;r.resize(n),r._trim();for(var i=0;i<n;i++){var a=6*i;r.uint16[a+0]=4*i+0,r.uint16[a+1]=4*i+1,r.uint16[a+2]=4*i+2,r.uint16[a+3]=4*i+2,r.uint16[a+4]=4*i+3,r.uint16[a+5]=4*i+0}return r}(d));for(var P=l.createIndexBuffer(Vn,!0),F=l.createVertexBuffer(C,t.collisionCircleLayout.members,!0),L=0,z=h;L<z.length;L+=1){var $=z[L],B=Rn($.transform,$.invTransform,e.transform);S.draw(l,u.TRIANGLES,Dt.disabled,It.disabled,e.colorModeForRenderPass(),Et.disabled,B,r.id,F,P,t.SegmentVector.simpleSegment(0,2*$.circleOffset,$.circleArray.length,$.circleArray.length/2),null,e.transform.zoom,null,null,null)}F.destroy(),P.destroy()}}var Zn=t.identity(new Float32Array(16));function Yn(e,n,r,i,a,s){var o=t.getAnchorAlignment(e),l=-(o.horizontalAlign-.5)*n,u=-(o.verticalAlign-.5)*r,c=t.evaluateVariableOffset(e,i);return new t.Point((l/a+c[0])*s,(u/a+c[1])*s)}function Qn(e,n,r,i,a,s,o,l,u,c,h){var d=e.text.placedSymbolArray,p=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,m={};p.clear();for(var g=0;g<d.length;g++){var y=d.get(g),v=y.hidden||!y.crossTileID||e.allowVerticalPlacement&&!y.placedOrientation?null:i[y.crossTileID];if(v){var _=new t.Point(y.anchorX,y.anchorY),b=Qt(_,r?l:o),x=te(s.cameraToCenterDistance,b.signedDistanceFromCamera),w=a.evaluateSizeForFeature(e.textSizeData,c,y)*x/t.ONE_EM;r&&(w*=e.tilePixelRatio/u);for(var S=Yn(v.anchor,v.width,v.height,v.textOffset,v.textBoxScale,w),C=r?Qt(_.add(S),o).point:b.point.add(n?S.rotate(-s.angle):S),D=e.allowVerticalPlacement&&y.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,I=0;I<y.numGlyphs;I++)t.addDynamicAttributes(p,C,D);h&&y.associatedIconIndex>=0&&(m[y.associatedIconIndex]={shiftedAnchor:C,angle:D})}else ue(y.numGlyphs,p)}if(h){f.clear();for(var k=e.icon.placedSymbolArray,E=0;E<k.length;E++){var A=k.get(E);if(A.hidden)ue(A.numGlyphs,f);else{var T=m[E];if(T)for(var R=0;R<A.numGlyphs;R++)t.addDynamicAttributes(f,T.shiftedAnchor,T.angle);else ue(A.numGlyphs,f)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(p)}function tr(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function er(e,n,r,i,a,s,o,l,u,c,h,d){for(var p=e.context,f=p.gl,m=e.transform,g="map"===l,y="map"===u,v=g&&"point"!==r.layout.get("symbol-placement"),_=g&&!y&&!v,b=void 0!==r.layout.get("symbol-sort-key").constantOr(1),x=e.depthModeForSublayer(0,Dt.ReadOnly),w=r.layout.get("text-variable-anchor"),S=[],C=0,D=i;C<D.length;C+=1){var I=D[C],k=n.getTile(I),E=k.getBucket(r);if(E){var A=a?E.text:E.icon;if(A&&A.segments.get().length){var T=A.programConfigurations.get(r.id),R=a||E.sdfIcons,M=a?E.textSizeData:E.iconSizeData,N=y||0!==m.pitch,O=e.useProgram(tr(R,a,E),T),P=t.evaluateSizeForZoom(M,m.zoom),F=void 0,L=[0,0],z=void 0,$=void 0,B=null,W=void 0;if(a)z=k.glyphAtlasTexture,$=f.LINEAR,F=k.glyphAtlasTexture.size,E.iconsInText&&(L=k.imageAtlasTexture.size,B=k.imageAtlasTexture,W=N||e.options.rotating||e.options.zooming||"composite"===M.kind||"camera"===M.kind?f.LINEAR:f.NEAREST);else{var q=1!==r.layout.get("icon-size").constantOr(0)||E.iconsNeedLinear;z=k.imageAtlasTexture,$=R||e.options.rotating||e.options.zooming||q||N?f.LINEAR:f.NEAREST,F=k.imageAtlasTexture.size}var V=de(k,1,e.transform.zoom),U=Zt(I.posMatrix,y,g,e.transform,V),j=Yt(I.posMatrix,y,g,e.transform,V),H=w&&E.hasTextData(),G="none"!==r.layout.get("icon-text-fit")&&H&&E.hasIconData();v&&ne(E,I.posMatrix,e,a,U,j,y,c);var J=e.translatePosMatrix(I.posMatrix,k,s,o),X=v||a&&w||G?Zn:U,K=e.translatePosMatrix(j,k,s,o,!0),Z=R&&0!==r.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),Y={program:O,buffers:A,uniformValues:R?E.iconsInText?Hn(M.kind,P,_,y,e,J,X,K,F,L):jn(M.kind,P,_,y,e,J,X,K,a,F,!0):Un(M.kind,P,_,y,e,J,X,K,a,F),atlasTexture:z,atlasTextureIcon:B,atlasInterpolation:$,atlasInterpolationIcon:W,isSDF:R,hasHalo:Z};if(b)for(var Q=0,tt=A.segments.get();Q<tt.length;Q+=1){var et=tt[Q];S.push({segments:new t.SegmentVector([et]),sortKey:et.sortKey,state:Y})}else S.push({segments:A.segments,sortKey:0,state:Y})}}}b&&S.sort((function(t,e){return t.sortKey-e.sortKey}));for(var nt=0,rt=S;nt<rt.length;nt+=1){var it=rt[nt],at=it.state;if(p.activeTexture.set(f.TEXTURE0),at.atlasTexture.bind(at.atlasInterpolation,f.CLAMP_TO_EDGE),at.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),at.atlasTextureIcon&&at.atlasTextureIcon.bind(at.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),at.isSDF){var st=at.uniformValues;at.hasHalo&&(st.u_is_halo=1,nr(at.buffers,it.segments,r,e,at.program,x,h,d,st)),st.u_is_halo=0}nr(at.buffers,it.segments,r,e,at.program,x,h,d,at.uniformValues)}}function nr(t,e,n,r,i,a,s,o,l){var u=r.context;i.draw(u,u.gl.TRIANGLES,a,s,o,Et.disabled,l,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function rr(t,e,n,r,i,a,s){var o,l,u,c,h,d=t.context.gl,p=n.paint.get("fill-pattern"),f=p&&p.constantOr(1),m=n.getCrossfadeParameters();s?(l=f&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",o=d.LINES):(l=f?"fillPattern":"fill",o=d.TRIANGLES);for(var g=0,y=r;g<y.length;g+=1){var v=y[g],_=e.getTile(v);if(!f||_.patternsLoaded()){var b=_.getBucket(n);if(b){var x=b.programConfigurations.get(n.id),w=t.useProgram(l,x);f&&(t.context.activeTexture.set(d.TEXTURE0),_.imageAtlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),x.updatePaintBuffers(m));var S=p.constantOr(null);if(S&&_.imageAtlas){var C=_.imageAtlas,D=C.patternPositions[S.to.toString()],I=C.patternPositions[S.from.toString()];D&&I&&x.setConstantPatternPositions(D,I)}var k=t.translatePosMatrix(v.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(s){c=b.indexBuffer2,h=b.segments2;var E=[d.drawingBufferWidth,d.drawingBufferHeight];u="fillOutlinePattern"===l&&f?En(k,t,m,_,E):kn(k,E)}else c=b.indexBuffer,h=b.segments,u=f?In(k,t,m,_):Dn(k);w.draw(t.context,o,i,t.stencilModeForClipping(v),a,Et.disabled,u,n.id,b.layoutVertexBuffer,c,h,n.paint,t.transform.zoom,x)}}}}function ir(t,e,n,r,i,a,s){for(var o=t.context,l=o.gl,u=n.paint.get("fill-extrusion-pattern"),c=u.constantOr(1),h=n.getCrossfadeParameters(),d=n.paint.get("fill-extrusion-opacity"),p=0,f=r;p<f.length;p+=1){var m=f[p],g=e.getTile(m),y=g.getBucket(n);if(y){var v=y.programConfigurations.get(n.id),_=t.useProgram(c?"fillExtrusionPattern":"fillExtrusion",v);c&&(t.context.activeTexture.set(l.TEXTURE0),g.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(h));var b=u.constantOr(null);if(b&&g.imageAtlas){var x=g.imageAtlas,w=x.patternPositions[b.to.toString()],S=x.patternPositions[b.from.toString()];w&&S&&v.setConstantPatternPositions(w,S)}var C=t.translatePosMatrix(m.posMatrix,g,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),D=n.paint.get("fill-extrusion-vertical-gradient"),I=c?Cn(C,t,D,d,m,h,g):Sn(C,t,D,d);_.draw(o,o.gl.TRIANGLES,i,a,s,Et.backCCW,I,n.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,n.paint,t.transform.zoom,v)}}}function ar(e,n,r,i,a,s){var o=e.context,l=o.gl,u=n.fbo;if(u){var c=e.useProgram("hillshade");o.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get());var h=function(e,n,r){var i=r.paint.get("hillshade-shadow-color"),a=r.paint.get("hillshade-highlight-color"),s=r.paint.get("hillshade-accent-color"),o=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(o-=e.transform.angle);var l,u,c,h=!e.options.moving;return{u_matrix:e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),h),u_image:0,u_latrange:(l=n.tileID,u=Math.pow(2,l.canonical.z),c=l.canonical.y,[new t.MercatorCoordinate(0,c/u).toLngLat().lat,new t.MercatorCoordinate(0,(c+1)/u).toLngLat().lat]),u_light:[r.paint.get("hillshade-exaggeration"),o],u_shadow:i,u_highlight:a,u_accent:s}}(e,n,r);c.draw(o,l.TRIANGLES,i,a,s,Et.disabled,h,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function sr(e,n,r,i,a,s,o){var l=e.context,u=l.gl,c=n.dem;if(c&&c.data){var h=c.dim,d=c.stride,p=c.getPixels();if(l.activeTexture.set(u.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(d),n.demTexture){var f=n.demTexture;f.update(p,{premultiply:!1}),f.bind(u.NEAREST,u.CLAMP_TO_EDGE)}else n.demTexture=new t.Texture(l,p,u.RGBA,{premultiply:!1}),n.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);l.activeTexture.set(u.TEXTURE0);var m=n.fbo;if(!m){var g=new t.Texture(l,{width:h,height:h,data:null},u.RGBA);g.bind(u.LINEAR,u.CLAMP_TO_EDGE),(m=n.fbo=l.createFramebuffer(h,h,!0)).colorAttachment.set(g.texture)}l.bindFramebuffer.set(m.framebuffer),l.viewport.set([0,0,h,h]),e.useProgram("hillshadePrepare").draw(l,u.TRIANGLES,a,s,o,Et.disabled,function(e,n,r){var i=n.stride,a=t.create();return t.ortho(a,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(a,a,[0,-t.EXTENT,0]),{u_matrix:a,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_maxzoom:r,u_unpack:n.getUnpackVector()}}(n.tileID,c,i),r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function or(e,n,r,i,a){var s=i.paint.get("raster-fade-duration");if(s>0){var o=t.browser.now(),l=(o-e.timeAdded)/s,u=n?(o-n.timeAdded)/s:-1,c=r.getSource(),h=a.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),d=!n||Math.abs(n.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),p=d&&e.refreshedUponExpiration?1:t.clamp(d?l:1-u,0,1);return e.refreshedUponExpiration&&l>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}var lr=new t.Color(1,0,0,1),ur=new t.Color(0,1,0,1),cr=new t.Color(0,0,1,1),hr=new t.Color(1,0,1,1),dr=new t.Color(0,1,1,1);function pr(t,e,n,r){mr(t,0,e+n/2,t.transform.width,n,r)}function fr(t,e,n,r){mr(t,e-n/2,0,n,t.transform.height,r)}function mr(e,n,r,i,a,s){var o=e.context,l=o.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.browser.devicePixelRatio,r*t.browser.devicePixelRatio,i*t.browser.devicePixelRatio,a*t.browser.devicePixelRatio),o.clear({color:s}),l.disable(l.SCISSOR_TEST)}function gr(e,n,r){var i=e.context,a=i.gl,s=r.posMatrix,o=e.useProgram("debug"),l=Dt.disabled,u=It.disabled,c=e.colorModeForRenderPass();i.activeTexture.set(a.TEXTURE0),e.emptyTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),o.draw(i,a.LINE_STRIP,l,u,c,Et.disabled,Mn(s,t.Color.red),"$debug",e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);var h=n.getTileByID(r.key).latestRawTileData,d=Math.floor((h&&h.byteLength||0)/1024),p=n.getTile(r).tileSize,f=512/Math.min(p,512)*(r.overscaledZ/e.transform.zoom)*.5,m=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(m+=" => "+r.overscaledZ),function(t,e){t.initDebugOverlayCanvas();var n=t.debugOverlayCanvas,r=t.context.gl,i=t.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(e,5,5),i.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,m+" "+d+"kb"),o.draw(i,a.TRIANGLES,l,u,kt.alphaBlended,Et.disabled,Mn(s,t.Color.transparent,f),"$debug",e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}var yr={symbol:function(e,n,r,i,a){if("translucent"===e.renderPass){var s=It.disabled,o=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,n,r,i,a,s,o){for(var l=n.transform,u="map"===a,c="map"===s,h=0,d=e;h<d.length;h+=1){var p=d[h],f=i.getTile(p),m=f.getBucket(r);if(m&&m.text&&m.text.segments.get().length){var g=t.evaluateSizeForZoom(m.textSizeData,l.zoom),y=de(f,1,n.transform.zoom),v=Zt(p.posMatrix,c,u,n.transform,y),_="none"!==r.layout.get("icon-text-fit")&&m.hasIconData();if(g){var b=Math.pow(2,l.zoom-f.tileID.overscaledZ);Qn(m,u,c,o,t.symbolSize,l,v,p.posMatrix,b,g,_)}}}}(i,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),a),0!==r.paint.get("icon-opacity").constantOr(1)&&er(e,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),s,o),0!==r.paint.get("text-opacity").constantOr(1)&&er(e,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),s,o),n.map.showCollisionBoxes&&(Kn(e,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Kn(e,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}},circle:function(e,n,r,i){if("translucent"===e.renderPass){var a=r.paint.get("circle-opacity"),s=r.paint.get("circle-stroke-width"),o=r.paint.get("circle-stroke-opacity"),l=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0!==a.constantOr(1)||0!==s.constantOr(1)&&0!==o.constantOr(1)){for(var u=e.context,c=u.gl,h=e.depthModeForSublayer(0,Dt.ReadOnly),d=It.disabled,p=e.colorModeForRenderPass(),f=[],m=0;m<i.length;m++){var g=i[m],y=n.getTile(g),v=y.getBucket(r);if(v){var _=v.programConfigurations.get(r.id),b={programConfiguration:_,program:e.useProgram("circle",_),layoutVertexBuffer:v.layoutVertexBuffer,indexBuffer:v.indexBuffer,uniformValues:An(e,g,y,r)};if(l)for(var x=0,w=v.segments.get();x<w.length;x+=1){var S=w[x];f.push({segments:new t.SegmentVector([S]),sortKey:S.sortKey,state:b})}else f.push({segments:v.segments,sortKey:0,state:b})}}l&&f.sort((function(t,e){return t.sortKey-e.sortKey}));for(var C=0,D=f;C<D.length;C+=1){var I=D[C],k=I.state;k.program.draw(u,c.TRIANGLES,h,d,p,Et.disabled,k.uniformValues,r.id,k.layoutVertexBuffer,k.indexBuffer,I.segments,r.paint,e.transform.zoom,k.programConfiguration)}}}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var a=e.context,s=a.gl,o=It.disabled,l=new kt([s.ONE,s.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,r){var i=t.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e.width/4,e.height/4,0,i.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),r.colorAttachment.set(n)}(t,e,a,i)}}(a,e,r),a.clear({color:t.Color.transparent});for(var u=0;u<i.length;u++){var c=i[u];if(!n.hasRenderableParent(c)){var h=n.getTile(c),d=h.getBucket(r);if(d){var p=d.programConfigurations.get(r.id);e.useProgram("heatmap",p).draw(a,s.TRIANGLES,Dt.disabled,o,l,Et.disabled,On(c.posMatrix,h,e.transform.zoom,r.paint.get("heatmap-intensity")),r.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,r.paint,e.transform.zoom,p)}}}a.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var r=e.context,i=r.gl,a=n.heatmapFbo;if(a){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var s=n.colorRampTexture;s||(s=n.colorRampTexture=new t.Texture(r,n.colorRamp,i.RGBA)),s.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,Dt.disabled,It.disabled,e.colorModeForRenderPass(),Et.disabled,function(e,n,r,i){var a=t.create();t.ortho(a,0,e.width,e.height,0,0,1);var s=e.context.gl;return{u_matrix:a,u_world:[s.drawingBufferWidth,s.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}}(e,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,r))},line:function(e,n,r,i){if("translucent"===e.renderPass){var a=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(0!==a.constantOr(1)&&0!==s.constantOr(1)){var o=e.depthModeForSublayer(0,Dt.ReadOnly),l=e.colorModeForRenderPass(),u=r.paint.get("line-dasharray"),c=r.paint.get("line-pattern"),h=c.constantOr(1),d=r.paint.get("line-gradient"),p=r.getCrossfadeParameters(),f=h?"linePattern":u?"lineSDF":d?"lineGradient":"line",m=e.context,g=m.gl,y=!0;if(d){m.activeTexture.set(g.TEXTURE0);var v=r.gradientTexture;if(!r.gradient)return;v||(v=r.gradientTexture=new t.Texture(m,r.gradient,g.RGBA)),v.bind(g.LINEAR,g.CLAMP_TO_EDGE)}for(var _=0,b=i;_<b.length;_+=1){var x=b[_],w=n.getTile(x);if(!h||w.patternsLoaded()){var S=w.getBucket(r);if(S){var C=S.programConfigurations.get(r.id),D=e.context.program.get(),I=e.useProgram(f,C),k=y||I.program!==D,E=c.constantOr(null);if(E&&w.imageAtlas){var A=w.imageAtlas,T=A.patternPositions[E.to.toString()],R=A.patternPositions[E.from.toString()];T&&R&&C.setConstantPatternPositions(T,R)}var M=h?Ln(e,w,r,p):u?zn(e,w,r,u,p):d?Fn(e,w,r):Pn(e,w,r);h?(m.activeTexture.set(g.TEXTURE0),w.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),C.updatePaintBuffers(p)):u&&(k||e.lineAtlas.dirty)&&(m.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(m)),I.draw(m,g.TRIANGLES,o,e.stencilModeForClipping(x),l,Et.disabled,M,r.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,r.paint,e.transform.zoom,C),y=!1}}}}}},fill:function(e,n,r,i){var a=r.paint.get("fill-color"),s=r.paint.get("fill-opacity");if(0!==s.constantOr(1)){var o=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(t.Color.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){var c=e.depthModeForSublayer(1,"opaque"===e.renderPass?Dt.ReadWrite:Dt.ReadOnly);rr(e,n,r,i,c,o,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){var h=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Dt.ReadOnly);rr(e,n,r,i,h,o,!0)}}},"fill-extrusion":function(t,e,n,r){var i=n.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===t.renderPass){var a=new Dt(t.context.gl.LEQUAL,Dt.ReadWrite,t.depthRangeFor3D);if(1!==i||n.paint.get("fill-extrusion-pattern").constantOr(1))ir(t,e,n,r,a,It.disabled,kt.disabled),ir(t,e,n,r,a,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var s=t.colorModeForRenderPass();ir(t,e,n,r,a,It.disabled,s)}}},hillshade:function(t,e,n,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var i=t.context,a=e.getSource().maxzoom,s=t.depthModeForSublayer(0,Dt.ReadOnly),o=t.colorModeForRenderPass(),l="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r],u=l[0],c=0,h=l[1];c<h.length;c+=1){var d=h[c],p=e.getTile(d);p.needsHillshadePrepare&&"offscreen"===t.renderPass?sr(t,p,n,a,s,It.disabled,o):"translucent"===t.renderPass&&ar(t,p,n,s,u[d.overscaledZ],o)}i.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,r){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")&&r.length)for(var i=t.context,a=i.gl,s=e.getSource(),o=t.useProgram("raster"),l=t.colorModeForRenderPass(),u=s instanceof M?[{},r]:t.stencilConfigForOverlap(r),c=u[0],h=u[1],d=h[h.length-1].overscaledZ,p=!t.options.moving,f=0,m=h;f<m.length;f+=1){var g=m[f],y=t.depthModeForSublayer(g.overscaledZ-d,1===n.paint.get("raster-opacity")?Dt.ReadWrite:Dt.ReadOnly,a.LESS),v=e.getTile(g),_=t.transform.calculatePosMatrix(g.toUnwrapped(),p);v.registerFadeDuration(n.paint.get("raster-fade-duration"));var b=e.findLoadedParent(g,0),x=or(v,b,e,n,t.transform),w=void 0,S=void 0,C="nearest"===n.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;i.activeTexture.set(a.TEXTURE0),v.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(a.TEXTURE1),b?(b.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,b.tileID.overscaledZ-v.tileID.overscaledZ),S=[v.tileID.canonical.x*w%1,v.tileID.canonical.y*w%1]):v.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);var D=Wn(_,S||[0,0],w||1,x,n);s instanceof M?o.draw(i,a.TRIANGLES,y,It.disabled,l,Et.disabled,D,n.id,s.boundsBuffer,t.quadTriangleIndexBuffer,s.boundsSegments):o.draw(i,a.TRIANGLES,y,c[g.overscaledZ],l,Et.disabled,D,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n){var r=n.paint.get("background-color"),i=n.paint.get("background-opacity");if(0!==i){var a=t.context,s=a.gl,o=t.transform,l=o.tileSize,u=n.paint.get("background-pattern");if(!t.isPatternMissing(u)){var c=!u&&1===r.a&&1===i&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===c){var h=It.disabled,d=t.depthModeForSublayer(0,"opaque"===c?Dt.ReadWrite:Dt.ReadOnly),p=t.colorModeForRenderPass(),f=t.useProgram(u?"backgroundPattern":"background"),m=o.coveringTiles({tileSize:l});u&&(a.activeTexture.set(s.TEXTURE0),t.imageManager.bind(t.context));for(var g=n.getCrossfadeParameters(),y=0,v=m;y<v.length;y+=1){var _=v[y],b=t.transform.calculatePosMatrix(_.toUnwrapped()),x=u?Jn(b,i,t,u,{tileID:_,tileSize:l},g):Gn(b,i,r);f.draw(a,s.TRIANGLES,d,h,p,Et.disabled,x,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,n){for(var r=0;r<n.length;r++)gr(t,e,n[r])},custom:function(t,e,n){var r=t.context,i=n.implementation;if("offscreen"===t.renderPass){var a=i.prerender;a&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),a.call(i,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(It.disabled);var s="3d"===i.renderingMode?new Dt(t.context.gl.LEQUAL,Dt.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Dt.ReadOnly);r.setDepthMode(s),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}},vr=function(t,e){this.context=new At(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=Tt.maxUnderzooming+Tt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ze,this.gpuTimers={}};vr.prototype.resize=function(e,n){if(this.width=e*t.browser.devicePixelRatio,this.height=n*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var r=0,i=this.style._order;r<i.length;r+=1)this.style._layers[i[r]].resize()},vr.prototype.setup=function(){var e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,Ue.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,Ue.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,R.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,Ue.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var s=new t.StructArrayLayout1ui2;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(s);var o=new t.StructArrayLayout3ui6;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(o),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new It({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},vr.prototype.clearStencil=function(){var e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Dt.disabled,this.stencilClearMode,kt.disabled,Et.disabled,Nn(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},vr.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var n=this.context,r=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(kt.disabled),n.setDepthMode(Dt.disabled);var i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var a=0,s=e;a<s.length;a+=1){var o=s[a],l=this._tileClippingMaskIDs[o.key]=this.nextStencilID++;i.draw(n,r.TRIANGLES,Dt.disabled,new It({func:r.ALWAYS,mask:0},l,255,r.KEEP,r.KEEP,r.REPLACE),kt.disabled,Et.disabled,Nn(o.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},vr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new It({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},vr.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new It({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},vr.prototype.stencilConfigForOverlap=function(t){var e,n=this.context.gl,r=t.sort((function(t,e){return e.overscaledZ-t.overscaledZ})),i=r[r.length-1].overscaledZ,a=r[0].overscaledZ-i+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();for(var s={},o=0;o<a;o++)s[o+i]=new It({func:n.GEQUAL,mask:255},o+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=a,[s,r]}return[(e={},e[i]=It.disabled,e),r]},vr.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new kt([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?kt.unblended:kt.alphaBlended},vr.prototype.depthModeForSublayer=function(t,e,n){if(!this.opaquePassEnabledForLayer())return Dt.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Dt(n||this.context.gl.LEQUAL,e,[r,r])},vr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},vr.prototype.render=function(e,n){var r=this;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now()),this.imageManager.beginFrame();var i=this.style._order,a=this.style.sourceCaches;for(var s in a){var o=a[s];o.used&&o.prepare(this.context)}var l,u,c={},h={},d={};for(var p in a){var f=a[p];c[p]=f.getVisibleCoordinates(),h[p]=c[p].slice().reverse(),d[p]=f.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<i.length;m++)if(this.style._layers[i[m]].is3D()){this.opaquePassCutoff=m;break}this.renderPass="offscreen";for(var g=0,y=i;g<y.length;g+=1){var v=this.style._layers[y[g]];if(v.hasOffscreenPass()&&!v.isHidden(this.transform.zoom)){var _=h[v.source];("custom"===v.type||_.length)&&this.renderLayer(this,a[v.source],v,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){var b=this.style._layers[i[this.currentLayer]],x=a[b.source],w=c[b.source];this._renderTileClippingMasks(b,w),this.renderLayer(this,x,b,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var S=this.style._layers[i[this.currentLayer]],C=a[S.source],D=("symbol"===S.type?d:h)[S.source];this._renderTileClippingMasks(S,c[S.source]),this.renderLayer(this,C,S,D)}this.options.showTileBoundaries&&(t.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(r.transform.zoom)&&(t.source!==(u&&u.id)&&(u=r.style.sourceCaches[t.source]),(!l||l.getSource().maxzoom<u.getSource().maxzoom)&&(l=u))})),l&&yr.debug(this,l,l.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;pr(t,t.transform.height-(e.top||0),3,lr),pr(t,e.bottom||0,3,ur),fr(t,e.left||0,3,cr),fr(t,t.transform.width-(e.right||0),3,hr);var n=t.transform.centerPoint;!function(t,e,n,r){mr(t,e-1,n-10,2,20,r),mr(t,e-10,n-1,20,2,r)}(t,n.x,t.transform.height-n.y,dr)}(this),this.context.setDefault()},vr.prototype.renderLayer=function(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||r.length)&&(this.id=n.id,this.gpuTimingStart(n),yr[n.type](t,e,n,r,this.style.placement.variableOffsets),this.gpuTimingEnd())},vr.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}},vr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},vr.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},vr.prototype.queryGpuTimers=function(t){var e={};for(var n in t){var r=t[n],i=this.context.extTimerQuery,a=i.getQueryObjectEXT(r.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r.query),e[n]=a}return e},vr.prototype.translatePosMatrix=function(e,n,r,i,a){if(!r[0]&&!r[1])return e;var s=a?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(s){var o=Math.sin(s),l=Math.cos(s);r=[r[0]*l-r[1]*o,r[0]*o+r[1]*l]}var u=[a?r[0]:de(n,r[0],this.transform.zoom),a?r[1]:de(n,r[1],this.transform.zoom),0],c=new Float32Array(16);return t.translate(c,e,u),c},vr.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},vr.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},vr.prototype.isPatternMissing=function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n},vr.prototype.useProgram=function(t,e){this.cache=this.cache||{};var n=""+t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new xn(this.context,_n[t],e,Xn[t],this._showOverdrawInspector)),this.cache[n]},vr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},vr.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)},vr.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},vr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var _r=function(t,e){this.points=t,this.planes=e};_r.fromInvProjectionMatrix=function(e,n,r){var i=Math.pow(2,r),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(n){return t.transformMat4([],n,e)})).map((function(e){return t.scale$1([],e,1/e[3]/n*i)})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var n=t.sub([],a[e[0]],a[e[1]]),r=t.sub([],a[e[2]],a[e[1]]),i=t.normalize([],t.cross([],n,r)),s=-t.dot(i,a[e[1]]);return i.concat(s)}));return new _r(a,s)};var br=function(e,n){this.min=e,this.max=n,this.center=t.scale$2([],t.add([],this.min,this.max),.5)};br.prototype.quadrant=function(e){for(var n=[e%2==0,e<2],r=t.clone$2(this.min),i=t.clone$2(this.max),a=0;a<n.length;a++)r[a]=n[a]?this.min[a]:this.center[a],i[a]=n[a]?this.center[a]:this.max[a];return i[2]=this.max[2],new br(r,i)},br.prototype.distanceX=function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]},br.prototype.distanceY=function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]},br.prototype.intersects=function(e){for(var n=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],r=!0,i=0;i<e.planes.length;i++){for(var a=e.planes[i],s=0,o=0;o<n.length;o++)s+=t.dot$1(a,n[o])>=0;if(0===s)return 0;s!==n.length&&(r=!1)}if(r)return 2;for(var l=0;l<3;l++){for(var u=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<e.points.length;h++){var d=e.points[h][l]-this.min[l];u=Math.min(u,d),c=Math.max(c,d)}if(c<0||u>this.max[l]-this.min[l])return 0}return 1};var xr=function(t,e,n,r){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=r};xr.prototype.interpolate=function(e,n,r){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,r)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,r)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,r)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,r)),this},xr.prototype.getCenter=function(e,n){var r=t.clamp((this.left+e-this.right)/2,0,e),i=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.Point(r,i)},xr.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right},xr.prototype.clone=function(){return new xr(this.top,this.bottom,this.left,this.right)},xr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var wr=function(e,n,r,i,a){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===a||a,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new xr,this._posMatrixCache={},this._alignedPosMatrixCache={}},Sr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};wr.prototype.clone=function(){var t=new wr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t},Sr.minZoom.get=function(){return this._minZoom},Sr.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Sr.maxZoom.get=function(){return this._maxZoom},Sr.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Sr.minPitch.get=function(){return this._minPitch},Sr.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},Sr.maxPitch.get=function(){return this._maxPitch},Sr.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},Sr.renderWorldCopies.get=function(){return this._renderWorldCopies},Sr.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Sr.worldSize.get=function(){return this.tileSize*this.scale},Sr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Sr.size.get=function(){return new t.Point(this.width,this.height)},Sr.bearing.get=function(){return-this.angle/Math.PI*180},Sr.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Sr.pitch.get=function(){return this._pitch/Math.PI*180},Sr.pitch.set=function(e){var n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},Sr.fov.get=function(){return this._fov/Math.PI*180},Sr.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Sr.zoom.get=function(){return this._zoom},Sr.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Sr.center.get=function(){return this._center},Sr.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Sr.padding.get=function(){return this._edgeInsets.toJSON()},Sr.padding.set=function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())},Sr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},wr.prototype.isPaddingEqual=function(t){return this._edgeInsets.equals(t)},wr.prototype.interpolatePadding=function(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()},wr.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},wr.prototype.getVisibleUnwrappedCoordinates=function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new t.Point(0,0)),i=this.pointCoordinate(new t.Point(this.width,0)),a=this.pointCoordinate(new t.Point(this.width,this.height)),s=this.pointCoordinate(new t.Point(0,this.height)),o=Math.floor(Math.min(r.x,i.x,a.x,s.x)),l=Math.floor(Math.max(r.x,i.x,a.x,s.x)),u=o-1;u<=l+1;u++)0!==u&&n.push(new t.UnwrappedTileID(u,e));return n},wr.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),r=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var i=t.MercatorCoordinate.fromLngLat(this.center),a=Math.pow(2,n),s=[a*i.x,a*i.y,0],o=_r.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),l=e.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(l=n);var u=function(t){return{aabb:new br([t*a,0,0],[(t+1)*a,a,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}},c=[],h=[],d=n,p=e.reparseOverscaled?r:n;if(this._renderWorldCopies)for(var f=1;f<=3;f++)c.push(u(-f)),c.push(u(f));for(c.push(u(0));c.length>0;){var m=c.pop(),g=m.x,y=m.y,v=m.fullyVisible;if(!v){var _=m.aabb.intersects(o);if(0===_)continue;v=2===_}var b=m.aabb.distanceX(s),x=m.aabb.distanceY(s),w=Math.max(Math.abs(b),Math.abs(x));if(m.zoom===d||w>3+(1<<d-m.zoom)-2&&m.zoom>=l)h.push({tileID:new t.OverscaledTileID(m.zoom===d?p:m.zoom,m.wrap,m.zoom,g,y),distanceSq:t.sqrLen([s[0]-.5-g,s[1]-.5-y])});else for(var S=0;S<4;S++){var C=(g<<1)+S%2,D=(y<<1)+(S>>1);c.push({aabb:m.aabb.quadrant(S),zoom:m.zoom+1,x:C,y:D,wrap:m.wrap,fullyVisible:v})}}return h.sort((function(t,e){return t.distanceSq-e.distanceSq})).map((function(t){return t.tileID}))},wr.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Sr.unmodified.get=function(){return this._unmodified},wr.prototype.zoomScale=function(t){return Math.pow(2,t)},wr.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},wr.prototype.project=function(e){var n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)},wr.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},Sr.point.get=function(){return this.project(this.center)},wr.prototype.setLocationAtPoint=function(e,n){var r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),s=new t.MercatorCoordinate(a.x-(r.x-i.x),a.y-(r.y-i.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())},wr.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},wr.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},wr.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},wr.prototype.coordinateLocation=function(t){return t.toLngLat()},wr.prototype.pointCoordinate=function(e){var n=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(r,r,this.pixelMatrixInverse);var i=n[3],a=r[3],s=n[1]/i,o=r[1]/a,l=n[2]/i,u=r[2]/a,c=l===u?0:(0-l)/(u-l);return new t.MercatorCoordinate(t.number(n[0]/i,r[0]/a,c)/this.worldSize,t.number(s,o,c)/this.worldSize)},wr.prototype.coordinatePoint=function(e){var n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},wr.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},wr.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},wr.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},wr.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var a=e.canonical,s=this.worldSize/this.zoomScale(a.z),o=a.x+Math.pow(2,a.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[o*s,a.y*s,0]),t.scale(l,l,[s/t.EXTENT,s/t.EXTENT,1]),t.multiply(l,n?this.alignedProjMatrix:this.projMatrix,l),i[r]=new Float32Array(l),i[r]},wr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},wr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,r,i,a=-90,s=90,o=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;a=t.mercatorYfromLat(h[1])*this.worldSize,e=(s=t.mercatorYfromLat(h[0])*this.worldSize)-a<u.y?u.y/(s-a):0}if(this.lngRange){var d=this.lngRange;o=t.mercatorXfromLng(d[0])*this.worldSize,n=(l=t.mercatorXfromLng(d[1])*this.worldSize)-o<u.x?u.x/(l-o):0}var p=this.point,f=Math.max(n||0,e||0);if(f)return this.center=this.unproject(new t.Point(n?(l+o)/2:p.x,e?(s+a)/2:p.y)),this.zoom+=this.scaleZoom(f),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var m=p.y,g=u.y/2;m-g<a&&(i=a+g),m+g>s&&(i=s-g)}if(this.lngRange){var y=p.x,v=u.x/2;y-v<o&&(r=o+v),y+v>l&&(r=l-v)}void 0===r&&void 0===i||(this.center=this.unproject(new t.Point(void 0!==r?r:p.x,void 0!==i?i:p.y))),this._unmodified=c,this._constraining=!1}},wr.prototype._calcMatrices=function(){if(this.height){var e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var n=Math.PI/2+this._pitch,r=this._fov*(.5+e.y/this.height),i=Math.sin(r)*this.cameraToCenterDistance/Math.sin(t.clamp(Math.PI-n-r,.01,Math.PI-.01)),a=this.point,s=a.x,o=a.y,l=1.01*(Math.cos(Math.PI/2-this._pitch)*i+this.cameraToCenterDistance),u=this.height/50,c=new Float64Array(16);t.perspective(c,this._fov,this.width/this.height,u,l),c[8]=2*-e.x/this.width,c[9]=2*e.y/this.height,t.scale(c,c,[1,-1,1]),t.translate(c,c,[0,0,-this.cameraToCenterDistance]),t.rotateX(c,c,this._pitch),t.rotateZ(c,c,this.angle),t.translate(c,c,[-s,-o,0]),this.mercatorMatrix=t.scale([],c,[this.worldSize,this.worldSize,this.worldSize]),t.scale(c,c,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=c,this.invProjMatrix=t.invert([],this.projMatrix);var h=this.width%2/2,d=this.height%2/2,p=Math.cos(this.angle),f=Math.sin(this.angle),m=s-Math.round(s)+p*h+f*d,g=o-Math.round(o)+p*d+f*h,y=new Float64Array(c);if(t.translate(y,y,[m>.5?m-1:m,g>.5?g-1:g,0]),this.alignedProjMatrix=y,c=t.create(),t.scale(c,c,[this.width/2,-this.height/2,1]),t.translate(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=t.create(),t.scale(c,c,[1,-1,1]),t.translate(c,c,[-1,-1,0]),t.scale(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(c=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={}}},wr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},wr.prototype.getCameraPoint=function(){var e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))},wr.prototype.getCameraQueryGeometry=function(e){var n=this.getCameraPoint();if(1===e.length)return[e[0],n];for(var r=n.x,i=n.y,a=n.x,s=n.y,o=0,l=e;o<l.length;o+=1){var u=l[o];r=Math.min(r,u.x),i=Math.min(i,u.y),a=Math.max(a,u.x),s=Math.max(s,u.y)}return[new t.Point(r,i),new t.Point(a,i),new t.Point(a,s),new t.Point(r,s),new t.Point(r,i)]},Object.defineProperties(wr.prototype,Sr);var Cr=function(e){var n,r,i,a;this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),r=!1,i=null,a=function(){i=null,r&&(n(),i=setTimeout(a,300),r=!1)},function(){return r=!0,i||a(),i})};Cr.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Cr.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Cr.prototype.getHashString=function(e){var n=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,i=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,i),s=Math.round(n.lng*a)/a,o=Math.round(n.lat*a)/a,l=this._map.getBearing(),u=this._map.getPitch(),c="";if(c+=e?"/"+s+"/"+o+"/"+r:r+"/"+o+"/"+s,(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+="/"+Math.round(u)),this._hashName){var h=this._hashName,d=!1,p=t.window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===h?(d=!0,e+"="+c):t})).filter((function(t){return t}));return d||p.push(h+"="+c),"#"+p.join("&")}return"#"+c},Cr.prototype._getCurrentHash=function(){var e,n=this,r=t.window.location.hash.replace("#","");return this._hashName?(r.split("&").map((function(t){return t.split("=")})).forEach((function(t){t[0]===n._hashName&&(e=t)})),(e&&e[1]||"").split("/")):r.split("/")},Cr.prototype._onHashChange=function(){var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(t){return isNaN(t)}))){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},Cr.prototype._updateHashUnthrottled=function(){var e=this.getHashString();try{t.window.history.replaceState(t.window.history.state,"",e)}catch(t){}};var Dr={linearity:.3,easing:t.bezier(0,0,.3,1)},Ir=t.extend({deceleration:2500,maxSpeed:1400},Dr),kr=t.extend({deceleration:20,maxSpeed:1400},Dr),Er=t.extend({deceleration:1e3,maxSpeed:360},Dr),Ar=t.extend({deceleration:1e3,maxSpeed:90},Dr),Tr=function(t){this._map=t,this.clear()};function Rr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Mr(e,n,r){var i=r.maxSpeed,a=r.linearity,s=r.deceleration,o=t.clamp(e*a/(n/1e3),-i,i),l=Math.abs(o)/(s*a);return{easing:r.easing,duration:1e3*l,amount:o*(l/2)}}Tr.prototype.clear=function(){this._inertiaBuffer=[]},Tr.prototype.record=function(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.browser.now(),settings:e})},Tr.prototype._drainInertiaBuffer=function(){for(var e=this._inertiaBuffer,n=t.browser.now();e.length>0&&n-e[0].time>160;)e.shift()},Tr.prototype._onMoveEnd=function(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var n={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0},r=0,i=this._inertiaBuffer;r<i.length;r+=1){var a=i[r].settings;n.zoom+=a.zoomDelta||0,n.bearing+=a.bearingDelta||0,n.pitch+=a.pitchDelta||0,a.panDelta&&n.pan._add(a.panDelta),a.around&&(n.around=a.around),a.pinchAround&&(n.pinchAround=a.pinchAround)}var s=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,o={};if(n.pan.mag()){var l=Mr(n.pan.mag(),s,t.extend({},Ir,e||{}));o.offset=n.pan.mult(l.amount/n.pan.mag()),o.center=this._map.transform.center,Rr(o,l)}if(n.zoom){var u=Mr(n.zoom,s,kr);o.zoom=this._map.transform.zoom+u.amount,Rr(o,u)}if(n.bearing){var c=Mr(n.bearing,s,Er);o.bearing=this._map.transform.bearing+t.clamp(c.amount,-179,179),Rr(o,c)}if(n.pitch){var h=Mr(n.pitch,s,Ar);o.pitch=this._map.transform.pitch+h.amount,Rr(o,h)}if(o.zoom||o.bearing){var d=void 0===n.pinchAround?n.around:n.pinchAround;o.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),t.extend(o,{noMoveStart:!0})}};var Nr=function(e){function r(r,i,a,s){void 0===s&&(s={});var o=n.mousePos(i.getCanvasContainer(),a),l=i.unproject(o);e.call(this,r,t.extend({point:o,lngLat:l,originalEvent:a},s)),this._defaultPrevented=!1,this.target=i}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),Or=function(e){function r(r,i,a){var s="touchend"===r?a.changedTouches:a.touches,o=n.touchPos(i.getCanvasContainer(),s),l=o.map((function(t){return i.unproject(t)})),u=o.reduce((function(t,e,n,r){return t.add(e.div(r.length))}),new t.Point(0,0)),c=i.unproject(u);e.call(this,r,{points:o,point:u,lngLats:l,lngLat:c,originalEvent:a}),this._defaultPrevented=!1}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),Pr=function(t){function e(e,n,r){t.call(this,e,{originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),Fr=function(t,e){this._map=t,this._clickTolerance=e.clickTolerance};Fr.prototype.reset=function(){delete this._mousedownPos},Fr.prototype.wheel=function(t){return this._firePreventable(new Pr(t.type,this._map,t))},Fr.prototype.mousedown=function(t,e){return this._mousedownPos=e,this._firePreventable(new Nr(t.type,this._map,t))},Fr.prototype.mouseup=function(t){this._map.fire(new Nr(t.type,this._map,t))},Fr.prototype.click=function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Nr(t.type,this._map,t))},Fr.prototype.dblclick=function(t){return this._firePreventable(new Nr(t.type,this._map,t))},Fr.prototype.mouseover=function(t){this._map.fire(new Nr(t.type,this._map,t))},Fr.prototype.mouseout=function(t){this._map.fire(new Nr(t.type,this._map,t))},Fr.prototype.touchstart=function(t){return this._firePreventable(new Or(t.type,this._map,t))},Fr.prototype.touchmove=function(t){this._map.fire(new Or(t.type,this._map,t))},Fr.prototype.touchend=function(t){this._map.fire(new Or(t.type,this._map,t))},Fr.prototype.touchcancel=function(t){this._map.fire(new Or(t.type,this._map,t))},Fr.prototype._firePreventable=function(t){if(this._map.fire(t),t.defaultPrevented)return{}},Fr.prototype.isEnabled=function(){return!0},Fr.prototype.isActive=function(){return!1},Fr.prototype.enable=function(){},Fr.prototype.disable=function(){};var Lr=function(t){this._map=t};Lr.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Lr.prototype.mousemove=function(t){this._map.fire(new Nr(t.type,this._map,t))},Lr.prototype.mousedown=function(){this._delayContextMenu=!0},Lr.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Nr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Lr.prototype.contextmenu=function(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Nr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()},Lr.prototype.isEnabled=function(){return!0},Lr.prototype.isActive=function(){return!1},Lr.prototype.enable=function(){},Lr.prototype.disable=function(){};var zr=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1};function $r(t,e){for(var n={},r=0;r<t.length;r++)n[t[r].identifier]=e[r];return n}zr.prototype.isEnabled=function(){return!!this._enabled},zr.prototype.isActive=function(){return!!this._active},zr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},zr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},zr.prototype.mousedown=function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(n.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)},zr.prototype.mousemoveWindow=function(t,e){if(this._active){var r=e;if(!(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)){var i=this._startPos;this._lastPos=r,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var a=Math.min(i.x,r.x),s=Math.max(i.x,r.x),o=Math.min(i.y,r.y),l=Math.max(i.y,r.y);n.setTransform(this._box,"translate("+a+"px,"+o+"px)"),this._box.style.width=s-a+"px",this._box.style.height=l-o+"px"}}},zr.prototype.mouseupWindow=function(e,r){var i=this;if(this._active&&0===e.button){var a=this._startPos,s=r;if(this.reset(),n.suppressClick(),a.x!==s.x||a.y!==s.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:function(t){return t.fitScreenCoordinates(a,s,i._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",e)}},zr.prototype.keydown=function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))},zr.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},zr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var Br=function(t){this.reset(),this.numTouches=t.numTouches};Br.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Br.prototype.touchstart=function(e,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){for(var n=new t.Point(0,0),r=0,i=e;r<i.length;r+=1)n._add(i[r]);return n.div(e.length)}(n),this.touches=$r(r,n)))},Br.prototype.touchmove=function(t,e,n){if(!this.aborted&&this.centroid){var r=$r(n,e);for(var i in this.touches){var a=r[i];(!a||a.dist(this.touches[i])>30)&&(this.aborted=!0)}}},Br.prototype.touchend=function(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){var r=!this.aborted&&this.centroid;if(this.reset(),r)return r}};var Wr=function(t){this.singleTap=new Br(t),this.numTaps=t.numTaps,this.reset()};Wr.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Wr.prototype.touchstart=function(t,e,n){this.singleTap.touchstart(t,e,n)},Wr.prototype.touchmove=function(t,e,n){this.singleTap.touchmove(t,e,n)},Wr.prototype.touchend=function(t,e,n){var r=this.singleTap.touchend(t,e,n);if(r){var i=t.timeStamp-this.lastTime<500,a=!this.lastTap||this.lastTap.dist(r)<30;if(i&&a||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}};var qr=function(){this._zoomIn=new Wr({numTouches:1,numTaps:2}),this._zoomOut=new Wr({numTouches:2,numTaps:1}),this.reset()};qr.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},qr.prototype.touchstart=function(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)},qr.prototype.touchmove=function(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)},qr.prototype.touchend=function(t,e,n){var r=this,i=this._zoomIn.touchend(t,e,n),a=this._zoomOut.touchend(t,e,n);return i?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}}):a?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(a)},{originalEvent:t})}}):void 0},qr.prototype.touchcancel=function(){this.reset()},qr.prototype.enable=function(){this._enabled=!0},qr.prototype.disable=function(){this._enabled=!1,this.reset()},qr.prototype.isEnabled=function(){return this._enabled},qr.prototype.isActive=function(){return this._active};var Vr=function(t){this.reset(),this._clickTolerance=t.clickTolerance||1};Vr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Vr.prototype._correctButton=function(t,e){return!1},Vr.prototype._move=function(t,e){return{}},Vr.prototype.mousedown=function(t,e){if(!this._lastPoint){var r=n.mouseButton(t);this._correctButton(t,r)&&(this._lastPoint=e,this._eventButton=r)}},Vr.prototype.mousemoveWindow=function(t,e){var n=this._lastPoint;if(n&&(t.preventDefault(),this._moved||!(e.dist(n)<this._clickTolerance)))return this._moved=!0,this._lastPoint=e,this._move(n,e)},Vr.prototype.mouseupWindow=function(t){n.mouseButton(t)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},Vr.prototype.enable=function(){this._enabled=!0},Vr.prototype.disable=function(){this._enabled=!1,this.reset()},Vr.prototype.isEnabled=function(){return this._enabled},Vr.prototype.isActive=function(){return this._active};var Ur=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.mousedown=function(e,n){t.prototype.mousedown.call(this,e,n),this._lastPoint&&(this._active=!0)},e.prototype._correctButton=function(t,e){return 0===e&&!t.ctrlKey},e.prototype._move=function(t,e){return{around:e,panDelta:e.sub(t)}},e}(Vr),jr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Vr),Hr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Vr),Gr=function(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()};Gr.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)},Gr.prototype.touchstart=function(t,e,n){return this._calculateTransform(t,e,n)},Gr.prototype.touchmove=function(t,e,n){if(this._active)return t.preventDefault(),this._calculateTransform(t,e,n)},Gr.prototype.touchend=function(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()},Gr.prototype.touchcancel=function(){this.reset()},Gr.prototype._calculateTransform=function(e,n,r){r.length>0&&(this._active=!0);var i=$r(r,n),a=new t.Point(0,0),s=new t.Point(0,0),o=0;for(var l in i){var u=i[l],c=this._touches[l];c&&(a._add(u),s._add(u.sub(c)),o++,i[l]=u)}if(this._touches=i,!(o<this._minTouches)&&s.mag()){var h=s.div(o);if(this._sum._add(h),!(this._sum.mag()<this._clickTolerance))return{around:a.div(o),panDelta:h}}},Gr.prototype.enable=function(){this._enabled=!0},Gr.prototype.disable=function(){this._enabled=!1,this.reset()},Gr.prototype.isEnabled=function(){return this._enabled},Gr.prototype.isActive=function(){return this._active};var Jr=function(){this.reset()};function Xr(t,e,n){for(var r=0;r<t.length;r++)if(t[r].identifier===n)return e[r]}function Kr(t,e){return Math.log(t/e)/Math.LN2}Jr.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Jr.prototype._start=function(t){},Jr.prototype._move=function(t,e,n){return{}},Jr.prototype.touchstart=function(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))},Jr.prototype.touchmove=function(t,e,n){if(this._firstTwoTouches){t.preventDefault();var r=this._firstTwoTouches,i=r[1],a=Xr(n,e,r[0]),s=Xr(n,e,i);if(a&&s){var o=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],o,t)}}},Jr.prototype.touchend=function(t,e,r){if(this._firstTwoTouches){var i=this._firstTwoTouches,a=i[1],s=Xr(r,e,i[0]),o=Xr(r,e,a);s&&o||(this._active&&n.suppressClick(),this.reset())}},Jr.prototype.touchcancel=function(){this.reset()},Jr.prototype.enable=function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around},Jr.prototype.disable=function(){this._enabled=!1,this.reset()},Jr.prototype.isEnabled=function(){return this._enabled},Jr.prototype.isActive=function(){return this._active};var Zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._distance,delete this._startDistance},e.prototype._start=function(t){this._startDistance=this._distance=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Kr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Kr(this._distance,n),pinchAround:e}},e}(Jr);function Yr(t,e){return 180*t.angleWith(e)/Math.PI}var Qr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},e.prototype._start=function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Yr(this._vector,n),pinchAround:e}},e.prototype._isBelowThreshold=function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,n=Yr(t,this._startVector);return Math.abs(n)<e},e}(Jr);function ti(t){return Math.abs(t.y)>Math.abs(t.x)}var ei=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},e.prototype._start=function(t){this._lastPoints=t,ti(t[0].sub(t[1]))&&(this._valid=!1)},e.prototype._move=function(t,e,n){var r=t[0].sub(this._lastPoints[0]),i=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(r,i,n.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+i.y)/2*-.5}},e.prototype.gestureBeginsVertically=function(t,e,n){if(void 0!==this._valid)return this._valid;var r=t.mag()>=2,i=e.mag()>=2;if(r||i){if(!r||!i)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;var a=t.y>0==e.y>0;return ti(t)&&ti(e)&&a}},e}(Jr),ni={panStep:100,bearingStep:15,pitchStep:10},ri=function(){var t=ni;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep};function ii(t){return t*(2-t)}ri.prototype.reset=function(){this._active=!1},ri.prototype.keydown=function(t){var e=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var n=0,r=0,i=0,a=0,s=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),a=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),a=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),s=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),s=1);break;default:return}return{cameraAnimation:function(o){var l=o.getZoom();o.easeTo({duration:300,easeId:"keyboardHandler",easing:ii,zoom:n?Math.round(l)+n*(t.shiftKey?2:1):l,bearing:o.getBearing()+r*e._bearingStep,pitch:o.getPitch()+i*e._pitchStep,offset:[-a*e._panStep,-s*e._panStep],center:o.getCenter()},{originalEvent:t})}}}},ri.prototype.enable=function(){this._enabled=!0},ri.prototype.disable=function(){this._enabled=!1,this.reset()},ri.prototype.isEnabled=function(){return this._enabled},ri.prototype.isActive=function(){return this._active};var ai=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};ai.prototype.setZoomRate=function(t){this._defaultZoomRate=t},ai.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},ai.prototype.isEnabled=function(){return!!this._enabled},ai.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},ai.prototype.isZooming=function(){return!!this._zooming},ai.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},ai.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ai.prototype.wheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=t.browser.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}},ai.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},ai.prototype._start=function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var r=n.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ai.prototype.renderFrame=function(){return this._onScrollFrame()},ai.prototype._onScrollFrame=function(){var e=this;if(this._frameId&&(this._frameId=null,this.isActive())){var n=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var a="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(a*i))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var s,o="number"==typeof this._targetZoom?this._targetZoom:n.zoom,l=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&l&&u){var h=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),d=u(h);s=t.number(l,o,d),h<1?this._frameId||(this._frameId=!0):c=!0}else s=o,c=!0;return this._active=!0,c&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._handler._triggerRenderFrame(),delete e._targetZoom,delete e._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!c,zoomDelta:s-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ai.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var r=this._prevEase,i=(t.browser.now()-r.start)/r.duration,a=r.easing(i+.01)-r.easing(i),s=.27/Math.sqrt(a*a+1e-4)*.01,o=Math.sqrt(.0729-s*s);n=t.bezier(s,o,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:n},n},ai.prototype.reset=function(){this._active=!1};var si=function(t,e){this._clickZoom=t,this._tapZoom=e};si.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},si.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},si.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},si.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var oi=function(){this.reset()};oi.prototype.reset=function(){this._active=!1},oi.prototype.dblclick=function(t,e){return t.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}},oi.prototype.enable=function(){this._enabled=!0},oi.prototype.disable=function(){this._enabled=!1,this.reset()},oi.prototype.isEnabled=function(){return this._enabled},oi.prototype.isActive=function(){return this._active};var li=function(){this._tap=new Wr({numTouches:1,numTaps:1}),this.reset()};li.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},li.prototype.touchstart=function(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))},li.prototype.touchmove=function(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var r=e[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(t,e,n)},li.prototype.touchend=function(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)},li.prototype.touchcancel=function(){this.reset()},li.prototype.enable=function(){this._enabled=!0},li.prototype.disable=function(){this._enabled=!1,this.reset()},li.prototype.isEnabled=function(){return this._enabled},li.prototype.isActive=function(){return this._active};var ui=function(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n};ui.prototype.enable=function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ui.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ui.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ui.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ci=function(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n};ci.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ci.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ci.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ci.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var hi=function(t,e,n,r){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0};hi.prototype.enable=function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},hi.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},hi.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},hi.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},hi.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},hi.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var di=function(t){return t.zoom||t.drag||t.pitch||t.rotate},pi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(t.Event);function fi(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}var mi=function(e,r){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tr(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r),t.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!1}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[t.window,"blur",void 0]];for(var a=0,s=this._listeners;a<s.length;a+=1){var o=s[a],l=o[0];n.addEventListener(l,o[1],l===t.window.document?this.handleWindowEvent:this.handleEvent,o[2])}};mi.prototype.destroy=function(){for(var e=0,r=this._listeners;e<r.length;e+=1){var i=r[e],a=i[0];n.removeEventListener(a,i[1],a===t.window.document?this.handleWindowEvent:this.handleEvent,i[2])}},mi.prototype._addDefaultHandlers=function(t){var e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Fr(e,t));var r=e.boxZoom=new zr(e,t);this._add("boxZoom",r);var i=new qr,a=new oi;e.doubleClickZoom=new si(a,i),this._add("tapZoom",i),this._add("clickZoom",a);var s=new li;this._add("tapDragZoom",s);var o=e.touchPitch=new ei;this._add("touchPitch",o);var l=new jr(t),u=new Hr(t);e.dragRotate=new ci(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new Ur(t),h=new Gr(t);e.dragPan=new ui(n,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);var d=new Qr,p=new Zr;e.touchZoomRotate=new hi(n,p,d,s),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]);var f=e.scrollZoom=new ai(e,this);this._add("scrollZoom",f,["mousePan"]);var m=e.keyboard=new ri;this._add("keyboard",m),this._add("blockableMapEvent",new Lr(e));for(var g=0,y=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];g<y.length;g+=1){var v=y[g];t.interactive&&t[v]&&e[v].enable(t[v])}},mi.prototype._add=function(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e},mi.prototype.stop=function(){if(!this._updatingCamera){for(var t=0,e=this._handlers;t<e.length;t+=1)e[t].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},mi.prototype.isActive=function(){for(var t=0,e=this._handlers;t<e.length;t+=1)if(e[t].handler.isActive())return!0;return!1},mi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},mi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},mi.prototype.isMoving=function(){return Boolean(di(this._eventsInProgress))||this.isZooming()},mi.prototype._blockedByActive=function(t,e,n){for(var r in t)if(r!==n&&(!e||e.indexOf(r)<0))return!0;return!1},mi.prototype.handleWindowEvent=function(t){this.handleEvent(t,t.type+"Window")},mi.prototype._getMapTouches=function(t){for(var e=[],n=0,r=t;n<r.length;n+=1){var i=r[n];this._el.contains(i.target)&&e.push(i)}return e},mi.prototype.handleEvent=function(t,e){if("blur"!==t.type){this._updatingCamera=!0;for(var r="renderFrame"===t.type?void 0:t,i={needsRenderFrame:!1},a={},s={},o=t.touches?this._getMapTouches(t.touches):void 0,l=o?n.touchPos(this._el,o):n.mousePos(this._el,t),u=0,c=this._handlers;u<c.length;u+=1){var h=c[u],d=h.handlerName,p=h.handler,f=h.allowed;if(p.isEnabled()){var m=void 0;this._blockedByActive(s,f,d)?p.reset():p[e||t.type]&&(m=p[e||t.type](t,l,o),this.mergeHandlerResult(i,a,m,d,r),m&&m.needsRenderFrame&&this._triggerRenderFrame()),(m||p.isActive())&&(s[d]=p)}}var g={};for(var y in this._previousActiveHandlers)s[y]||(g[y]=r);this._previousActiveHandlers=s,(Object.keys(g).length||fi(i))&&(this._changes.push([i,a,g]),this._triggerRenderFrame()),(Object.keys(s).length||fi(i))&&this._map._stop(!0),this._updatingCamera=!1;var v=i.cameraAnimation;v&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],v(this._map))}else this.stop()},mi.prototype.mergeHandlerResult=function(e,n,r,i,a){if(r){t.extend(e,r);var s={handlerName:i,originalEvent:r.originalEvent||a};void 0!==r.zoomDelta&&(n.zoom=s),void 0!==r.panDelta&&(n.drag=s),void 0!==r.pitchDelta&&(n.pitch=s),void 0!==r.bearingDelta&&(n.rotate=s)}},mi.prototype._applyChanges=function(){for(var e={},n={},r={},i=0,a=this._changes;i<a.length;i+=1){var s=a[i],o=s[0],l=s[1],u=s[2];o.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(o.panDelta)),o.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+o.zoomDelta),o.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+o.bearingDelta),o.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+o.pitchDelta),void 0!==o.around&&(e.around=o.around),void 0!==o.pinchAround&&(e.pinchAround=o.pinchAround),o.noInertia&&(e.noInertia=o.noInertia),t.extend(n,l),t.extend(r,u)}this._updateMapTransform(e,n,r),this._changes=[]},mi.prototype._updateMapTransform=function(t,e,n){var r=this._map,i=r.transform;if(!fi(t))return this._fireEvents(e,n);var a=t.panDelta,s=t.zoomDelta,o=t.bearingDelta,l=t.pitchDelta,u=t.around,c=t.pinchAround;void 0!==c&&(u=c),r._stop(!0),u=u||r.transform.centerPoint;var h=i.pointLocation(a?u.sub(a):u);o&&(i.bearing+=o),l&&(i.pitch+=l),s&&(i.zoom+=s),i.setLocationAtPoint(h,u),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,n)},mi.prototype._fireEvents=function(e,n){var r=this,i=di(this._eventsInProgress),a=di(e),s={};for(var o in e)this._eventsInProgress[o]||(s[o+"start"]=e[o].originalEvent),this._eventsInProgress[o]=e[o];for(var l in!i&&a&&this._fireEvent("movestart",a.originalEvent),s)this._fireEvent(l,s[l]);for(var u in e.rotate&&(this._bearingChanged=!0),a&&this._fireEvent("move",a.originalEvent),e)this._fireEvent(u,e[u].originalEvent);var c,h={};for(var d in this._eventsInProgress){var p=this._eventsInProgress[d],f=p.handlerName,m=p.originalEvent;this._handlersById[f].isActive()||(delete this._eventsInProgress[d],h[d+"end"]=c=n[f]||m)}for(var g in h)this._fireEvent(g,h[g]);var y=di(this._eventsInProgress);if((i||a)&&!y){this._updatingCamera=!0;var v=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=function(t){return 0!==t&&-r._bearingSnap<t&&t<r._bearingSnap};v?(_(v.bearing||this._map.getBearing())&&(v.bearing=0),this._map.easeTo(v,{originalEvent:c})):(this._map.fire(new t.Event("moveend",{originalEvent:c})),_(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},mi.prototype._fireEvent=function(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},mi.prototype._triggerRenderFrame=function(){var t=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame((function(e){delete t._frameId,t.handleEvent(new pi("renderFrame",{timeStamp:e})),t._applyChanges()})))};var gi=function(e){function n(n,r){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=r.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCenter=function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,r){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)},n.prototype.panTo=function(e,n,r){return this.easeTo(t.extend({center:e},n),r)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.getPadding=function(){return this.transform.padding},n.prototype.setPadding=function(t,e){return this.jumpTo({padding:t},e),this},n.prototype.rotateTo=function(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.resetNorthPitch=function(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(e,n){return e=t.LngLatBounds.convert(e),this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),0,n)},n.prototype._cameraForBoxAndBearing=function(e,n,r,i){var a={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.extend({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var s=i.padding;i.padding={top:s,bottom:s,right:s,left:s}}i.padding=t.extend(a,i.padding);var o=this.transform,l=o.padding,u=o.project(t.LngLat.convert(e)),c=o.project(t.LngLat.convert(n)),h=u.rotate(-r*Math.PI/180),d=c.rotate(-r*Math.PI/180),p=new t.Point(Math.max(h.x,d.x),Math.max(h.y,d.y)),f=new t.Point(Math.min(h.x,d.x),Math.min(h.y,d.y)),m=p.sub(f),g=(o.width-(l.left+l.right+i.padding.left+i.padding.right))/m.x,y=(o.height-(l.top+l.bottom+i.padding.top+i.padding.bottom))/m.y;if(!(y<0||g<0)){var v=Math.min(o.scaleZoom(o.scale*Math.min(g,y)),i.maxZoom),_=t.Point.convert(i.offset),b=new t.Point(_.x+(i.padding.left-i.padding.right)/2,_.y+(i.padding.top-i.padding.bottom)/2).mult(o.scale/o.zoomScale(v));return{center:o.unproject(u.add(c).div(2).sub(b)),zoom:v,bearing:r}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},n.prototype.fitBounds=function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)},n.prototype.fitScreenCoordinates=function(e,n,r,i,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(n)),r,i),i,a)},n.prototype._fitInternal=function(e,n,r){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this},n.prototype.jumpTo=function(e,n){this.stop();var r=this.transform,i=!1,a=!1,s=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(a=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(s=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),a&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),s&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var r=this;this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.browser.prefersReducedMotion)&&(e.duration=0);var i=this.transform,a=this.getZoom(),s=this.getBearing(),o=this.getPitch(),l=this.getPadding(),u="zoom"in e?+e.zoom:a,c="bearing"in e?this._normalizeBearing(e.bearing,s):s,h="pitch"in e?+e.pitch:o,d="padding"in e?e.padding:i.padding,p=t.Point.convert(e.offset),f=i.centerPoint.add(p),m=i.pointLocation(f),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);var y,v,_=i.project(m),b=i.project(g).sub(_),x=i.zoomScale(u-a);e.around&&(y=t.LngLat.convert(e.around),v=i.locationPoint(y));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||u!==a,this._rotating=this._rotating||s!==c,this._pitching=this._pitching||h!==o,this._padding=!i.isPaddingEqual(d),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,w),clearTimeout(this._easeEndTimeoutID),this._ease((function(e){if(r._zooming&&(i.zoom=t.number(a,u,e)),r._rotating&&(i.bearing=t.number(s,c,e)),r._pitching&&(i.pitch=t.number(o,h,e)),r._padding&&(i.interpolatePadding(l,d,e),f=i.centerPoint.add(p)),y)i.setLocationAtPoint(y,v);else{var m=i.zoomScale(i.zoom-a),g=u>a?Math.min(2,x):Math.max(.5,x),w=Math.pow(g,1-e),S=i.unproject(_.add(b.mult(e*w)).mult(m));i.setLocationAtPoint(i.renderWorldCopies?S.wrap():S,f)}r._fireMoveEvents(n)}),(function(t){r._afterEase(n,t)}),e),this},n.prototype._prepareEase=function(e,n,r){void 0===r&&(r={}),this._moving=!0,n||r.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e,n){if(!this._easeId||!n||this._easeId!==n){delete this._easeId;var r=this._zooming,i=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),i&&this.fire(new t.Event("rotateend",e)),a&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}},n.prototype.flyTo=function(e,n){var r=this;if(!e.essential&&t.browser.prefersReducedMotion){var i=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var a=this.transform,s=this.getZoom(),o=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="zoom"in e?t.clamp(+e.zoom,a.minZoom,a.maxZoom):s,h="bearing"in e?this._normalizeBearing(e.bearing,o):o,d="pitch"in e?+e.pitch:l,p="padding"in e?e.padding:a.padding,f=a.zoomScale(c-s),m=t.Point.convert(e.offset),g=a.centerPoint.add(m),y=a.pointLocation(g),v=t.LngLat.convert(e.center||y);this._normalizeCenter(v);var _=a.project(y),b=a.project(v).sub(_),x=e.curve,w=Math.max(a.width,a.height),S=w/f,C=b.mag();if("minZoom"in e){var D=t.clamp(Math.min(e.minZoom,s,c),a.minZoom,a.maxZoom),I=w/a.zoomScale(D-s);x=Math.sqrt(I/C*2)}var k=x*x;function E(t){var e=(S*S-w*w+(t?-1:1)*k*k*C*C)/(2*(t?S:w)*k*C);return Math.log(Math.sqrt(e*e+1)-e)}function A(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}var R=E(0),M=function(t){return T(R)/T(R+x*t)},N=function(t){return w*((T(R)*(A(e=R+x*t)/T(e))-A(R))/k)/C;var e},O=(E(1)-R)/x;if(Math.abs(C)<1e-6||!isFinite(O)){if(Math.abs(w-S)<1e-6)return this.easeTo(e,n);var P=S<w?-1:1;O=Math.abs(Math.log(S/w))/x,N=function(){return 0},M=function(t){return Math.exp(P*x*t)}}return e.duration="duration"in e?+e.duration:1e3*O/("screenSpeed"in e?+e.screenSpeed/x:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==h,this._pitching=d!==l,this._padding=!a.isPaddingEqual(p),this._prepareEase(n,!1),this._ease((function(e){var i=e*O,f=1/M(i);a.zoom=1===e?c:s+a.scaleZoom(f),r._rotating&&(a.bearing=t.number(o,h,e)),r._pitching&&(a.pitch=t.number(l,d,e)),r._padding&&(a.interpolatePadding(u,p,e),g=a.centerPoint.add(m));var y=1===e?v:a.unproject(_.add(b.mult(N(i))).mult(f));a.setLocationAtPoint(a.renderWorldCopies?y.wrap():y,g),r._fireMoveEvents(n)}),(function(){return r._afterEase(n)}),e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){return this._stop()},n.prototype._stop=function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var n=this._onEaseEnd;delete this._onEaseEnd,n.call(this,e)}if(!t){var r=this.handlers;r&&r.stop()}return this},n.prototype._ease=function(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.browser.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),yi=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};yi.prototype.getDefaultPosition=function(){return"bottom-right"},yi.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},yi.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},yi.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){var r=n.reduce((function(t,e,r){return e.value&&(t+=e.key+"="+e.value+(r<n.length-1?"&":"")),t}),"?");e.href=t.config.FEEDBACK_URL+"/"+r+(this._map._hash?this._map._hash.getHashString(!0):""),e.rel="noopener nofollow"}},yi.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},yi.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var r in n){var i=n[r];if(i.used){var a=i.getSource();a.attribution&&t.indexOf(a.attribution)<0&&t.push(a.attribution)}}t.sort((function(t,e){return t.length-e.length}));var s=(t=t.filter((function(e,n){for(var r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}))).join(" | ");s!==this._attribHTML&&(this._attribHTML=s,t.length?(this._innerContainer.innerHTML=s,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},yi.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var vi=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};vi.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},vi.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},vi.prototype.getDefaultPosition=function(){return"bottom-left"},vi.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},vi.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},vi.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var _i=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};_i.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},_i.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,r=e?this._queue.concat(e):this._queue;n<r.length;n+=1){var i=r[n];if(i.id===t)return void(i.cancelled=!0)}},_i.prototype.run=function(t){void 0===t&&(t=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,r=e;n<r.length;n+=1){var i=r[n];if(!i.cancelled&&(i.callback(t),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},_i.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var bi={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},xi=t.window.HTMLImageElement,wi=t.window.HTMLElement,Si=t.window.ImageBitmap,Ci={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Di=function(r){function i(e){var n=this;if(null!=(e=t.extend({},Ci,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var i=new wr(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(r.call(this,i,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new _i,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},bi,e.locale),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken),"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof wi))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return n._update(!1)})),this.on("moveend",(function(){return n._update(!1)})),this.on("zoom",(function(){return n._update(!0)})),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new mi(this,e),this._hash=e.hash&&new Cr("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new yi({customAttribution:e.customAttribution})),this.addControl(new vi,e.logoPosition),this.on("style.load",(function(){n.transform.unmodified&&n.jumpTo(n.style.stylesheet)})),this.on("data",(function(e){n._update("style"===e.dataType),n.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(function(e){n.fire(new t.Event(e.dataType+"dataloading",e))}))}r&&(i.__proto__=r),(i.prototype=Object.create(r&&r.prototype)).constructor=i;var a={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(e,n){if(void 0===n&&e.getDefaultPosition&&(n=e.getDefaultPosition()),void 0===n&&(n="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this},i.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this},i.prototype.resize=function(e){var n=this._containerDimensions(),r=n[0],i=n[1];this._resizeCanvas(r,i),this.transform.resize(r,i),this.painter.resize(r,i);var a=!this._moving;return a&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),a&&this.fire(new t.Event("moveend",e)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},i.prototype.setMinZoom=function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.setMinPitch=function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},i.prototype.getMinPitch=function(){return this.transform.minPitch},i.prototype.setMaxPitch=function(t){if((t=null==t?60:t)>60)throw new Error("maxPitch must be less than or equal to 60");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},i.prototype.getMaxPitch=function(){return this.transform.maxPitch},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},i.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},i.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},i.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},i.prototype._createDelegatedListener=function(t,e,n){var r,i=this;if("mouseenter"===t||"mouseover"===t){var a=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){var s=i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[];s.length?a||(a=!0,n.call(i,new Nr(t,i,r.originalEvent,{features:s}))):a=!1},mouseout:function(){a=!1}}}}if("mouseleave"===t||"mouseout"===t){var s=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){(i.getLayer(e)?i.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?s=!0:s&&(s=!1,n.call(i,new Nr(t,i,r.originalEvent)))},mouseout:function(e){s&&(s=!1,n.call(i,new Nr(t,i,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(r={},r[t]=function(t){var r=i.getLayer(e)?i.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(i,t),delete t.features)},r)}},i.prototype.on=function(t,e,n){if(void 0===n)return r.prototype.on.call(this,t,e);var i=this._createDelegatedListener(t,e,n);for(var a in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i),i.delegates)this.on(a,i.delegates[a]);return this},i.prototype.once=function(t,e,n){if(void 0===n)return r.prototype.once.call(this,t,e);var i=this._createDelegatedListener(t,e,n);for(var a in i.delegates)this.once(a,i.delegates[a]);return this},i.prototype.off=function(t,e,n){var i=this;return void 0===n?r.prototype.off.call(this,t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&function(r){for(var a=r[t],s=0;s<a.length;s++){var o=a[s];if(o.layer===e&&o.listener===n){for(var l in o.delegates)i.off(l,o.delegates[l]);return a.splice(s,1),i}}}(this._delegatedListeners),this)},i.prototype.queryRenderedFeatures=function(e,n){if(!this.style)return[];var r;if(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])r=[t.Point.convert(e)];else{var i=t.Point.convert(e[0]),a=t.Point.convert(e[1]);r=[i,new t.Point(a.x,i.y),a,new t.Point(i.x,a.y),i]}return this.style.queryRenderedFeatures(r,n,this.transform)},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))},i.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},i.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new Ve(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},i.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ve(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},i.prototype._diffStyle=function(e,n){var r=this;if("string"==typeof e){var i=this._requestManager.normalizeStyleURL(e),a=this._requestManager.transformRequest(i,t.ResourceType.Style);t.getJSON(a,(function(e,i){e?r.fire(new t.ErrorEvent(e)):i&&r._updateDiff(i,n)}))}else"object"==typeof e&&this._updateDiff(e,n)},i.prototype._updateDiff=function(e,n){try{this.style.setState(e)&&this._update(!0)}catch(r){t.warnOnce("Unable to perform style diff: "+(r.message||r.error||r)+".  Rebuilding the style from scratch."),this._updateStyle(e,n)}},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)},i.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var r in n){var i=n[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,n,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var a=r.sdf;void 0===a&&(a=!1);var s=r.stretchX,o=r.stretchY,l=r.content;if(this._lazyInitEmptyStyle(),n instanceof xi||Si&&n instanceof Si){var u=t.browser.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:u.width,height:u.height},u.data),pixelRatio:i,stretchX:s,stretchY:o,content:l,sdf:a,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=n;this.style.addImage(e,{data:new t.RGBAImage({width:n.width,height:n.height},new Uint8Array(n.data)),pixelRatio:i,stretchX:s,stretchY:o,content:l,sdf:a,version:0,userImage:c}),c.onAdd&&c.onAdd(this,e)}},i.prototype.updateImage=function(e,n){var r=this.style.getImage(e);if(!r)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var i=n instanceof xi||Si&&n instanceof Si?t.browser.getImageData(n):n,a=i.width,s=i.height,o=i.data;return void 0===a||void 0===s?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):a!==r.data.width||s!==r.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(r.data.replace(o,!(n instanceof xi||Si&&n instanceof Si)),void this.style.updateImage(e,r))},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)},i.prototype.setFilter=function(t,e,n){return void 0===n&&(n={}),this.style.setFilter(t,e,n),this._update(!0)},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,n,r){return void 0===r&&(r={}),this.style.setPaintProperty(t,e,n,r),this._update(!0)},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,n,r){return void 0===r&&(r={}),this.style.setLayoutProperty(t,e,n,r),this._update(!0)},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t,e){return void 0===e&&(e={}),this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},i.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},i.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var i=this._controlContainer=n.create("div","mapboxgl-control-container",t),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){a[t]=n.create("div","mapboxgl-ctrl-"+t,i)}))},i.prototype._resizeCanvas=function(e,n){var r=t.browser.devicePixelRatio||1;this._canvas.width=r*e,this._canvas.height=r*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},i.prototype._setupPainter=function(){var n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(this.painter=new vr(r,this.transform),t.webpSupported.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(e){var n,r=this,i=0,a=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=a.createQueryEXT(),a.beginQueryEXT(a.TIME_ELAPSED_EXT,n),i=t.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){var s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var o=this.transform.zoom,l=t.browser.now();this.style.zoomHistory.update(o,l);var u=new t.EvaluationParameters(o,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();1===c&&c===this._crossFadingFactor||(s=!0,this._crossFadingFactor=c),this.style.update(u)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var h=t.browser.now()-i;a.endQueryEXT(a.TIME_ELAPSED_EXT,n),setTimeout((function(){var e=a.getQueryObjectEXT(n,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(n),r.fire(new t.Event("gpu-timing-frame",{cpuTime:h,gpuTime:e}))}),50)}if(this.listens("gpu-timing-layer")){var d=this.painter.collectGpuTimers();setTimeout((function(){var e=r.painter.queryGpuTimers(d);r.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new t.Event("idle"))),this}},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,n=this._controls;e<n.length;e+=1)n[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),Ii(this._canvasContainer),Ii(this._controlContainer),Ii(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new t.Event("remove"))},i.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame((function(t){e._frame=null,e._render(t)})))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},a.showTileBoundaries.get=function(){return!!this._showTileBoundaries},a.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},a.showPadding.get=function(){return!!this._showPadding},a.showPadding.set=function(t){this._showPadding!==t&&(this._showPadding=t,this._update())},a.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},a.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},a.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},a.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},a.repaint.get=function(){return!!this._repaint},a.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},a.vertices.get=function(){return!!this._vertices},a.vertices.set=function(t){this._vertices=t,this._update()},i.prototype._setCacheLimits=function(e,n){t.setCacheLimits(e,n)},a.version.get=function(){return t.version},Object.defineProperties(i.prototype,a),i}(gi);function Ii(t){t.parentNode&&t.parentNode.removeChild(t)}var ki={showCompass:!0,showZoom:!0,visualizePitch:!1},Ei=function(e){var r=this;this.options=t.extend({},ki,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(t){return r._map.zoomIn({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(t){return r._map.zoomOut({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(t){r.options.visualizePitch?r._map.resetNorthPitch({},{originalEvent:t}):r._map.resetNorth({},{originalEvent:t})})),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ei.prototype._updateZoomButtons=function(){var t=this._map.getZoom();this._zoomInButton.disabled=t===this._map.getMaxZoom(),this._zoomOutButton.disabled=t===this._map.getMinZoom()},Ei.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},Ei.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ai(this._map,this._compass,this.options.visualizePitch)),this._container},Ei.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ei.prototype._createButton=function(t,e){var r=n.create("button",t,this._container);return r.type="button",r.addEventListener("click",e),r},Ei.prototype._setButtonTitle=function(t,e){var n=this._map._getUIString("NavigationControl."+e);t.title=n,t.setAttribute("aria-label",n)};var Ai=function(e,r,i){void 0===i&&(i=!1),this._clickTolerance=10,this.element=r,this.mouseRotate=new jr({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new Hr({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(r,"mousedown",this.mousedown),n.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(r,"touchmove",this.touchmove),n.addEventListener(r,"touchend",this.touchend),n.addEventListener(r,"touchcancel",this.reset)};function Ti(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){var i=new t.LngLat(e.lng-360,e.lat),a=new t.LngLat(e.lng+360,e.lat),s=r.locationPoint(e).distSqr(n);r.locationPoint(i).distSqr(n)<s?e=i:r.locationPoint(a).distSqr(n)<s&&(e=a)}for(;Math.abs(e.lng-r.center.lng)>180;){var o=r.locationPoint(e);if(o.x>=0&&o.y>=0&&o.x<=r.width&&o.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}Ai.prototype.down=function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),n.disableDrag()},Ai.prototype.move=function(t,e){var n=this.map,r=this.mouseRotate.mousemoveWindow(t,e);if(r&&r.bearingDelta&&n.setBearing(n.getBearing()+r.bearingDelta),this.mousePitch){var i=this.mousePitch.mousemoveWindow(t,e);i&&i.pitchDelta&&n.setPitch(n.getPitch()+i.pitchDelta)}},Ai.prototype.off=function(){var t=this.element;n.removeEventListener(t,"mousedown",this.mousedown),n.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(t,"touchmove",this.touchmove),n.removeEventListener(t,"touchend",this.touchend),n.removeEventListener(t,"touchcancel",this.reset),this.offTemp()},Ai.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(t.window,"mousemove",this.mousemove),n.removeEventListener(t.window,"mouseup",this.mouseup)},Ai.prototype.mousedown=function(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:function(){return e.preventDefault()}}),n.mousePos(this.element,e)),n.addEventListener(t.window,"mousemove",this.mousemove),n.addEventListener(t.window,"mouseup",this.mouseup)},Ai.prototype.mousemove=function(t){this.move(t,n.mousePos(this.element,t))},Ai.prototype.mouseup=function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()},Ai.prototype.touchstart=function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))},Ai.prototype.touchmove=function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))},Ai.prototype.touchend=function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ai.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ri={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mi(t,e,n){var r=t.classList;for(var i in Ri)r.remove("mapboxgl-"+n+"-anchor-"+i);r.add("mapboxgl-"+n+"-anchor-"+e)}var Ni,Oi=function(e){function r(r,i){var a=this;if(e.call(this),(r instanceof t.window.HTMLElement||i)&&(r=t.extend({element:r},i)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._draggable=r&&r.draggable||!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&"auto"!==r.pitchAlignment?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=t.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var s=n.createNS("http://www.w3.org/2000/svg","svg");s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height","41px"),s.setAttributeNS(null,"width","27px"),s.setAttributeNS(null,"viewBox","0 0 27 41");var o=n.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");var l=n.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill-rule","nonzero");var u=n.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"transform","translate(3.0, 29.0)"),u.setAttributeNS(null,"fill","#000000");for(var c=0,h=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];c<h.length;c+=1){var d=h[c],p=n.createNS("http://www.w3.org/2000/svg","ellipse");p.setAttributeNS(null,"opacity","0.04"),p.setAttributeNS(null,"cx","10.5"),p.setAttributeNS(null,"cy","5.80029008"),p.setAttributeNS(null,"rx",d.rx),p.setAttributeNS(null,"ry",d.ry),u.appendChild(p)}var f=n.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"fill",this._color);var m=n.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),f.appendChild(m);var g=n.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"fill","#000000");var y=n.createNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),g.appendChild(y);var v=n.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");var _=n.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(8.0, 8.0)");var b=n.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#000000"),b.setAttributeNS(null,"opacity","0.25"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962");var x=n.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#FFFFFF"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962"),_.appendChild(b),_.appendChild(x),l.appendChild(u),l.appendChild(f),l.appendChild(g),l.appendChild(v),l.appendChild(_),s.appendChild(l),this._element.appendChild(s),this._offset=t.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(t){t.preventDefault()})),this._element.addEventListener("mousedown",(function(t){t.preventDefault()})),this._element.addEventListener("focus",(function(){var t=a._map.getContainer();t.scrollTop=0,t.scrollLeft=0})),Mi(this._element,this._anchor,"marker"),this._popup=null}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},r.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},r.prototype.getElement=function(){return this._element},r.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},r.prototype._onKeyPress=function(t){var e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()},r.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},r.prototype.getPopup=function(){return this._popup},r.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},r.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ti(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,Ri[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+r+" "+e)}},r.prototype.getOffset=function(){return this._offset},r.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},r.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},r.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},r.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},r.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},r.prototype.isDraggable=function(){return this._draggable},r.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},r.prototype.getRotation=function(){return this._rotation},r.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},r.prototype.getRotationAlignment=function(){return this._rotationAlignment},r.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},r.prototype.getPitchAlignment=function(){return this._pitchAlignment},r}(t.Evented),Pi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Fi=0,Li=!1,zi=function(e){function r(n){e.call(this),this.options=t.extend({},Pi,n),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.onAdd=function(e){var r;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==Ni?r(Ni):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((function(t){r(Ni="denied"!==t.state)})):r(Ni=!!t.window.navigator.geolocation),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Fi=0,Li=!1},r.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())},r.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},r.prototype._onSuccess=function(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}},r.prototype._updateCamera=function(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,i=this._map.getBearing(),a=t.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),a,{geolocateSource:!0})},r.prototype._updateMarker=function(e){if(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},r.prototype._updateCircleRadius=function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([1,t]),r=e.distanceTo(n),i=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=i+"px",this._circleElement.style.height=i+"px"},r.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},r.prototype._onError=function(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Li)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(e){var r=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{var a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Oi(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Oi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==r._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new t.Event("trackuserlocationend")))}))},r.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Fi--,Li=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Fi>1?(e={maximumAge:6e5,timeout:0},Li=!0):(e=this.options.positionOptions,Li=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(t.Evented),$i={maxWidth:100,unit:"metric"},Bi=function(e){this.options=t.extend({},$i,e),t.bindAll(["_onMove","setUnit"],this)};function Wi(t,e,n){var r=n&&n.maxWidth||100,i=t._container.clientHeight/2,a=t.unproject([0,i]),s=t.unproject([r,i]),o=a.distanceTo(s);if(n&&"imperial"===n.unit){var l=3.2808*o;l>5280?qi(e,r,l/5280,t._getUIString("ScaleControl.Miles")):qi(e,r,l,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?qi(e,r,o/1852,t._getUIString("ScaleControl.NauticalMiles")):o>=1e3?qi(e,r,o/1e3,t._getUIString("ScaleControl.Kilometers")):qi(e,r,o,t._getUIString("ScaleControl.Meters"))}function qi(t,e,n,r){var i,a,s,o=(i=n,(a=Math.pow(10,(""+Math.floor(i)).length-1))*(s=(s=i/a)>=10?10:s>=5?5:s>=3?3:s>=2?2:s>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(s)));t.style.width=e*(o/n)+"px",t.innerHTML=o+"&nbsp;"+r}Bi.prototype.getDefaultPosition=function(){return"bottom-left"},Bi.prototype._onMove=function(){Wi(this._map,this._container,this.options)},Bi.prototype.onAdd=function(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Bi.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Bi.prototype.setUnit=function(t){this.options.unit=t,Wi(this._map,this._container,this.options)};var Vi=function(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange")};Vi.prototype.onAdd=function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Vi.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Vi.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},Vi.prototype._setupUI=function(){var e=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Vi.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},Vi.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Vi.prototype._isFullscreen=function(){return this._fullscreen},Vi.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Vi.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ui={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},ji=function(e){function r(n){e.call(this),this.options=t.extend(Object.create(Ui),n),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.addTo=function(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},r.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},r.prototype.getElement=function(){return this._container},r.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},r.prototype.setHTML=function(e){var n,r=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");for(i.innerHTML=e;n=i.firstChild;)r.appendChild(n);return this.setDOMContent(r)},r.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},r.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},r.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},r.prototype.addClassName=function(t){this._container&&this._container.classList.add(t)},r.prototype.removeClassName=function(t){this._container&&this._container.classList.remove(t)},r.prototype.toggleClassName=function(t){if(this._container)return this._container.classList.toggle(t)},r.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},r.prototype._onMouseUp=function(t){this._update(t.point)},r.prototype._onMouseMove=function(t){this._update(t.point)},r.prototype._onDrag=function(t){this._update(t.point)},r.prototype._update=function(e){var r=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return r._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ti(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var i=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),a=this.options.anchor,s=function e(n){if(n){if("number"==typeof n){var r=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.Point(0,0),top:new t.Point(0,n),"top-left":new t.Point(r,r),"top-right":new t.Point(-r,r),bottom:new t.Point(0,-n),"bottom-left":new t.Point(r,-r),"bottom-right":new t.Point(-r,-r),left:new t.Point(n,0),right:new t.Point(-n,0)}}if(n instanceof t.Point||Array.isArray(n)){var i=t.Point.convert(n);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.Point.convert(n.center||[0,0]),top:t.Point.convert(n.top||[0,0]),"top-left":t.Point.convert(n["top-left"]||[0,0]),"top-right":t.Point.convert(n["top-right"]||[0,0]),bottom:t.Point.convert(n.bottom||[0,0]),"bottom-left":t.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(n["bottom-right"]||[0,0]),left:t.Point.convert(n.left||[0,0]),right:t.Point.convert(n.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!a){var o,l=this._container.offsetWidth,u=this._container.offsetHeight;o=i.y+s.bottom.y<u?["top"]:i.y>this._map.transform.height-u?["bottom"]:[],i.x<l/2?o.push("left"):i.x>this._map.transform.width-l/2&&o.push("right"),a=0===o.length?"bottom":o.join("-")}var c=i.add(s[a]).round();n.setTransform(this._container,Ri[a]+" translate("+c.x+"px,"+c.y+"px)"),Mi(this._container,a,"popup")}},r.prototype._onClose=function(){this.remove()},r}(t.Evented),Hi={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:Di,NavigationControl:Ei,GeolocateControl:zi,AttributionControl:yi,ScaleControl:Bi,FullscreenControl:Vi,Popup:ji,Marker:Oi,Style:Ve,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,prewarm:function(){zt().acquire(Ot)},clearPrewarmedResources:function(){var t=Ft;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Ot),Ft=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Pt.workerCount},set workerCount(t){Pt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:""};return Hi})),n}()},5:function(t,e){},B9Yq:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},EhIR:function(t,e,n){(function(t){var r;!function(t,i,a){function s(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new s(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,i))||(i.exports=r):this.alea=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},PDX0:function(t,e){(function(e){t.exports=e}).call(this,{})},YSVl:function(t,e,n){var r=n("EhIR"),i=n("uDiL"),a=n("pJ6O"),s=n("yuCN"),o=n("euyF"),l=n("ie1u"),u=n("pJ3+");u.alea=r,u.xor128=i,u.xorwow=a,u.xorshift7=s,u.xor4096=o,u.tychei=l,t.exports=u},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},euyF:function(t,e,n){(function(t){var r;!function(t,i,a){function s(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n=i[a]=(n^=n>>>15)^(t^=t>>>12),e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,s,o=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,a=-32;a<l;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=0==(n=o[127&a]^=r+(s=s+1640531527|0))?i+1:0);for(i>=128&&(o[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=o[i+34&127],n=o[i=i+1&127],r^=r<<13,n^=n<<17,o[i]=(r^=r>>>15)^(n^=n>>>12);t.w=s,t.X=o,t.i=i}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,i))||(i.exports=r):this.xor4096=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},ie1u:function(t,e,n){(function(t){var r;!function(t,i,a){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,i))||(i.exports=r):this.tychei=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},"pJ3+":function(t,e,n){var r;!function(i,a){var s,o=this,l=a.pow(256,6),u=a.pow(2,52),c=2*u;function h(t,e,n){var r=[],h=f(function t(e,n){var r,i=[],a=typeof e;if(n&&"object"==a)for(r in e)try{i.push(t(e[r],n-1))}catch(s){}return i.length?i:"string"==a?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(i)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(256):(t=new Uint8Array(256),(o.crypto||o.msCrypto).getRandomValues(t)),m(t)}catch(r){var e=o.navigator,n=e&&e.plugins;return[+new Date,o,n,o.screen,m(i)]}}():t,3),r),g=new d(r),y=function(){for(var t=g.g(6),e=l,n=0;t<u;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return y.int32=function(){return 0|g.g(4)},y.quick=function(){return g.g(4)/4294967296},y.double=y,f(m(g.S),i),(e.pass||n||function(t,e,n,r){return r&&(r.S&&p(r,g),t.state=function(){return p(g,{})}),n?(a.random=t,e):t})(y,h,"global"in e?e.global:this==a,e.state)}function d(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<256;)s[i]=i++;for(i=0;i<256;i++)s[i]=s[a=255&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=255&i+1],n=256*n+s[255&(s[i]=s[a=255&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(256)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var n,r=t+"",i=0;i<r.length;)e[255&i]=255&(n^=19*e[255&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(a.seedrandom=h,f(a.random(),i),t.exports){t.exports=h;try{s=n(3)}catch(g){}}else void 0===(r=(function(){return h}).call(e,n,e,t))||(t.exports=r)}([],Math)},pJ6O:function(t,e,n){(function(t){var r;!function(t,i,a){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,i))||(i.exports=r):this.xorwow=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},uDiL:function(t,e,n){(function(t){var r;!function(t,i,a){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,i))||(i.exports=r):this.xor128=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},xexB:function(t,e,n){var r;!function(e,n){"use strict";"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(n,i){"use strict";var a=[],s=Object.getPrototypeOf,o=a.slice,l=a.flat?function(t){return a.flat.call(t)}:function(t){return a.concat.apply([],t)},u=a.push,c=a.indexOf,h={},d=h.toString,p=h.hasOwnProperty,f=p.toString,m=f.call(Object),g={},y=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},v=function(t){return null!=t&&t===t.window},_=n.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function x(t,e,n){var r,i,a=(n=n||_).createElement("script");if(a.text=t,e)for(r in b)(i=e[r]||e.getAttribute&&e.getAttribute(r))&&a.setAttribute(r,i);n.head.appendChild(a).parentNode.removeChild(a)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[d.call(t)]||"object":typeof t}var S="3.5.1",C=function(t,e){return new C.fn.init(t,e)};function D(t){var e=!!t&&"length"in t&&t.length,n=w(t);return!y(t)&&!v(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}C.fn=C.prototype={jquery:S,constructor:C,length:0,toArray:function(){return o.call(this)},get:function(t){return null==t?o.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=C.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return C.each(this,t)},map:function(t){return this.pushStack(C.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(C.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(C.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(0<=n&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:a.sort,splice:a.splice},C.extend=C.fn.extend=function(){var t,e,n,r,i,a,s=arguments[0]||{},o=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[o]||{},o++),"object"==typeof s||y(s)||(s={}),o===l&&(s=this,o--);o<l;o++)if(null!=(t=arguments[o]))for(e in t)r=t[e],"__proto__"!==e&&s!==r&&(u&&r&&(C.isPlainObject(r)||(i=Array.isArray(r)))?(n=s[e],a=i&&!Array.isArray(n)?[]:i||C.isPlainObject(n)?n:{},i=!1,s[e]=C.extend(u,a,r)):void 0!==r&&(s[e]=r));return s},C.extend({expando:"jQuery"+(S+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==d.call(t)||(e=s(t))&&("function"!=typeof(n=p.call(e,"constructor")&&e.constructor)||f.call(n)!==m))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){x(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,r=0;if(D(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(D(Object(t))?C.merge(n,"string"==typeof t?[t]:t):u.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:c.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,a=t.length,s=!n;i<a;i++)!e(t[i],i)!==s&&r.push(t[i]);return r},map:function(t,e,n){var r,i,a=0,s=[];if(D(t))for(r=t.length;a<r;a++)null!=(i=e(t[a],a,n))&&s.push(i);else for(a in t)null!=(i=e(t[a],a,n))&&s.push(i);return l(s)},guid:1,support:g}),"function"==typeof Symbol&&(C.fn[Symbol.iterator]=a[Symbol.iterator]),C.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){h["[object "+e+"]"]=e.toLowerCase()}));var I=function(t){var e,n,r,i,a,s,o,l,u,c,h,d,p,f,m,g,y,v,_,b="sizzle"+1*new Date,x=t.document,w=0,S=0,C=lt(),D=lt(),I=lt(),k=lt(),E=function(t,e){return t===e&&(h=!0),0},A={}.hasOwnProperty,T=[],R=T.pop,M=T.push,N=T.push,O=T.slice,P=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",z="(?:\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",$="\\["+L+"*("+z+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+z+"))|)"+L+"*\\]",B=":("+z+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+$+")*)|.*)\\)|)",W=new RegExp(L+"+","g"),q=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),V=new RegExp("^"+L+"*,"+L+"*"),U=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),j=new RegExp(L+"|>"),H=new RegExp(B),G=new RegExp("^"+z+"$"),J={ID:new RegExp("^#("+z+")"),CLASS:new RegExp("^\\.("+z+")"),TAG:new RegExp("^("+z+"|[*])"),ATTR:new RegExp("^"+$),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},rt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,it=function(t,e){return e?"\0"===t?"\ufffd":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},at=function(){d()},st=bt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{N.apply(T=O.call(x.childNodes),x.childNodes)}catch(e){N={apply:T.length?function(t,e){M.apply(t,O.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}function ot(t,e,r,i){var a,o,u,c,h,f,y,v=e&&e.ownerDocument,x=e?e.nodeType:9;if(r=r||[],"string"!=typeof t||!t||1!==x&&9!==x&&11!==x)return r;if(!i&&(d(e),e=e||p,m)){if(11!==x&&(h=Q.exec(t)))if(a=h[1]){if(9===x){if(!(u=e.getElementById(a)))return r;if(u.id===a)return r.push(u),r}else if(v&&(u=v.getElementById(a))&&_(e,u)&&u.id===a)return r.push(u),r}else{if(h[2])return N.apply(r,e.getElementsByTagName(t)),r;if((a=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return N.apply(r,e.getElementsByClassName(a)),r}if(n.qsa&&!k[t+" "]&&(!g||!g.test(t))&&(1!==x||"object"!==e.nodeName.toLowerCase())){if(y=t,v=e,1===x&&(j.test(t)||U.test(t))){for((v=tt.test(t)&&yt(e.parentNode)||e)===e&&n.scope||((c=e.getAttribute("id"))?c=c.replace(rt,it):e.setAttribute("id",c=b)),o=(f=s(t)).length;o--;)f[o]=(c?"#"+c:":scope")+" "+_t(f[o]);y=f.join(",")}try{return N.apply(r,v.querySelectorAll(y)),r}catch(e){k(t,!0)}finally{c===b&&e.removeAttribute("id")}}}return l(t.replace(q,"$1"),e,r,i)}function lt(){var t=[];return function e(n,i){return t.push(n+" ")>r.cacheLength&&delete e[t.shift()],e[n+" "]=i}}function ut(t){return t[b]=!0,t}function ct(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=e}function dt(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function mt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return ut((function(e){return e=+e,ut((function(n,r){for(var i,a=t([],n.length,e),s=a.length;s--;)n[i=a[s]]&&(n[i]=!(r[i]=n[i]))}))}))}function yt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=ot.support={},a=ot.isXML=function(t){var e=(t.ownerDocument||t).documentElement;return!X.test(t.namespaceURI||e&&e.nodeName||"HTML")},d=ot.setDocument=function(t){var e,i,s=t?t.ownerDocument||t:x;return s!=p&&9===s.nodeType&&s.documentElement&&(f=(p=s).documentElement,m=!a(p),x!=p&&(i=p.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",at,!1):i.attachEvent&&i.attachEvent("onunload",at)),n.scope=ct((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ct((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ct((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Y.test(p.getElementsByClassName),n.getById=ct((function(t){return f.appendChild(t).id=b,!p.getElementsByName||!p.getElementsByName(b).length})),n.getById?(r.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},r.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n=e.getElementById(t);return n?[n]:[]}}):(r.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},r.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n,r,i,a=e.getElementById(t);if(a){if((n=a.getAttributeNode("id"))&&n.value===t)return[a];for(i=e.getElementsByName(t),r=0;a=i[r++];)if((n=a.getAttributeNode("id"))&&n.value===t)return[a]}return[]}}),r.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,a=e.getElementsByTagName(t);if("*"===t){for(;n=a[i++];)1===n.nodeType&&r.push(n);return r}return a},r.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},y=[],g=[],(n.qsa=Y.test(p.querySelectorAll))&&(ct((function(t){var e;f.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+L+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+L+"*(?:value|"+F+")"),t.querySelectorAll("[id~="+b+"-]").length||g.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||g.push("\\["+L+"*name"+L+"*="+L+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||g.push(".#.+[+~]"),t.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")})),ct((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+L+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(n.matchesSelector=Y.test(v=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ct((function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),y.push("!=",B)})),g=g.length&&new RegExp(g.join("|")),y=y.length&&new RegExp(y.join("|")),e=Y.test(f.compareDocumentPosition),_=e||Y.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},E=e?function(t,e){if(t===e)return h=!0,0;var r=!t.compareDocumentPosition-!e.compareDocumentPosition;return r||(1&(r=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===r?t==p||t.ownerDocument==x&&_(x,t)?-1:e==p||e.ownerDocument==x&&_(x,e)?1:c?P(c,t)-P(c,e):0:4&r?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,r=0,i=t.parentNode,a=e.parentNode,s=[t],o=[e];if(!i||!a)return t==p?-1:e==p?1:i?-1:a?1:c?P(c,t)-P(c,e):0;if(i===a)return dt(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)o.unshift(n);for(;s[r]===o[r];)r++;return r?dt(s[r],o[r]):s[r]==x?-1:o[r]==x?1:0}),p},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&m&&!k[e+" "]&&(!y||!y.test(e))&&(!g||!g.test(e)))try{var r=v.call(t,e);if(r||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(t){k(e,!0)}return 0<ot(e,p,null,[t]).length},ot.contains=function(t,e){return(t.ownerDocument||t)!=p&&d(t),_(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!=p&&d(t);var i=r.attrHandle[e.toLowerCase()],a=i&&A.call(r.attrHandle,e.toLowerCase())?i(t,e,!m):void 0;return void 0!==a?a:n.attributes||!m?t.getAttribute(e):(a=t.getAttributeNode(e))&&a.specified?a.value:null},ot.escape=function(t){return(t+"").replace(rt,it)},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,r=[],i=0,a=0;if(h=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(E),h){for(;e=t[a++];)e===t[a]&&(i=r.push(a));for(;i--;)t.splice(r[i],1)}return c=null,t},i=ot.getText=function(t){var e,n="",r=0,a=t.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=i(t)}else if(3===a||4===a)return t.nodeValue}else for(;e=t[r++];)n+=i(e);return n},(r=ot.selectors={cacheLength:50,createPseudo:ut,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return J.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&H.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=C[t+" "];return e||(e=new RegExp("(^|"+L+")"+t+"("+L+"|$)"))&&C(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(r){var i=ot.attr(r,t);return null==i?"!="===e:!e||(i+="","="===e?i===n:"!="===e?i!==n:"^="===e?n&&0===i.indexOf(n):"*="===e?n&&-1<i.indexOf(n):"$="===e?n&&i.slice(-n.length)===n:"~="===e?-1<(" "+i.replace(W," ")+" ").indexOf(n):"|="===e&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,r,i){var a="nth"!==t.slice(0,3),s="last"!==t.slice(-4),o="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,l){var u,c,h,d,p,f,m=a!==s?"nextSibling":"previousSibling",g=e.parentNode,y=o&&e.nodeName.toLowerCase(),v=!l&&!o,_=!1;if(g){if(a){for(;m;){for(d=e;d=d[m];)if(o?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?g.firstChild:g.lastChild],s&&v){for(_=(p=(u=(c=(h=(d=g)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&u[1])&&u[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(_=p=0)||f.pop();)if(1===d.nodeType&&++_&&d===e){c[t]=[w,p,_];break}}else if(v&&(_=p=(u=(c=(h=(d=e)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&u[1]),!1===_)for(;(d=++p&&d&&d[m]||(_=p=0)||f.pop())&&((o?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++_||(v&&((c=(h=d[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[w,_]),d!==e)););return(_-=i)===r||_%r==0&&0<=_/r}}},PSEUDO:function(t,e){var n,i=r.pseudos[t]||r.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return i[b]?i(e):1<i.length?(n=[t,t,"",e],r.setFilters.hasOwnProperty(t.toLowerCase())?ut((function(t,n){for(var r,a=i(t,e),s=a.length;s--;)t[r=P(t,a[s])]=!(n[r]=a[s])})):function(t){return i(t,0,n)}):i}},pseudos:{not:ut((function(t){var e=[],n=[],r=o(t.replace(q,"$1"));return r[b]?ut((function(t,e,n,i){for(var a,s=r(t,null,i,[]),o=t.length;o--;)(a=s[o])&&(t[o]=!(e[o]=a))})):function(t,i,a){return e[0]=t,r(e,null,a,n),e[0]=null,!n.pop()}})),has:ut((function(t){return function(e){return 0<ot(t,e).length}})),contains:ut((function(t){return t=t.replace(et,nt),function(e){return-1<(e.textContent||i(e)).indexOf(t)}})),lang:ut((function(t){return G.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:mt(!1),disabled:mt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!r.pseudos.empty(t)},header:function(t){return Z.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt((function(){return[0]})),last:gt((function(t,e){return[e-1]})),eq:gt((function(t,e,n){return[n<0?n+e:n]})),even:gt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:gt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:gt((function(t,e,n){for(var r=n<0?n+e:e<n?e:n;0<=--r;)t.push(r);return t})),gt:gt((function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t}))}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})r.pseudos[e]=ft(e);function vt(){}function _t(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function bt(t,e,n){var r=e.dir,i=e.next,a=i||r,s=n&&"parentNode"===a,o=S++;return e.first?function(e,n,i){for(;e=e[r];)if(1===e.nodeType||s)return t(e,n,i);return!1}:function(e,n,l){var u,c,h,d=[w,o];if(l){for(;e=e[r];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[r];)if(1===e.nodeType||s)if(c=(h=e[b]||(e[b]={}))[e.uniqueID]||(h[e.uniqueID]={}),i&&i===e.nodeName.toLowerCase())e=e[r]||e;else{if((u=c[a])&&u[0]===w&&u[1]===o)return d[2]=u[2];if((c[a]=d)[2]=t(e,n,l))return!0}return!1}}function xt(t){return 1<t.length?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function wt(t,e,n,r,i){for(var a,s=[],o=0,l=t.length,u=null!=e;o<l;o++)(a=t[o])&&(n&&!n(a,r,i)||(s.push(a),u&&e.push(o)));return s}function St(t,e,n,r,i,a){return r&&!r[b]&&(r=St(r)),i&&!i[b]&&(i=St(i,a)),ut((function(a,s,o,l){var u,c,h,d=[],p=[],f=s.length,m=a||function(t,e,n){for(var r=0,i=e.length;r<i;r++)ot(t,e[r],n);return n}(e||"*",o.nodeType?[o]:o,[]),g=!t||!a&&e?m:wt(m,d,t,o,l),y=n?i||(a?t:f||r)?[]:s:g;if(n&&n(g,y,o,l),r)for(u=wt(y,p),r(u,[],o,l),c=u.length;c--;)(h=u[c])&&(y[p[c]]=!(g[p[c]]=h));if(a){if(i||t){if(i){for(u=[],c=y.length;c--;)(h=y[c])&&u.push(g[c]=h);i(null,y=[],u,l)}for(c=y.length;c--;)(h=y[c])&&-1<(u=i?P(a,h):d[c])&&(a[u]=!(s[u]=h))}}else y=wt(y===s?y.splice(f,y.length):y),i?i(null,s,y,l):N.apply(s,y)}))}function Ct(t){for(var e,n,i,a=t.length,s=r.relative[t[0].type],o=s||r.relative[" "],l=s?1:0,c=bt((function(t){return t===e}),o,!0),h=bt((function(t){return-1<P(e,t)}),o,!0),d=[function(t,n,r){var i=!s&&(r||n!==u)||((e=n).nodeType?c(t,n,r):h(t,n,r));return e=null,i}];l<a;l++)if(n=r.relative[t[l].type])d=[bt(xt(d),n)];else{if((n=r.filter[t[l].type].apply(null,t[l].matches))[b]){for(i=++l;i<a&&!r.relative[t[i].type];i++);return St(1<l&&xt(d),1<l&&_t(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(q,"$1"),n,l<i&&Ct(t.slice(l,i)),i<a&&Ct(t=t.slice(i)),i<a&&_t(t))}d.push(n)}return xt(d)}return vt.prototype=r.filters=r.pseudos,r.setFilters=new vt,s=ot.tokenize=function(t,e){var n,i,a,s,o,l,u,c=D[t+" "];if(c)return e?0:c.slice(0);for(o=t,l=[],u=r.preFilter;o;){for(s in n&&!(i=V.exec(o))||(i&&(o=o.slice(i[0].length)||o),l.push(a=[])),n=!1,(i=U.exec(o))&&(n=i.shift(),a.push({value:n,type:i[0].replace(q," ")}),o=o.slice(n.length)),r.filter)!(i=J[s].exec(o))||u[s]&&!(i=u[s](i))||(n=i.shift(),a.push({value:n,type:s,matches:i}),o=o.slice(n.length));if(!n)break}return e?o.length:o?ot.error(t):D(t,l).slice(0)},o=ot.compile=function(t,e){var n,i,a,o,l,c,h=[],f=[],g=I[t+" "];if(!g){for(e||(e=s(t)),n=e.length;n--;)(g=Ct(e[n]))[b]?h.push(g):f.push(g);(g=I(t,(i=f,o=0<(a=h).length,l=0<i.length,c=function(t,e,n,s,c){var h,f,g,y=0,v="0",_=t&&[],b=[],x=u,S=t||l&&r.find.TAG("*",c),C=w+=null==x?1:Math.random()||.1,D=S.length;for(c&&(u=e==p||e||c);v!==D&&null!=(h=S[v]);v++){if(l&&h){for(f=0,e||h.ownerDocument==p||(d(h),n=!m);g=i[f++];)if(g(h,e||p,n)){s.push(h);break}c&&(w=C)}o&&((h=!g&&h)&&y--,t&&_.push(h))}if(y+=v,o&&v!==y){for(f=0;g=a[f++];)g(_,b,e,n);if(t){if(0<y)for(;v--;)_[v]||b[v]||(b[v]=R.call(s));b=wt(b)}N.apply(s,b),c&&!t&&0<b.length&&1<y+a.length&&ot.uniqueSort(s)}return c&&(w=C,u=x),_},o?ut(c):c))).selector=t}return g},l=ot.select=function(t,e,n,i){var a,l,u,c,h,d="function"==typeof t&&t,p=!i&&s(t=d.selector||t);if(n=n||[],1===p.length){if(2<(l=p[0]=p[0].slice(0)).length&&"ID"===(u=l[0]).type&&9===e.nodeType&&m&&r.relative[l[1].type]){if(!(e=(r.find.ID(u.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(a=J.needsContext.test(t)?0:l.length;a--&&!r.relative[c=(u=l[a]).type];)if((h=r.find[c])&&(i=h(u.matches[0].replace(et,nt),tt.test(l[0].type)&&yt(e.parentNode)||e))){if(l.splice(a,1),!(t=i.length&&_t(l)))return N.apply(n,i),n;break}}return(d||o(t,p))(i,e,!m,n,!e||tt.test(t)&&yt(e.parentNode)||e),n},n.sortStable=b.split("").sort(E).join("")===b,n.detectDuplicates=!!h,d(),n.sortDetached=ct((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ct((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ct((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ct((function(t){return null==t.getAttribute("disabled")}))||ht(F,(function(t,e,n){var r;if(!n)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null})),ot}(n);C.find=I,C.expr=I.selectors,C.expr[":"]=C.expr.pseudos,C.uniqueSort=C.unique=I.uniqueSort,C.text=I.getText,C.isXMLDoc=I.isXML,C.contains=I.contains,C.escapeSelector=I.escape;var k=function(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&C(t).is(n))break;r.push(t)}return r},E=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},A=C.expr.match.needsContext;function T(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var R=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function M(t,e,n){return y(e)?C.grep(t,(function(t,r){return!!e.call(t,r,t)!==n})):e.nodeType?C.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?C.grep(t,(function(t){return-1<c.call(e,t)!==n})):C.filter(e,t,n)}C.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?C.find.matchesSelector(r,t)?[r]:[]:C.find.matches(t,C.grep(e,(function(t){return 1===t.nodeType})))},C.fn.extend({find:function(t){var e,n,r=this.length,i=this;if("string"!=typeof t)return this.pushStack(C(t).filter((function(){for(e=0;e<r;e++)if(C.contains(i[e],this))return!0})));for(n=this.pushStack([]),e=0;e<r;e++)C.find(t,i[e],n);return 1<r?C.uniqueSort(n):n},filter:function(t){return this.pushStack(M(this,t||[],!1))},not:function(t){return this.pushStack(M(this,t||[],!0))},is:function(t){return!!M(this,"string"==typeof t&&A.test(t)?C(t):t||[],!1).length}});var N,O=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(C.fn.init=function(t,e,n){var r,i;if(!t)return this;if(n=n||N,"string"==typeof t){if(!(r="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:O.exec(t))||!r[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(r[1]){if(C.merge(this,C.parseHTML(r[1],(e=e instanceof C?e[0]:e)&&e.nodeType?e.ownerDocument||e:_,!0)),R.test(r[1])&&C.isPlainObject(e))for(r in e)y(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}return(i=_.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==n.ready?n.ready(t):t(C):C.makeArray(t,this)}).prototype=C.fn,N=C(_);var P=/^(?:parents|prev(?:Until|All))/,F={children:!0,contents:!0,next:!0,prev:!0};function L(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}C.fn.extend({has:function(t){var e=C(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(C.contains(this,e[t]))return!0}))},closest:function(t,e){var n,r=0,i=this.length,a=[],s="string"!=typeof t&&C(t);if(!A.test(t))for(;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?-1<s.index(n):1===n.nodeType&&C.find.matchesSelector(n,t))){a.push(n);break}return this.pushStack(1<a.length?C.uniqueSort(a):a)},index:function(t){return t?"string"==typeof t?c.call(C(t),this[0]):c.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(C.uniqueSort(C.merge(this.get(),C(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),C.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return k(t,"parentNode")},parentsUntil:function(t,e,n){return k(t,"parentNode",n)},next:function(t){return L(t,"nextSibling")},prev:function(t){return L(t,"previousSibling")},nextAll:function(t){return k(t,"nextSibling")},prevAll:function(t){return k(t,"previousSibling")},nextUntil:function(t,e,n){return k(t,"nextSibling",n)},prevUntil:function(t,e,n){return k(t,"previousSibling",n)},siblings:function(t){return E((t.parentNode||{}).firstChild,t)},children:function(t){return E(t.firstChild)},contents:function(t){return null!=t.contentDocument&&s(t.contentDocument)?t.contentDocument:(T(t,"template")&&(t=t.content||t),C.merge([],t.childNodes))}},(function(t,e){C.fn[t]=function(n,r){var i=C.map(this,e,n);return"Until"!==t.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=C.filter(r,i)),1<this.length&&(F[t]||C.uniqueSort(i),P.test(t)&&i.reverse()),this.pushStack(i)}}));var z=/[^\x20\t\r\n\f]+/g;function $(t){return t}function B(t){throw t}function W(t,e,n,r){var i;try{t&&y(i=t.promise)?i.call(t).done(e).fail(n):t&&y(i=t.then)?i.call(t,e,n):e.apply(void 0,[t].slice(r))}catch(t){n.apply(void 0,[t])}}C.Callbacks=function(t){var e;t="string"==typeof t?(e={},C.each(t.match(z)||[],(function(t,n){e[n]=!0})),e):C.extend({},t);var n,r,i,a,s=[],o=[],l=-1,u=function(){for(a=a||t.once,i=n=!0;o.length;l=-1)for(r=o.shift();++l<s.length;)!1===s[l].apply(r[0],r[1])&&t.stopOnFalse&&(l=s.length,r=!1);t.memory||(r=!1),n=!1,a&&(s=r?[]:"")},c={add:function(){return s&&(r&&!n&&(l=s.length-1,o.push(r)),function e(n){C.each(n,(function(n,r){y(r)?t.unique&&c.has(r)||s.push(r):r&&r.length&&"string"!==w(r)&&e(r)}))}(arguments),r&&!n&&u()),this},remove:function(){return C.each(arguments,(function(t,e){for(var n;-1<(n=C.inArray(e,s,n));)s.splice(n,1),n<=l&&l--})),this},has:function(t){return t?-1<C.inArray(t,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=o=[],s=r="",this},disabled:function(){return!s},lock:function(){return a=o=[],r||n||(s=r=""),this},locked:function(){return!!a},fireWith:function(t,e){return a||(e=[t,(e=e||[]).slice?e.slice():e],o.push(e),n||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},C.extend({Deferred:function(t){var e=[["notify","progress",C.Callbacks("memory"),C.Callbacks("memory"),2],["resolve","done",C.Callbacks("once memory"),C.Callbacks("once memory"),0,"resolved"],["reject","fail",C.Callbacks("once memory"),C.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return a.done(arguments).fail(arguments),this},catch:function(t){return i.then(null,t)},pipe:function(){var t=arguments;return C.Deferred((function(n){C.each(e,(function(e,r){var i=y(t[r[4]])&&t[r[4]];a[r[1]]((function(){var t=i&&i.apply(this,arguments);t&&y(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[t]:arguments)}))})),t=null})).promise()},then:function(t,r,i){var a=0;function s(t,e,r,i){return function(){var o=this,l=arguments,u=function(){var n,u;if(!(t<a)){if((n=r.apply(o,l))===e.promise())throw new TypeError("Thenable self-resolution");y(u=n&&("object"==typeof n||"function"==typeof n)&&n.then)?i?u.call(n,s(a,e,$,i),s(a,e,B,i)):(a++,u.call(n,s(a,e,$,i),s(a,e,B,i),s(a,e,$,e.notifyWith))):(r!==$&&(o=void 0,l=[n]),(i||e.resolveWith)(o,l))}},c=i?u:function(){try{u()}catch(u){C.Deferred.exceptionHook&&C.Deferred.exceptionHook(u,c.stackTrace),a<=t+1&&(r!==B&&(o=void 0,l=[u]),e.rejectWith(o,l))}};t?c():(C.Deferred.getStackHook&&(c.stackTrace=C.Deferred.getStackHook()),n.setTimeout(c))}}return C.Deferred((function(n){e[0][3].add(s(0,n,y(i)?i:$,n.notifyWith)),e[1][3].add(s(0,n,y(t)?t:$)),e[2][3].add(s(0,n,y(r)?r:B))})).promise()},promise:function(t){return null!=t?C.extend(t,i):i}},a={};return C.each(e,(function(t,n){var s=n[2],o=n[5];i[n[1]]=s.add,o&&s.add((function(){r=o}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(n[3].fire),a[n[0]]=function(){return a[n[0]+"With"](this===a?void 0:this,arguments),this},a[n[0]+"With"]=s.fireWith})),i.promise(a),t&&t.call(a,a),a},when:function(t){var e=arguments.length,n=e,r=Array(n),i=o.call(arguments),a=C.Deferred(),s=function(t){return function(n){r[t]=this,i[t]=1<arguments.length?o.call(arguments):n,--e||a.resolveWith(r,i)}};if(e<=1&&(W(t,a.done(s(n)).resolve,a.reject,!e),"pending"===a.state()||y(i[n]&&i[n].then)))return a.then();for(;n--;)W(i[n],s(n),a.reject);return a.promise()}});var q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;C.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&q.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},C.readyException=function(t){n.setTimeout((function(){throw t}))};var V=C.Deferred();function U(){_.removeEventListener("DOMContentLoaded",U),n.removeEventListener("load",U),C.ready()}C.fn.ready=function(t){return V.then(t).catch((function(t){C.readyException(t)})),this},C.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--C.readyWait:C.isReady)||(C.isReady=!0)!==t&&0<--C.readyWait||V.resolveWith(_,[C])}}),C.ready.then=V.then,"complete"===_.readyState||"loading"!==_.readyState&&!_.documentElement.doScroll?n.setTimeout(C.ready):(_.addEventListener("DOMContentLoaded",U),n.addEventListener("load",U));var j=function(t,e,n,r,i,a,s){var o=0,l=t.length,u=null==n;if("object"===w(n))for(o in i=!0,n)j(t,e,o,n[o],!0,a,s);else if(void 0!==r&&(i=!0,y(r)||(s=!0),u&&(s?(e.call(t,r),e=null):(u=e,e=function(t,e,n){return u.call(C(t),n)})),e))for(;o<l;o++)e(t[o],n,s?r:r.call(t[o],o,e(t[o],n)));return i?t:u?e.call(t):l?e(t[0],n):a},H=/^-ms-/,G=/-([a-z])/g;function J(t,e){return e.toUpperCase()}function X(t){return t.replace(H,"ms-").replace(G,J)}var K=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Z(){this.expando=C.expando+Z.uid++}Z.uid=1,Z.prototype={cache:function(t){var e=t[this.expando];return e||(e={},K(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[X(e)]=n;else for(r in e)i[X(r)]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][X(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r=t[this.expando];if(void 0!==r){if(void 0!==e){n=(e=Array.isArray(e)?e.map(X):(e=X(e))in r?[e]:e.match(z)||[]).length;for(;n--;)delete r[e[n]]}(void 0===e||C.isEmptyObject(r))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!C.isEmptyObject(e)}};var Y=new Z,Q=new Z,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var r,i;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:tt.test(i)?JSON.parse(i):i)}catch(t){}Q.set(t,e,n)}else n=void 0;return n}C.extend({hasData:function(t){return Q.hasData(t)||Y.hasData(t)},data:function(t,e,n){return Q.access(t,e,n)},removeData:function(t,e){Q.remove(t,e)},_data:function(t,e,n){return Y.access(t,e,n)},_removeData:function(t,e){Y.remove(t,e)}}),C.fn.extend({data:function(t,e){var n,r,i,a=this[0],s=a&&a.attributes;if(void 0===t){if(this.length&&(i=Q.get(a),1===a.nodeType&&!Y.get(a,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(r=s[n].name).indexOf("data-")&&(r=X(r.slice(5)),nt(a,r,i[r]));Y.set(a,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each((function(){Q.set(this,t)})):j(this,(function(e){var n;if(a&&void 0===e)return void 0!==(n=Q.get(a,t))||void 0!==(n=nt(a,t))?n:void 0;this.each((function(){Q.set(this,t,e)}))}),null,e,1<arguments.length,null,!0)},removeData:function(t){return this.each((function(){Q.remove(this,t)}))}}),C.extend({queue:function(t,e,n){var r;if(t)return r=Y.get(t,e=(e||"fx")+"queue"),n&&(!r||Array.isArray(n)?r=Y.access(t,e,C.makeArray(n)):r.push(n)),r||[]},dequeue:function(t,e){var n=C.queue(t,e=e||"fx"),r=n.length,i=n.shift(),a=C._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete a.stop,i.call(t,(function(){C.dequeue(t,e)}),a)),!r&&a&&a.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Y.get(t,n)||Y.access(t,n,{empty:C.Callbacks("once memory").add((function(){Y.remove(t,[e+"queue",n])}))})}}),C.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?C.queue(this[0],t):void 0===e?this:this.each((function(){var n=C.queue(this,t,e);C._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&C.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){C.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,r=1,i=C.Deferred(),a=this,s=this.length,o=function(){--r||i.resolveWith(a,[a])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=Y.get(a[s],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(o));return o(),i.promise(e)}});var rt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,it=new RegExp("^(?:([+-])=|)("+rt+")([a-z%]*)$","i"),at=["Top","Right","Bottom","Left"],st=_.documentElement,ot=function(t){return C.contains(t.ownerDocument,t)},lt={composed:!0};st.getRootNode&&(ot=function(t){return C.contains(t.ownerDocument,t)||t.getRootNode(lt)===t.ownerDocument});var ut=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&ot(t)&&"none"===C.css(t,"display")};function ct(t,e,n,r){var i,a,s=20,o=r?function(){return r.cur()}:function(){return C.css(t,e,"")},l=o(),u=n&&n[3]||(C.cssNumber[e]?"":"px"),c=t.nodeType&&(C.cssNumber[e]||"px"!==u&&+l)&&it.exec(C.css(t,e));if(c&&c[3]!==u){for(u=u||c[3],c=+(l/=2)||1;s--;)C.style(t,e,c+u),(1-a)*(1-(a=o()/l||.5))<=0&&(s=0),c/=a;C.style(t,e,(c*=2)+u),n=n||[]}return n&&(c=+c||+l||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=c,r.end=i)),i}var ht={};function dt(t,e){for(var n,r,i,a,s,o,l,u=[],c=0,h=t.length;c<h;c++)(r=t[c]).style&&(n=r.style.display,e?("none"===n&&(u[c]=Y.get(r,"display")||null,u[c]||(r.style.display="")),""===r.style.display&&ut(r)&&(u[c]=(l=s=a=void 0,s=(i=r).ownerDocument,(l=ht[o=i.nodeName])||(a=s.body.appendChild(s.createElement(o)),l=C.css(a,"display"),a.parentNode.removeChild(a),"none"===l&&(l="block"),ht[o]=l)))):"none"!==n&&(u[c]="none",Y.set(r,"display",n)));for(c=0;c<h;c++)null!=u[c]&&(t[c].style.display=u[c]);return t}C.fn.extend({show:function(){return dt(this,!0)},hide:function(){return dt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ut(this)?C(this).show():C(this).hide()}))}});var pt,ft,mt=/^(?:checkbox|radio)$/i,gt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,yt=/^$|^module$|\/(?:java|ecma)script/i;pt=_.createDocumentFragment().appendChild(_.createElement("div")),(ft=_.createElement("input")).setAttribute("type","radio"),ft.setAttribute("checked","checked"),ft.setAttribute("name","t"),pt.appendChild(ft),g.checkClone=pt.cloneNode(!0).cloneNode(!0).lastChild.checked,pt.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!pt.cloneNode(!0).lastChild.defaultValue,pt.innerHTML="<option></option>",g.option=!!pt.lastChild;var vt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _t(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&T(t,e)?C.merge([t],n):n}function bt(t,e){for(var n=0,r=t.length;n<r;n++)Y.set(t[n],"globalEval",!e||Y.get(e[n],"globalEval"))}vt.tbody=vt.tfoot=vt.colgroup=vt.caption=vt.thead,vt.th=vt.td,g.option||(vt.optgroup=vt.option=[1,"<select multiple='multiple'>","</select>"]);var xt=/<|&#?\w+;/;function wt(t,e,n,r,i){for(var a,s,o,l,u,c,h=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((a=t[p])||0===a)if("object"===w(a))C.merge(d,a.nodeType?[a]:a);else if(xt.test(a)){for(s=s||h.appendChild(e.createElement("div")),o=(gt.exec(a)||["",""])[1].toLowerCase(),s.innerHTML=(l=vt[o]||vt._default)[1]+C.htmlPrefilter(a)+l[2],c=l[0];c--;)s=s.lastChild;C.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(e.createTextNode(a));for(h.textContent="",p=0;a=d[p++];)if(r&&-1<C.inArray(a,r))i&&i.push(a);else if(u=ot(a),s=_t(h.appendChild(a),"script"),u&&bt(s),n)for(c=0;a=s[c++];)yt.test(a.type||"")&&n.push(a);return h}var St=/^key/,Ct=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Dt=/^([^.]*)(?:\.(.+)|)/;function It(){return!0}function kt(){return!1}function Et(t,e){return t===function(){try{return _.activeElement}catch(t){}}()==("focus"===e)}function At(t,e,n,r,i,a){var s,o;if("object"==typeof e){for(o in"string"!=typeof n&&(r=r||n,n=void 0),e)At(t,o,n,r,e[o],a);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=kt;else if(!i)return t;return 1===a&&(s=i,(i=function(t){return C().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=C.guid++)),t.each((function(){C.event.add(this,e,i,r,n)}))}function Tt(t,e,n){n?(Y.set(t,e,!1),C.event.add(t,e,{namespace:!1,handler:function(t){var r,i,a=Y.get(this,e);if(1&t.isTrigger&&this[e]){if(a.length)(C.event.special[e]||{}).delegateType&&t.stopPropagation();else if(a=o.call(arguments),Y.set(this,e,a),r=n(this,e),this[e](),a!==(i=Y.get(this,e))||r?Y.set(this,e,!1):i={},a!==i)return t.stopImmediatePropagation(),t.preventDefault(),i.value}else a.length&&(Y.set(this,e,{value:C.event.trigger(C.extend(a[0],C.Event.prototype),a.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Y.get(t,e)&&C.event.add(t,e,It)}C.event={global:{},add:function(t,e,n,r,i){var a,s,o,l,u,c,h,d,p,f,m,g=Y.get(t);if(K(t))for(n.handler&&(n=(a=n).handler,i=a.selector),i&&C.find.matchesSelector(st,i),n.guid||(n.guid=C.guid++),(l=g.events)||(l=g.events=Object.create(null)),(s=g.handle)||(s=g.handle=function(e){return void 0!==C&&C.event.triggered!==e.type?C.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(z)||[""]).length;u--;)p=m=(o=Dt.exec(e[u])||[])[1],f=(o[2]||"").split(".").sort(),p&&(h=C.event.special[p]||{},h=C.event.special[p=(i?h.delegateType:h.bindType)||p]||{},c=C.extend({type:p,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&C.expr.match.needsContext.test(i),namespace:f.join(".")},a),(d=l[p])||((d=l[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,r,f,s)||t.addEventListener&&t.addEventListener(p,s)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,c):d.push(c),C.event.global[p]=!0)},remove:function(t,e,n,r,i){var a,s,o,l,u,c,h,d,p,f,m,g=Y.hasData(t)&&Y.get(t);if(g&&(l=g.events)){for(u=(e=(e||"").match(z)||[""]).length;u--;)if(p=m=(o=Dt.exec(e[u])||[])[1],f=(o[2]||"").split(".").sort(),p){for(h=C.event.special[p]||{},d=l[p=(r?h.delegateType:h.bindType)||p]||[],o=o[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=a=d.length;a--;)c=d[a],!i&&m!==c.origType||n&&n.guid!==c.guid||o&&!o.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(d.splice(a,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,g.handle)||C.removeEvent(t,p,g.handle),delete l[p])}else for(p in l)C.event.remove(t,p+e[u],n,r,!0);C.isEmptyObject(l)&&Y.remove(t,"handle events")}},dispatch:function(t){var e,n,r,i,a,s,o=new Array(arguments.length),l=C.event.fix(t),u=(Y.get(this,"events")||Object.create(null))[l.type]||[],c=C.event.special[l.type]||{};for(o[0]=l,e=1;e<arguments.length;e++)o[e]=arguments[e];if(l.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,l)){for(s=C.event.handlers.call(this,l,u),e=0;(i=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=i.elem,n=0;(a=i.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==a.namespace&&!l.rnamespace.test(a.namespace)||(l.handleObj=a,l.data=a.data,void 0!==(r=((C.event.special[a.origType]||{}).handle||a.handler).apply(i.elem,o))&&!1===(l.result=r)&&(l.preventDefault(),l.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,r,i,a,s,o=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&!("click"===t.type&&1<=t.button))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(a=[],s={},n=0;n<l;n++)void 0===s[i=(r=e[n]).selector+" "]&&(s[i]=r.needsContext?-1<C(i,this).index(u):C.find(i,this,null,[u]).length),s[i]&&a.push(r);a.length&&o.push({elem:u,handlers:a})}return u=this,l<e.length&&o.push({elem:u,handlers:e.slice(l)}),o},addProp:function(t,e){Object.defineProperty(C.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[C.expando]?t:new C.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return mt.test(e.type)&&e.click&&T(e,"input")&&Tt(e,"click",It),!1},trigger:function(t){var e=this||t;return mt.test(e.type)&&e.click&&T(e,"input")&&Tt(e,"click"),!0},_default:function(t){var e=t.target;return mt.test(e.type)&&e.click&&T(e,"input")&&Y.get(e,"click")||T(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},C.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},C.Event=function(t,e){if(!(this instanceof C.Event))return new C.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?It:kt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&C.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[C.expando]=!0},C.Event.prototype={constructor:C.Event,isDefaultPrevented:kt,isPropagationStopped:kt,isImmediatePropagationStopped:kt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=It,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=It,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=It,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},C.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&St.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Ct.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},C.event.addProp),C.each({focus:"focusin",blur:"focusout"},(function(t,e){C.event.special[t]={setup:function(){return Tt(this,t,Et),!1},trigger:function(){return Tt(this,t),!0},delegateType:e}})),C.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){C.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=t.relatedTarget,i=t.handleObj;return r&&(r===this||C.contains(this,r))||(t.type=i.origType,n=i.handler.apply(this,arguments),t.type=e),n}}})),C.fn.extend({on:function(t,e,n,r){return At(this,t,e,n,r)},one:function(t,e,n,r){return At(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,C(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=kt),this.each((function(){C.event.remove(this,t,n,e)}))}});var Rt=/<script|<style|<link/i,Mt=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ot(t,e){return T(t,"table")&&T(11!==e.nodeType?e:e.firstChild,"tr")&&C(t).children("tbody")[0]||t}function Pt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ft(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Lt(t,e){var n,r,i,a,s,o;if(1===e.nodeType){if(Y.hasData(t)&&(o=Y.get(t).events))for(i in Y.remove(e,"handle events"),o)for(n=0,r=o[i].length;n<r;n++)C.event.add(e,i,o[i][n]);Q.hasData(t)&&(a=Q.access(t),s=C.extend({},a),Q.set(e,s))}}function zt(t,e,n,r){e=l(e);var i,a,s,o,u,c,h=0,d=t.length,p=d-1,f=e[0],m=y(f);if(m||1<d&&"string"==typeof f&&!g.checkClone&&Mt.test(f))return t.each((function(i){var a=t.eq(i);m&&(e[0]=f.call(this,i,a.html())),zt(a,e,n,r)}));if(d&&(a=(i=wt(e,t[0].ownerDocument,!1,t,r)).firstChild,1===i.childNodes.length&&(i=a),a||r)){for(o=(s=C.map(_t(i,"script"),Pt)).length;h<d;h++)u=i,h!==p&&(u=C.clone(u,!0,!0),o&&C.merge(s,_t(u,"script"))),n.call(t[h],u,h);if(o)for(c=s[s.length-1].ownerDocument,C.map(s,Ft),h=0;h<o;h++)yt.test((u=s[h]).type||"")&&!Y.access(u,"globalEval")&&C.contains(c,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?C._evalUrl&&!u.noModule&&C._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},c):x(u.textContent.replace(Nt,""),u,c))}return t}function $t(t,e,n){for(var r,i=e?C.filter(e,t):t,a=0;null!=(r=i[a]);a++)n||1!==r.nodeType||C.cleanData(_t(r)),r.parentNode&&(n&&ot(r)&&bt(_t(r,"script")),r.parentNode.removeChild(r));return t}C.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var r,i,a,s,o,l,u,c=t.cloneNode(!0),h=ot(t);if(!(g.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||C.isXMLDoc(t)))for(s=_t(c),r=0,i=(a=_t(t)).length;r<i;r++)o=a[r],"input"===(u=(l=s[r]).nodeName.toLowerCase())&&mt.test(o.type)?l.checked=o.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=o.defaultValue);if(e)if(n)for(a=a||_t(t),s=s||_t(c),r=0,i=a.length;r<i;r++)Lt(a[r],s[r]);else Lt(t,c);return 0<(s=_t(c,"script")).length&&bt(s,!h&&_t(t,"script")),c},cleanData:function(t){for(var e,n,r,i=C.event.special,a=0;void 0!==(n=t[a]);a++)if(K(n)){if(e=n[Y.expando]){if(e.events)for(r in e.events)i[r]?C.event.remove(n,r):C.removeEvent(n,r,e.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),C.fn.extend({detach:function(t){return $t(this,t,!0)},remove:function(t){return $t(this,t)},text:function(t){return j(this,(function(t){return void 0===t?C.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return zt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ot(this,t).appendChild(t)}))},prepend:function(){return zt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Ot(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return zt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return zt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(C.cleanData(_t(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return C.clone(this,t,e)}))},html:function(t){return j(this,(function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Rt.test(t)&&!vt[(gt.exec(t)||["",""])[1].toLowerCase()]){t=C.htmlPrefilter(t);try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(C.cleanData(_t(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return zt(this,arguments,(function(e){var n=this.parentNode;C.inArray(this,t)<0&&(C.cleanData(_t(this)),n&&n.replaceChild(e,this))}),t)}}),C.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){C.fn[t]=function(t){for(var n,r=[],i=C(t),a=i.length-1,s=0;s<=a;s++)n=s===a?this:this.clone(!0),C(i[s])[e](n),u.apply(r,n.get());return this.pushStack(r)}}));var Bt=new RegExp("^("+rt+")(?!px)[a-z%]+$","i"),Wt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},qt=function(t,e,n){var r,i,a={};for(i in e)a[i]=t.style[i],t.style[i]=e[i];for(i in r=n.call(t),e)t.style[i]=a[i];return r},Vt=new RegExp(at.join("|"),"i");function Ut(t,e,n){var r,i,a,s,o=t.style;return(n=n||Wt(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||ot(t)||(s=C.style(t,e)),!g.pixelBoxStyles()&&Bt.test(s)&&Vt.test(e)&&(r=o.width,i=o.minWidth,a=o.maxWidth,o.minWidth=o.maxWidth=o.width=s,s=n.width,o.width=r,o.minWidth=i,o.maxWidth=a)),void 0!==s?s+"":s}function jt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(c){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",st.appendChild(u).appendChild(c);var t=n.getComputedStyle(c);r="1%"!==t.top,l=12===e(t.marginLeft),c.style.right="60%",s=36===e(t.right),i=36===e(t.width),c.style.position="absolute",a=12===e(c.offsetWidth/3),st.removeChild(u),c=null}}function e(t){return Math.round(parseFloat(t))}var r,i,a,s,o,l,u=_.createElement("div"),c=_.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===c.style.backgroundClip,C.extend(g,{boxSizingReliable:function(){return t(),i},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),a},reliableTrDimensions:function(){var t,e,r,i;return null==o&&(t=_.createElement("table"),e=_.createElement("tr"),r=_.createElement("div"),t.style.cssText="position:absolute;left:-11111px",e.style.height="1px",r.style.height="9px",st.appendChild(t).appendChild(e).appendChild(r),i=n.getComputedStyle(e),o=3<parseInt(i.height),st.removeChild(t)),o}}))}();var Ht=["Webkit","Moz","ms"],Gt=_.createElement("div").style,Jt={};function Xt(t){return C.cssProps[t]||Jt[t]||(t in Gt?t:Jt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Ht.length;n--;)if((t=Ht[n]+e)in Gt)return t}(t)||t)}var Kt=/^(none|table(?!-c[ea]).+)/,Zt=/^--/,Yt={position:"absolute",visibility:"hidden",display:"block"},Qt={letterSpacing:"0",fontWeight:"400"};function te(t,e,n){var r=it.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function ee(t,e,n,r,i,a){var s="width"===e?1:0,o=0,l=0;if(n===(r?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=C.css(t,n+at[s],!0,i)),r?("content"===n&&(l-=C.css(t,"padding"+at[s],!0,i)),"margin"!==n&&(l-=C.css(t,"border"+at[s]+"Width",!0,i))):(l+=C.css(t,"padding"+at[s],!0,i),"padding"!==n?l+=C.css(t,"border"+at[s]+"Width",!0,i):o+=C.css(t,"border"+at[s]+"Width",!0,i));return!r&&0<=a&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-a-l-o-.5))||0),l}function ne(t,e,n){var r=Wt(t),i=(!g.boxSizingReliable()||n)&&"border-box"===C.css(t,"boxSizing",!1,r),a=i,s=Ut(t,e,r),o="offset"+e[0].toUpperCase()+e.slice(1);if(Bt.test(s)){if(!n)return s;s="auto"}return(!g.boxSizingReliable()&&i||!g.reliableTrDimensions()&&T(t,"tr")||"auto"===s||!parseFloat(s)&&"inline"===C.css(t,"display",!1,r))&&t.getClientRects().length&&(i="border-box"===C.css(t,"boxSizing",!1,r),(a=o in t)&&(s=t[o])),(s=parseFloat(s)||0)+ee(t,e,n||(i?"border":"content"),a,r,s)+"px"}function re(t,e,n,r,i){return new re.prototype.init(t,e,n,r,i)}C.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Ut(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,a,s,o=X(e),l=Zt.test(e),u=t.style;if(l||(e=Xt(o)),s=C.cssHooks[e]||C.cssHooks[o],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(t,!1,r))?i:u[e];"string"==(a=typeof n)&&(i=it.exec(n))&&i[1]&&(n=ct(t,e,i),a="number"),null!=n&&n==n&&("number"!==a||l||(n+=i&&i[3]||(C.cssNumber[o]?"":"px")),g.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,r))||(l?u.setProperty(e,n):u[e]=n))}},css:function(t,e,n,r){var i,a,s,o=X(e);return Zt.test(e)||(e=Xt(o)),(s=C.cssHooks[e]||C.cssHooks[o])&&"get"in s&&(i=s.get(t,!0,n)),void 0===i&&(i=Ut(t,e,r)),"normal"===i&&e in Qt&&(i=Qt[e]),""===n||n?(a=parseFloat(i),!0===n||isFinite(a)?a||0:i):i}}),C.each(["height","width"],(function(t,e){C.cssHooks[e]={get:function(t,n,r){if(n)return!Kt.test(C.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ne(t,e,r):qt(t,Yt,(function(){return ne(t,e,r)}))},set:function(t,n,r){var i,a=Wt(t),s=!g.scrollboxSize()&&"absolute"===a.position,o=(s||r)&&"border-box"===C.css(t,"boxSizing",!1,a),l=r?ee(t,e,r,o,a):0;return o&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(a[e])-ee(t,e,"border",!1,a)-.5)),l&&(i=it.exec(n))&&"px"!==(i[3]||"px")&&(t.style[e]=n,n=C.css(t,e)),te(0,n,l)}}})),C.cssHooks.marginLeft=jt(g.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Ut(t,"marginLeft"))||t.getBoundingClientRect().left-qt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),C.each({margin:"",padding:"",border:"Width"},(function(t,e){C.cssHooks[t+e]={expand:function(n){for(var r=0,i={},a="string"==typeof n?n.split(" "):[n];r<4;r++)i[t+at[r]+e]=a[r]||a[r-2]||a[0];return i}},"margin"!==t&&(C.cssHooks[t+e].set=te)})),C.fn.extend({css:function(t,e){return j(this,(function(t,e,n){var r,i,a={},s=0;if(Array.isArray(e)){for(r=Wt(t),i=e.length;s<i;s++)a[e[s]]=C.css(t,e[s],!1,r);return a}return void 0!==n?C.style(t,e,n):C.css(t,e)}),t,e,1<arguments.length)}}),((C.Tween=re).prototype={constructor:re,init:function(t,e,n,r,i,a){this.elem=t,this.prop=n,this.easing=i||C.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=a||(C.cssNumber[n]?"":"px")},cur:function(){var t=re.propHooks[this.prop];return t&&t.get?t.get(this):re.propHooks._default.get(this)},run:function(t){var e,n=re.propHooks[this.prop];return this.pos=e=this.options.duration?C.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):re.propHooks._default.set(this),this}}).init.prototype=re.prototype,(re.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=C.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){C.fx.step[t.prop]?C.fx.step[t.prop](t):1!==t.elem.nodeType||!C.cssHooks[t.prop]&&null==t.elem.style[Xt(t.prop)]?t.elem[t.prop]=t.now:C.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=re.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},C.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},C.fx=re.prototype.init,C.fx.step={};var ie,ae,se,oe,le=/^(?:toggle|show|hide)$/,ue=/queueHooks$/;function ce(){ae&&(!1===_.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(ce):n.setTimeout(ce,C.fx.interval),C.fx.tick())}function he(){return n.setTimeout((function(){ie=void 0})),ie=Date.now()}function de(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=at[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function pe(t,e,n){for(var r,i=(fe.tweeners[e]||[]).concat(fe.tweeners["*"]),a=0,s=i.length;a<s;a++)if(r=i[a].call(n,e,t))return r}function fe(t,e,n){var r,i,a=0,s=fe.prefilters.length,o=C.Deferred().always((function(){delete l.elem})),l=function(){if(i)return!1;for(var e=ie||he(),n=Math.max(0,u.startTime+u.duration-e),r=1-(n/u.duration||0),a=0,s=u.tweens.length;a<s;a++)u.tweens[a].run(r);return o.notifyWith(t,[u,r,n]),r<1&&s?n:(s||o.notifyWith(t,[u,1,0]),o.resolveWith(t,[u]),!1)},u=o.promise({elem:t,props:C.extend({},e),opts:C.extend(!0,{specialEasing:{},easing:C.easing._default},n),originalProperties:e,originalOptions:n,startTime:ie||he(),duration:n.duration,tweens:[],createTween:function(e,n){var r=C.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(r),r},stop:function(e){var n=0,r=e?u.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)u.tweens[n].run(1);return e?(o.notifyWith(t,[u,1,0]),o.resolveWith(t,[u,e])):o.rejectWith(t,[u,e]),this}}),c=u.props;for(function(t,e){var n,r,i,a,s;for(n in t)if(i=e[r=X(n)],a=t[n],Array.isArray(a)&&(i=a[1],a=t[n]=a[0]),n!==r&&(t[r]=a,delete t[n]),(s=C.cssHooks[r])&&"expand"in s)for(n in a=s.expand(a),delete t[r],a)n in t||(t[n]=a[n],e[n]=i);else e[r]=i}(c,u.opts.specialEasing);a<s;a++)if(r=fe.prefilters[a].call(u,t,c,u.opts))return y(r.stop)&&(C._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return C.map(c,pe,u),y(u.opts.start)&&u.opts.start.call(t,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),C.fx.timer(C.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u}C.Animation=C.extend(fe,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ct(n.elem,t,it.exec(e),n),n}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(z);for(var n,r=0,i=t.length;r<i;r++)(fe.tweeners[n=t[r]]=fe.tweeners[n]||[]).unshift(e)},prefilters:[function(t,e,n){var r,i,a,s,o,l,u,c,h="width"in e||"height"in e,d=this,p={},f=t.style,m=t.nodeType&&ut(t),g=Y.get(t,"fxshow");for(r in n.queue||(null==(s=C._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,o=s.empty.fire,s.empty.fire=function(){s.unqueued||o()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,C.queue(t,"fx").length||s.empty.fire()}))}))),e)if(le.test(i=e[r])){if(delete e[r],a=a||"toggle"===i,i===(m?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;m=!0}p[r]=g&&g[r]||C.style(t,r)}if((l=!C.isEmptyObject(e))||!C.isEmptyObject(p))for(r in h&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(u=g&&g.display)&&(u=Y.get(t,"display")),"none"===(c=C.css(t,"display"))&&(u?c=u:(dt([t],!0),u=t.style.display||u,c=C.css(t,"display"),dt([t]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===C.css(t,"float")&&(l||(d.done((function(){f.display=u})),null==u&&(u="none"===(c=f.display)?"":c)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(m=g.hidden):g=Y.access(t,"fxshow",{display:u}),a&&(g.hidden=!m),m&&dt([t],!0),d.done((function(){for(r in m||dt([t]),Y.remove(t,"fxshow"),p)C.style(t,r,p[r])}))),l=pe(m?g[r]:0,r,d),r in g||(g[r]=l.start,m&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?fe.prefilters.unshift(t):fe.prefilters.push(t)}}),C.speed=function(t,e,n){var r=t&&"object"==typeof t?C.extend({},t):{complete:n||!n&&e||y(t)&&t,duration:t,easing:n&&e||e&&!y(e)&&e};return C.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration=r.duration in C.fx.speeds?C.fx.speeds[r.duration]:C.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){y(r.old)&&r.old.call(this),r.queue&&C.dequeue(this,r.queue)},r},C.fn.extend({fadeTo:function(t,e,n,r){return this.filter(ut).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=C.isEmptyObject(t),a=C.speed(e,n,r),s=function(){var e=fe(this,C.extend({},t),a);(i||Y.get(this,"finish"))&&e.stop(!0)};return s.finish=s,i||!1===a.queue?this.each(s):this.queue(a.queue,s)},stop:function(t,e,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,i=null!=t&&t+"queueHooks",a=C.timers,s=Y.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&ue.test(i)&&r(s[i]);for(i=a.length;i--;)a[i].elem!==this||null!=t&&a[i].queue!==t||(a[i].anim.stop(n),e=!1,a.splice(i,1));!e&&n||C.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=Y.get(this),r=n[t+"queue"],i=n[t+"queueHooks"],a=C.timers,s=r?r.length:0;for(n.finish=!0,C.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=a.length;e--;)a[e].elem===this&&a[e].queue===t&&(a[e].anim.stop(!0),a.splice(e,1));for(e=0;e<s;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish}))}}),C.each(["toggle","show","hide"],(function(t,e){var n=C.fn[e];C.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(de(e,!0),t,r,i)}})),C.each({slideDown:de("show"),slideUp:de("hide"),slideToggle:de("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){C.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}})),C.timers=[],C.fx.tick=function(){var t,e=0,n=C.timers;for(ie=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||C.fx.stop(),ie=void 0},C.fx.timer=function(t){C.timers.push(t),C.fx.start()},C.fx.interval=13,C.fx.start=function(){ae||(ae=!0,ce())},C.fx.stop=function(){ae=null},C.fx.speeds={slow:600,fast:200,_default:400},C.fn.delay=function(t,e){return t=C.fx&&C.fx.speeds[t]||t,this.queue(e=e||"fx",(function(e,r){var i=n.setTimeout(e,t);r.stop=function(){n.clearTimeout(i)}}))},se=_.createElement("input"),oe=_.createElement("select").appendChild(_.createElement("option")),se.type="checkbox",g.checkOn=""!==se.value,g.optSelected=oe.selected,(se=_.createElement("input")).value="t",se.type="radio",g.radioValue="t"===se.value;var me,ge=C.expr.attrHandle;C.fn.extend({attr:function(t,e){return j(this,C.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each((function(){C.removeAttr(this,t)}))}}),C.extend({attr:function(t,e,n){var r,i,a=t.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===t.getAttribute?C.prop(t,e,n):(1===a&&C.isXMLDoc(t)||(i=C.attrHooks[e.toLowerCase()]||(C.expr.match.bool.test(e)?me:void 0)),void 0!==n?null===n?void C.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=C.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){if(!g.radioValue&&"radio"===e&&T(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r=0,i=e&&e.match(z);if(i&&1===t.nodeType)for(;n=i[r++];)t.removeAttribute(n)}}),me={set:function(t,e,n){return!1===e?C.removeAttr(t,n):t.setAttribute(n,n),n}},C.each(C.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=ge[e]||C.find.attr;ge[e]=function(t,e,r){var i,a,s=e.toLowerCase();return r||(a=ge[s],ge[s]=i,i=null!=n(t,e,r)?s:null,ge[s]=a),i}}));var ye=/^(?:input|select|textarea|button)$/i,ve=/^(?:a|area)$/i;function _e(t){return(t.match(z)||[]).join(" ")}function be(t){return t.getAttribute&&t.getAttribute("class")||""}function xe(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(z)||[]}C.fn.extend({prop:function(t,e){return j(this,C.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each((function(){delete this[C.propFix[t]||t]}))}}),C.extend({prop:function(t,e,n){var r,i,a=t.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&C.isXMLDoc(t)||(i=C.propHooks[e=C.propFix[e]||e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=C.find.attr(t,"tabindex");return e?parseInt(e,10):ye.test(t.nodeName)||ve.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(C.propHooks.selected={get:function(t){return null},set:function(t){}}),C.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){C.propFix[this.toLowerCase()]=this})),C.fn.extend({addClass:function(t){var e,n,r,i,a,s,o,l=0;if(y(t))return this.each((function(e){C(this).addClass(t.call(this,e,be(this)))}));if((e=xe(t)).length)for(;n=this[l++];)if(i=be(n),r=1===n.nodeType&&" "+_e(i)+" "){for(s=0;a=e[s++];)r.indexOf(" "+a+" ")<0&&(r+=a+" ");i!==(o=_e(r))&&n.setAttribute("class",o)}return this},removeClass:function(t){var e,n,r,i,a,s,o,l=0;if(y(t))return this.each((function(e){C(this).removeClass(t.call(this,e,be(this)))}));if(!arguments.length)return this.attr("class","");if((e=xe(t)).length)for(;n=this[l++];)if(i=be(n),r=1===n.nodeType&&" "+_e(i)+" "){for(s=0;a=e[s++];)for(;-1<r.indexOf(" "+a+" ");)r=r.replace(" "+a+" "," ");i!==(o=_e(r))&&n.setAttribute("class",o)}return this},toggleClass:function(t,e){var n=typeof t,r="string"===n||Array.isArray(t);return"boolean"==typeof e&&r?e?this.addClass(t):this.removeClass(t):y(t)?this.each((function(n){C(this).toggleClass(t.call(this,n,be(this),e),e)})):this.each((function(){var e,i,a,s;if(r)for(i=0,a=C(this),s=xe(t);e=s[i++];)a.hasClass(e)?a.removeClass(e):a.addClass(e);else void 0!==t&&"boolean"!==n||((e=be(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Y.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,r=0;for(e=" "+t+" ";n=this[r++];)if(1===n.nodeType&&-1<(" "+_e(be(n))+" ").indexOf(e))return!0;return!1}});var we=/\r/g;C.fn.extend({val:function(t){var e,n,r,i=this[0];return arguments.length?(r=y(t),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?t.call(this,n,C(this).val()):t)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=C.map(i,(function(t){return null==t?"":t+""}))),(e=C.valHooks[this.type]||C.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))}))):i?(e=C.valHooks[i.type]||C.valHooks[i.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(we,""):null==n?"":n:void 0}}),C.extend({valHooks:{option:{get:function(t){var e=C.find.attr(t,"value");return null!=e?e:_e(C.text(t))}},select:{get:function(t){var e,n,r,i=t.options,a=t.selectedIndex,s="select-one"===t.type,o=s?null:[],l=s?a+1:i.length;for(r=a<0?l:s?a:0;r<l;r++)if(((n=i[r]).selected||r===a)&&!n.disabled&&(!n.parentNode.disabled||!T(n.parentNode,"optgroup"))){if(e=C(n).val(),s)return e;o.push(e)}return o},set:function(t,e){for(var n,r,i=t.options,a=C.makeArray(e),s=i.length;s--;)((r=i[s]).selected=-1<C.inArray(C.valHooks.option.get(r),a))&&(n=!0);return n||(t.selectedIndex=-1),a}}}}),C.each(["radio","checkbox"],(function(){C.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<C.inArray(C(t).val(),e)}},g.checkOn||(C.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),g.focusin="onfocusin"in n;var Se=/^(?:focusinfocus|focusoutblur)$/,Ce=function(t){t.stopPropagation()};C.extend(C.event,{trigger:function(t,e,r,i){var a,s,o,l,u,c,h,d,f=[r||_],m=p.call(t,"type")?t.type:t,g=p.call(t,"namespace")?t.namespace.split("."):[];if(s=d=o=r=r||_,3!==r.nodeType&&8!==r.nodeType&&!Se.test(m+C.event.triggered)&&(-1<m.indexOf(".")&&(m=(g=m.split(".")).shift(),g.sort()),u=m.indexOf(":")<0&&"on"+m,(t=t[C.expando]?t:new C.Event(m,"object"==typeof t&&t)).isTrigger=i?2:3,t.namespace=g.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),e=null==e?[t]:C.makeArray(e,[t]),h=C.event.special[m]||{},i||!h.trigger||!1!==h.trigger.apply(r,e))){if(!i&&!h.noBubble&&!v(r)){for(Se.test((l=h.delegateType||m)+m)||(s=s.parentNode);s;s=s.parentNode)f.push(s),o=s;o===(r.ownerDocument||_)&&f.push(o.defaultView||o.parentWindow||n)}for(a=0;(s=f[a++])&&!t.isPropagationStopped();)d=s,t.type=1<a?l:h.bindType||m,(c=(Y.get(s,"events")||Object.create(null))[t.type]&&Y.get(s,"handle"))&&c.apply(s,e),(c=u&&s[u])&&c.apply&&K(s)&&(t.result=c.apply(s,e),!1===t.result&&t.preventDefault());return t.type=m,i||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(f.pop(),e)||!K(r)||u&&y(r[m])&&!v(r)&&((o=r[u])&&(r[u]=null),C.event.triggered=m,t.isPropagationStopped()&&d.addEventListener(m,Ce),r[m](),t.isPropagationStopped()&&d.removeEventListener(m,Ce),C.event.triggered=void 0,o&&(r[u]=o)),t.result}},simulate:function(t,e,n){var r=C.extend(new C.Event,n,{type:t,isSimulated:!0});C.event.trigger(r,null,e)}}),C.fn.extend({trigger:function(t,e){return this.each((function(){C.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return C.event.trigger(t,e,n,!0)}}),g.focusin||C.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){C.event.simulate(e,t.target,C.event.fix(t))};C.event.special[e]={setup:function(){var r=this.ownerDocument||this.document||this,i=Y.access(r,e);i||r.addEventListener(t,n,!0),Y.access(r,e,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=Y.access(r,e)-1;i?Y.access(r,e,i):(r.removeEventListener(t,n,!0),Y.remove(r,e))}}}));var De=n.location,Ie={guid:Date.now()},ke=/\?/;C.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||C.error("Invalid XML: "+t),e};var Ee=/\[\]$/,Ae=/\r?\n/g,Te=/^(?:submit|button|image|reset|file)$/i,Re=/^(?:input|select|textarea|keygen)/i;function Me(t,e,n,r){var i;if(Array.isArray(e))C.each(e,(function(e,i){n||Ee.test(t)?r(t,i):Me(t+"["+("object"==typeof i&&null!=i?e:"")+"]",i,n,r)}));else if(n||"object"!==w(e))r(t,e);else for(i in e)Me(t+"["+i+"]",e[i],n,r)}C.param=function(t,e){var n,r=[],i=function(t,e){var n=y(e)?e():e;r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!C.isPlainObject(t))C.each(t,(function(){i(this.name,this.value)}));else for(n in t)Me(n,t[n],e,i);return r.join("&")},C.fn.extend({serialize:function(){return C.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=C.prop(this,"elements");return t?C.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!C(this).is(":disabled")&&Re.test(this.nodeName)&&!Te.test(t)&&(this.checked||!mt.test(t))})).map((function(t,e){var n=C(this).val();return null==n?null:Array.isArray(n)?C.map(n,(function(t){return{name:e.name,value:t.replace(Ae,"\r\n")}})):{name:e.name,value:n.replace(Ae,"\r\n")}})).get()}});var Ne=/%20/g,Oe=/#.*$/,Pe=/([?&])_=[^&]*/,Fe=/^(.*?):[ \t]*([^\r\n]*)$/gm,Le=/^(?:GET|HEAD)$/,ze=/^\/\//,$e={},Be={},We="*/".concat("*"),qe=_.createElement("a");function Ve(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,a=e.toLowerCase().match(z)||[];if(y(n))for(;r=a[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function Ue(t,e,n,r){var i={},a=t===Be;function s(o){var l;return i[o]=!0,C.each(t[o]||[],(function(t,o){var u=o(e,n,r);return"string"!=typeof u||a||i[u]?a?!(l=u):void 0:(e.dataTypes.unshift(u),s(u),!1)})),l}return s(e.dataTypes[0])||!i["*"]&&s("*")}function je(t,e){var n,r,i=C.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r||(r={}))[n]=e[n]);return r&&C.extend(!0,t,r),t}qe.href=De.href,C.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:De.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(De.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":We,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":C.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?je(je(t,C.ajaxSettings),e):je(C.ajaxSettings,t)},ajaxPrefilter:Ve($e),ajaxTransport:Ve(Be),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0);var r,i,a,s,o,l,u,c,h,d,p=C.ajaxSetup({},e=e||{}),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?C(f):C.event,g=C.Deferred(),y=C.Callbacks("once memory"),v=p.statusCode||{},b={},x={},w="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(u){if(!s)for(s={};e=Fe.exec(a);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return u?a:null},setRequestHeader:function(t,e){return null==u&&(t=x[t.toLowerCase()]=x[t.toLowerCase()]||t,b[t]=e),this},overrideMimeType:function(t){return null==u&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(u)S.always(t[S.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||w;return r&&r.abort(e),D(0,e),this}};if(g.promise(S),p.url=((t||p.url||De.href)+"").replace(ze,De.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(z)||[""],null==p.crossDomain){l=_.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=qe.protocol+"//"+qe.host!=l.protocol+"//"+l.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=C.param(p.data,p.traditional)),Ue($e,p,e,S),u)return S;for(h in(c=C.event&&p.global)&&0==C.active++&&C.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Le.test(p.type),i=p.url.replace(Oe,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ne,"+")):(d=p.url.slice(i.length),p.data&&(p.processData||"string"==typeof p.data)&&(i+=(ke.test(i)?"&":"?")+p.data,delete p.data),!1===p.cache&&(i=i.replace(Pe,"$1"),d=(ke.test(i)?"&":"?")+"_="+Ie.guid+++d),p.url=i+d),p.ifModified&&(C.lastModified[i]&&S.setRequestHeader("If-Modified-Since",C.lastModified[i]),C.etag[i]&&S.setRequestHeader("If-None-Match",C.etag[i])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&S.setRequestHeader("Content-Type",p.contentType),S.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+We+"; q=0.01":""):p.accepts["*"]),p.headers)S.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(f,S,p)||u))return S.abort();if(w="abort",y.add(p.complete),S.done(p.success),S.fail(p.error),r=Ue(Be,p,e,S)){if(S.readyState=1,c&&m.trigger("ajaxSend",[S,p]),u)return S;p.async&&0<p.timeout&&(o=n.setTimeout((function(){S.abort("timeout")}),p.timeout));try{u=!1,r.send(b,D)}catch(t){if(u)throw t;D(-1,t)}}else D(-1,"No Transport");function D(t,e,s,l){var h,d,_,b,x,w=e;u||(u=!0,o&&n.clearTimeout(o),r=void 0,a=l||"",S.readyState=0<t?4:0,h=200<=t&&t<300||304===t,s&&(b=function(t,e,n){for(var r,i,a,s,o=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in o)if(o[i]&&o[i].test(r)){l.unshift(i);break}if(l[0]in n)a=l[0];else{for(i in n){if(!l[0]||t.converters[i+" "+l[0]]){a=i;break}s||(s=i)}a=a||s}if(a)return a!==l[0]&&l.unshift(a),n[a]}(p,S,s)),!h&&-1<C.inArray("script",p.dataTypes)&&(p.converters["text script"]=function(){}),b=function(t,e,n,r){var i,a,s,o,l,u={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)u[s.toLowerCase()]=t.converters[s];for(a=c.shift();a;)if(t.responseFields[a]&&(n[t.responseFields[a]]=e),!l&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=a,a=c.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(s=u[l+" "+a]||u["* "+a]))for(i in u)if((o=i.split(" "))[1]===a&&(s=u[l+" "+o[0]]||u["* "+o[0]])){!0===s?s=u[i]:!0!==u[i]&&(a=o[0],c.unshift(o[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+a}}}return{state:"success",data:e}}(p,b,S,h),h?(p.ifModified&&((x=S.getResponseHeader("Last-Modified"))&&(C.lastModified[i]=x),(x=S.getResponseHeader("etag"))&&(C.etag[i]=x)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=b.state,d=b.data,h=!(_=b.error))):(_=w,!t&&w||(w="error",t<0&&(t=0))),S.status=t,S.statusText=(e||w)+"",h?g.resolveWith(f,[d,w,S]):g.rejectWith(f,[S,w,_]),S.statusCode(v),v=void 0,c&&m.trigger(h?"ajaxSuccess":"ajaxError",[S,p,h?d:_]),y.fireWith(f,[S,w]),c&&(m.trigger("ajaxComplete",[S,p]),--C.active||C.event.trigger("ajaxStop")))}return S},getJSON:function(t,e,n){return C.get(t,e,n,"json")},getScript:function(t,e){return C.get(t,void 0,e,"script")}}),C.each(["get","post"],(function(t,e){C[e]=function(t,n,r,i){return y(n)&&(i=i||r,r=n,n=void 0),C.ajax(C.extend({url:t,type:e,dataType:i,data:n,success:r},C.isPlainObject(t)&&t))}})),C.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),C._evalUrl=function(t,e,n){return C.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){C.globalEval(t,e,n)}})},C.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=C(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return y(t)?this.each((function(e){C(this).wrapInner(t.call(this,e))})):this.each((function(){var e=C(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=y(t);return this.each((function(n){C(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){C(this).replaceWith(this.childNodes)})),this}}),C.expr.pseudos.hidden=function(t){return!C.expr.pseudos.visible(t)},C.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},C.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(i){}};var He={0:200,1223:204},Ge=C.ajaxSettings.xhr();g.cors=!!Ge&&"withCredentials"in Ge,g.ajax=Ge=!!Ge,C.ajaxTransport((function(t){var e,r;if(g.cors||Ge&&!t.crossDomain)return{send:function(i,a){var s,o=t.xhr();if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)o[s]=t.xhrFields[s];for(s in t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)o.setRequestHeader(s,i[s]);e=function(t){return function(){e&&(e=r=o.onload=o.onerror=o.onabort=o.ontimeout=o.onreadystatechange=null,"abort"===t?o.abort():"error"===t?"number"!=typeof o.status?a(0,"error"):a(o.status,o.statusText):a(He[o.status]||o.status,o.statusText,"text"!==(o.responseType||"text")||"string"!=typeof o.responseText?{binary:o.response}:{text:o.responseText},o.getAllResponseHeaders()))}},o.onload=e(),r=o.onerror=o.ontimeout=e("error"),void 0!==o.onabort?o.onabort=r:o.onreadystatechange=function(){4===o.readyState&&n.setTimeout((function(){e&&r()}))},e=e("abort");try{o.send(t.hasContent&&t.data||null)}catch(i){if(e)throw i}},abort:function(){e&&e()}}})),C.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),C.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return C.globalEval(t),t}}}),C.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),C.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(r,i){e=C("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&i("error"===t.type?404:200,t.type)}),_.head.appendChild(e[0])},abort:function(){n&&n()}}}));var Je,Xe=[],Ke=/(=)\?(?=&|$)|\?\?/;C.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Xe.pop()||C.expando+"_"+Ie.guid++;return this[t]=!0,t}}),C.ajaxPrefilter("json jsonp",(function(t,e,r){var i,a,s,o=!1!==t.jsonp&&(Ke.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ke.test(t.data)&&"data");if(o||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(Ke,"$1"+i):!1!==t.jsonp&&(t.url+=(ke.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||C.error(i+" was not called"),s[0]},t.dataTypes[0]="json",a=n[i],n[i]=function(){s=arguments},r.always((function(){void 0===a?C(n).removeProp(i):n[i]=a,t[i]&&(t.jsonpCallback=e.jsonpCallback,Xe.push(i)),s&&y(a)&&a(s[0]),s=a=void 0})),"script"})),g.createHTMLDocument=((Je=_.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Je.childNodes.length),C.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(g.createHTMLDocument?((r=(e=_.implementation.createHTMLDocument("")).createElement("base")).href=_.location.href,e.head.appendChild(r)):e=_),a=!n&&[],(i=R.exec(t))?[e.createElement(i[1])]:(i=wt([t],e,a),a&&a.length&&C(a).remove(),C.merge([],i.childNodes)));var r,i,a},C.fn.load=function(t,e,n){var r,i,a,s=this,o=t.indexOf(" ");return-1<o&&(r=_e(t.slice(o)),t=t.slice(0,o)),y(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),0<s.length&&C.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done((function(t){a=arguments,s.html(r?C("<div>").append(C.parseHTML(t)).find(r):t)})).always(n&&function(t,e){s.each((function(){n.apply(this,a||[t.responseText,e,t])}))}),this},C.expr.pseudos.animated=function(t){return C.grep(C.timers,(function(e){return t===e.elem})).length},C.offset={setOffset:function(t,e,n){var r,i,a,s,o,l,u=C.css(t,"position"),c=C(t),h={};"static"===u&&(t.style.position="relative"),o=c.offset(),a=C.css(t,"top"),l=C.css(t,"left"),("absolute"===u||"fixed"===u)&&-1<(a+l).indexOf("auto")?(s=(r=c.position()).top,i=r.left):(s=parseFloat(a)||0,i=parseFloat(l)||0),y(e)&&(e=e.call(t,n,C.extend({},o))),null!=e.top&&(h.top=e.top-o.top+s),null!=e.left&&(h.left=e.left-o.left+i),"using"in e?e.using.call(t,h):("number"==typeof h.top&&(h.top+="px"),"number"==typeof h.left&&(h.left+="px"),c.css(h))}},C.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){C.offset.setOffset(this,t,e)}));var e,n,r=this[0];return r?r.getClientRects().length?{top:(e=r.getBoundingClientRect()).top+(n=r.ownerDocument.defaultView).pageYOffset,left:e.left+n.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,r=this[0],i={top:0,left:0};if("fixed"===C.css(r,"position"))e=r.getBoundingClientRect();else{for(e=this.offset(),n=r.ownerDocument,t=r.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===C.css(t,"position");)t=t.parentNode;t&&t!==r&&1===t.nodeType&&((i=C(t).offset()).top+=C.css(t,"borderTopWidth",!0),i.left+=C.css(t,"borderLeftWidth",!0))}return{top:e.top-i.top-C.css(r,"marginTop",!0),left:e.left-i.left-C.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===C.css(t,"position");)t=t.offsetParent;return t||st}))}}),C.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;C.fn[t]=function(r){return j(this,(function(t,r,i){var a;if(v(t)?a=t:9===t.nodeType&&(a=t.defaultView),void 0===i)return a?a[e]:t[r];a?a.scrollTo(n?a.pageXOffset:i,n?i:a.pageYOffset):t[r]=i}),t,r,arguments.length)}})),C.each(["top","left"],(function(t,e){C.cssHooks[e]=jt(g.pixelPosition,(function(t,n){if(n)return n=Ut(t,e),Bt.test(n)?C(t).position()[e]+"px":n}))})),C.each({Height:"height",Width:"width"},(function(t,e){C.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,r){C.fn[r]=function(i,a){var s=arguments.length&&(n||"boolean"!=typeof i),o=n||(!0===i||!0===a?"margin":"border");return j(this,(function(e,n,i){var a;return v(e)?0===r.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(a=e.documentElement,Math.max(e.body["scroll"+t],a["scroll"+t],e.body["offset"+t],a["offset"+t],a["client"+t])):void 0===i?C.css(e,n,o):C.style(e,n,i,o)}),e,s?i:void 0,s)}}))})),C.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){C.fn[e]=function(t){return this.on(e,t)}})),C.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),C.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){C.fn[e]=function(t,n){return 0<arguments.length?this.on(e,null,t,n):this.trigger(e)}}));var Ze=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;C.proxy=function(t,e){var n,r,i;if("string"==typeof e&&(n=t[e],e=t,t=n),y(t))return r=o.call(arguments,2),(i=function(){return t.apply(e||this,r.concat(o.call(arguments)))}).guid=t.guid=t.guid||C.guid++,i},C.holdReady=function(t){t?C.readyWait++:C.ready(!0)},C.isArray=Array.isArray,C.parseJSON=JSON.parse,C.nodeName=T,C.isFunction=y,C.isWindow=v,C.camelCase=X,C.type=w,C.now=Date.now,C.isNumeric=function(t){var e=C.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},C.trim=function(t){return null==t?"":(t+"").replace(Ze,"")},void 0===(r=(function(){return C}).apply(e,[]))||(t.exports=r);var Ye=n.jQuery,Qe=n.$;return C.noConflict=function(t){return n.$===C&&(n.$=Qe),t&&n.jQuery===C&&(n.jQuery=Ye),C},void 0===i&&(n.jQuery=n.$=C),C}))},yuCN:function(t,e,n){(function(t){var r;!function(t,i,a){function s(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],r[i]=n^=(t^=t<<13)^t<<9,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,i))||(i.exports=r):this.xorshift7=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},zUnb:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"shuffle",(function(){return jm})),n.d(r,"clamp",(function(){return Hm})),n.d(r,"nearestLargerEven",(function(){return Gm})),n.d(r,"sum",(function(){return Jm})),n.d(r,"randUniform",(function(){return Xm})),n.d(r,"distSquared",(function(){return Km})),n.d(r,"assert",(function(){return Zm})),n.d(r,"assertShapesMatch",(function(){return Ym})),n.d(r,"assertNonNull",(function(){return Qm})),n.d(r,"flatten",(function(){return tg})),n.d(r,"sizeFromShape",(function(){return eg})),n.d(r,"isScalarShape",(function(){return ng})),n.d(r,"arraysEqual",(function(){return rg})),n.d(r,"isInt",(function(){return ig})),n.d(r,"tanh",(function(){return ag})),n.d(r,"sizeToSquarishShape",(function(){return sg})),n.d(r,"createShuffledIndices",(function(){return og})),n.d(r,"rightPad",(function(){return lg})),n.d(r,"repeatedTry",(function(){return ug})),n.d(r,"inferFromImplicitShape",(function(){return cg})),n.d(r,"parseAxisParam",(function(){return hg})),n.d(r,"squeezeShape",(function(){return dg})),n.d(r,"getTypedArrayFromDType",(function(){return pg})),n.d(r,"getArrayFromDType",(function(){return fg})),n.d(r,"checkConversionForErrors",(function(){return mg})),n.d(r,"isValidDtype",(function(){return gg})),n.d(r,"hasEncodingLoss",(function(){return yg})),n.d(r,"isTypedArray",(function(){return vg})),n.d(r,"bytesPerElement",(function(){return _g})),n.d(r,"bytesFromStringArray",(function(){return bg})),n.d(r,"isString",(function(){return xg})),n.d(r,"isBoolean",(function(){return wg})),n.d(r,"isNumber",(function(){return Sg})),n.d(r,"inferDtype",(function(){return Cg})),n.d(r,"isFunction",(function(){return Dg})),n.d(r,"nearestDivisor",(function(){return Ig})),n.d(r,"computeStrides",(function(){return kg})),n.d(r,"toTypedArray",(function(){return Eg})),n.d(r,"toNestedArray",(function(){return Ag})),n.d(r,"makeOnesTypedArray",(function(){return Tg})),n.d(r,"makeZerosTypedArray",(function(){return Rg})),n.d(r,"now",(function(){return Mg})),n.d(r,"assertNonNegativeIntegerDimensions",(function(){return Ng})),n.d(r,"fetch",(function(){return Og})),n.d(r,"encodeString",(function(){return Pg})),n.d(r,"decodeString",(function(){return Fg})),n.d(r,"locToIndex",(function(){return Lg})),n.d(r,"indexToLoc",(function(){return zg}));var i={};n.r(i),n.d(i,"makeTypesMatch",(function(){return iy})),n.d(i,"assertTypesMatch",(function(){return ay})),n.d(i,"isTensorInList",(function(){return sy})),n.d(i,"getTensorsInContainer",(function(){return oy}));var a={};n.r(a),n.d(a,"isMobile",(function(){return hy})),n.d(a,"isBrowser",(function(){return dy}));var s={};n.r(s),n.d(s,"assertParamsValid",(function(){return xb})),n.d(s,"maskToAxes",(function(){return wb})),n.d(s,"computeOutShape",(function(){return Sb})),n.d(s,"startForAxis",(function(){return Cb})),n.d(s,"stopForAxis",(function(){return Db})),n.d(s,"isSliceContinous",(function(){return Ib})),n.d(s,"computeFlatOffset",(function(){return kb}));var o={};n.r(o),n.d(o,"copyModel",(function(){return tx})),n.d(o,"listModels",(function(){return Yb})),n.d(o,"moveModel",(function(){return ex})),n.d(o,"removeModel",(function(){return Qb})),n.d(o,"browserFiles",(function(){return xx})),n.d(o,"browserHTTPRequest",(function(){return Tx})),n.d(o,"concatenateArrayBuffers",(function(){return Wb})),n.d(o,"decodeWeights",(function(){return Lb})),n.d(o,"encodeWeights",(function(){return Fb})),n.d(o,"fromMemory",(function(){return Nx})),n.d(o,"getLoadHandlers",(function(){return Jb})),n.d(o,"getModelArtifactsInfoForJSON",(function(){return Vb})),n.d(o,"getSaveHandlers",(function(){return Gb})),n.d(o,"http",(function(){return Ax})),n.d(o,"isHTTPScheme",(function(){return kx})),n.d(o,"loadWeights",(function(){return Cx})),n.d(o,"registerLoadRouter",(function(){return Hb})),n.d(o,"registerSaveRouter",(function(){return jb})),n.d(o,"weightsLoaderFactory",(function(){return Dx})),n.d(o,"withSaveHandler",(function(){return Ox}));var l={};n.r(l),n.d(l,"toPixels",(function(){return Lx})),n.d(l,"fromPixels",(function(){return zx}));var u={};n.r(u),n.d(u,"Serializable",(function(){return Vx})),n.d(u,"SerializationMap",(function(){return Ux})),n.d(u,"registerClass",(function(){return jx}));var c={};n.r(c),n.d(c,"segOpComputeOptimalWindowSize",(function(){return Jw})),n.d(c,"computeOutShape",(function(){return Xw})),n.d(c,"collectGatherOpShapeInfo",(function(){return Kw}));var h={};n.r(h),n.d(h,"fft",(function(){return zS})),n.d(h,"ifft",(function(){return $S})),n.d(h,"rfft",(function(){return BS})),n.d(h,"irfft",(function(){return WS}));var d={};n.r(d),n.d(d,"hannWindow",(function(){return HS})),n.d(d,"hammingWindow",(function(){return GS})),n.d(d,"frame",(function(){return JS})),n.d(d,"stft",(function(){return XS}));var p={};n.r(p),n.d(p,"Reduction",(function(){return ZS})),n.d(p,"absoluteDifference",(function(){return YS})),n.d(p,"computeWeightedLoss",(function(){return QS})),n.d(p,"cosineDistance",(function(){return tC})),n.d(p,"hingeLoss",(function(){return eC})),n.d(p,"huberLoss",(function(){return nC})),n.d(p,"logLoss",(function(){return rC})),n.d(p,"meanSquaredError",(function(){return iC})),n.d(p,"sigmoidCrossEntropy",(function(){return aC})),n.d(p,"softmaxCrossEntropy",(function(){return sC}));var f={};n.r(f),n.d(f,"bandPart",(function(){return lC})),n.d(f,"gramSchmidt",(function(){return uC})),n.d(f,"qr",(function(){return cC}));var m={};n.r(m),n.d(m,"nonMaxSuppression",(function(){return bC})),n.d(m,"resizeBilinear",(function(){return xC})),n.d(m,"resizeNearestNeighbor",(function(){return wC})),n.d(m,"nonMaxSuppressionAsync",(function(){return SC})),n.d(m,"nonMaxSuppressionWithScore",(function(){return CC})),n.d(m,"nonMaxSuppressionWithScoreAsync",(function(){return DC})),n.d(m,"cropAndResize",(function(){return IC}));var g={};n.r(g),n.d(g,"matMul",(function(){return RC})),n.d(g,"conv2d",(function(){return MC})),n.d(g,"depthwiseConv2d",(function(){return NC}));var y={};n.r(y),n.d(y,"add",(function(){return a_})),n.d(y,"addN",(function(){return Hx})),n.d(y,"batchToSpaceND",(function(){return fb})),n.d(y,"batchNorm",(function(){return Jx})),n.d(y,"batchNorm2d",(function(){return Xx})),n.d(y,"batchNorm3d",(function(){return Kx})),n.d(y,"batchNorm4d",(function(){return Zx})),n.d(y,"broadcastTo",(function(){return Qx})),n.d(y,"clone",(function(){return Yx})),n.d(y,"concat",(function(){return Qy})),n.d(y,"concat1d",(function(){return tw})),n.d(y,"concat2d",(function(){return ew})),n.d(y,"concat3d",(function(){return nw})),n.d(y,"concat4d",(function(){return rw})),n.d(y,"conv1d",(function(){return iw})),n.d(y,"conv2d",(function(){return Uv})),n.d(y,"conv2dTranspose",(function(){return aw})),n.d(y,"conv3d",(function(){return sw})),n.d(y,"conv3dTranspose",(function(){return ow})),n.d(y,"depthToSpace",(function(){return lw})),n.d(y,"depthwiseConv2d",(function(){return uw})),n.d(y,"diag",(function(){return cw})),n.d(y,"div",(function(){return nb})),n.d(y,"divNoNan",(function(){return vw})),n.d(y,"dot",(function(){return _w})),n.d(y,"equal",(function(){return bw})),n.d(y,"eye",(function(){return xw})),n.d(y,"greater",(function(){return ww})),n.d(y,"greaterEqual",(function(){return Sw})),n.d(y,"less",(function(){return Cw})),n.d(y,"lessEqual",(function(){return Dw})),n.d(y,"localResponseNormalization",(function(){return Iw})),n.d(y,"matMul",(function(){return cv})),n.d(y,"max",(function(){return kw})),n.d(y,"multinomial",(function(){return Ew})),n.d(y,"notEqual",(function(){return Aw})),n.d(y,"oneHot",(function(){return Px})),n.d(y,"outerProduct",(function(){return Tw})),n.d(y,"pad",(function(){return bb})),n.d(y,"pad1d",(function(){return Rw})),n.d(y,"pad2d",(function(){return Mw})),n.d(y,"pad3d",(function(){return Nw})),n.d(y,"pad4d",(function(){return Ow})),n.d(y,"rand",(function(){return Pw})),n.d(y,"randomGamma",(function(){return Bw})),n.d(y,"randomNormal",(function(){return Ww})),n.d(y,"randomUniform",(function(){return qw})),n.d(y,"separableConv2d",(function(){return Vw})),n.d(y,"spaceToBatchND",(function(){return dv})),n.d(y,"split",(function(){return kv})),n.d(y,"square",(function(){return rb})),n.d(y,"squaredDifference",(function(){return Uw})),n.d(y,"sub",(function(){return ab})),n.d(y,"tile",(function(){return sb})),n.d(y,"truncatedNormal",(function(){return jw})),n.d(y,"booleanMaskAsync",(function(){return eS})),n.d(y,"complex",(function(){return Ny})),n.d(y,"real",(function(){return Oy})),n.d(y,"imag",(function(){return Py})),n.d(y,"reverse",(function(){return nS})),n.d(y,"reverse1d",(function(){return rS})),n.d(y,"reverse2d",(function(){return iS})),n.d(y,"reverse3d",(function(){return aS})),n.d(y,"reverse4d",(function(){return sS})),n.d(y,"maxPool",(function(){return uS})),n.d(y,"avgPool",(function(){return cS})),n.d(y,"pool",(function(){return hS})),n.d(y,"maxPool3d",(function(){return dS})),n.d(y,"avgPool3d",(function(){return pS})),n.d(y,"maxPoolWithArgmax",(function(){return fS})),n.d(y,"slice",(function(){return Eb})),n.d(y,"slice1d",(function(){return Ab})),n.d(y,"slice2d",(function(){return Tb})),n.d(y,"slice3d",(function(){return Rb})),n.d(y,"slice4d",(function(){return Mb})),n.d(y,"abs",(function(){return s_})),n.d(y,"acos",(function(){return o_})),n.d(y,"acosh",(function(){return l_})),n.d(y,"asin",(function(){return u_})),n.d(y,"asinh",(function(){return c_})),n.d(y,"atan",(function(){return h_})),n.d(y,"atanh",(function(){return d_})),n.d(y,"ceil",(function(){return p_})),n.d(y,"clipByValue",(function(){return f_})),n.d(y,"cos",(function(){return m_})),n.d(y,"cosh",(function(){return g_})),n.d(y,"erf",(function(){return y_})),n.d(y,"exp",(function(){return v_})),n.d(y,"expm1",(function(){return __})),n.d(y,"floor",(function(){return b_})),n.d(y,"log",(function(){return x_})),n.d(y,"log1p",(function(){return w_})),n.d(y,"logSigmoid",(function(){return S_})),n.d(y,"neg",(function(){return C_})),n.d(y,"reciprocal",(function(){return D_})),n.d(y,"round",(function(){return I_})),n.d(y,"rsqrt",(function(){return k_})),n.d(y,"sigmoid",(function(){return E_})),n.d(y,"sign",(function(){return A_})),n.d(y,"isNaN",(function(){return T_})),n.d(y,"isInf",(function(){return R_})),n.d(y,"isFinite",(function(){return M_})),n.d(y,"sin",(function(){return N_})),n.d(y,"sinh",(function(){return O_})),n.d(y,"softplus",(function(){return P_})),n.d(y,"sqrt",(function(){return F_})),n.d(y,"step",(function(){return L_})),n.d(y,"tan",(function(){return z_})),n.d(y,"tanh",(function(){return $_})),n.d(y,"all",(function(){return gv})),n.d(y,"any",(function(){return yv})),n.d(y,"argMax",(function(){return vv})),n.d(y,"argMin",(function(){return _v})),n.d(y,"logSumExp",(function(){return bv})),n.d(y,"mean",(function(){return xv})),n.d(y,"min",(function(){return wv})),n.d(y,"moments",(function(){return Sv})),n.d(y,"sum",(function(){return Cv})),n.d(y,"prod",(function(){return Dv})),n.d(y,"equalStrict",(function(){return mS})),n.d(y,"greaterEqualStrict",(function(){return gS})),n.d(y,"greaterStrict",(function(){return yS})),n.d(y,"lessEqualStrict",(function(){return vS})),n.d(y,"lessStrict",(function(){return _S})),n.d(y,"notEqualStrict",(function(){return bS})),n.d(y,"addStrict",(function(){return B_})),n.d(y,"atan2",(function(){return W_})),n.d(y,"divStrict",(function(){return q_})),n.d(y,"floorDiv",(function(){return V_})),n.d(y,"maximum",(function(){return U_})),n.d(y,"maximumStrict",(function(){return j_})),n.d(y,"minimum",(function(){return H_})),n.d(y,"minimumStrict",(function(){return G_})),n.d(y,"mod",(function(){return J_})),n.d(y,"modStrict",(function(){return X_})),n.d(y,"mul",(function(){return K_})),n.d(y,"mulStrict",(function(){return Z_})),n.d(y,"pow",(function(){return Y_})),n.d(y,"powStrict",(function(){return Q_})),n.d(y,"squaredDifferenceStrict",(function(){return tb})),n.d(y,"subStrict",(function(){return eb})),n.d(y,"elu",(function(){return SS})),n.d(y,"leakyRelu",(function(){return CS})),n.d(y,"prelu",(function(){return DS})),n.d(y,"relu",(function(){return IS})),n.d(y,"relu6",(function(){return kS})),n.d(y,"selu",(function(){return ES})),n.d(y,"logicalAnd",(function(){return dw})),n.d(y,"logicalNot",(function(){return pw})),n.d(y,"logicalOr",(function(){return fw})),n.d(y,"logicalXor",(function(){return mw})),n.d(y,"where",(function(){return gw})),n.d(y,"whereAsync",(function(){return yw})),n.d(y,"buffer",(function(){return tv})),n.d(y,"print",(function(){return ev})),n.d(y,"cast",(function(){return nv})),n.d(y,"cumsum",(function(){return rv})),n.d(y,"expandDims",(function(){return iv})),n.d(y,"reshape",(function(){return av})),n.d(y,"squeeze",(function(){return sv})),n.d(y,"stack",(function(){return ov})),n.d(y,"unstack",(function(){return lv})),n.d(y,"setdiff1dAsync",(function(){return uv})),n.d(y,"fill",(function(){return Jy})),n.d(y,"linspace",(function(){return Xy})),n.d(y,"ones",(function(){return Hy})),n.d(y,"range",(function(){return Ky})),n.d(y,"scalar",(function(){return zy})),n.d(y,"tensor",(function(){return Fy})),n.d(y,"tensor1d",(function(){return $y})),n.d(y,"tensor2d",(function(){return By})),n.d(y,"tensor3d",(function(){return Wy})),n.d(y,"tensor4d",(function(){return qy})),n.d(y,"tensor5d",(function(){return Vy})),n.d(y,"tensor6d",(function(){return Uy})),n.d(y,"variable",(function(){return jy})),n.d(y,"zeros",(function(){return Gy})),n.d(y,"onesLike",(function(){return Zy})),n.d(y,"zerosLike",(function(){return Yy})),n.d(y,"transpose",(function(){return hb})),n.d(y,"softmax",(function(){return AS})),n.d(y,"logSoftmax",(function(){return TS})),n.d(y,"norm",(function(){return RS})),n.d(y,"gather",(function(){return Qw})),n.d(y,"unsortedSegmentSum",(function(){return tS})),n.d(y,"basicLSTMCell",(function(){return MS})),n.d(y,"multiRNNCell",(function(){return NS})),n.d(y,"movingAverage",(function(){return OS})),n.d(y,"stridedSlice",(function(){return PS})),n.d(y,"topk",(function(){return FS})),n.d(y,"scatterND",(function(){return LS})),n.d(y,"fft",(function(){return zS})),n.d(y,"ifft",(function(){return $S})),n.d(y,"rfft",(function(){return BS})),n.d(y,"irfft",(function(){return WS})),n.d(y,"sparseToDense",(function(){return qS})),n.d(y,"gatherND",(function(){return VS})),n.d(y,"dropout",(function(){return US})),n.d(y,"hannWindow",(function(){return HS})),n.d(y,"hammingWindow",(function(){return GS})),n.d(y,"frame",(function(){return JS})),n.d(y,"stft",(function(){return XS})),n.d(y,"inTopKAsync",(function(){return KS})),n.d(y,"op",(function(){return My})),n.d(y,"image",(function(){return m})),n.d(y,"linalg",(function(){return f})),n.d(y,"losses",(function(){return p})),n.d(y,"spectral",(function(){return h})),n.d(y,"fused",(function(){return g})),n.d(y,"signal",(function(){return d}));var v={};n.r(v),n.d(v,"axesAreInnerMostDims",(function(){return wy})),n.d(v,"combineLocations",(function(){return Sy})),n.d(v,"computeOutAndReduceShapes",(function(){return Cy})),n.d(v,"expandShapeToKeepDim",(function(){return Dy})),n.d(v,"assertAxesAreInnerMostDims",(function(){return Iy})),n.d(v,"getAxesPermutation",(function(){return ky})),n.d(v,"getUndoAxesPermutation",(function(){return Ey})),n.d(v,"getInnerMostAxes",(function(){return Ay})),n.d(v,"getBroadcastDims",(function(){return fy})),n.d(v,"getReductionAxes",(function(){return my})),n.d(v,"assertAndGetBroadcastShape",(function(){return gy})),n.d(v,"assertParamsConsistent",(function(){return Ty})),n.d(v,"computeOutShape",(function(){return Ry})),n.d(v,"computePool2DInfo",(function(){return Av})),n.d(v,"computePool3DInfo",(function(){return Tv})),n.d(v,"computeConv2DInfo",(function(){return Rv})),n.d(v,"computeConv3DInfo",(function(){return Mv})),n.d(v,"computeDefaultPad",(function(){return Nv})),n.d(v,"tupleValuesAreOne",(function(){return zv})),n.d(v,"eitherStridesOrDilationsAreOne",(function(){return $v})),n.d(v,"convertConv2DDataFormat",(function(){return Bv})),n.d(v,"PARALLELIZE_THRESHOLD",(function(){return Hw})),n.d(v,"computeOptimalWindowSize",(function(){return Gw})),n.d(v,"nonMaxSuppressionV3",(function(){return pC})),n.d(v,"nonMaxSuppressionV5",(function(){return fC})),n.d(v,"upcastType",(function(){return ny})),n.d(v,"getReshaped",(function(){return HC})),n.d(v,"getPermuted",(function(){return GC})),n.d(v,"getReshapedPermuted",(function(){return JC})),n.d(v,"getSliceBeginCoords",(function(){return XC})),n.d(v,"getSliceSize",(function(){return KC})),n.d(v,"prepareAndValidate",(function(){return $x})),n.d(v,"validateUpdateShape",(function(){return Bx})),n.d(v,"validateInput",(function(){return Wx})),n.d(v,"calculateShapes",(function(){return qx})),n.d(v,"SELU_SCALEALPHA",(function(){return xS})),n.d(v,"SELU_SCALE",(function(){return wS})),n.d(v,"shouldFuse",(function(){return kC})),n.d(v,"ERF_P",(function(){return ZC})),n.d(v,"ERF_A1",(function(){return YC})),n.d(v,"ERF_A2",(function(){return QC})),n.d(v,"ERF_A3",(function(){return tD})),n.d(v,"ERF_A4",(function(){return eD})),n.d(v,"ERF_A5",(function(){return nD})),n.d(v,"warn",(function(){return rD})),n.d(v,"log",(function(){return iD})),n.d(v,"mergeRealAndImagArrays",(function(){return aD})),n.d(v,"splitRealAndImagArrays",(function(){return sD})),n.d(v,"complexWithEvenIndex",(function(){return oD})),n.d(v,"complexWithOddIndex",(function(){return lD})),n.d(v,"getComplexWithIndex",(function(){return uD})),n.d(v,"assignToTypedArray",(function(){return cD})),n.d(v,"exponents",(function(){return hD})),n.d(v,"exponent",(function(){return dD})),n.d(v,"segment_util",(function(){return c})),n.d(v,"castTensor",(function(){return pD})),n.d(v,"reshapeTensor",(function(){return fD})),n.d(v,"linspaceImpl",(function(){return mD}));var _={};n.r(_),n.d(_,"nonMaxSuppressionV3",(function(){return pC})),n.d(_,"nonMaxSuppressionV5",(function(){return fC})),n.d(_,"split",(function(){return gD})),n.d(_,"tile",(function(){return yD})),n.d(_,"topkImpl",(function(){return vD})),n.d(_,"whereImpl",(function(){return hw}));var b={};n.r(b),n.d(b,"json",(function(){return TT}));var x={};n.r(x),n.d(x,"json",(function(){return RT}));var w={};n.r(w),n.d(w,"json",(function(){return MT}));var S={};n.r(S),n.d(S,"json",(function(){return NT}));var C={};n.r(C),n.d(C,"json",(function(){return OT}));var D={};n.r(D),n.d(D,"json",(function(){return PT}));var I={};n.r(I),n.d(I,"json",(function(){return FT}));var k={};n.r(k),n.d(k,"json",(function(){return LT}));var E={};n.r(E),n.d(E,"json",(function(){return zT}));var A={};n.r(A),n.d(A,"json",(function(){return $T}));var T={};n.r(T),n.d(T,"json",(function(){return BT}));var R={};n.r(R),n.d(R,"json",(function(){return WT}));var M={};n.r(M),n.d(M,"json",(function(){return qT}));var N={};n.r(N),n.d(N,"json",(function(){return VT}));var O={};n.r(O),n.d(O,"json",(function(){return UT}));var P={};n.r(P),n.d(P,"json",(function(){return jT}));var F={};function L(t){return"function"==typeof t}n.r(F),n.d(F,"maxImpl",(function(){return vR})),n.d(F,"transposeImpl",(function(){return _R}));let z=!1;const $={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else z&&console.log("RxJS: Back to a better error behavior. Thank you. <3");z=t},get useDeprecatedSynchronousErrorHandling(){return z}};function B(t){setTimeout(()=>{throw t},0)}const W={closed:!0,next(t){},error(t){if($.useDeprecatedSynchronousErrorHandling)throw t;B(t)},complete(){}},q=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function V(t){return null!==t&&"object"==typeof t}const U=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let j=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_unsubscribe:r,_subscriptions:i}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(L(r))try{r.call(this)}catch(a){e=a instanceof U?H(a.errors):[a]}if(q(i)){let t=-1,n=i.length;for(;++t<n;){const n=i[t];if(V(n))try{n.unsubscribe()}catch(a){e=e||[],a instanceof U?e=e.concat(H(a.errors)):e.push(a)}}}if(e)throw new U(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof t){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}var e;return t.EMPTY=((e=new t).closed=!0,e),t})();function H(t){return t.reduce((t,e)=>t.concat(e instanceof U?e.errors:e),[])}const G=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class J extends j{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=W;break;case 1:if(!t){this.destination=W;break}if("object"==typeof t){t instanceof J?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new X(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new X(this,t,e,n)}}[G](){return this}static create(t,e,n){const r=new J(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class X extends J{constructor(t,e,n,r){let i;super(),this._parentSubscriber=t;let a=this;L(e)?i=e:e&&(i=e.next,n=e.error,r=e.complete,e!==W&&(a=Object.create(e),L(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=i,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;$.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=$;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):B(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;B(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);$.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),$.useDeprecatedSynchronousErrorHandling)throw n;B(n)}}__tryOrSetError(t,e,n){if(!$.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return $.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(B(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const K=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function Z(t){return t}function Y(...t){return Q(t)}function Q(t){return 0===t.length?Z:1===t.length?t[0]:function(e){return t.reduce((t,e)=>e(t),e)}}let tt=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof J)return t;if(t[G])return t[G]()}return t||e||n?new J(t,e,n):new J(W)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||$.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),$.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){$.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof J?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=et(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[K](){return this}pipe(...t){return 0===t.length?this:Q(t)(this)}toPromise(t){return new(t=et(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function et(t){if(t||(t=$.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const nt=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class rt extends j{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class it extends J{constructor(t){super(t),this.destination=t}}let at=(()=>{class t extends tt{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[G](){return new it(this)}lift(t){const e=new st(this,this);return e.operator=t,e}next(t){if(this.closed)throw new nt;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new nt;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new nt;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new nt;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new nt;return this.hasError?(t.error(this.thrownError),j.EMPTY):this.isStopped?(t.complete(),j.EMPTY):(this.observers.push(t),new rt(this,t))}asObservable(){const t=new tt;return t.source=this,t}}return t.create=(t,e)=>new st(t,e),t})();class st extends at{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):j.EMPTY}}function ot(t){return t&&"function"==typeof t.schedule}class lt extends J{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const ut=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()};function ct(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const ht=ct(),dt=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function pt(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const ft=t=>{if(t&&"function"==typeof t[K])return r=t,t=>{const e=r[K]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(dt(t))return ut(t);if(pt(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,B),t);if(t&&"function"==typeof t[ht])return e=t,t=>{const n=e[ht]();for(;;){const e=n.next();if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=V(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}var e,n,r};function mt(t,e,n,r,i=new lt(t,n,r)){if(!i.closed)return e instanceof tt?e.subscribe(i):ft(e)(i)}class gt extends J{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function yt(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new vt(t,e))}}class vt{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new _t(t,this.project,this.thisArg))}}class _t extends J{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function bt(t,e){return new tt(n=>{const r=new j;let i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r})}function xt(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[K]}(t))return function(t,e){return new tt(n=>{const r=new j;return r.add(e.schedule(()=>{const i=t[K]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(pt(t))return function(t,e){return new tt(n=>{const r=new j;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if(dt(t))return bt(t,e);if(function(t){return t&&"function"==typeof t[ht]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new tt(n=>{const r=new j;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[ht](),r.add(e.schedule((function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())})))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof tt?t:new tt(ft(t))}function wt(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(wt((n,r)=>xt(t(n,r)).pipe(yt((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new St(t,n)))}class St{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new Ct(t,this.project,this.concurrent))}}class Ct extends gt{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){const r=new lt(this,e,n),i=this.destination;i.add(r);const a=mt(this,t,void 0,void 0,r);a!==r&&i.add(a)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,n,r,i){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Dt(t=Number.POSITIVE_INFINITY){return wt(Z,t)}function It(t,e){return e?bt(t,e):new tt(ut(t))}function kt(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return ot(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof tt?t[0]:Dt(e)(It(t,n))}function Et(){return function(t){return t.lift(new At(t))}}class At{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new Tt(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class Tt extends J{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class Rt extends tt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new j,t.add(this.source.subscribe(new Nt(this.getSubject(),this))),t.closed&&(this._connection=null,t=j.EMPTY)),t}refCount(){return Et()(this)}}const Mt=(()=>{const t=Rt.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class Nt extends it{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function Ot(){return new at}function Pt(){return t=>{return Et()((e=Ot,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,Mt);return r.source=t,r.subjectFactory=n,r})(t));var e}}function Ft(t){return{toString:t}.toString()}function Lt(t,e,n){return Ft(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}const zt=Lt("Inject",t=>({token:t})),$t=Lt("Optional"),Bt=Lt("Self"),Wt=Lt("SkipSelf");var qt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function Vt(t){for(let e in t)if(t[e]===Vt)return e;throw Error("Could not find renamed property on target object.")}function Ut(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function jt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ht(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function Gt(t){return Jt(t,t[Kt])||Jt(t,t[Qt])}function Jt(t,e){return e&&e.token===t?e:null}function Xt(t){return t&&(t.hasOwnProperty(Zt)||t.hasOwnProperty(te))?t[Zt]:null}const Kt=Vt({"\u0275prov":Vt}),Zt=Vt({"\u0275inj":Vt}),Yt=Vt({"\u0275provFallback":Vt}),Qt=Vt({ngInjectableDef:Vt}),te=Vt({ngInjectorDef:Vt});function ee(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(ee).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function ne(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const re=Vt({__forward_ref__:Vt});function ie(t){return t.__forward_ref__=ie,t.toString=function(){return ee(this())},t}function ae(t){return se(t)?t():t}function se(t){return"function"==typeof t&&t.hasOwnProperty(re)&&t.__forward_ref__===ie}const oe="undefined"!=typeof globalThis&&globalThis,le="undefined"!=typeof window&&window,ue="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ce="undefined"!=typeof global&&global,he=oe||ce||le||ue,de=Vt({"\u0275cmp":Vt}),pe=Vt({"\u0275dir":Vt}),fe=Vt({"\u0275pipe":Vt}),me=Vt({"\u0275mod":Vt}),ge=Vt({"\u0275loc":Vt}),ye=Vt({"\u0275fac":Vt}),ve=Vt({__NG_ELEMENT_ID__:Vt});class _e{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=jt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const be=new _e("INJECTOR",-1),xe={},we=/\n/gm,Se=Vt({provide:String,useValue:Vt});let Ce,De=void 0;function Ie(t){const e=De;return De=t,e}function ke(t){const e=Ce;return Ce=t,e}function Ee(t,e=qt.Default){if(void 0===De)throw new Error("inject() must be called from an injection context");return null===De?Re(t,void 0,e):De.get(t,e&qt.Optional?null:void 0,e)}function Ae(t,e=qt.Default){return(Ce||Ee)(ae(t),e)}const Te=Ae;function Re(t,e,n){const r=Gt(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&qt.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${ee(t)}]`)}function Me(t){const e=[];for(let n=0;n<t.length;n++){const r=ae(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t=void 0,n=qt.Default;for(let e=0;e<r.length;e++){const i=r[e];i instanceof $t||"Optional"===i.ngMetadataName||i===$t?n|=qt.Optional:i instanceof Wt||"SkipSelf"===i.ngMetadataName||i===Wt?n|=qt.SkipSelf:i instanceof Bt||"Self"===i.ngMetadataName||i===Bt?n|=qt.Self:t=i instanceof zt||i===zt?i.token:i}e.push(Ae(t,n))}else e.push(Ae(r))}return e}class Ne{get(t,e=xe){if(e===xe){const e=new Error(`NullInjectorError: No provider for ${ee(t)}!`);throw e.name="NullInjectorError",e}return e}}class Oe{}class Pe{}function Fe(t,e){t.forEach(t=>Array.isArray(t)?Fe(t,e):e(t))}function Le(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ze(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function $e(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function Be(t,e,n){let r=qe(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function We(t,e){const n=qe(t,e);if(n>=0)return t[1|n]}function qe(t,e){return function(t,e,n){let r=0,i=t.length>>1;for(;i!==r;){const n=r+(i-r>>1),a=t[n<<1];if(e===a)return n<<1;a>e?i=n:r=n+1}return~(i<<1)}(t,e)}const Ve=function(){var t={OnPush:0,Default:1};return t[t.OnPush]="OnPush",t[t.Default]="Default",t}(),Ue=function(){var t={Emulated:0,Native:1,None:2,ShadowDom:3};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t[t.ShadowDom]="ShadowDom",t}(),je={},He=[];let Ge=0;function Je(t){return Ft(()=>{const e=t.type,n=e.prototype,r={},i={type:e,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onChanges:null,onInit:n.ngOnInit||null,doCheck:n.ngDoCheck||null,afterContentInit:n.ngAfterContentInit||null,afterContentChecked:n.ngAfterContentChecked||null,afterViewInit:n.ngAfterViewInit||null,afterViewChecked:n.ngAfterViewChecked||null,onDestroy:n.ngOnDestroy||null,onPush:t.changeDetection===Ve.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||He,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||Ue.Emulated,id:"c",styles:t.styles||He,_:null,setInput:null,schemas:t.schemas||null,tView:null},a=t.directives,s=t.features,o=t.pipes;return i.id+=Ge++,i.inputs=Qe(t.inputs,r),i.outputs=Qe(t.outputs),s&&s.forEach(t=>t(i)),i.directiveDefs=a?()=>("function"==typeof a?a():a).map(Xe):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(Ke):null,i})}function Xe(t){return en(t)||function(t){return t[pe]||null}(t)}function Ke(t){return function(t){return t[fe]||null}(t)}const Ze={};function Ye(t){const e={type:t.type,bootstrap:t.bootstrap||He,declarations:t.declarations||He,imports:t.imports||He,exports:t.exports||He,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&Ft(()=>{Ze[t.id]=t.type}),e}function Qe(t,e){if(null==t)return je;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,e&&(e[i]=a)}return n}const tn=Je;function en(t){return t[de]||null}function nn(t,e){return t.hasOwnProperty(ye)?t[ye]:null}function rn(t,e){const n=t[me]||null;if(!n&&!0===e)throw new Error(`Type ${ee(t)} does not have '\u0275mod' property.`);return n}function an(t){return Array.isArray(t)&&"object"==typeof t[1]}function sn(t){return Array.isArray(t)&&!0===t[1]}function on(t){return 0!=(8&t.flags)}function ln(t){return 2==(2&t.flags)}function un(t){return 1==(1&t.flags)}function cn(t){return null!==t.template}function hn(t){return 0!=(512&t[2])}let dn=void 0;function pn(){return void 0!==dn?dn:"undefined"!=typeof document?document:void 0}function fn(t){return!!t.listen}const mn={createRenderer:(t,e)=>pn()};function gn(t){for(;Array.isArray(t);)t=t[0];return t}function yn(t,e){return gn(e[t+19])}function vn(t,e){return gn(e[t.index])}function _n(t,e){return t.data[e+19]}function bn(t,e){const n=e[t];return an(n)?n:n[0]}function xn(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function wn(t){return 4==(4&t[2])}function Sn(t){return 128==(128&t[2])}function Cn(t,e){return null===t||null==e?null:t[e]}function Dn(t){t[18]=0}const In={lFrame:Hn(null),bindingsEnabled:!0,checkNoChangesMode:!1};function kn(){return In.bindingsEnabled}function En(){return In.lFrame.lView}function An(){return In.lFrame.tView}function Tn(t){In.lFrame.contextLView=t}function Rn(){return In.lFrame.previousOrParentTNode}function Mn(t,e){In.lFrame.previousOrParentTNode=t,In.lFrame.isParent=e}function Nn(){return In.lFrame.isParent}function On(){In.lFrame.isParent=!1}function Pn(){return In.checkNoChangesMode}function Fn(t){In.checkNoChangesMode=t}function Ln(){const t=In.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function zn(){return In.lFrame.bindingIndex++}function $n(t){const e=In.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function Bn(t,e){const n=In.lFrame;n.bindingIndex=n.bindingRootIndex=t,n.currentDirectiveIndex=e}function Wn(){return In.lFrame.currentQueryIndex}function qn(t){In.lFrame.currentQueryIndex=t}function Vn(t,e){const n=jn();In.lFrame=n,n.previousOrParentTNode=e,n.lView=t}function Un(t,e){const n=jn(),r=t[1];In.lFrame=n,n.previousOrParentTNode=e,n.lView=t,n.tView=r,n.contextLView=t,n.bindingIndex=r.bindingStartIndex}function jn(){const t=In.lFrame,e=null===t?null:t.child;return null===e?Hn(t):e}function Hn(t){const e={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null};return null!==t&&(t.child=e),e}function Gn(){const t=In.lFrame;return In.lFrame=t.parent,t.previousOrParentTNode=null,t.lView=null,t}const Jn=Gn;function Xn(){const t=Gn();t.isParent=!0,t.tView=null,t.selectedIndex=0,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.currentSanitizer=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Kn(){return In.lFrame.selectedIndex}function Zn(t){In.lFrame.selectedIndex=t}function Yn(){const t=In.lFrame;return _n(t.tView,t.selectedIndex)}function Qn(){In.lFrame.currentNamespace="http://www.w3.org/2000/svg"}function tr(){In.lFrame.currentNamespace=null}function er(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n];e.afterContentInit&&(t.contentHooks||(t.contentHooks=[])).push(-n,e.afterContentInit),e.afterContentChecked&&((t.contentHooks||(t.contentHooks=[])).push(n,e.afterContentChecked),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,e.afterContentChecked)),e.afterViewInit&&(t.viewHooks||(t.viewHooks=[])).push(-n,e.afterViewInit),e.afterViewChecked&&((t.viewHooks||(t.viewHooks=[])).push(n,e.afterViewChecked),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,e.afterViewChecked)),null!=e.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(n,e.onDestroy)}}function nr(t,e,n){ar(t,e,3,n)}function rr(t,e,n,r){(3&t[2])===n&&ar(t,e,n,r)}function ir(t,e){let n=t[2];(3&n)===e&&(n&=1023,n+=1,t[2]=n)}function ar(t,e,n,r){const i=null!=r?r:-1;let a=0;for(let s=void 0!==r?65535&t[18]:0;s<e.length;s++)if("number"==typeof e[s+1]){if(a=e[s],null!=r&&a>=r)break}else e[s]<0&&(t[18]+=65536),(a<i||-1==i)&&(sr(t,n,e,s),t[18]=(4294901760&t[18])+s+2),s++}function sr(t,e,n,r){const i=n[r]<0,a=n[r+1],s=t[i?-n[r]:n[r]];i?t[2]>>10<t[18]>>16&&(3&t[2])===e&&(t[2]+=1024,a.call(s)):a.call(s)}class or{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function lr(t,e,n){const r=fn(t);let i=0;for(;i<n.length;){const a=n[i];if("number"==typeof a){if(0!==a)break;i++;const s=n[i++],o=n[i++],l=n[i++];r?t.setAttribute(e,o,l,s):e.setAttributeNS(s,o,l)}else{const s=a,o=n[++i];cr(s)?r&&t.setProperty(e,s,o):r?t.setAttribute(e,s,o):e.setAttribute(s,o),i++}}return i}function ur(t){return 3===t||4===t||6===t}function cr(t){return 64===t.charCodeAt(0)}function hr(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||dr(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function dr(t,e,n,r,i){let a=0,s=t.length;if(-1===e)s=-1;else for(;a<t.length;){const n=t[a++];if("number"==typeof n){if(n===e){s=-1;break}if(n>e){s=a-1;break}}}for(;a<t.length;){const e=t[a];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==i&&(t[a+1]=i));if(r===t[a+1])return void(t[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==s&&(t.splice(s,0,e),a=s+1),t.splice(a++,0,n),null!==r&&t.splice(a++,0,r),null!==i&&t.splice(a++,0,i)}function pr(t){return-1!==t}function fr(t){return 32767&t}function mr(t){return t>>16}function gr(t,e){let n=mr(t),r=e;for(;n>0;)r=r[15],n--;return r}function yr(t){return"string"==typeof t?t:null==t?"":""+t}function vr(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():yr(t)}const _r=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(he))();function br(t){return{name:"window",target:t.ownerDocument.defaultView}}function xr(t){return t instanceof Function?t():t}let wr=!0;function Sr(t){const e=wr;return wr=t,e}let Cr=0;function Dr(t,e){const n=kr(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Ir(r.data,t),Ir(e,null),Ir(r.blueprint,null));const i=Er(t,e),a=t.injectorIndex;if(pr(i)){const t=fr(i),n=gr(i,e),r=n[1].data;for(let i=0;i<8;i++)e[a+i]=n[t+i]|r[t+i]}return e[a+8]=i,a}function Ir(t,e){t.push(0,0,0,0,0,0,0,0,e)}function kr(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null==e[t.injectorIndex+8]?-1:t.injectorIndex}function Er(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=e[6],r=1;for(;n&&-1===n.injectorIndex;)n=(e=e[15])?e[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function Ar(t,e,n){!function(t,e,n){let r="string"!=typeof n?n[ve]:n.charCodeAt(0)||0;null==r&&(r=n[ve]=Cr++);const i=255&r,a=1<<i,s=64&i,o=32&i,l=e.data;128&i?s?o?l[t+7]|=a:l[t+6]|=a:o?l[t+5]|=a:l[t+4]|=a:s?o?l[t+3]|=a:l[t+2]|=a:o?l[t+1]|=a:l[t]|=a}(t,e,n)}function Tr(t,e,n,r=qt.Default,i){if(null!==t){const i=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t[ve];return"number"==typeof e&&e>0?255&e:e}(n);if("function"==typeof i){Vn(e,t);try{const t=i();if(null!=t||r&qt.Optional)return t;throw new Error(`No provider for ${vr(n)}!`)}finally{Jn()}}else if("number"==typeof i){if(-1===i)return new Lr(t,e);let a=null,s=kr(t,e),o=-1,l=r&qt.Host?e[16][6]:null;for((-1===s||r&qt.SkipSelf)&&(o=-1===s?Er(t,e):e[s+8],Fr(r,!1)?(a=e[1],s=fr(o),e=gr(o,e)):s=-1);-1!==s;){o=e[s+8];const t=e[1];if(Pr(i,s,t.data)){const t=Mr(s,e,n,a,r,l);if(t!==Rr)return t}Fr(r,e[1].data[s+8]===l)&&Pr(i,s,e)?(a=t,s=fr(o),e=gr(o,e)):s=-1}}}if(r&qt.Optional&&void 0===i&&(i=null),0==(r&(qt.Self|qt.Host))){const t=e[9],a=ke(void 0);try{return t?t.get(n,i,r&qt.Optional):Re(n,i,r&qt.Optional)}finally{ke(a)}}if(r&qt.Optional)return i;throw new Error(`NodeInjector: NOT_FOUND [${vr(n)}]`)}const Rr={};function Mr(t,e,n,r,i,a){const s=e[1],o=s.data[t+8],l=Nr(o,s,n,null==r?ln(o)&&wr:r!=s&&3===o.type,i&qt.Host&&a===o);return null!==l?Or(e,s,l,o):Rr}function Nr(t,e,n,r,i){const a=t.providerIndexes,s=e.data,o=65535&a,l=t.directiveStart,u=a>>16,c=i?o+u:t.directiveEnd;for(let h=r?o:o+u;h<c;h++){const t=s[h];if(h<l&&n===t||h>=l&&t.type===n)return h}if(i){const t=s[l];if(t&&cn(t)&&t.type===n)return l}return null}function Or(t,e,n,r){let i=t[n];const a=e.data;if(i instanceof or){const s=i;if(s.resolving)throw new Error(`Circular dep for ${vr(a[n])}`);const o=Sr(s.canSeeViewProviders);let l;s.resolving=!0,s.injectImpl&&(l=ke(s.injectImpl)),Vn(t,r);try{i=t[n]=s.factory(void 0,a,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{onChanges:r,onInit:i,doCheck:a}=e;r&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)),i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(-t,i),a&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,a),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,a))}(n,a[n],e)}finally{s.injectImpl&&ke(l),Sr(o),s.resolving=!1,Jn()}}return i}function Pr(t,e,n){const r=64&t,i=32&t;let a;return a=128&t?r?i?n[e+7]:n[e+6]:i?n[e+5]:n[e+4]:r?i?n[e+3]:n[e+2]:i?n[e+1]:n[e],!!(a&1<<t)}function Fr(t,e){return!(t&qt.Self||t&qt.Host&&e)}class Lr{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Tr(this._tNode,this._lView,t,void 0,e)}}function zr(t){return Ft(()=>{const e=Object.getPrototypeOf(t.prototype).constructor,n=e[ye]||function t(e){const n=e;if(se(e))return()=>{const e=t(ae(n));return e?e():null};let r=nn(n);if(null===r){const t=Xt(n);r=t&&t.factory}return r||null}(e);return null!==n?n:t=>new t})}function $r(t){return t.ngDebugContext}function Br(t){return t.ngOriginalError}function Wr(t,...e){t.error(...e)}class qr{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||Wr}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?$r(t)?$r(t):this._findContext(Br(t)):null}_findOriginalError(t){let e=Br(t);for(;e&&Br(e);)e=Br(e);return e}}class Vr{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class Ur extends Vr{getTypeName(){return"HTML"}}class jr extends Vr{getTypeName(){return"Style"}}class Hr extends Vr{getTypeName(){return"Script"}}class Gr extends Vr{getTypeName(){return"URL"}}class Jr extends Vr{getTypeName(){return"ResourceURL"}}function Xr(t){return t instanceof Vr?t.changingThisBreaksApplicationSecurity:t}function Kr(t,e){const n=Zr(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see http://g.co/ng/security#xss)`)}return n===e}function Zr(t){return t instanceof Vr&&t.getTypeName()||null}let Yr=!0,Qr=!1;function ti(){return Qr=!0,Yr}class ei{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert");let e=this.inertDocument.body;if(null==e){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t),e=this.inertDocument.createElement("body"),t.appendChild(e)}e.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!e.querySelector||e.querySelector("svg")?(e.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=e.querySelector&&e.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(t){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch(r){return null}const e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(void 0);const n=e.response.body;return n.removeChild(n.firstChild),n}getInertBodyElement_DOMParser(t){t="<body><remove></remove>"+t+"</body>";try{const e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch(e){return null}}getInertBodyElement_InertDocument(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=t,e;const n=this.inertDocument.createElement("body");return n.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const ni=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,ri=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function ii(t){return(t=String(t)).match(ni)||t.match(ri)?t:(ti()&&console.warn(`WARNING: sanitizing unsafe URL value ${t} (see http://g.co/ng/security#xss)`),"unsafe:"+t)}function ai(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function si(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const oi=ai("area,br,col,hr,img,wbr"),li=ai("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ui=ai("rp,rt"),ci=si(ui,li),hi=si(oi,si(li,ai("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),si(ui,ai("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ci),di=ai("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),pi=ai("srcset"),fi=si(di,pi,ai("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ai("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),mi=ai("script,style,template");class gi{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!hi.hasOwnProperty(e))return this.sanitizedSomething=!0,!mi.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,a=e.toLowerCase();if(!fi.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let s=t.value;di[a]&&(s=ii(s)),pi[a]&&(r=s,s=(r=String(r)).split(",").map(t=>ii(t.trim())).join(", ")),this.buf.push(" ",e,'="',_i(s),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();hi.hasOwnProperty(e)&&!oi.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(_i(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const yi=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,vi=/([^\#-~ |!])/g;function _i(t){return t.replace(/&/g,"&amp;").replace(yi,(function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"})).replace(vi,(function(t){return"&#"+t.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let bi;function xi(t,e){let n=null;try{bi=bi||new ei(t);let r=e?String(e):"";n=bi.getInertBodyElement(r);let i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=bi.getInertBodyElement(r)}while(r!==a);const s=new gi,o=s.sanitizeChildren(wi(n)||n);return ti()&&s.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),o}finally{if(n){const t=wi(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}function wi(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}const Si=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}(),Ci=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:attr|calc|var))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Di=/^url\(([^)]+)\)$/;function Ii(t){if(!(t=String(t).trim()))return"";const e=t.match(Di);return e&&ii(e[1])===e[1]||t.match(Ci)&&function(t){let e=!0,n=!0;for(let r=0;r<t.length;r++){const i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(ti()&&console.warn(`WARNING: sanitizing unsafe style value ${t} (see http://g.co/ng/security#xss).`),"unsafe")}function ki(t){const e=Ti();return e?e.sanitize(Si.HTML,t)||"":Kr(t,"HTML")?Xr(t):xi(pn(),yr(t))}function Ei(t){const e=Ti();return e?e.sanitize(Si.STYLE,t)||"":Kr(t,"Style")?Xr(t):Ii(yr(t))}const Ai=function(t,e,n){if(void 0===e&&void 0===n)return Ei(t);let r=!0;return 1&(n=n||3)&&(r=function(t){return"background-image"===t||"backgroundImage"===t||"background"===t||"border-image"===t||"borderImage"===t||"border-image-source"===t||"borderImageSource"===t||"filter"===t||"list-style"===t||"listStyle"===t||"list-style-image"===t||"listStyleImage"===t||"clip-path"===t||"clipPath"===t}(t)),2&n?r?Ei(e):Xr(e):r};function Ti(){const t=En();return t&&t[12]}function Ri(t,e){t.__ngContext__=e}function Mi(t){throw new Error(`Multiple components match node with tagname ${t.tagName}`)}function Ni(){throw new Error("Cannot mix multi providers and regular providers")}function Oi(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const n=e.length;if(i+n===r||t.charCodeAt(i+n)<=32)return i}n=i+1}}function Pi(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==Oi(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function Fi(t,e,n){return e===(0!==t.type||n?t.tagName:"ng-template")}function Li(t,e,n){let r=4;const i=t.attrs||[],a=function(t){for(let e=0;e<t.length;e++)if(ur(t[e]))return e;return t.length}(i);let s=!1;for(let o=0;o<e.length;o++){const l=e[o];if("number"!=typeof l){if(!s)if(4&r){if(r=2|1&r,""!==l&&!Fi(t,l,n)||""===l&&1===e.length){if(zi(r))return!1;s=!0}}else{const u=8&r?l:e[++o];if(8&r&&null!==t.attrs){if(!Pi(t.attrs,u,n)){if(zi(r))return!1;s=!0}continue}const c=$i(8&r?"class":l,i,0==t.type&&"ng-template"!==t.tagName,n);if(-1===c){if(zi(r))return!1;s=!0;continue}if(""!==u){let t;t=c>a?"":i[c+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==Oi(e,u,0)||2&r&&u!==t){if(zi(r))return!1;s=!0}}}}else{if(!s&&!zi(r)&&!zi(l))return!1;if(s&&zi(l))continue;s=!1,r=l|1&r}}return zi(r)||s}function zi(t){return 0==(1&t)}function $i(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let n=!1;for(;i<e.length;){const r=e[i];if(r===t)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++i];for(;"string"==typeof t;)t=e[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){if(t[n]===e)return n;n++}return-1}(e,t)}function Bi(t,e,n=!1){for(let r=0;r<e.length;r++)if(Li(t,e[r],n))return!0;return!1}function Wi(t,e){t:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let e=0;e<t.length;e++)if(t[e]!==r[e])continue t;return!0}}return!1}function qi(t,e){return t?":not("+e.trim()+")":e}function Vi(t){let e=t[0],n=1,r=2,i="",a=!1;for(;n<t.length;){let s=t[n];if("string"==typeof s)if(2&r){const e=t[++n];i+="["+s+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""===i||zi(s)||(e+=qi(a,i),i=""),r=s,a=a||!zi(r);n++}return""!==i&&(e+=qi(a,i)),e}const Ui={};function ji(t){const e=t[3];return sn(e)?e[3]:e}function Hi(t){Gi(An(),En(),Kn()+t,Pn())}function Gi(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&nr(e,r,n)}else{const r=t.preOrderHooks;null!==r&&rr(e,r,0,n)}Zn(n)}function Ji(t,e){return t<<17|e<<2}function Xi(t){return t>>17&32767}function Ki(t){return 2|t}function Zi(t){return(131068&t)>>2}function Yi(t,e){return-131069&t|e<<2}function Qi(t){return 1|t}function ta(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],a=n[r+1];if(-1!==a){const n=t.data[a];qn(i),n.contentQueries(2,e[a],a)}}}function ea(t,e,n){return fn(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function na(t,e,n,r,i,a,s,o,l,u){const c=e.blueprint.slice();return c[0]=i,c[2]=140|r,Dn(c),c[3]=c[15]=t,c[8]=n,c[10]=s||t&&t[10],c[11]=o||t&&t[11],c[12]=l||t&&t[12]||null,c[9]=u||t&&t[9]||null,c[6]=a,c[16]=2==e.type?t[16]:c,c}function ra(t,e,n,r,i,a){const s=n+19,o=t.data[s]||function(t,e,n,r,i,a){const s=Rn(),o=Nn(),l=o?s:s&&s.parent,u=t.data[n]=pa(0,l&&l!==e?l:null,r,n,i,a);return null===t.firstChild&&(t.firstChild=u),s&&(!o||null!=s.child||null===u.parent&&2!==s.type?o||(s.next=u):s.child=u),u}(t,e,s,r,i,a);return Mn(o,!0),o}function ia(t,e,n){Un(e,e[6]);try{const r=t.viewQuery;null!==r&&Fa(1,r,n);const i=t.template;null!==i&&oa(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&ta(t,e),t.staticViewQueries&&Fa(2,t.viewQuery,n);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)Ra(t,e[n])}(e,a)}finally{e[2]&=-5,Xn()}}function aa(t,e,n,r){const i=e[2];if(256==(256&i))return;Un(e,e[6]);const a=Pn();try{Dn(e),In.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&oa(t,e,n,2,r);const s=3==(3&i);if(!a)if(s){const n=t.preOrderCheckHooks;null!==n&&nr(e,n,null)}else{const n=t.preOrderHooks;null!==n&&rr(e,n,0,null),ir(e,0)}if(function(t){let e=t[13];for(;null!==e;){let n;if(sn(e)&&(n=e[2])>>1==-1){for(let t=9;t<e.length;t++){const n=e[t],r=n[1];Sn(n)&&aa(r,n,r.template,n[8])}0!=(1&n)&&Aa(e,t[16])}e=e[4]}}(e),null!==t.contentQueries&&ta(t,e),!a)if(s){const n=t.contentCheckHooks;null!==n&&nr(e,n)}else{const n=t.contentHooks;null!==n&&rr(e,n,1),ir(e,1)}!function(t,e){try{const n=t.expandoInstructions;if(null!==n){let r=t.expandoStartIndex,i=-1,a=-1;for(let t=0;t<n.length;t++){const s=n[t];"number"==typeof s?s<=0?(a=0-s,Zn(a),r+=9+n[++t],i=r):r+=s:(null!==s&&(Bn(r,i),s(2,e[i])),i++)}}}finally{Zn(-1)}}(t,e);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)Ta(t,e[n])}(e,o);const l=t.viewQuery;if(null!==l&&Fa(2,l,r),!a)if(s){const n=t.viewCheckHooks;null!==n&&nr(e,n)}else{const n=t.viewHooks;null!==n&&rr(e,n,2),ir(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),a||(e[2]&=-73)}finally{Xn()}}function sa(t,e,n,r){const i=e[10],a=!Pn(),s=wn(e);try{a&&!s&&i.begin&&i.begin(),s&&ia(t,e,r),aa(t,e,n,r)}finally{a&&!s&&i.end&&i.end()}}function oa(t,e,n,r,i){const a=Kn();try{Zn(-1),2&r&&e.length>19&&Gi(t,e,0,Pn()),n(r,i)}finally{Zn(a)}}function la(t,e,n){if(on(e)){const r=e.directiveEnd;for(let i=e.directiveStart;i<r;i++){const e=t.data[i];e.contentQueries&&e.contentQueries(1,n[i],i)}}}function ua(t,e,n){kn()&&(function(t,e,n,r){const i=n.directiveStart,a=n.directiveEnd;t.firstCreatePass||Dr(n,e),Ri(r,e);const s=n.initialInputs;for(let o=i;o<a;o++){const r=t.data[o],a=cn(r);a&&Da(e,n,r);const l=Or(e,t,o,n);Ri(l,e),null!==s&&Ia(0,o-i,l,r,0,s),a&&(bn(n.index,e)[8]=l)}}(t,e,n,vn(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,a=t.expandoInstructions,s=t.firstCreatePass,o=n.index-19;try{Zn(o);for(let n=r;n<i;n++){const r=t.data[n],i=e[n];null!==r.hostBindings||0!==r.hostVars||null!==r.hostAttrs?_a(r,i):s&&a.push(null)}}finally{Zn(-1)}}(t,e,n))}function ca(t,e,n=vn){const r=e.localNames;if(null!==r){let i=e.index+1;for(let a=0;a<r.length;a+=2){const s=r[a+1],o=-1===s?n(e,t):t[s];t[i++]=o}}}function ha(t){return t.tView||(t.tView=da(1,-1,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts))}function da(t,e,n,r,i,a,s,o,l,u){const c=19+r,h=c+i,d=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Ui);return n}(c,h);return d[1]={type:t,id:e,blueprint:d,template:n,queries:null,viewQuery:o,node:null,data:d.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:u}}function pa(t,e,n,r,i,a){return{type:n,index:r,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function fa(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function ma(t,e,n,r,i,a,s,o){const l=vn(e,n);let u,c=e.inputs;var h;!o&&null!=c&&(u=c[r])?(qa(t,n,u,r,i),ln(e)&&function(t,e){const n=bn(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3===e.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,i=null!=s?s(i,e.tagName||"",r):i,fn(a)?a.setProperty(l,r,i):cr(r)||(l.setProperty?l.setProperty(r,i):l[r]=i))}function ga(t,e,n,r){let i=!1;if(kn()){const a=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let a=0;a<r.length;a++){const s=r[a];Bi(n,s.selectors,!1)&&(i||(i=[]),Ar(Dr(n,e),t,s.type),cn(s)?(2&n.flags&&Mi(n),xa(t,n),i.unshift(s)):i.push(s))}return i}(t,e,n),s=null===r?null:{"":-1};if(null!==a){let r=0;i=!0,Sa(n,t.data.length,a.length);for(let t=0;t<a.length;t++){const e=a[t];e.providersResolver&&e.providersResolver(e)}ba(t,n,a.length);let o=!1,l=!1;for(let i=0;i<a.length;i++){const u=a[i];n.mergedAttrs=hr(n.mergedAttrs,u.hostAttrs),Ca(t,e,u),wa(t.data.length-1,u,s),null!==u.contentQueries&&(n.flags|=8),null===u.hostBindings&&null===u.hostAttrs&&0===u.hostVars||(n.flags|=128),!o&&(u.onChanges||u.onInit||u.doCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index-19),o=!0),l||!u.onChanges&&!u.doCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index-19),l=!0),ya(t,u),r+=u.hostVars}!function(t,e){const n=e.directiveEnd,r=t.data,i=e.attrs,a=[];let s=null,o=null;for(let l=e.directiveStart;l<n;l++){const t=r[l],e=t.inputs;a.push(null!==i?ka(e,i):null),s=fa(e,l,s),o=fa(t.outputs,l,o)}null!==s&&(s.hasOwnProperty("class")&&(e.flags|=16),s.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=a,e.inputs=s,e.outputs=o}(t,n),va(t,e,r)}s&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const i=n[e[t+1]];if(null==i)throw new Error(`Export of name '${e[t+1]}' not found!`);r.push(e[t],i)}}}(n,r,s)}return n.mergedAttrs=hr(n.mergedAttrs,n.attrs),i}function ya(t,e){const n=t.expandoInstructions;n.push(e.hostBindings),0!==e.hostVars&&n.push(e.hostVars)}function va(t,e,n){for(let r=0;r<n;r++)e.push(Ui),t.blueprint.push(Ui),t.data.push(null)}function _a(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function ba(t,e,n){const r=19-e.index,i=t.data.length-(65535&e.providerIndexes);(t.expandoInstructions||(t.expandoInstructions=[])).push(r,i,n)}function xa(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function wa(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;cn(e)&&(n[""]=t)}}function Sa(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Ca(t,e,n){t.data.push(n);const r=n.factory||(n.factory=nn(n.type)),i=new or(r,cn(n),null);t.blueprint.push(i),e.push(i)}function Da(t,e,n){const r=vn(e,t),i=ha(n),a=t[10],s=Ma(t,na(t,i,null,n.onPush?64:16,r,e,a,a.createRenderer(r,n)));t[e.index]=s}function Ia(t,e,n,r,i,a){const s=a[e];if(null!==s){const t=r.setInput;for(let e=0;e<s.length;){const i=s[e++],a=s[e++],o=s[e++];null!==t?r.setInput(n,o,i,a):n[a]=o}}}function ka(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function Ea(t,e,n,r){return new Array(t,!0,-2,e,null,null,r,n,null)}function Aa(t,e){const n=t[5];for(let r=0;r<n.length;r++){const t=n[r],i=t[3][3][16];if(i!==e&&0==(16&i[2])){const e=t[1];aa(e,t,e.template,t[8])}}}function Ta(t,e){const n=bn(e,t);if(Sn(n)&&80&n[2]){const t=n[1];aa(t,n,t.template,n[8])}}function Ra(t,e){const n=bn(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),ia(r,n,n[8])}function Ma(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Na(t){for(;t;){t[2]|=64;const e=ji(t);if(hn(t)&&!e)return t;t=e}return null}function Oa(t,e,n){const r=e[10];r.begin&&r.begin();try{aa(t,e,t.template,n)}catch(i){throw Wa(e,i),i}finally{r.end&&r.end()}}function Pa(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=xn(n),i=r[1];sa(i,r,i.template,n)}}(t[8])}function Fa(t,e,n){qn(0),e(t,n)}const La=(()=>Promise.resolve(null))();function za(t){return t[7]||(t[7]=[])}function $a(t){return t.cleanup||(t.cleanup=[])}function Ba(t,e){return function(t){for(;Array.isArray(t);){if("object"==typeof t[1])return t;t=t[0]}return null}(e[t.index])[11]}function Wa(t,e){const n=t[9],r=n?n.get(qr,null):null;r&&r.handleError(e)}function qa(t,e,n,r,i){for(let a=0;a<n.length;){const s=n[a++],o=n[a++],l=e[s],u=t.data[s];null!==u.setInput?u.setInput(l,i,r,o):l[o]=i}}function Va(t,e,n){const r=yn(e,t),i=t[11];fn(i)?i.setValue(r,n):r.textContent=n}function Ua(t,e){const n=e[3];return-1===t.index?sn(n)?n:null:n}function ja(t,e){const n=Ua(t,e);return n?rs(e[11],n[7]):null}function Ha(t,e,n,r,i){if(null!=r){let a,s=!1;sn(r)?a=r:an(r)&&(s=!0,r=r[0]);const o=gn(r);0===t&&null!==n?null==i?es(e,n,o):ts(e,n,o,i||null):1===t&&null!==n?ts(e,n,o,i||null):2===t?function(t,e,n){const r=rs(t,e);r&&function(t,e,n,r){fn(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,o,s):3===t&&e.destroyNode(o),null!=a&&function(t,e,n,r,i){const a=n[7];a!==gn(n)&&Ha(e,t,r,a,i);for(let s=9;s<n.length;s++){const i=n[s];ls(i[1],i,t,e,r,a)}}(e,t,a,n,i)}}function Ga(t,e,n,r){const i=ja(t.node,e);i&&ls(t,e,e[11],n?1:2,i,r)}function Ja(t,e){const n=t[5],r=n.indexOf(e);n.splice(r,1)}function Xa(t,e){if(t.length<=9)return;const n=9+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&Ja(i,r),e>0&&(t[n-1][4]=r[4]);const a=ze(t,9+e);Ga(r[1],r,!1,null);const s=a[5];null!==s&&s.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function Ka(t,e){if(!(256&e[2])){const n=e[11];fn(n)&&n.destroyNode&&ls(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Ya(t[1],t);for(;e;){let n=null;if(an(e))n=e[13];else{const t=e[9];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)an(e)&&Ya(e[1],e),e=Za(e,t);null===e&&(e=t),an(e)&&Ya(e[1],e),n=e&&e[4]}e=n}}(e)}}function Za(t,e){let n;return an(t)&&(n=t[6])&&2===n.type?Ua(n,t):t[3]===e?null:t[3]}function Ya(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];t instanceof or||n[r+1].call(t)}}(t,e),function(t,e){const n=t.cleanup;if(null!==n){const t=e[7];for(let r=0;r<n.length-1;r+=2)if("string"==typeof n[r]){const i=n[r+1],a="function"==typeof i?i(e):gn(e[i]),s=t[n[r+2]],o=n[r+3];"boolean"==typeof o?a.removeEventListener(n[r],s,o):o>=0?t[o]():t[-o].unsubscribe(),r+=2}else n[r].call(t[n[r+1]]);e[7]=null}}(t,e);const n=e[6];n&&3===n.type&&fn(e[11])&&e[11].destroy();const r=e[17];if(null!==r&&sn(e[3])){r!==e[3]&&Ja(r,e);const n=e[5];null!==n&&n.detachView(t)}}}function Qa(t,e,n){let r=e.parent;for(;null!=r&&(4===r.type||5===r.type);)r=(e=r).parent;if(null==r){const t=n[6];return 2===t.type?ja(t,n):n[0]}if(e&&5===e.type&&4&e.flags)return vn(e,n).parentNode;if(2&r.flags){const e=t.data,n=e[e[r.index].directiveStart].encapsulation;if(n!==Ue.ShadowDom&&n!==Ue.Native)return null}return vn(r,n)}function ts(t,e,n,r){fn(t)?t.insertBefore(e,n,r):e.insertBefore(n,r,!0)}function es(t,e,n){fn(t)?t.appendChild(e,n):e.appendChild(n)}function ns(t,e,n,r){null!==r?ts(t,e,n,r):es(t,e,n)}function rs(t,e){return fn(t)?t.parentNode(e):e.parentNode}function is(t,e){if(2===t.type){const n=Ua(t,e);return null===n?null:ss(n.indexOf(e,9)-9,n)}return 4===t.type||5===t.type?vn(t,e):null}function as(t,e,n,r){const i=Qa(t,r,e);if(null!=i){const t=e[11],a=is(r.parent||e[6],e);if(Array.isArray(n))for(let e=0;e<n.length;e++)ns(t,i,n[e],a);else ns(t,i,n,a)}}function ss(t,e){const n=9+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return function t(e,n){if(null!==n){const r=n.type;if(3===r)return vn(n,e);if(0===r)return ss(-1,e[n.index]);if(4===r||5===r){const r=n.child;if(null!==r)return t(e,r);{const t=e[n.index];return sn(t)?ss(-1,t):gn(t)}}{const r=e[16],i=r[6],a=ji(r),s=i.projection[n.projection];return null!=s?t(a,s):t(e,n.next)}}return null}(t,r)}return e[7]}function os(t,e,n,r,i,a,s){for(;null!=n;){const o=r[n.index],l=n.type;s&&0===e&&(o&&Ri(gn(o),r),n.flags|=4),64!=(64&n.flags)&&(4===l||5===l?(os(t,e,n.child,r,i,a,!1),Ha(e,t,i,o,a)):1===l?us(t,e,r,n,i,a):Ha(e,t,i,o,a)),n=s?n.projectionNext:n.next}}function ls(t,e,n,r,i,a){os(n,r,t.node.child,e,i,a,!1)}function us(t,e,n,r,i,a){const s=n[16],o=s[6].projection[r.projection];if(Array.isArray(o))for(let l=0;l<o.length;l++)Ha(e,t,i,o[l],a);else os(t,e,o,s[3],i,a,!0)}function cs(t,e,n){fn(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function hs(t,e,n){fn(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}class ds{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}get rootNodes(){const t=this._lView;return null==t[0]?function t(e,n,r,i,a=!1){for(;null!==r;){const s=n[r.index];if(null!==s&&i.push(gn(s)),sn(s))for(let e=9;e<s.length;e++){const n=s[e],r=n[1].firstChild;null!==r&&t(n[1],n,r,i)}const o=r.type;if(4===o||5===o)t(e,n,r.child,i);else if(1===o){const e=n[16],a=e[6],s=ji(e);let o=a.projection[r.projection];null!==o&&null!==s&&t(s[1],s,o,i,!0)}r=a?r.projectionNext:r.next}return i}(t[1],t,t[6].child,[]):[]}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}Ka(this._lView[1],this._lView)}onDestroy(t){var e,n,r;e=this._lView[1],r=t,za(n=this._lView).push(r),e.firstCreatePass&&$a(e).push(n[7].length-1,null)}markForCheck(){Na(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Oa(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Fn(!0);try{Oa(t,e,n)}finally{Fn(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,ls(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class ps extends ds{constructor(t){super(t),this._view=t}detectChanges(){Pa(this._view)}checkNoChanges(){!function(t){Fn(!0);try{Pa(t)}finally{Fn(!1)}}(this._view)}get context(){return null}}let fs,ms,gs;function ys(t,e,n){return fs||(fs=class extends t{}),new fs(vn(e,n))}function vs(t,e,n,r){return ms||(ms=class extends t{constructor(t,e,n){super(),this._declarationView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=na(this._declarationView,e,t,16,null,e.node);n[17]=this._declarationView[this._declarationTContainer.index];const r=this._declarationView[5];null!==r&&(n[5]=r.createEmbeddedView(e)),ia(e,n,t);const i=new ds(n);return i._tViewNode=n[6],i}}),0===n.type?new ms(r,n,ys(e,n,r)):null}function _s(t,e,n,r){let i;gs||(gs=class extends t{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostView=n}get element(){return ys(e,this._hostTNode,this._hostView)}get injector(){return new Lr(this._hostTNode,this._hostView)}get parentInjector(){const t=Er(this._hostTNode,this._hostView),e=gr(t,this._hostView),n=function(t,e,n){if(n.parent&&-1!==n.parent.injectorIndex){const t=n.parent.injectorIndex;let e=n.parent;for(;null!=e.parent&&t==e.parent.injectorIndex;)e=e.parent;return e}let r=mr(t),i=e,a=e[6];for(;r>1;)i=i[15],a=i[6],r--;return a}(t,this._hostView,this._hostTNode);return pr(t)&&null!=n?new Lr(n,e):new Lr(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){return null!==this._lContainer[8]&&this._lContainer[8][t]||null}get length(){return this._lContainer.length-9}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const a=n||this.parentInjector;if(!i&&null==t.ngModule&&a){const t=a.get(Oe,null);t&&(i=t)}const s=t.create(a,r,void 0,i);return this.insert(s.hostView,e),s}insert(t,e){const n=t._lView,r=n[1];if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),sn(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new gs(e,e[6],e[3]);r.detach(r.indexOf(t))}}const i=this._adjustIndex(e);return function(t,e,n,r){const i=9+r,a=n.length;r>0&&(n[i-1][4]=e),r<a-9?(e[4]=n[i],Le(n,9+r,e)):(n.push(e),e[4]=null),e[3]=n;const s=e[17];null!==s&&n!==s&&function(t,e){const n=t[5],r=e[3][3][16];16!=(16&r[2])&&e[16]!==r&&(t[2]|=1),null===n?t[5]=[e]:n.push(e)}(s,e);const o=e[5];null!==o&&o.insertView(t),e[2]|=128}(r,n,this._lContainer,i),Ga(r,n,!0,ss(i,this._lContainer)),t.attachToViewContainerRef(this),Le(this._lContainer[8],i,t),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(t,e)}indexOf(t){const e=this._lContainer[8];return null!==e?e.indexOf(t):-1}remove(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1);(function(t,e){const n=Xa(t,e);n&&Ka(n[1],n)})(this._lContainer,e),ze(this._lContainer[8],e)}detach(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),n=Xa(this._lContainer,e);return n&&null!=ze(this._lContainer[8],e)?new ds(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const a=r[n.index];if(sn(a))i=a,function(t,e){t[2]=-2}(i);else{let t;if(4===n.type)t=gn(a);else if(t=r[11].createComment(""),hn(r)){const e=r[11],i=vn(n,r);ts(e,rs(e,i),t,function(t,e){return fn(t)?t.nextSibling(e):e.nextSibling}(e,i))}else as(r[1],r,t,n);r[n.index]=i=Ea(a,r,t,n),Ma(r,i)}return new gs(i,n,r)}let bs=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>xs(),t})();const xs=function(t=!1){return function(t,e,n){if(!n&&ln(t)){const n=bn(t.index,e);return new ds(n,n)}return 3===t.type||0===t.type||4===t.type||5===t.type?new ds(e[16],e):null}(Rn(),En(),t)},ws=new _e("Set Injector scope."),Ss={},Cs={},Ds=[];let Is=void 0;function ks(){return void 0===Is&&(Is=new Ne),Is}function Es(t,e=null,n=null,r){return new As(t,n,e||ks(),r)}class As{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];e&&Fe(e,n=>this.processProvider(n,t,e)),Fe([t],t=>this.processInjectorType(t,[],i)),this.records.set(be,Ms(void 0,this));const a=this.records.get(ws);this.scope=null!=a?a.value:null,this.source=r||("object"==typeof t?null:ee(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=xe,n=qt.Default){this.assertNotDestroyed();const r=Ie(this);try{if(!(n&qt.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(i=t)||"object"==typeof i&&i instanceof _e)&&Gt(t);e=n&&this.injectableDefInScope(n)?Ms(Ts(t),Ss):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&qt.Self?ks():this.parent).get(t,e=n&qt.Optional&&e===xe?null:e)}catch(a){if("NullInjectorError"===a.name){if((a.ngTempTokenPath=a.ngTempTokenPath||[]).unshift(ee(t)),r)throw a;return function(t,e,n,r){const i=t.ngTempTokenPath;throw e.__source&&i.unshift(e.__source),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=ee(e);if(Array.isArray(e))i=e.map(ee).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):ee(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(we,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(a,t,"R3InjectorError",this.source)}throw a}finally{Ie(r)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(ee(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=ae(t)))return!1;let r=Xt(t);const i=null==r&&t.ngModule||void 0,a=void 0===i?t:i,s=-1!==n.indexOf(a);if(void 0!==i&&(r=Xt(i)),null==r)return!1;if(null!=r.imports&&!s){let t;n.push(a);try{Fe(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];Fe(r,t=>this.processProvider(t,n,r||Ds))}}this.injectorDefTypes.add(a),this.records.set(a,Ms(r.factory,Ss));const o=r.providers;if(null!=o&&!s){const e=t;Fe(o,t=>this.processProvider(t,e,o))}return void 0!==i&&void 0!==t.providers}processProvider(t,e,n){let r=Os(t=ae(t))?t:ae(t&&t.provide);const i=function(t,e,n){return Ns(t)?Ms(void 0,t.useValue):Ms(Rs(t,e,n),Ss)}(t,e,n);if(Os(t)||!0!==t.multi){const t=this.records.get(r);t&&void 0!==t.multi&&Ni()}else{let e=this.records.get(r);e?void 0===e.multi&&Ni():(e=Ms(void 0,Ss,!0),e.factory=()=>Me(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,i)}hydrate(t,e){var n;return e.value===Cs?function(t){throw new Error(`Cannot instantiate cyclic dependency! ${t}`)}(ee(t)):e.value===Ss&&(e.value=Cs,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function Ts(t){const e=Gt(t),n=null!==e?e.factory:nn(t);if(null!==n)return n;const r=Xt(t);if(null!==r)return r.factory;if(t instanceof _e)throw new Error(`Token ${ee(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=$e(e,"?");throw new Error(`Can't resolve all parameters for ${ee(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[Kt]||t[Qt]||t[Yt]&&t[Yt]());if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\n`+`This will become an error in v10. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Rs(t,e,n){let r=void 0;if(Os(t)){const e=ae(t);return nn(e)||Ts(e)}if(Ns(t))r=()=>ae(t.useValue);else if((i=t)&&i.useFactory)r=()=>t.useFactory(...Me(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>Ae(ae(t.useExisting));else{const i=ae(t&&(t.useClass||t.provide));if(i||function(t,e,n){let r="";throw t&&e&&(r=` - only instances of Provider and Type are allowed, got: [${e.map(t=>t==n?"?"+n+"?":"...").join(", ")}]`),new Error(`Invalid provider for the NgModule '${ee(t)}'`+r)}(e,n,t),!function(t){return!!t.deps}(t))return nn(i)||Ts(i);r=()=>new i(...Me(t.deps))}var i;return r}function Ms(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Ns(t){return null!==t&&"object"==typeof t&&Se in t}function Os(t){return"function"==typeof t}const Ps=function(t,e,n){return function(t,e=null,n=null,r){const i=Es(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};let Fs=(()=>{class t{static create(t,e){return Array.isArray(t)?Ps(t,e,""):Ps(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=xe,t.NULL=new Ne,t.\u0275prov=jt({token:t,providedIn:"any",factory:()=>Ae(be)}),t.__NG_ELEMENT_ID__=-1,t})();const Ls=new _e("AnalyzeForEntryComponents");let zs=new Map;const $s=new Set;function Bs(t){return"string"==typeof t?t:t.text()}function Ws(t,e){let n=t.styles,r=t.classes,i=0;for(let a=0;a<e.length;a++){const t=e[a];"number"==typeof t?i=t:1==i?r=ne(r,t):2==i&&(n=ne(n,t+": "+e[++a]+";"))}null!==n&&(t.styles=n),null!==r&&(t.classes=r)}let qs=null;function Vs(){if(!qs){const t=he.Symbol;if(t&&t.iterator)qs=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(qs=n)}}}return qs}function Us(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}function js(t){return!!Hs(t)&&(Array.isArray(t)||!(t instanceof Map)&&Vs()in t)}function Hs(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Gs(t,e,n){return t[e]=n}function Js(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Xs(t,e,n,r){const i=Js(t,e,n);return Js(t,e+1,r)||i}function Ks(t,e,n,r){const i=En();return Js(i,zn(),e)&&(An(),function(t,e,n,r,i,a){const s=vn(t,e),o=e[11];if(null==r)fn(o)?o.removeAttribute(s,n,a):s.removeAttribute(n);else{const e=null==i?yr(r):i(r,t.tagName||"",n);fn(o)?o.setAttribute(s,n,e,a):a?s.setAttributeNS(a,n,e):s.setAttribute(n,e)}}(Yn(),i,t,e,n,r)),Ks}function Zs(t,e,n,r){return Js(t,zn(),n)?e+yr(n)+r:Ui}function Ys(t,e,n,r,i,a,s,o){const l=En(),u=An(),c=t+19,h=u.firstCreatePass?function(t,e,n,r,i,a,s,o,l){const u=e.consts,c=ra(e,n[6],t,0,s||null,Cn(u,o));ga(e,n,c,Cn(u,l)),er(e,c);const h=c.tViews=da(2,-1,r,i,a,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u),d=pa(0,null,2,-1,null,null);return d.injectorIndex=c.injectorIndex,h.node=d,null!==e.queries&&(e.queries.template(e,c),h.queries=e.queries.embeddedTView(c)),c}(t,u,l,e,n,r,i,a,s):u.data[c];Mn(h,!1);const d=l[11].createComment("");as(u,l,d,h),Ri(d,l),Ma(l,l[c]=Ea(d,l,d,h)),un(h)&&ua(u,l,h),null!=s&&ca(l,h,o)}function Qs(t){return function(t,e){return t[e+19]}(In.lFrame.contextLView,t)}function to(t,e=qt.Default){const n=En();return null==n?Ae(t,e):Tr(Rn(),n,ae(t),e)}function eo(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let r=0;for(;r<t;){const i=n[r];if(ur(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<t&&"string"==typeof n[r];)r++;else{if(i===e)return n[r+1];r+=2}}}return null}(Rn(),t)}function no(){throw new Error("invalid")}function ro(t,e,n){const r=En();return Js(r,zn(),e)&&ma(An(),Yn(),r,t,e,r[11],n,!1),ro}function io(t,e,n,r,i){const a=i?"class":"style";qa(t,n,e.inputs[a],a,r)}function ao(t,e,n,r){const i=En(),a=An(),s=19+t,o=i[11],l=i[s]=ea(e,o,In.lFrame.currentNamespace),u=a.firstCreatePass?function(t,e,n,r,i,a,s){const o=e.consts,l=Cn(o,a),u=ra(e,n[6],t,3,i,l);return ga(e,n,u,Cn(o,s)),null!==u.mergedAttrs&&Ws(u,u.mergedAttrs),null!==e.queries&&e.queries.elementStart(e,u),u}(t,a,i,0,e,n,r):a.data[s];Mn(u,!0);const c=u.mergedAttrs;null!==c&&lr(o,l,c);const h=u.classes;null!==h&&hs(o,l,h);const d=u.styles;null!==d&&cs(o,l,d),as(a,i,l,u),0===In.lFrame.elementDepthCount&&Ri(l,i),In.lFrame.elementDepthCount++,un(u)&&(ua(a,i,u),la(a,u,i)),null!==r&&ca(i,u)}function so(){let t=Rn();Nn()?On():(t=t.parent,Mn(t,!1));const e=t;In.lFrame.elementDepthCount--;const n=An();n.firstCreatePass&&(er(n,t),on(t)&&n.queries.elementEnd(t)),null!==e.classes&&function(t){return 0!=(16&t.flags)}(e)&&io(n,e,En(),e.classes,!0),null!==e.styles&&function(t){return 0!=(32&t.flags)}(e)&&io(n,e,En(),e.styles,!1)}function oo(t,e,n,r){ao(t,e,n,r),so()}function lo(t,e,n){const r=En(),i=An(),a=t+19,s=i.firstCreatePass?function(t,e,n,r,i){const a=e.consts,s=Cn(a,r),o=ra(e,n[6],t,4,"ng-container",s);return null!==s&&Ws(o,s),ga(e,n,o,Cn(a,i)),null!==e.queries&&e.queries.elementStart(e,o),o}(t,i,r,e,n):i.data[a];Mn(s,!0);const o=r[a]=r[11].createComment("");as(i,r,o,s),Ri(o,r),un(s)&&(ua(i,r,s),la(i,s,r)),null!=n&&ca(r,s)}function uo(){let t=Rn();const e=An();Nn()?On():(t=t.parent,Mn(t,!1)),e.firstCreatePass&&(er(e,t),on(t)&&e.queries.elementEnd(t))}function co(){return En()}function ho(t){return!!t&&"function"==typeof t.then}function po(t){return!!t&&"function"==typeof t.subscribe}function fo(t,e,n=!1,r){const i=En(),a=An(),s=Rn();return go(a,i,i[11],s,t,e,n,r),fo}function mo(t,e,n=!1,r){const i=Rn(),a=En(),s=Ba(i,a);return go(An(),a,s,i,t,e,n,r),mo}function go(t,e,n,r,i,a,s=!1,o){const l=un(r),u=t.firstCreatePass&&(t.cleanup||(t.cleanup=[])),c=za(e);let h=!0;if(3===r.type){const d=vn(r,e),p=o?o(d):je,f=p.target||d,m=c.length,g=o?t=>o(gn(t[r.index])).target:r.index;if(fn(n)){let s=null;if(!o&&l&&(s=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let a=0;a<i.length-1;a+=2){const t=i[a];if(t===n&&i[a+1]===r){const t=e[7],n=i[a+2];return t.length>n?t[n]:null}"string"==typeof t&&(a+=2)}return null}(t,e,i,r.index)),null!==s)(s.__ngLastListenerFn__||s).__ngNextListenerFn__=a,s.__ngLastListenerFn__=a,h=!1;else{a=vo(r,e,a,!1);const t=n.listen(p.name||f,i,a);c.push(a,t),u&&u.push(i,g,m,m+1)}}else a=vo(r,e,a,!0),f.addEventListener(i,a,s),c.push(a),u&&u.push(i,g,m,s)}const d=r.outputs;let p;if(h&&null!==d&&(p=d[i])){const t=p.length;if(t)for(let n=0;n<t;n+=2){const t=e[p[n]][p[n+1]].subscribe(a),s=c.length;c.push(a,t),u&&u.push(i,r.index,s,-(s+1))}}}function yo(t,e,n){try{return!1!==e(n)}catch(r){return Wa(t,r),!1}}function vo(t,e,n,r){return function i(a){if(a===Function)return n;const s=2&t.flags?bn(t.index,e):e;0==(32&e[2])&&Na(s);let o=yo(e,n,a),l=i.__ngNextListenerFn__;for(;l;)o=yo(e,l,a)&&o,l=l.__ngNextListenerFn__;return r&&!1===o&&(a.preventDefault(),a.returnValue=!1),o}}function _o(t=1){return function(t){return(In.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,In.lFrame.contextLView))[8]}(t)}function bo(t,e){let n=null;const r=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let i=0;i<e.length;i++){const a=e[i];if("*"!==a){if(null===r?Bi(t,a,!0):Wi(r,a))return i}else n=i}return n}function xo(t){const e=En()[16][6];if(!e.projection){const n=e.projection=$e(t?t.length:1,null),r=n.slice();let i=e.child;for(;null!==i;){const e=t?bo(i,t):0;null!==e&&(r[e]?r[e].projectionNext=i:n[e]=i,r[e]=i),i=i.next}}}function wo(t,e=0,n){const r=En(),i=An(),a=ra(i,r[6],t,1,null,n||null);null===a.projection&&(a.projection=e),On(),function(t,e,n){us(e[11],0,e,n,Qa(t,n,e),is(n.parent||e[6],e))}(i,r,a)}const So=[];function Co(t,e,n,r,i){const a=t[n+1],s=null===e;let o=r?Xi(a):Zi(a),l=!1;for(;0!==o&&(!1===l||s);){const n=t[o+1];Do(t[o],e)&&(l=!0,t[o+1]=r?Qi(n):Ki(n)),o=r?Xi(n):Zi(n)}l&&(t[n+1]=r?Ki(a):Qi(a))}function Do(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&qe(t,e)>=0}const Io={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ko(t){return t.substring(Io.key,Io.keyEnd)}function Eo(t,e){const n=Io.textEnd;return n===e?-1:(e=Io.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,Io.key=e,n),Ao(t,e,n))}function Ao(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function To(t,e,n){return No(t,e,n,!1),To}function Ro(t,e){return No(t,e,null,!0),Ro}function Mo(t,e){for(let n=function(t){return function(t){Io.key=0,Io.keyEnd=0,Io.value=0,Io.valueEnd=0,Io.textEnd=t.length}(t),Eo(t,Ao(t,0,Io.textEnd))}(e);n>=0;n=Eo(e,n))Be(t,ko(e),!0)}function No(t,e,n,r){const i=En(),a=An(),s=$n(2);if(a.firstUpdatePass&&Fo(a,t,s,r),e!==Ui&&Js(i,s,e)){let o;null==n&&(o=function(){const t=In.lFrame;return null===t?null:t.currentSanitizer}())&&(n=o),$o(a,a.data[Kn()+19],i,i[11],t,i[s+1]=function(t,e){return null==t||("function"==typeof e?t=e(t):"string"==typeof e?t+=e:"object"==typeof t&&(t=ee(Xr(t)))),t}(e,n),r,s)}}function Oo(t,e,n,r){const i=An(),a=$n(2);i.firstUpdatePass&&Fo(i,null,a,r);const s=En();if(n!==Ui&&Js(s,a,n)){const o=i.data[Kn()+19];if(qo(o,r)&&!Po(i,a)){let t=r?o.classes:o.styles;null!==t&&(n=ne(t,n||"")),io(i,o,s,n,r)}else!function(t,e,n,r,i,a,s,o){i===Ui&&(i=So);let l=0,u=0,c=0<i.length?i[0]:null,h=0<a.length?a[0]:null;for(;null!==c||null!==h;){const d=l<i.length?i[l+1]:void 0,p=u<a.length?a[u+1]:void 0;let f=null,m=void 0;c===h?(l+=2,u+=2,d!==p&&(f=h,m=p)):null===h||null!==c&&c<h?(l+=2,f=c):(u+=2,f=h,m=p),null!==f&&$o(t,e,n,r,f,m,s,o),c=l<i.length?i[l]:null,h=u<a.length?a[u]:null}}(i,o,s,s[11],s[a+1],s[a+1]=function(t,e,n){if(null==n||""===n)return So;const r=[],i=Xr(n);if(Array.isArray(i))for(let a=0;a<i.length;a++)t(r,i[a],!0);else if("object"==typeof i)for(const a in i)i.hasOwnProperty(a)&&t(r,a,i[a]);else"string"==typeof i&&e(r,i);return r}(t,e,n),r,a)}}function Po(t,e){return e>=t.expandoStartIndex}function Fo(t,e,n,r){const i=t.data;if(null===i[n+1]){const a=i[Kn()+19],s=Po(t,n);qo(a,r)&&null===e&&!s&&(e=!1),e=function(t,e,n,r){const i=function(t){const e=In.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let a=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=zo(n=Lo(null,t,e,n,r),e.attrs,r),a=null);else{const s=e.directiveStylingLast;if(-1===s||t[s]!==i)if(n=Lo(i,t,e,n,r),null===a){let n=function(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==Zi(r))return t[Xi(r)]}(t,e,r);void 0!==n&&Array.isArray(n)&&(n=Lo(null,t,e,n[1],r),n=zo(n,e.attrs,r),function(t,e,n,r){t[Xi(n?e.classBindings:e.styleBindings)]=r}(t,e,r,n))}else a=function(t,e,n){let r=void 0;const i=e.directiveEnd;for(let a=1+e.directiveStylingLast;a<i;a++)r=zo(r,t[a].hostAttrs,n);return zo(r,e.attrs,n)}(t,e,r)}return void 0!==a&&(r?e.residualClasses=a:e.residualStyles=a),n}(i,a,e,r),function(t,e,n,r,i,a){let s=a?e.classBindings:e.styleBindings,o=Xi(s),l=Zi(s);t[r]=n;let u,c=!1;if(Array.isArray(n)){const t=n;u=t[1],(null===u||qe(t,u)>0)&&(c=!0)}else u=n;if(i)if(0!==l){const e=Xi(t[o+1]);t[r+1]=Ji(e,o),0!==e&&(t[e+1]=Yi(t[e+1],r)),t[o+1]=131071&t[o+1]|r<<17}else t[r+1]=Ji(o,0),0!==o&&(t[o+1]=Yi(t[o+1],r)),o=r;else t[r+1]=Ji(l,0),0===o?o=r:t[l+1]=Yi(t[l+1],r),l=r;c&&(t[r+1]=Ki(t[r+1])),Co(t,u,r,!0),Co(t,u,r,!1),function(t,e,n,r,i){const a=i?t.residualClasses:t.residualStyles;null!=a&&"string"==typeof e&&qe(a,e)>=0&&(n[r+1]=Qi(n[r+1]))}(e,u,t,r,a),s=Ji(o,l),a?e.classBindings=s:e.styleBindings=s}(i,a,e,n,s,r)}}function Lo(t,e,n,r,i){let a=null;const s=n.directiveEnd;let o=n.directiveStylingLast;for(-1===o?o=n.directiveStart:o++;o<s&&(a=e[o],r=zo(r,a.hostAttrs,i),a!==t);)o++;return null!==t&&(n.directiveStylingLast=o),r}function zo(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let a=0;a<e.length;a++){const s=e[a];"number"==typeof s?i=s:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Be(t,s,!!n||e[++a]))}return void 0===t?null:t}function $o(t,e,n,r,i,a,s,o){if(3!==e.type)return;const l=t.data,u=l[o+1];Wo(1==(1&u)?Bo(l,e,n,i,Zi(u),s):void 0)||(Wo(a)||function(t){return 2==(2&t)}(u)&&(a=Bo(l,null,n,i,o,s)),function(t,e,n,r,i){const a=fn(t);if(e)i?a?t.addClass(n,r):n.classList.add(r):a?t.removeClass(n,r):n.classList.remove(r);else{const e=-1==r.indexOf("-")?void 0:2;null==i?a?t.removeStyle(n,r,e):n.style.removeProperty(r):a?t.setStyle(n,r,i,e):n.style.setProperty(r,i)}}(r,s,yn(Kn(),n),i,a))}function Bo(t,e,n,r,i,a){const s=null===e;let o=void 0;for(;i>0;){const e=t[i],a=Array.isArray(e),l=a?e[1]:e,u=null===l;let c=n[i+1];c===Ui&&(c=u?So:void 0);let h=u?We(c,r):l===r?c:void 0;if(a&&!Wo(h)&&(h=We(e,r)),Wo(h)&&(o=h,s))return o;const d=t[i+1];i=s?Xi(d):Zi(d)}if(null!==e){let t=a?e.residualClasses:e.residualStyles;null!=t&&(o=We(t,r))}return o}function Wo(t){return void 0!==t}function qo(t,e){return 0!=(t.flags&(e?16:32))}function Vo(t,e=""){const n=En(),r=An(),i=t+19,a=r.firstCreatePass?ra(r,n[6],t,3,null,null):r.data[i],s=n[i]=function(t,e){return fn(e)?e.createText(t):e.createTextNode(t)}(e,n[11]);as(r,n,s,a),Mn(a,!1)}function Uo(t){return jo("",t,""),Uo}function jo(t,e,n){const r=En(),i=Zs(r,t,e,n);return i!==Ui&&Va(r,Kn(),i),jo}function Ho(t,e,n,r,i){const a=En(),s=function(t,e,n,r,i,a){const s=Xs(t,In.lFrame.bindingIndex,n,i);return $n(2),s?e+yr(n)+r+yr(i)+a:Ui}(a,t,e,n,r,i);return s!==Ui&&Va(a,Kn(),s),Ho}function Go(t,e,n){Oo(Be,Mo,Zs(En(),t,e,n),!0)}function Jo(t,e,n){const r=En();return Js(r,zn(),e)&&ma(An(),Yn(),r,t,e,r[11],n,!0),Jo}function Xo(t,e,n){const r=En();if(Js(r,zn(),e)){const i=An(),a=Yn();ma(i,a,r,t,e,Ba(a,r),n,!0)}return Xo}function Ko(t,e){const n=xn(t)[1],r=n.data.length-1;er(n,{directiveStart:r,directiveEnd:r+1})}function Zo(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const r=[t];for(;e;){let i=void 0;if(cn(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(n){r.push(i);const e=t;e.inputs=Yo(t.inputs),e.declaredInputs=Yo(t.declaredInputs),e.outputs=Yo(t.outputs);const n=i.hostBindings;n&&el(t,n);const a=i.viewQuery,s=i.contentQueries;if(a&&Qo(t,a),s&&tl(t,s),Ut(t.inputs,i.inputs),Ut(t.declaredInputs,i.declaredInputs),Ut(t.outputs,i.outputs),cn(i)&&i.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(i.data.animation)}e.afterContentChecked=e.afterContentChecked||i.afterContentChecked,e.afterContentInit=t.afterContentInit||i.afterContentInit,e.afterViewChecked=t.afterViewChecked||i.afterViewChecked,e.afterViewInit=t.afterViewInit||i.afterViewInit,e.doCheck=t.doCheck||i.doCheck,e.onDestroy=t.onDestroy||i.onDestroy,e.onInit=t.onInit||i.onInit}const e=i.features;if(e)for(let r=0;r<e.length;r++){const i=e[r];i&&i.ngInherit&&i(t),i===Zo&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=hr(i.hostAttrs,n=hr(n,i.hostAttrs))}}(r)}function Yo(t){return t===je?{}:t===He?[]:t}function Qo(t,e){const n=t.viewQuery;t.viewQuery=n?(t,r)=>{e(t,r),n(t,r)}:e}function tl(t,e){const n=t.contentQueries;t.contentQueries=n?(t,r,i)=>{e(t,r,i),n(t,r,i)}:e}function el(t,e){const n=t.hostBindings;t.hostBindings=n?(t,r)=>{e(t,r),n(t,r)}:e}class nl{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function rl(t){t.type.prototype.ngOnChanges&&(t.setInput=il,t.onChanges=function(){const t=al(this),e=t&&t.current;if(e){const n=t.previous;if(n===je)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}})}function il(t,e,n,r){const i=al(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:je,current:null}),a=i.current||(i.current={}),s=i.previous,o=this.declaredInputs[n],l=s[o];a[o]=new nl(l&&l.currentValue,e,s===je),t[r]=e}function al(t){return t.__ngSimpleChanges__||null}function sl(t,e,n,r,i){if(t=ae(t),Array.isArray(t))for(let a=0;a<t.length;a++)sl(t[a],e,n,r,i);else{const a=An(),s=En();let o=Os(t)?t:ae(t.provide),l=Rs(t);const u=Rn(),c=65535&u.providerIndexes,h=u.directiveStart,d=u.providerIndexes>>16;if(Os(t)||!t.multi){const r=new or(l,i,to),p=ul(o,e,i?c:c+d,h);-1===p?(Ar(Dr(u,s),a,o),ol(a,t,e.length),e.push(o),u.directiveStart++,u.directiveEnd++,i&&(u.providerIndexes+=65536),n.push(r),s.push(r)):(n[p]=r,s[p]=r)}else{const p=ul(o,e,c+d,h),f=ul(o,e,c,c+d),m=p>=0&&n[p],g=f>=0&&n[f];if(i&&!g||!i&&!m){Ar(Dr(u,s),a,o);const c=function(t,e,n,r,i){const a=new or(t,n,to);return a.multi=[],a.index=e,a.componentProviders=0,ll(a,i,r&&!n),a}(i?hl:cl,n.length,i,r,l);!i&&g&&(n[f].providerFactory=c),ol(a,t,e.length),e.push(o),u.directiveStart++,u.directiveEnd++,i&&(u.providerIndexes+=65536),n.push(c),s.push(c)}else ol(a,t,p>-1?p:f),ll(n[i?f:p],l,!i&&r);!i&&r&&g&&n[f].componentProviders++}}}function ol(t,e,n){if(Os(e)||e.useClass){const r=(e.useClass||e).prototype.ngOnDestroy;r&&(t.destroyHooks||(t.destroyHooks=[])).push(n,r)}}function ll(t,e,n){t.multi.push(e),n&&t.componentProviders++}function ul(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function cl(t,e,n,r){return dl(this.multi,[])}function hl(t,e,n,r){const i=this.multi;let a;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Or(n,n[1],this.providerFactory.index,r);a=e.slice(0,t),dl(i,a);for(let n=t;n<e.length;n++)a.push(e[n])}else a=[],dl(i,a);return a}function dl(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function pl(t,e=[]){return n=>{n.providersResolver=(n,r)=>function(t,e,n){const r=An();if(r.firstCreatePass){const i=cn(t);sl(n,r.data,r.blueprint,i,!0),sl(e,r.data,r.blueprint,i,!1)}}(n,r?r(t):t,e)}}rl.ngInherit=!0;class fl{}class ml{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${ee(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let gl=(()=>{class t{}return t.NULL=new ml,t})(),yl=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>vl(t),t})();const vl=function(t){return ys(t,Rn(),En())};class _l{}const bl=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}();let xl=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>wl(),t})();const wl=function(){const t=En(),e=bn(Rn().index,t);return function(t){const e=t[11];if(fn(e))return e;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(an(e)?e:t)};let Sl=(()=>{class t{}return t.\u0275prov=jt({token:t,providedIn:"root",factory:()=>null}),t})();class Cl{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Dl=new Cl("9.0.7");class Il{constructor(){}supports(t){return js(t)}create(t){return new El(t)}}const kl=(t,e)=>e;class El{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||kl}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const a=!n||e&&e.currentIndex<Ml(n,r,i)?e:n,s=Ml(a,r,i),o=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(e=e._next,null==a.previousIndex)r++;else{i||(i=[]);const t=s-r,e=o-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,a=r+n;e<=a&&a<t&&(i[n]=r+1)}i[a.previousIndex]=e-t}}s!==o&&t(a,s,o)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!js(t))throw new Error(`Error trying to diff '${ee(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,a=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&Us(i.trackById,r)?(a&&(i=this._verifyReinsertion(i,n,r,e)),Us(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),a=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Vs()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&Us(i.trackById,r)?(a&&(i=this._verifyReinsertion(i,t,r,e)),Us(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),a=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Us(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Us(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Al(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Rl),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Rl),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Al{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Tl{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Us(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class Rl{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Tl,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ml(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Nl{constructor(){}supports(t){return t instanceof Map||Hs(t)}create(){return new Ol}}class Ol{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Hs(t)))throw new Error(`Error trying to diff '${ee(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Pl(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Us(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Pl{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let Fl=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Wt,new $t]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=jt({token:t,providedIn:"root",factory:()=>new t([new Il])}),t})(),Ll=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Wt,new $t]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=jt({token:t,providedIn:"root",factory:()=>new t([new Nl])}),t})();const zl=[new Nl],$l=new Fl([new Il]),Bl=new Ll(zl);let Wl=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ql(t,yl),t})();const ql=function(t,e){return vs(t,e,Rn(),En())};let Vl=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Ul(t,yl),t})();const Ul=function(t,e){return _s(t,e,Rn(),En())},jl={};class Hl extends gl{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=en(t);return new Xl(e,this.ngModule)}}function Gl(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const Jl=new _e("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>_r});class Xl extends fl{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(Vi).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Gl(this.componentDef.inputs)}get outputs(){return Gl(this.componentDef.outputs)}create(t,e,n,r){const i=(r=r||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const a=t.get(n,jl,i);return a!==jl||r===jl?a:e.get(n,r,i)}}}(t,r.injector):t,a=i.get(_l,mn),s=i.get(Sl,null),o=a.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",u=n?function(t,e,n){if(fn(t))return t.selectRootElement(e,n===Ue.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(o,n,this.componentDef.encapsulation):ea(l,a.createRenderer(null,this.componentDef),function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),c=this.componentDef.onPush?576:528,h="string"==typeof n&&/^#root-ng-internal-isolated-\d+/.test(n),d={components:[],scheduler:_r,clean:La,playerHandler:null,flags:0},p=da(0,-1,null,1,0,null,null,null,null,null),f=na(null,p,d,c,null,null,a,o,s,i);let m,g;Un(f,null);try{const t=function(t,e,n,r,i,a){const s=n[1];n[19]=t;const o=ra(s,null,0,3,null,null),l=o.mergedAttrs=e.hostAttrs;null!==l&&(Ws(o,l),null!==t&&(lr(i,t,l),null!==o.classes&&hs(i,t,o.classes),null!==o.styles&&cs(i,t,o.styles)));const u=r.createRenderer(t,e),c=na(n,ha(e),null,e.onPush?64:16,n[19],o,r,u,void 0);return s.firstCreatePass&&(Ar(Dr(o,n),s,e.type),xa(s,o),Sa(o,n.length,1)),Ma(n,c),n[19]=c}(u,this.componentDef,f,a,o);if(u)if(n)lr(o,u,["ng-version",Dl.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let a=t[r];if("string"==typeof a)2===i?""!==a&&e.push(a,t[++r]):8===i&&n.push(a);else{if(!zi(i))break;i=a}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&lr(o,u,t),e&&e.length>0&&hs(o,u,e.join(" "))}g=_n(f[1],0),e&&(g.projection=e.map(t=>Array.from(t))),m=function(t,e,n,r,i){const a=n[1],s=function(t,e,n){const r=Rn();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),ba(t,r,1),Ca(t,e,n));const i=Or(e,t,e.length-1,r);Ri(i,e);const a=vn(r,e);return a&&Ri(a,e),i}(a,n,e);r.components.push(s),t[8]=s,i&&i.forEach(t=>t(s,e)),e.contentQueries&&e.contentQueries(1,s,n.length-1);const o=Rn();if(a.firstCreatePass&&(null!==e.hostBindings||null!==e.hostAttrs)){Zn(o.index-19);const t=n[1];ya(t,e),va(t,n,e.hostVars),_a(e,s)}return s}(t,this.componentDef,f,d,[Ko]),ia(p,f,null)}finally{Xn()}const y=new Kl(this.componentType,m,ys(yl,g,f),f,g);return n&&!h||(y.hostView._tViewNode.child=g),y}}class Kl extends class{}{constructor(t,e,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.destroyCbs=[],this.instance=e,this.hostView=this.changeDetectorRef=new ps(r),this.hostView._tViewNode=function(t,e,n,r){let i=t.node;return null==i&&(t.node=i=pa(0,null,2,-1,null,null)),r[6]=i}(r[1],0,0,r),this.componentType=t}get injector(){return new Lr(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(t=>t()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(t){this.destroyCbs&&this.destroyCbs.push(t)}}const Zl=void 0;var Yl=["en",[["a","p"],["AM","PM"],Zl],[["AM","PM"],Zl,Zl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Zl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Zl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Zl,"{1} 'at' {0}",Zl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Ql={};function tu(t){return t in Ql||(Ql[t]=he.ng&&he.ng.common&&he.ng.common.locales&&he.ng.common.locales[t]),Ql[t]}const eu=function(){var t={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,PluralCase:19,ExtraData:20};return t[t.LocaleId]="LocaleId",t[t.DayPeriodsFormat]="DayPeriodsFormat",t[t.DayPeriodsStandalone]="DayPeriodsStandalone",t[t.DaysFormat]="DaysFormat",t[t.DaysStandalone]="DaysStandalone",t[t.MonthsFormat]="MonthsFormat",t[t.MonthsStandalone]="MonthsStandalone",t[t.Eras]="Eras",t[t.FirstDayOfWeek]="FirstDayOfWeek",t[t.WeekendRange]="WeekendRange",t[t.DateFormat]="DateFormat",t[t.TimeFormat]="TimeFormat",t[t.DateTimeFormat]="DateTimeFormat",t[t.NumberSymbols]="NumberSymbols",t[t.NumberFormats]="NumberFormats",t[t.CurrencyCode]="CurrencyCode",t[t.CurrencySymbol]="CurrencySymbol",t[t.CurrencyName]="CurrencyName",t[t.Currencies]="Currencies",t[t.PluralCase]="PluralCase",t[t.ExtraData]="ExtraData",t}();let nu="en-US";function ru(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+` [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(nu=t.toLowerCase().replace(/_/g,"-"))}const iu=new Map;class au extends Oe{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Hl(this);const n=rn(t),r=t[ge]||null;r&&ru(r),this._bootstrapComponents=xr(n.bootstrap),this._r3Injector=Es(t,e,[{provide:Oe,useValue:this},{provide:gl,useValue:this.componentFactoryResolver}],ee(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Fs.THROW_IF_NOT_FOUND,n=qt.Default){return t===Fs||t===Oe||t===be?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class su extends Pe{constructor(t){super(),this.moduleType=t,null!==rn(t)&&function t(e){if(null!==e.\u0275mod.id){const t=e.\u0275mod.id;(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${ee(e)} vs ${ee(e.name)}`)})(t,iu.get(t),e),iu.set(t,e)}let n=e.\u0275mod.imports;n instanceof Function&&(n=n()),n&&n.forEach(e=>t(e))}(t)}create(t){return new au(this.moduleType,t)}}function ou(t,e,n,r){return function(t,e,n,r,i,a){const s=e+n;return Js(t,s,i)?Gs(t,s+1,a?r.call(a,i):r(i)):uu(t,s+1)}(En(),Ln(),t,e,n,r)}function lu(t,e,n,r,i){return function(t,e,n,r,i,a,s){const o=e+n;return Xs(t,o,i,a)?Gs(t,o+2,s?r.call(s,i,a):r(i,a)):uu(t,o+2)}(En(),Ln(),t,e,n,r,i)}function uu(t,e){const n=t[e];return n===Ui?void 0:n}class cu extends at{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,a=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(a=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(a=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const s=super.subscribe(r,i,a);return t instanceof j&&t.add(s),s}}function hu(){return this._results[Vs()]()}class du{constructor(){this.dirty=!0,this._results=[],this.changes=new cu,this.length=0;const t=Vs(),e=du.prototype;e[t]||(e[t]=hu)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=function t(e,n){void 0===n&&(n=e);for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class pu{constructor(t){this.queryList=t,this.matches=null}clone(){return new pu(this.queryList)}setDirty(){this.queryList.setDirty()}}class fu{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);r.push(this.queries[n.indexInDeclarationView].clone())}return new fu(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==Ru(t,e).matches&&this.queries[e].setDirty()}}class mu{constructor(t,e,n,r=null){this.predicate=t,this.descendants=e,this.isStatic=n,this.read=r}}class gu{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,i=this.getByIndex(n).embeddedTView(t,r);i&&(i.indexInDeclarationView=n,null!==e?e.push(i):e=[i])}return null!==e?new gu(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class yu{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new yu(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&4===n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){if(Array.isArray(this.metadata.predicate)){const n=this.metadata.predicate;for(let r=0;r<n.length;r++)this.matchTNodeWithReadOption(t,e,vu(e,n[r]))}else{const n=this.metadata.predicate;n===Wl?0===e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Nr(e,t,n,!1,!1))}}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===yl||r===Vl||r===Wl&&0===e.type)this.addMatch(e.index,-2);else{const n=Nr(e,t,r,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function vu(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function _u(t,e,n,r){return-1===n?function(t,e){return 3===t.type||4===t.type?ys(yl,t,e):0===t.type?vs(Wl,yl,t,e):null}(e,t):-2===n?function(t,e,n){return n===yl?ys(yl,e,t):n===Wl?vs(Wl,yl,e,t):n===Vl?_s(Vl,yl,e,t):void 0}(t,e,r):Or(t,t[1],n,e)}function bu(t,e,n,r){const i=e[5].queries[r];if(null===i.matches){const r=t.data,a=n.matches,s=[];for(let t=0;t<a.length;t+=2){const i=a[t];s.push(i<0?null:_u(e,r[i],a[t+1],n.metadata.read))}i.matches=s}return i.matches}function xu(t){const e=En(),n=An(),r=Wn();qn(r+1);const i=Ru(n,r);if(t.dirty&&wn(e)===i.metadata.isStatic){if(null===i.matches)t.reset([]);else{const a=i.crossesNgTemplate?function t(e,n,r,i){const a=e.queries.getByIndex(r),s=a.matches;if(null!==s){const o=bu(e,n,a,r);for(let e=0;e<s.length;e+=2){const r=s[e];if(r>0)i.push(o[e/2]);else{const a=s[e+1],o=n[-r];for(let e=9;e<o.length;e++){const n=o[e];n[17]===n[3]&&t(n[1],n,a,i)}if(null!==o[5]){const e=o[5];for(let n=0;n<e.length;n++){const r=e[n];t(r[1],r,a,i)}}}}}return i}(n,e,r,[]):bu(n,e,i,r);t.reset(a),t.notifyOnChanges()}return!0}return!1}function wu(t,e,n){Cu(An(),En(),t,e,n,!0)}function Su(t,e,n){Cu(An(),En(),t,e,n,!1)}function Cu(t,e,n,r,i,a){t.firstCreatePass&&(Tu(t,new mu(n,r,a,i),-1),a&&(t.staticViewQueries=!0)),Au(t,e)}function Du(t,e,n,r){ku(An(),En(),e,n,r,!1,Rn(),t)}function Iu(t,e,n,r){ku(An(),En(),e,n,r,!0,Rn(),t)}function ku(t,e,n,r,i,a,s,o){t.firstCreatePass&&(Tu(t,new mu(n,r,a,i),s.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(t.contentQueries.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(t,o),a&&(t.staticContentQueries=!0)),Au(t,e)}function Eu(){return t=En(),e=Wn(),t[5].queries[e].queryList;var t,e}function Au(t,e){const n=new du;!function(t,e,n,r){const i=za(e);i.push(n),t.firstCreatePass&&$a(t).push(r,i.length-1)}(t,e,n,n.destroy),null===e[5]&&(e[5]=new fu),e[5].queries.push(new pu(n))}function Tu(t,e,n){null===t.queries&&(t.queries=new gu),t.queries.track(new yu(e,n))}function Ru(t,e){return t.queries.getByIndex(e)}function Mu(t,e){return vs(Wl,yl,t,e)}const Nu=new _e("Application Initializer");let Ou=(()=>{class t{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();ho(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nu,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const Pu=new _e("AppId"),Fu={provide:Pu,useFactory:function(){return`${Lu()}${Lu()}${Lu()}`},deps:[]};function Lu(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const zu=new _e("Platform Initializer"),$u=new _e("Platform ID"),Bu=new _e("appBootstrapListener");let Wu=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const qu=new _e("LocaleId"),Vu=new _e("DefaultCurrencyCode");class Uu{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const ju=function(t){return new su(t)},Hu=ju,Gu=function(t){return Promise.resolve(ju(t))},Ju=function(t){const e=ju(t),n=xr(rn(t).declarations).reduce((t,e)=>{const n=en(e);return n&&t.push(new Xl(n)),t},[]);return new Uu(e,n)},Xu=Ju,Ku=function(t){return Promise.resolve(Ju(t))};let Zu=(()=>{class t{constructor(){this.compileModuleSync=Hu,this.compileModuleAsync=Gu,this.compileModuleAndAllComponentsSync=Xu,this.compileModuleAndAllComponentsAsync=Ku}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const Yu=new _e("compilerOptions"),Qu=(()=>Promise.resolve(0))();function tc(t){"undefined"==typeof Zone?Qu.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class ec{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cu(!1),this.onMicrotaskEmpty=new cu(!1),this.onStable=new cu(!1),this.onError=new cu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=e,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let t=he.requestAnimationFrame,e=he.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(he,()=>{t.lastRequestAnimationFrameId=-1,ac(t),ic(t)}),ac(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(n,r,i,a,s,o)=>{try{return sc(t),n.invokeTask(i,a,s,o)}finally{e&&"eventTask"===a.type&&e(),oc(t)}},onInvoke:(e,n,r,i,a,s,o)=>{try{return sc(t),e.invoke(r,i,a,s,o)}finally{oc(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,ac(t),ic(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ec.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(ec.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,t,rc,nc,nc);try{return i.runTask(a,e,n)}finally{i.cancelTask(a)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function nc(){}const rc={};function ic(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function ac(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function sc(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function oc(t){t._nesting--,ic(t)}class lc{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cu,this.onMicrotaskEmpty=new cu,this.onStable=new cu,this.onError=new cu}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let uc=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ec.assertNotInAngularZone(),tc(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())tc(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(Ae(ec))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),cc=(()=>{class t{constructor(){this._applications=new Map,pc.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return pc.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();class hc{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let dc,pc=new hc,fc=function(t,e,n){const r=new su(n);if(0===zs.size)return Promise.resolve(r);const i=function(t){const e=[];return t.forEach(t=>t&&e.push(...t)),e}(t.get(Yu,[]).concat(e).map(t=>t.providers));if(0===i.length)return Promise.resolve(r);const a=function(){const t=he.ng;if(!t||!t.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return t.\u0275compilerFacade}(),s=Fs.create({providers:i}).get(a.ResourceLoader);return function(t){const e=[],n=new Map;function r(t){let e=n.get(t);if(!e){const r=(t=>Promise.resolve(s.get(t)))(t);n.set(t,e=r.then(Bs))}return e}return zs.forEach((t,n)=>{const i=[];t.templateUrl&&i.push(r(t.templateUrl).then(e=>{t.template=e}));const a=t.styleUrls,s=t.styles||(t.styles=[]),o=t.styles.length;a&&a.forEach((e,n)=>{s.push(""),i.push(r(e).then(r=>{s[o+n]=r,a.splice(a.indexOf(e),1),0==a.length&&(t.styleUrls=void 0)}))});const l=Promise.all(i).then(()=>function(t){$s.delete(t)}(n));e.push(l)}),zs=new Map,Promise.all(e).then(()=>{})}().then(()=>r)};const mc=new _e("AllowMultipleToken");class gc{constructor(t,e){this.name=t,this.token=e}}function yc(t,e,n=[]){const r=`Platform: ${e}`,i=new _e(r);return(e=[])=>{let a=vc();if(!a||a.injector.get(mc,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0},{provide:ws,useValue:"platform"});!function(t){if(dc&&!dc.destroyed&&!dc.injector.get(mc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");dc=t.get(_c);const e=t.get(zu,null);e&&e.forEach(t=>t())}(Fs.create({providers:t,name:r}))}return function(t){const e=vc();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function vc(){return dc&&!dc.destroyed?dc:null}let _c=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new lc:("zone.js"===t?void 0:t)||new ec({enableLongStackTrace:ti(),shouldCoalesceEventChangeDetection:e}),n}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),r=[{provide:ec,useValue:n}];return n.run(()=>{const e=Fs.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),a=i.injector.get(qr,null);if(!a)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.onDestroy(()=>wc(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{a.handleError(t)}})),function(t,e,n){try{const r=n();return ho(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(a,n,()=>{const t=i.injector.get(Ou);return t.runInitializers(),t.donePromise.then(()=>(ru(i.injector.get(qu,"en-US")||"en-US"),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=bc({},e);return fc(this.injector,n,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(xc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${ee(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Ae(Fs))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();function bc(t,e){return Array.isArray(e)?e.reduce(bc,t):Object.assign(Object.assign({},t),e)}let xc=(()=>{class t{constructor(t,e,n,r,i,a){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=ti(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new tt(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),o=new tt(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{ec.assertNotInAngularZone(),tc(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{ec.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=kt(s,o.pipe(Pt()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof fl?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(Oe),i=n.create(Fs.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const a=i.injector.get(uc,null);return a&&i.injector.get(cc).registerApplication(i.location.nativeElement,a),this._loadComponent(i),ti()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;wc(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Bu,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),wc(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(Ae(ec),Ae(Wu),Ae(Fs),Ae(qr),Ae(gl),Ae(Ou))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();function wc(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Sc{}class Cc{}const Dc={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Ic=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||Dc}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>kc(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>kc(t,e,r))}}return t.\u0275fac=function(e){return new(e||t)(Ae(Zu),Ae(Cc,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();function kc(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const Ec=yc(null,"core",[{provide:$u,useValue:"unknown"},{provide:_c,deps:[Fs]},{provide:cc,deps:[]},{provide:Wu,deps:[]}]),Ac=[{provide:xc,useClass:xc,deps:[ec,Wu,Fs,qr,gl,Ou]},{provide:Jl,deps:[ec],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Ou,useClass:Ou,deps:[[new $t,Nu]]},{provide:Zu,useClass:Zu,deps:[]},Fu,{provide:Fl,useFactory:function(){return $l},deps:[]},{provide:Ll,useFactory:function(){return Bl},deps:[]},{provide:qu,useFactory:function(t){return ru(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new zt(qu),new $t,new Wt]]},{provide:Vu,useValue:"USD"}];let Tc=(()=>{class t{constructor(t){}}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)(Ae(xc))},providers:Ac}),t})();let Rc=null;function Mc(){return Rc}const Nc=new _e("DocumentToken");let Oc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:Pc,token:t,providedIn:"platform"}),t})();function Pc(){return Ae(Lc)}const Fc=new _e("Location Initialized");let Lc=(()=>{class t extends Oc{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=Mc().getLocation(),this._history=Mc().getHistory()}getBaseHrefFromDOM(){return Mc().getBaseHref(this._doc)}onPopState(t){Mc().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){Mc().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){zc()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){zc()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc))},t.\u0275prov=jt({factory:$c,token:t,providedIn:"platform"}),t})();function zc(){return!!window.history.pushState}function $c(){return new Lc(Ae(Nc))}function Bc(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function Wc(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function qc(t){return t&&"?"!==t[0]?"?"+t:t}let Vc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:Uc,token:t,providedIn:"root"}),t})();function Uc(t){const e=Ae(Nc).location;return new Hc(Ae(Oc),e&&e.origin||"")}const jc=new _e("appBaseHref");let Hc=(()=>{class t extends Vc{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Bc(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+qc(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+qc(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+qc(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Ae(Oc),Ae(jc,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),Gc=(()=>{class t extends Vc{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Bc(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+qc(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+qc(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Ae(Oc),Ae(jc,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),Jc=(()=>{class t{constructor(t,e){this._subject=new cu,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=Wc(Kc(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+qc(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Kc(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qc(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qc(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)})}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(Ae(Vc),Ae(Oc))},t.normalizeQueryParams=qc,t.joinWithSlash=Bc,t.stripTrailingSlash=Wc,t.\u0275prov=jt({factory:Xc,token:t,providedIn:"root"}),t})();function Xc(){return new Jc(Ae(Vc),Ae(Oc))}function Kc(t){return t.replace(/\/index.html$/,"")}const Zc=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}();class Yc{}let Qc=(()=>{class t extends Yc{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=tu(e);if(n)return n;const r=e.split("-")[0];if(n=tu(r),n)return n;if("en"===r)return Yl;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[eu.PluralCase]}(e||this.locale)(t)){case Zc.Zero:return"zero";case Zc.One:return"one";case Zc.Two:return"two";case Zc.Few:return"few";case Zc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(Ae(qu))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();function th(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}let eh=(()=>{class t{constructor(t,e,n,r){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(js(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${ee(t.item)}`);this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(to(Fl),to(Ll),to(yl),to(xl))},t.\u0275dir=tn({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class nh{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let rh=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){ti()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. `+"See https://angular.io/api/common/NgForOf#change-propagation for more information."),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new nh(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new ih(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const a=new ih(t,i);e.push(a)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(to(Vl),to(Wl),to(Fl))},t.\u0275dir=tn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class ih{constructor(t,e){this.record=t,this.view=e}}let ah=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new sh,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){oh("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){oh("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(to(Vl),to(Wl))},t.\u0275dir=tn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class sh{constructor(){this.$implicit=null,this.ngIf=null}}function oh(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${ee(e)}'.`)}class lh{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let uh=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const e=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),e}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let e=0;e<this._defaultViews.length;e++)this._defaultViews[e].enforceState(t)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),t})(),ch=(()=>{class t{constructor(t,e,n){this.ngSwitch=n,n._addCase(),this._view=new lh(t,e)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(to(Vl),to(Wl),to(uh,1))},t.\u0275dir=tn({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),t})(),hh=(()=>{class t{constructor(t,e,n){n._addDefault(new lh(t,e))}}return t.\u0275fac=function(e){return new(e||t)(to(Vl),to(Wl),to(uh,1))},t.\u0275dir=tn({type:t,selectors:[["","ngSwitchDefault",""]]}),t})(),dh=(()=>{class t{constructor(t,e,n){this._ngEl=t,this._differs=e,this._renderer=n,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,e){const[n,r]=t.split(".");null!=(e=null!=e&&r?`${e}${r}`:e)?this._renderer.setStyle(this._ngEl.nativeElement,n,e):this._renderer.removeStyle(this._ngEl.nativeElement,n)}_applyChanges(t){t.forEachRemovedItem(t=>this._setStyle(t.key,null)),t.forEachAddedItem(t=>this._setStyle(t.key,t.currentValue)),t.forEachChangedItem(t=>this._setStyle(t.key,t.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(Ll),to(xl))},t.\u0275dir=tn({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),ph=(()=>{class t{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const t=this._viewContainerRef;this._viewRef&&t.remove(t.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?t.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&this.ngTemplateOutletContext&&this._updateExistingContext(this.ngTemplateOutletContext)}_shouldRecreateView(t){const e=t.ngTemplateOutletContext;return!!t.ngTemplateOutlet||e&&this._hasContextShapeChanged(e)}_hasContextShapeChanged(t){const e=Object.keys(t.previousValue||{}),n=Object.keys(t.currentValue||{});if(e.length===n.length){for(let t of n)if(-1===e.indexOf(t))return!0;return!1}return!0}_updateExistingContext(t){for(let e of Object.keys(t))this._viewRef.context[e]=this.ngTemplateOutletContext[e]}}return t.\u0275fac=function(e){return new(e||t)(to(Vl))},t.\u0275dir=tn({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[rl]}),t})(),fh=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[{provide:Yc,useClass:Qc}]}),t})(),mh=(()=>{class t{}return t.\u0275prov=jt({token:t,providedIn:"root",factory:()=>new gh(Ae(Nc),window,Ae(qr))}),t})();class gh{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const e=this.document.querySelector(`#${t}`);if(e)return void this.scrollToElement(e);const n=this.document.querySelector(`[name='${t}']`);if(n)return void this.scrollToElement(n)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(t){return!1}}}class yh extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new yh,Rc||(Rc=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=_h||(_h=document.querySelector("base"),_h)?_h.getAttribute("href"):null;return null==e?null:(n=e,vh||(vh=document.createElement("a")),vh.setAttribute("href",n),"/"===vh.pathname.charAt(0)?vh.pathname:"/"+vh.pathname);var n}resetBaseElement(){_h=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return th(document.cookie,t)}}let vh,_h=null;const bh=new _e("TRANSITION_ID"),xh=[{provide:Nu,useFactory:function(t,e,n){return()=>{n.get(Ou).donePromise.then(()=>{const n=Mc();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[bh,Nc,Fs],multi:!0}];class wh{static init(){var t;t=new wh,pc=t}addToWindow(t){he.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},he.getAllAngularTestabilities=()=>t.getAllTestabilities(),he.getAllAngularRootElements=()=>t.getAllRootElements(),he.frameworkStabilizers||(he.frameworkStabilizers=[]),he.frameworkStabilizers.push(t=>{const e=he.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,n--,0==n&&t(r)};e.forEach((function(t){t.whenStable(i)}))})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?Mc().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const Sh=new _e("EventManagerPlugins");let Ch=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}return t.\u0275fac=function(e){return new(e||t)(Ae(Sh),Ae(ec))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();class Dh{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=Mc().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let Ih=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),kh=(()=>{class t extends Ih{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>Mc().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const Eh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Ah=/%COMP%/g;function Th(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Th(t,i,n):(i=i.replace(Ah,t),n.push(i))}return n}function Rh(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Mh=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Nh(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case Ue.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new Oh(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case Ue.Native:case Ue.ShadowDom:return new Ph(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=Th(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Ae(Ch),Ae(kh),Ae(Pu))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();class Nh{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(Eh[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=Eh[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=Eh[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&bl.DashCase?t.style.setProperty(e,n,r&bl.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&bl.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Rh(n)):this.eventManager.addEventListener(t,e,Rh(n))}}class Oh extends Nh{constructor(t,e,n,r){super(t),this.component=n;const i=Th(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(Ah,r+"-"+n.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(Ah,t)}(r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Ph extends Nh{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===Ue.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=Th(r.id,r.styles,[]);for(let a=0;a<i.length;a++){const t=document.createElement("style");t.textContent=i[a],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Fh=(()=>{class t extends Dh{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const Lh=["alt","control","meta","shift"],zh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$h={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Bh={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Wh=(()=>{class t extends Dh{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const i=t.parseEventName(n),a=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Mc().onAndCancel(e,i.domEventName,a))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let a="";if(Lh.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),a+=t+".")}),a+=i,0!=n.length||0===i.length)return null;const s={};return s.domEventName=r,s.fullKey=a,s}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&$h.hasOwnProperty(e)&&(e=$h[e]))}return zh[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),Lh.forEach(r=>{r!=n&&(0,Bh[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),qh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:function(){return Ae(Vh)},token:t,providedIn:"root"}),t})(),Vh=(()=>{class t extends qh{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case Si.NONE:return e;case Si.HTML:return Kr(e,"HTML")?Xr(e):xi(this._doc,String(e));case Si.STYLE:return Kr(e,"Style")?Xr(e):Ii(e);case Si.SCRIPT:if(Kr(e,"Script"))return Xr(e);throw new Error("unsafe value used in a script context");case Si.URL:return Zr(e),Kr(e,"URL")?Xr(e):ii(String(e));case Si.RESOURCE_URL:if(Kr(e,"ResourceURL"))return Xr(e);throw new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see http://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return new Ur(t)}bypassSecurityTrustStyle(t){return new jr(t)}bypassSecurityTrustScript(t){return new Hr(t)}bypassSecurityTrustUrl(t){return new Gr(t)}bypassSecurityTrustResourceUrl(t){return new Jr(t)}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc))},t.\u0275prov=jt({factory:function(){return t=Ae(be),new Vh(t.get(Nc));var t},token:t,providedIn:"root"}),t})();const Uh=yc(Ec,"browser",[{provide:$u,useValue:"browser"},{provide:zu,useValue:function(){yh.makeCurrent(),wh.init()},multi:!0},{provide:Nc,useFactory:function(){return function(t){dn=t}(document),document},deps:[]}]),jh=[[],{provide:ws,useValue:"root"},{provide:qr,useFactory:function(){return new qr},deps:[]},{provide:Sh,useClass:Fh,multi:!0,deps:[Nc,ec,$u]},{provide:Sh,useClass:Wh,multi:!0,deps:[Nc]},[],{provide:Mh,useClass:Mh,deps:[Ch,kh,Pu]},{provide:_l,useExisting:Mh},{provide:Ih,useExisting:kh},{provide:kh,useClass:kh,deps:[Nc]},{provide:uc,useClass:uc,deps:[ec]},{provide:Ch,useClass:Ch,deps:[Sh,ec]},[]];let Hh=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:Pu,useValue:e.appId},{provide:bh,useExisting:Pu},xh]}}}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)(Ae(t,12))},providers:jh,imports:[fh,Tc]}),t})();function Gh(...t){let e=t[t.length-1];return ot(e)?(t.pop(),bt(t,e)):It(t)}"undefined"!=typeof window&&window;class Jh extends at{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new nt;return this._value}next(t){super.next(this._value=t)}}const Xh=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})(),Kh={};class Zh{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new Yh(t,this.resultSelector))}}class Yh extends gt{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(Kh),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++){const e=t[n];this.add(mt(this,e,e,n))}}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n,r,i){const a=this.values,s=this.toRespond?a[n]===Kh?--this.toRespond:this.toRespond:0;a[n]=e,0===s&&(this.resultSelector?this._tryResultSelector(a):this.destination.next(a.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const Qh=new tt(t=>t.complete());function td(t){return t?function(t){return new tt(e=>t.schedule(()=>e.complete()))}(t):Qh}function ed(t){return new tt(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?xt(n):td()).subscribe(e)})}function nd(){return Dt(1)}function rd(t,e){return function(n){return n.lift(new id(t,e))}}class id{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new ad(t,this.predicate,this.thisArg))}}class ad extends J{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}const sd=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function od(t){return function(e){return 0===t?td():e.lift(new ld(t))}}class ld{constructor(t){if(this.total=t,this.total<0)throw new sd}call(t,e){return e.subscribe(new ud(t,this.total))}}class ud extends J{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function cd(t=pd){return e=>e.lift(new hd(t))}class hd{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new dd(t,this.errorFactory))}}class dd extends J{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function pd(){return new Xh}function fd(t=null){return e=>e.lift(new md(t))}class md{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new gd(t,this.defaultValue))}}class gd extends J{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function yd(t,e){const n=arguments.length>=2;return r=>r.pipe(t?rd((e,n)=>t(e,n,r)):Z,od(1),n?fd(e):cd(()=>new Xh))}function vd(t){return function(e){const n=new _d(t),r=e.lift(n);return n.caught=r}}class _d{constructor(t){this.selector=t}call(t,e){return e.subscribe(new bd(t,this.selector,this.caught))}}class bd extends gt{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new lt(this,void 0,void 0);this.add(r);const i=mt(this,n,void 0,void 0,r);i!==r&&this.add(i)}}}function xd(t){return e=>0===t?td():e.lift(new wd(t))}class wd{constructor(t){if(this.total=t,this.total<0)throw new sd}call(t,e){return e.subscribe(new Sd(t,this.total))}}class Sd extends J{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function Cd(t,e){const n=arguments.length>=2;return r=>r.pipe(t?rd((e,n)=>t(e,n,r)):Z,xd(1),n?fd(e):cd(()=>new Xh))}class Dd{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new Id(t,this.predicate,this.thisArg,this.source))}}class Id extends J{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function kd(t,e){return"function"==typeof e?n=>n.pipe(kd((n,r)=>xt(t(n,r)).pipe(yt((t,i)=>e(n,t,r,i))))):e=>e.lift(new Ed(t))}class Ed{constructor(t){this.project=t}call(t,e){return e.subscribe(new Ad(t,this.project))}}class Ad extends gt{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}_innerSub(t,e,n){const r=this.innerSubscription;r&&r.unsubscribe();const i=new lt(this,e,n),a=this.destination;a.add(i),this.innerSubscription=mt(this,t,void 0,void 0,i),this.innerSubscription!==i&&a.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,n,r,i){this.destination.next(e)}}function Td(...t){return nd()(Gh(...t))}function Rd(...t){const e=t[t.length-1];return ot(e)?(t.pop(),n=>Td(t,n,e)):e=>Td(t,e)}function Md(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Nd(t,e,n))}}class Nd{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new Od(t,this.accumulator,this.seed,this.hasSeed))}}class Od extends J{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function Pd(t,e){return wt(t,e,1)}function Fd(){}function Ld(t,e,n){return function(r){return r.lift(new zd(t,e,n))}}class zd{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new $d(t,this.nextOrObserver,this.error,this.complete))}}class $d extends J{constructor(t,e,n,r){super(t),this._tapNext=Fd,this._tapError=Fd,this._tapComplete=Fd,this._tapError=n||Fd,this._tapComplete=r||Fd,L(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Fd,this._tapError=e.error||Fd,this._tapComplete=e.complete||Fd)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}function Bd(t){return e=>e.lift(new Wd(t))}class Wd{constructor(t){this.callback=t}call(t,e){return e.subscribe(new qd(t,this.callback))}}class qd extends J{constructor(t,e){super(t),this.add(new j(e))}}class Vd{constructor(t,e){this.id=t,this.url=e}}class Ud extends Vd{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class jd extends Vd{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Hd extends Vd{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Gd extends Vd{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Jd extends Vd{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xd extends Vd{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Kd extends Vd{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Zd extends Vd{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yd extends Vd{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qd{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class tp{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ep{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class np{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rp{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ip{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ap{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let sp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&oo(0,"router-outlet")},directives:function(){return[lm]},encapsulation:2}),t})();class op{constructor(t){this.params=t||{}}has(t){return this.params.hasOwnProperty(t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function lp(t){return new op(t)}function up(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function cp(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let a=0;a<r.length;a++){const e=r[a],n=t[a];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}class hp{constructor(t,e){this.routes=t,this.module=e}}function dp(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];pp(r,fp(e,r))}}function pp(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&dp(t.children,e)}function fp(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function mp(t){const e=t.children&&t.children.map(mp),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=sp),n}function gp(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let i;for(let a=0;a<n.length;a++)if(i=n[a],!yp(t[i],e[i]))return!1;return!0}function yp(t,e){return Array.isArray(t)&&Array.isArray(e)?t.length==e.length&&t.every(t=>e.indexOf(t)>-1):t===e}function vp(t){return Array.prototype.concat.apply([],t)}function _p(t){return t.length>0?t[t.length-1]:null}function bp(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function xp(t){return po(t)?t:ho(t)?xt(Promise.resolve(t)):Gh(t)}function wp(t,e,n){return n?function(t,e){return gp(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!Ip(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>yp(t[n],e[n]))}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length)return!!Ip(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!Ip(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),a=i.slice(n.segments.length);return!!Ip(n.segments,t)&&!!n.children.primary&&e(n.children.primary,r,a)}}(e,n,n.segments)}(t.root,e.root)}class Sp{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=lp(this.queryParams)),this._queryParamMap}toString(){return Tp.serialize(this)}}class Cp{constructor(t,e){this.segments=t,this.children=e,this.parent=null,bp(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Rp(this)}}class Dp{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=lp(this.parameters)),this._parameterMap}toString(){return Lp(this)}}function Ip(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function kp(t,e){let n=[];return bp(t.children,(t,r)=>{"primary"===r&&(n=n.concat(e(t,r)))}),bp(t.children,(t,r)=>{"primary"!==r&&(n=n.concat(e(t,r)))}),n}class Ep{}class Ap{parse(t){const e=new qp(t);return new Sp(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`${`/${function t(e,n){if(!e.hasChildren())return Rp(e);if(n){const n=e.children.primary?t(e.children.primary,!1):"",r=[];return bp(e.children,(e,n)=>{"primary"!==n&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=kp(e,(n,r)=>"primary"===r?[t(e.children.primary,!1)]:[`${r}:${t(n,!1)}`]);return`${Rp(e)}/(${n.join("//")})`}}(t.root,!0)}`}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${Np(e)}=${Np(t)}`).join("&"):`${Np(e)}=${Np(n)}`});return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Tp=new Ap;function Rp(t){return t.segments.map(t=>Lp(t)).join("/")}function Mp(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Np(t){return Mp(t).replace(/%3B/gi,";")}function Op(t){return Mp(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Pp(t){return decodeURIComponent(t)}function Fp(t){return Pp(t.replace(/\+/g,"%20"))}function Lp(t){return`${Op(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Op(t)}=${Op(e[t])}`).join("")}`;var e}const zp=/^[^\/()?;=#]+/;function $p(t){const e=t.match(zp);return e?e[0]:""}const Bp=/^[^=?&#]+/,Wp=/^[^?&#]+/;class qp{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Cp([],{}):new Cp([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new Cp(t,e)),n}parseSegment(){const t=$p(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Dp(Pp(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=$p(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=$p(this.remaining);t&&(n=t,this.capture(n))}t[Pp(e)]=Pp(n)}parseQueryParam(t){const e=function(t){const e=t.match(Bp);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Wp);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const r=Fp(e),i=Fp(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(e=[e],t[r]=e),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=$p(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i="primary");const a=this.parseChildren();e[i]=1===Object.keys(a).length?a.primary:new Cp([],a),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Vp{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Up(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Up(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=jp(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return jp(t,this._root).map(t=>t.value)}}function Up(t,e){if(t===e.value)return e;for(const n of e.children){const e=Up(t,n);if(e)return e}return null}function jp(t,e){if(t===e.value)return[e];for(const n of e.children){const r=jp(t,n);if(r.length)return r.unshift(e),r}return[]}class Hp{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Gp(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Jp extends Vp{constructor(t,e){super(t),this.snapshot=e,tf(this,t)}toString(){return this.snapshot.toString()}}function Xp(t,e){const n=function(t,e){const n=new Yp([],{},{},"",{},"primary",e,null,t.root,-1,{});return new Qp("",new Hp(n,[]))}(t,e),r=new Jh([new Dp("",{})]),i=new Jh({}),a=new Jh({}),s=new Jh({}),o=new Jh(""),l=new Kp(r,i,s,o,a,"primary",e,n.root);return l.snapshot=n.root,new Jp(new Hp(l,[]),n)}class Kp{constructor(t,e,n,r,i,a,s,o){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=a,this.component=s,this._futureSnapshot=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(yt(t=>lp(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(yt(t=>lp(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Zp(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Yp{constructor(t,e,n,r,i,a,s,o,l,u,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=a,this.component=s,this.routeConfig=o,this._urlSegment=l,this._lastPathIndex=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=lp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=lp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Qp extends Vp{constructor(t,e){super(e),this.url=t,tf(this,e)}toString(){return ef(this._root)}}function tf(t,e){e.value._routerState=t,e.children.forEach(e=>tf(t,e))}function ef(t){const e=t.children.length>0?` { ${t.children.map(ef).join(", ")} } `:"";return`${t.value}${e}`}function nf(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,gp(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),gp(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!gp(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),gp(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function rf(t,e){var n,r;return gp(t.params,e.params)&&Ip(n=t.url,r=e.url)&&n.every((t,e)=>gp(t.parameters,r[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||rf(t.parent,e.parent))}function af(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function sf(t,e,n,r,i){let a={};return r&&bp(r,(t,e)=>{a[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new Sp(n.root===t?e:function t(e,n,r){const i={};return bp(e.children,(e,a)=>{i[a]=e===n?r:t(e,n,r)}),new Cp(e.segments,i)}(n.root,t,e),a,i)}class of{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&af(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==_p(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class lf{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function uf(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets.primary:`${t}`}function cf(t,e,n){if(t||(t=new Cp([],{})),0===t.segments.length&&t.hasChildren())return hf(t,e,n);const r=function(t,e,n){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return a;const e=t.segments[i],s=uf(n[r]),o=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&o&&"object"==typeof o&&void 0===o.outlets){if(!mf(s,o,e))return a;r+=2}else{if(!mf(s,{},e))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new Cp(t.segments.slice(0,r.pathIndex),{});return e.children.primary=new Cp(t.segments.slice(r.pathIndex),t.children),hf(e,0,i)}return r.match&&0===i.length?new Cp(t.segments,{}):r.match&&!t.hasChildren()?df(t,e,n):r.match?hf(t,0,i):df(t,e,n)}function hf(t,e,n){if(0===n.length)return new Cp(t.segments,{});{const r=function(t){return"object"!=typeof t[0]||void 0===t[0].outlets?{primary:t}:t[0].outlets}(n),i={};return bp(r,(n,r)=>{null!==n&&(i[r]=cf(t.children[r],e,n))}),bp(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new Cp(t.segments,i)}}function df(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){const t=pf(n[i].outlets);return new Cp(r,t)}if(0===i&&af(n[0])){r.push(new Dp(t.segments[e].path,n[0])),i++;continue}const a=uf(n[i]),s=i<n.length-1?n[i+1]:null;a&&s&&af(s)?(r.push(new Dp(a,ff(s))),i+=2):(r.push(new Dp(a,{})),i++)}return new Cp(r,{})}function pf(t){const e={};return bp(t,(t,n)=>{null!==t&&(e[n]=df(new Cp([],{}),0,t))}),e}function ff(t){const e={};return bp(t,(t,n)=>e[n]=`${t}`),e}function mf(t,e,n){return t==n.path&&gp(e,n.parameters)}class gf{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),nf(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=Gp(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),bp(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=Gp(t),i=t.value.component?n.children:e;bp(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=Gp(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new ip(t.value.snapshot))}),t.children.length&&this.forwardEvent(new np(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(nf(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),yf(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function yf(t){nf(t.value),t.children.forEach(yf)}function vf(t){return"function"==typeof t}function _f(t){return t instanceof Sp}class bf{constructor(t){this.segmentGroup=t||null}}class xf{constructor(t){this.urlTree=t}}function wf(t){return new tt(e=>e.error(new bf(t)))}function Sf(t){return new tt(e=>e.error(new xf(t)))}function Cf(t){return new tt(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Df{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(Oe)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(yt(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(vd(t=>{if(t instanceof xf)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof bf)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(yt(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(vd(t=>{if(t instanceof bf)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new Cp([],{primary:t}):t;return new Sp(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(yt(t=>new Cp([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return Gh({});const n=[],r=[],i={};return bp(t,(t,a)=>{const s=e(a,t).pipe(yt(t=>i[a]=t));"primary"===a?n.push(s):r.push(s)}),Gh.apply(null,n.concat(r)).pipe(nd(),yd(),yt(()=>i))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,a){return Gh(...n).pipe(yt(s=>this.expandSegmentAgainstRoute(t,e,n,s,r,i,a).pipe(vd(t=>{if(t instanceof bf)return Gh(null);throw t}))),nd(),Cd(t=>!!t),vd((t,n)=>{if(t instanceof Xh||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return Gh(new Cp([],{}));throw new bf(e)}throw t}))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,a,s){return Af(r)!==a?wf(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a):wf(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Sf(i):this.lineralizeSegments(n,i).pipe(wt(n=>{const i=new Cp(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a){const{matched:s,consumedSegments:o,lastChild:l,positionalParamSegments:u}=If(e,r,i);if(!s)return wf(e);const c=this.applyRedirectCommands(o,r.redirectTo,u);return r.redirectTo.startsWith("/")?Sf(c):this.lineralizeSegments(r,c).pipe(wt(r=>this.expandSegment(t,e,n,r.concat(i.slice(l)),a,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(yt(t=>(n._loadedConfig=t,new Cp(r,{})))):Gh(new Cp(r,{}));const{matched:i,consumedSegments:a,lastChild:s}=If(e,n,r);if(!i)return wf(e);const o=r.slice(s);return this.getChildConfig(t,n,r).pipe(wt(t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:s}=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some(n=>Ef(t,e,n)&&"primary"!==Af(n))}(t,n,r)?{segmentGroup:kf(new Cp(e,function(t,e){const n={};n.primary=e;for(const r of t)""===r.path&&"primary"!==Af(r)&&(n[Af(r)]=new Cp([],{}));return n}(r,new Cp(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some(n=>Ef(t,e,n))}(t,n,r)?{segmentGroup:kf(new Cp(t.segments,function(t,e,n,r){const i={};for(const a of n)Ef(t,e,a)&&!r[Af(a)]&&(i[Af(a)]=new Cp([],{}));return Object.assign(Object.assign({},r),i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,a,o,r);return 0===s.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(yt(t=>new Cp(a,t))):0===r.length&&0===s.length?Gh(new Cp(a,{})):this.expandSegment(n,i,r,s,"primary",!0).pipe(yt(t=>new Cp(a.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Gh(new hp(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Gh(e._loadedConfig):function(t,e,n){const r=e.canLoad;return r&&0!==r.length?xt(r).pipe(yt(r=>{const i=t.get(r);let a;if(function(t){return t&&vf(t.canLoad)}(i))a=i.canLoad(e,n);else{if(!vf(i))throw new Error("Invalid CanLoad guard");a=i(e,n)}return xp(a)})).pipe(nd(),(i=t=>!0===t,t=>t.lift(new Dd(i,void 0,t)))):Gh(!0);var i}(t.injector,e,n).pipe(wt(n=>n?this.configLoader.load(t.injector,e).pipe(yt(t=>(e._loadedConfig=t,t))):function(t){return new tt(e=>e.error(up(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Gh(new hp([],t))}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Gh(n);if(r.numberOfChildren>1||!r.children.primary)return Cf(t.redirectTo);r=r.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new Sp(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return bp(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let a={};return bp(e.children,(e,i)=>{a[i]=this.createSegmentGroup(t,e,n,r)}),new Cp(i,a)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function If(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||cp)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function kf(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new Cp(t.segments.concat(e.segments),e.children)}return t}function Ef(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Af(t){return t.outlet||"primary"}class Tf{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Rf{constructor(t,e){this.component=t,this.route=e}}function Mf(t,e,n){const r=t._root;return function t(e,n,r,i,a={canDeactivateChecks:[],canActivateChecks:[]}){const s=Gp(n);return e.children.forEach(e=>{!function(e,n,r,i,a={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,o=n?n.value:null,l=r?r.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const u=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Ip(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ip(t.url,e.url)||!gp(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!rf(t,e)||!gp(t.queryParams,e.queryParams);case"paramsChange":default:return!rf(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);u?a.canActivateChecks.push(new Tf(i)):(s.data=o.data,s._resolvedData=o._resolvedData),t(e,n,s.component?l?l.children:null:r,i,a),u&&a.canDeactivateChecks.push(new Rf(l&&l.outlet&&l.outlet.component||null,o))}else o&&Of(n,l,a),a.canActivateChecks.push(new Tf(i)),t(e,null,s.component?l?l.children:null:r,i,a)}(e,s[e.value.outlet],r,i.concat([e.value]),a),delete s[e.value.outlet]}),bp(s,(t,e)=>Of(t,r.getContext(e),a)),a}(r,e?e._root:null,n,[r.value])}function Nf(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function Of(t,e,n){const r=Gp(t),i=t.value;bp(r,(t,r)=>{Of(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new Rf(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}const Pf=Symbol("INITIAL_VALUE");function Ff(){return kd(t=>function(...t){let e=null,n=null;return ot(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&q(t[0])&&(t=t[0]),It(t,n).lift(new Zh(e))}(...t.map(t=>t.pipe(xd(1),Rd(Pf)))).pipe(Md((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==Pf)return t;if(r===Pf&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||_f(r))return r}return t},t)},Pf),rd(t=>t!==Pf),yt(t=>_f(t)?t:!0===t),xd(1)))}function Lf(t,e){return null!==t&&e&&e(new rp(t)),Gh(!0)}function zf(t,e){return null!==t&&e&&e(new ep(t)),Gh(!0)}function $f(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Gh(r.map(r=>ed(()=>{const i=Nf(r,e,n);let a;if(function(t){return t&&vf(t.canActivate)}(i))a=xp(i.canActivate(e,t));else{if(!vf(i))throw new Error("Invalid CanActivate guard");a=xp(i(e,t))}return a.pipe(Cd())}))).pipe(Ff()):Gh(!0)}function Bf(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>ed(()=>Gh(e.guards.map(i=>{const a=Nf(i,e.node,n);let s;if(function(t){return t&&vf(t.canActivateChild)}(a))s=xp(a.canActivateChild(r,t));else{if(!vf(a))throw new Error("Invalid CanActivateChild guard");s=xp(a(r,t))}return s.pipe(Cd())})).pipe(Ff())));return Gh(i).pipe(Ff())}class Wf{}class qf{constructor(t,e,n,r,i,a){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=a}recognize(){try{const t=jf(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),n=new Yp([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Hp(n,e),i=new Qp(this.url,r);return this.inheritParamsAndData(i._root),Gh(i)}catch(t){return new tt(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,n=Zp(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=kp(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};t.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(n),n.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const a of t)try{return this.processSegmentAgainstRoute(a,e,n,r)}catch(i){if(!(i instanceof Wf))throw i}if(this.noLeftoversInUrl(e,n,r))return[];throw new Wf}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new Wf;if((t.outlet||"primary")!==r)throw new Wf;let i,a=[],s=[];if("**"===t.path){const a=n.length>0?_p(n).parameters:{};i=new Yp(n,a,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Jf(t),r,t.component,t,Vf(e),Uf(e)+n.length,Xf(t))}else{const o=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new Wf;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||cp)(n,t,e);if(!r)throw new Wf;const i={};bp(r.posParams,(t,e)=>{i[e]=t.path});const a=r.consumed.length>0?Object.assign(Object.assign({},i),r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:a}}(e,t,n);a=o.consumedSegments,s=n.slice(o.lastChild),i=new Yp(a,o.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Jf(t),r,t.component,t,Vf(e),Uf(e)+a.length,Xf(t))}const o=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:u}=jf(e,a,s,o,this.relativeLinkResolution);if(0===u.length&&l.hasChildren()){const t=this.processChildren(o,l);return[new Hp(i,t)]}if(0===o.length&&0===u.length)return[new Hp(i,[])];const c=this.processSegment(o,l,u,"primary");return[new Hp(i,c)]}}function Vf(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Uf(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function jf(t,e,n,r,i){if(n.length>0&&function(t,e,n){return n.some(n=>Hf(t,e,n)&&"primary"!==Gf(n))}(t,n,r)){const i=new Cp(e,function(t,e,n,r){const i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const a of n)if(""===a.path&&"primary"!==Gf(a)){const n=new Cp([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[Gf(a)]=n}return i}(t,e,r,new Cp(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>Hf(t,e,n))}(t,n,r)){const a=new Cp(t.segments,function(t,e,n,r,i,a){const s={};for(const o of r)if(Hf(t,n,o)&&!i[Gf(o)]){const n=new Cp([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===a?t.segments.length:e.length,s[Gf(o)]=n}return Object.assign(Object.assign({},i),s)}(t,e,n,r,t.children,i));return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:n}}const a=new Cp(t.segments,t.children);return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:n}}function Hf(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function Gf(t){return t.outlet||"primary"}function Jf(t){return t.data||{}}function Xf(t){return t.resolve||{}}function Kf(t,e,n,r){const i=Nf(t,e,r);return xp(i.resolve?i.resolve(e,n):i(e,n))}function Zf(t){return function(e){return e.pipe(kd(e=>{const n=t(e);return n?xt(n).pipe(yt(()=>e)):xt([e])}))}}class Yf{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}const Qf=new _e("ROUTES");class tm{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(yt(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new hp(vp(r.injector.get(Qf)).map(mp),r)}))}loadModuleFactory(t){return"string"==typeof t?xt(this.loader.load(t)):xp(t()).pipe(wt(t=>t instanceof Pe?Gh(t):xt(this.compiler.compileModuleAsync(t))))}}class em{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function nm(t){throw t}function rm(t,e,n){return e.parse("/")}function im(t,e){return Gh(null)}let am=(()=>{class t{constructor(t,e,n,r,i,a,s,o){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=o,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new at,this.errorHandler=nm,this.malformedUriErrorHandler=rm,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:im,afterPreactivation:im},this.urlHandlingStrategy=new em,this.routeReuseStrategy=new Yf,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(Oe),this.console=i.get(Wu);const l=i.get(ec);this.isNgZoneEnabled=l instanceof ec,this.resetConfig(o),this.currentUrlTree=new Sp(new Cp([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new tm(a,s,t=>this.triggerEvent(new Qd(t)),t=>this.triggerEvent(new tp(t))),this.routerState=Xp(this.currentUrlTree,this.rootComponentType),this.transitions=new Jh({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(rd(t=>0!==t.id),yt(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),kd(t=>{let n=!1,r=!1;return Gh(t).pipe(Ld(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),kd(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Gh(t).pipe(kd(t=>{const n=this.transitions.getValue();return e.next(new Ud(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?Qh:[t]}),kd(t=>Promise.resolve(t)),(r=this.ngModule.injector,i=this.configLoader,a=this.urlSerializer,s=this.config,function(t){return t.pipe(kd(t=>function(t,e,n,r,i){return new Df(t,e,n,r,i).apply()}(r,i,a,t.extractedUrl,s).pipe(yt(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e})))))}),Ld(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return function(a){return a.pipe(wt(a=>function(t,e,n,r,i="emptyOnly",a="legacy"){return new qf(t,e,n,r,i,a).recognize()}(t,e,a.urlAfterRedirects,n(a.urlAfterRedirects),r,i).pipe(yt(t=>Object.assign(Object.assign({},a),{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),Ld(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),Ld(t=>{const n=new Jd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var r,i,a,s;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:a,extras:s}=t,o=new Ud(n,this.serializeUrl(r),i,a);e.next(o);const l=Xp(r,this.rootComponentType).snapshot;return Gh(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:r,extras:Object.assign(Object.assign({},s),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),Qh}),Zf(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:a,replaceUrl:s}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!a,replaceUrl:!!s})}),Ld(t=>{const e=new Xd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),yt(t=>Object.assign(Object.assign({},t),{guards:Mf(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe(wt(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:s}}=n;return 0===s.length&&0===a.length?Gh(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return xt(t).pipe(wt(t=>function(t,e,n,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?Gh(a.map(a=>{const s=Nf(a,e,i);let o;if(function(t){return t&&vf(t.canDeactivate)}(s))o=xp(s.canDeactivate(t,e,n,r));else{if(!vf(s))throw new Error("Invalid CanDeactivate guard");o=xp(s(t,e,n,r))}return o.pipe(Cd())})).pipe(Ff()):Gh(!0)}(t.component,t.route,n,e,r)),Cd(t=>!0!==t,!0))}(s,r,i,t).pipe(wt(n=>n&&"boolean"==typeof n?function(t,e,n,r){return xt(e).pipe(Pd(e=>xt([zf(e.route.parent,r),Lf(e.route,r),Bf(t,e.path,n),$f(t,e.route,n)]).pipe(nd(),Cd(t=>!0!==t,!0))),Cd(t=>!0!==t,!0))}(r,a,t,e):Gh(n)),yt(t=>Object.assign(Object.assign({},n),{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),Ld(t=>{if(_f(t.guardsResult)){const e=up(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),Ld(t=>{const e=new Kd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),rd(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new Hd(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),Zf(t=>{if(t.guards.canActivateChecks.length)return Gh(t).pipe(Ld(t=>{const e=new Zd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),(e=this.paramsInheritanceStrategy,n=this.ngModule.injector,function(t){return t.pipe(wt(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;return i.length?xt(i).pipe(Pd(t=>function(t,e,n,r){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return Gh({});if(1===i.length){const a=i[0];return Kf(t[a],e,n,r).pipe(yt(t=>({[a]:t})))}const a={};return xt(i).pipe(wt(i=>Kf(t[i],e,n,r).pipe(yt(t=>(a[i]=t,t))))).pipe(yd(),yt(()=>a))}(t._resolve,t,e,r).pipe(yt(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Zp(t,n).resolve),null)))}(t.route,r,e,n)),function(t,e){return arguments.length>=2?function(n){return Y(Md(t,e),od(1),fd(e))(n)}:function(e){return Y(Md((e,n,r)=>t(e,n,r+1)),od(1))(e)}}((t,e)=>t),yt(e=>t)):Gh(t)}))}),Ld(t=>{const e=new Yd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}));var e,n}),Zf(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:a,replaceUrl:s}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!a,replaceUrl:!!s})}),yt(t=>{const e=function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const a=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new Hp(i,a)}{const r=e.retrieve(n.value);if(r){const t=r.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=new Kp(new Jh((i=n.value).url),new Jh(i.params),new Jh(i.queryParams),new Jh(i.fragment),new Jh(i.data),i.outlet,i.component,i),a=n.children.map(n=>t(e,n));return new Hp(r,a)}}var i}(t,e._root,n?n._root:void 0);return new Jp(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),Ld(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(i=this.rootContexts,a=this.routeReuseStrategy,s=t=>this.triggerEvent(t),yt(t=>(new gf(a,t.targetRouterState,t.currentRouterState,s).activate(i),t))),Ld({next(){n=!0},complete(){n=!0}}),Bd(()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new Hd(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null}),vd(n=>{if(r=!0,(i=n)&&i.ngNavigationCancelingError){const r=_f(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new Hd(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),r?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);return this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new Gd(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(a){t.reject(a)}}var i;return Qh}));var i,a,s}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{let e=this.parseUrl(t.url);const n="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout(()=>{this.scheduleNavigation(e,n,r,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){dp(t),this.config=t.map(mp),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:a,queryParamsHandling:s,preserveFragment:o}=e;ti()&&a&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const l=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i;let c=null;if(s)switch(s){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=a?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return sf(e.root,e.root,e,r,i);const a=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new of(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return bp(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new of(n,e,r)}(n);if(a.toRoot())return sf(e.root,new Cp([],{}),e,r,i);const s=function(t,e,n){if(t.isAbsolute)return new lf(e.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new lf(n.snapshot._urlSegment,!0,0);const r=af(t.commands[0])?0:1;return function(t,e,n){let r=t,i=e,a=n;for(;a>i;){if(a-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new lf(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(a,e,t),o=s.processChildren?hf(s.segmentGroup,s.index,a.commands):cf(s.segmentGroup,s.index,a.commands);return sf(s.segmentGroup,o,e,r,i)}(l,this.currentUrlTree,t,c,u)}navigateByUrl(t,e={skipLocationChange:!1}){ti()&&this.isNgZoneEnabled&&!ec.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const n=_f(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(_f(t))return wp(this.currentUrlTree,t,e);const n=this.parseUrl(t);return wp(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new jd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r,i){const a=this.getTransition();if(a&&"imperative"!==e&&"imperative"===a.source&&a.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(a&&"hashchange"==e&&"popstate"===a.source&&a.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(a&&"popstate"==e&&"hashchange"===a.source&&a.rawUrl.toString()===t.toString())return Promise.resolve(!0);let s,o,l;i?(s=i.resolve,o=i.reject,l=i.promise):l=new Promise((t,e)=>{s=t,o=e});const u=++this.navigationId;return this.setTransition({id:u,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:s,reject:o,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(i,"",Object.assign(Object.assign({},r),{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(t){no()},t.\u0275dir=tn({type:t}),t})();class sm{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new om,this.attachRef=null}}class om{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new sm,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}let lm=(()=>{class t{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new cu,this.deactivateEvents=new cu,this.name=r||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new um(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(to(om),to(Vl),to(gl),eo("name"),to(bs))},t.\u0275dir=tn({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class um{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Kp?this.route:t===om?this.childContexts:this.parent.get(t,e)}}class cm{}class hm{preload(t,e){return Gh(null)}}let dm=(()=>{class t{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new tm(e,n,e=>t.triggerEvent(new Qd(e)),e=>t.triggerEvent(new tp(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(rd(t=>t instanceof jd),Pd(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Oe);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return xt(n).pipe(Dt(),yt(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(wt(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(Ae(am),Ae(Sc),Ae(Zu),Ae(Fs),Ae(cm))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),pm=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Ud?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof jd&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof ap&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new ap(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(t){no()},t.\u0275dir=tn({type:t}),t})();const fm=new _e("ROUTER_CONFIGURATION"),mm=new _e("ROUTER_FORROOT_GUARD"),gm=[Jc,{provide:Ep,useClass:Ap},{provide:am,useFactory:function(t,e,n,r,i,a,s,o={},l,u){const c=new am(null,t,e,n,r,i,a,vp(s));if(l&&(c.urlHandlingStrategy=l),u&&(c.routeReuseStrategy=u),o.errorHandler&&(c.errorHandler=o.errorHandler),o.malformedUriErrorHandler&&(c.malformedUriErrorHandler=o.malformedUriErrorHandler),o.enableTracing){const t=Mc();c.events.subscribe(e=>{t.logGroup(`Router Event: ${e.constructor.name}`),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return o.onSameUrlNavigation&&(c.onSameUrlNavigation=o.onSameUrlNavigation),o.paramsInheritanceStrategy&&(c.paramsInheritanceStrategy=o.paramsInheritanceStrategy),o.urlUpdateStrategy&&(c.urlUpdateStrategy=o.urlUpdateStrategy),o.relativeLinkResolution&&(c.relativeLinkResolution=o.relativeLinkResolution),c},deps:[Ep,om,Jc,Fs,Sc,Zu,Qf,fm,[class{},new $t],[class{},new $t]]},om,{provide:Kp,useFactory:function(t){return t.routerState.root},deps:[am]},{provide:Sc,useClass:Ic},dm,hm,class{preload(t,e){return e().pipe(vd(()=>Gh(null)))}},{provide:fm,useValue:{enableTracing:!1}}];function ym(){return new gc("Router",am)}let vm=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[gm,wm(e),{provide:mm,useFactory:xm,deps:[[am,new $t,new Wt]]},{provide:fm,useValue:n||{}},{provide:Vc,useFactory:bm,deps:[Oc,[new zt(jc),new $t],fm]},{provide:pm,useFactory:_m,deps:[am,mh,fm]},{provide:cm,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:hm},{provide:gc,multi:!0,useFactory:ym},[Sm,{provide:Nu,multi:!0,useFactory:Cm,deps:[Sm]},{provide:Im,useFactory:Dm,deps:[Sm]},{provide:Bu,multi:!0,useExisting:Im}]]}}static forChild(e){return{ngModule:t,providers:[wm(e)]}}}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)(Ae(mm,8),Ae(am,8))}}),t})();function _m(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new pm(t,e,n)}function bm(t,e,n={}){return n.useHash?new Gc(t,e):new Hc(t,e)}function xm(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function wm(t){return[{provide:Ls,multi:!0,useValue:t},{provide:Qf,multi:!0,useValue:t}]}let Sm=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new at}appInitializer(){return this.injector.get(Fc,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(am),r=this.injector.get(fm);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=()=>this.initNavigation?Gh(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(fm),n=this.injector.get(dm),r=this.injector.get(pm),i=this.injector.get(am),a=this.injector.get(xc);t===a.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}return t.\u0275fac=function(e){return new(e||t)(Ae(Fs))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();function Cm(t){return t.appInitializer.bind(t)}function Dm(t){return t.bootstrapListener.bind(t)}const Im=new _e("Router Initializer"),km=[[{name:"US",date:"Jan 6 \u2013 12, 2019",hasData:!0,query:"Infinity War",value:37},{name:"CA",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:46},{name:"MX",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:24},{name:"RU",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:37},{name:"DE",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:18},{name:"TR",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:25},{name:"GB",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:23},{name:"FR",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:9},{name:"IT",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:23},{name:"ES",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:22},{name:"UA",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:19},{name:"PL",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:15},{name:"RO",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:34},{name:"IN",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:16},{name:"ID",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:18},{name:"PK",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:25},{name:"JP",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:7},{name:"PH",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:17},{name:"VN",date:"Jan 6 \u2013 12, 2019",hasData:!0,value:12}],[{name:"US",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:30},{name:"CA",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:30},{name:"MX",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:27},{name:"RU",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:38},{name:"DE",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:16},{name:"TR",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:29},{name:"GB",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:19},{name:"FR",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:9},{name:"IT",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:16},{name:"ES",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:16},{name:"UA",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:18},{name:"PL",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:16},{name:"RO",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:17},{name:"CN",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:100},{name:"IN",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:15},{name:"ID",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:15},{name:"PK",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:18},{name:"JP",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:19},{name:"PH",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:14},{name:"VN",date:"Jan 13 \u2013 19, 2019",hasData:!0,value:8}],[{name:"US",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:23},{name:"CA",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:25},{name:"MX",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:19},{name:"RU",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:34},{name:"DE",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:14},{name:"TR",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:26},{name:"GB",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:17},{name:"FR",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:9},{name:"IT",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:14},{name:"ES",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:19},{name:"UA",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:35},{name:"PL",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:11},{name:"RO",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:22},{name:"IN",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:15},{name:"ID",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:15},{name:"PK",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:29},{name:"JP",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:13},{name:"PH",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:13},{name:"VN",date:"Jan 20 \u2013 26, 2019",hasData:!0,value:8}],[{name:"US",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:21},{name:"CA",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:20},{name:"MX",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:21},{name:"RU",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:22},{name:"DE",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:15},{name:"TR",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:27},{name:"GB",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:13},{name:"FR",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:7},{name:"IT",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:11},{name:"ES",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:14},{name:"UA",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:53},{name:"PL",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:12},{name:"RO",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:18},{name:"IN",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:14},{name:"ID",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:16},{name:"PK",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:24},{name:"JP",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:11},{name:"PH",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:10},{name:"VN",date:"Jan 27 \u2013 Feb 2, 2019",hasData:!0,value:12}],[{name:"US",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:21},{name:"CA",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:21},{name:"MX",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:20},{name:"RU",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:17},{name:"DE",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:16},{name:"TR",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:20},{name:"GB",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:14},{name:"FR",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:7},{name:"IT",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:13},{name:"ES",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:16},{name:"UA",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:17},{name:"PL",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:10},{name:"RO",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:25},{name:"CN",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:77},{name:"IN",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:13},{name:"ID",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:16},{name:"PK",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:24},{name:"JP",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:20},{name:"PH",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:12},{name:"VN",date:"Feb 3 \u2013 9, 2019",hasData:!0,value:14}],[{name:"US",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:18},{name:"CA",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:17},{name:"MX",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:17},{name:"RU",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:20},{name:"DE",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:14},{name:"TR",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:16},{name:"GB",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:13},{name:"FR",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:8},{name:"IT",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:10},{name:"ES",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:13},{name:"UA",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:17},{name:"PL",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:9},{name:"RO",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:13},{name:"CN",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:45},{name:"IN",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:13},{name:"ID",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:14},{name:"PK",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:21},{name:"JP",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:9},{name:"PH",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:9},{name:"VN",date:"Feb 10 \u2013 16, 2019",hasData:!0,value:8}],[{name:"US",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:17},{name:"CA",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:18},{name:"MX",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:17},{name:"RU",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:21},{name:"DE",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:13},{name:"TR",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:16},{name:"GB",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:14},{name:"FR",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:5},{name:"IT",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:8},{name:"ES",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:13},{name:"UA",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:43},{name:"PL",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:14},{name:"RO",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:18},{name:"CN",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:35},{name:"IN",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:13},{name:"ID",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:10},{name:"PK",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:19},{name:"JP",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:12},{name:"PH",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:9},{name:"VN",date:"Feb 17 \u2013 23, 2019",hasData:!0,value:10}],[{name:"US",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:18},{name:"CA",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:16},{name:"MX",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:20},{name:"RU",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:34},{name:"DE",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:14},{name:"TR",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:18},{name:"GB",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:13},{name:"FR",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:8},{name:"IT",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:9},{name:"ES",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:16},{name:"UA",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:34},{name:"PL",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:8},{name:"RO",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:14},{name:"IN",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:13},{name:"ID",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:12},{name:"PK",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:19},{name:"JP",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:16},{name:"PH",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:9},{name:"VN",date:"Feb 24 \u2013 Mar 2, 2019",hasData:!0,value:5}],[{name:"US",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:21},{name:"CA",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:20},{name:"MX",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:19},{name:"RU",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:24},{name:"DE",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:20},{name:"TR",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:16},{name:"GB",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:13},{name:"FR",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:10},{name:"IT",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:13},{name:"ES",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:17},{name:"UA",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:19},{name:"PL",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:12},{name:"RO",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:14},{name:"IN",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:18},{name:"ID",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:29},{name:"PK",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:24},{name:"JP",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:10},{name:"PH",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:11},{name:"VN",date:"Mar 3 \u2013 9, 2019",hasData:!0,value:13}],[{name:"US",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:31},{name:"CA",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:34},{name:"MX",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:34},{name:"RU",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:23},{name:"DE",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:24},{name:"TR",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:30},{name:"GB",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:24},{name:"FR",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:15},{name:"IT",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:17},{name:"ES",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:26},{name:"UA",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:36},{name:"PL",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:15},{name:"RO",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:20},{name:"CN",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:32},{name:"IN",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:27},{name:"ID",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:32},{name:"PK",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:24},{name:"JP",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:23},{name:"PH",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:18},{name:"VN",date:"Mar 10 \u2013 16, 2019",hasData:!0,value:17}],[{name:"US",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:26},{name:"CA",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:28},{name:"MX",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:40},{name:"RU",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:35},{name:"DE",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:20},{name:"TR",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:27},{name:"GB",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:22},{name:"FR",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:15},{name:"IT",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:15},{name:"ES",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:30},{name:"UA",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:36},{name:"PL",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:16},{name:"RO",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:17},{name:"CN",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:31},{name:"IN",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:30},{name:"ID",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:28},{name:"PK",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:24},{name:"JP",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:22},{name:"PH",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:16},{name:"VN",date:"Mar 17 \u2013 23, 2019",hasData:!0,value:14}],[{name:"US",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:29},{name:"CA",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:28},{name:"MX",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:36},{name:"RU",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:54},{name:"DE",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:19},{name:"TR",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:22},{name:"GB",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:25},{name:"FR",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:13},{name:"IT",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:13},{name:"ES",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:25},{name:"UA",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:28},{name:"PL",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:17},{name:"RO",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:7},{name:"CN",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:31},{name:"IN",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:30},{name:"ID",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:25},{name:"PK",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:29},{name:"JP",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:12},{name:"PH",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:17},{name:"VN",date:"Mar 24 \u2013 30, 2019",hasData:!0,value:14}],[{name:"US",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:32},{name:"CA",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:30},{name:"MX",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:45},{name:"RU",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:30},{name:"DE",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:23},{name:"TR",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:27},{name:"GB",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:28},{name:"FR",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:17},{name:"IT",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:19},{name:"ES",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:27},{name:"UA",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:19},{name:"PL",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:20},{name:"RO",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:22},{name:"CN",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:35},{name:"IN",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:29},{name:"ID",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:24},{name:"PK",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:40},{name:"JP",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:28},{name:"PH",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:20},{name:"VN",date:"Mar 31 \u2013 Apr 6, 2019",hasData:!0,value:12}],[{name:"US",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:28},{name:"CA",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:29},{name:"MX",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:41},{name:"RU",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:24},{name:"DE",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:28},{name:"TR",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:25},{name:"GB",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:25},{name:"FR",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:23},{name:"IT",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:16},{name:"ES",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:25},{name:"UA",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:38},{name:"PL",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:15},{name:"RO",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:20},{name:"CN",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:31},{name:"IN",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:33},{name:"ID",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:18},{name:"PK",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:46},{name:"JP",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:29},{name:"PH",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:23},{name:"VN",date:"Apr 7 \u2013 13, 2019",hasData:!0,value:11}],[{name:"US",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:30},{name:"CA",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:33},{name:"MX",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:51},{name:"RU",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:27},{name:"DE",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:31},{name:"TR",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:35},{name:"GB",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:31},{name:"FR",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:22},{name:"IT",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:22},{name:"ES",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:32},{name:"UA",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:19},{name:"PL",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:17},{name:"RO",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:25},{name:"CN",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:44},{name:"IN",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:39},{name:"ID",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:26},{name:"PK",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:45},{name:"JP",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:26},{name:"PH",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:32},{name:"VN",date:"Apr 14 \u2013 20, 2019",hasData:!0,value:20}],[{name:"US",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:95},{name:"CA",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:84},{name:"MX",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:99},{name:"RU",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:59},{name:"DE",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:100},{name:"TR",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:100},{name:"GB",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:100},{name:"FR",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:100},{name:"IT",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:100},{name:"ES",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:96},{name:"UA",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:71},{name:"PL",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:97},{name:"RO",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:52},{name:"CN",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:40},{name:"IN",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:100},{name:"ID",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:71},{name:"PK",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:79},{name:"JP",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:50},{name:"PH",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:97},{name:"VN",date:"Apr 21 \u2013 27, 2019",hasData:!0,value:40}],[{name:"US",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"CA",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"MX",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"RU",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"DE",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:80},{name:"TR",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:95},{name:"GB",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:80},{name:"FR",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:77},{name:"IT",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:69},{name:"ES",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"UA",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:70},{name:"PL",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"RO",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"CN",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:39},{name:"IN",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:75},{name:"ID",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"PK",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"JP",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"PH",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100},{name:"VN",date:"Apr 28 \u2013 May 4, 2019",hasData:!0,value:100}],[{name:"US",date:"May 5 \u2013 11, 2019",hasData:!0,value:51},{name:"CA",date:"May 5 \u2013 11, 2019",hasData:!0,value:51},{name:"MX",date:"May 5 \u2013 11, 2019",hasData:!0,value:52},{name:"RU",date:"May 5 \u2013 11, 2019",hasData:!0,value:55},{name:"DE",date:"May 5 \u2013 11, 2019",hasData:!0,value:42},{name:"TR",date:"May 5 \u2013 11, 2019",hasData:!0,value:41},{name:"GB",date:"May 5 \u2013 11, 2019",hasData:!0,value:40},{name:"FR",date:"May 5 \u2013 11, 2019",hasData:!0,value:35},{name:"IT",date:"May 5 \u2013 11, 2019",hasData:!0,value:29},{name:"ES",date:"May 5 \u2013 11, 2019",hasData:!0,value:44},{name:"UA",date:"May 5 \u2013 11, 2019",hasData:!0,value:65},{name:"PL",date:"May 5 \u2013 11, 2019",hasData:!0,value:30},{name:"RO",date:"May 5 \u2013 11, 2019",hasData:!0,value:51},{name:"CN",date:"May 5 \u2013 11, 2019",hasData:!0,value:69},{name:"IN",date:"May 5 \u2013 11, 2019",hasData:!0,value:39},{name:"ID",date:"May 5 \u2013 11, 2019",hasData:!0,value:57},{name:"PK",date:"May 5 \u2013 11, 2019",hasData:!0,value:63},{name:"JP",date:"May 5 \u2013 11, 2019",hasData:!0,value:51},{name:"PH",date:"May 5 \u2013 11, 2019",hasData:!0,value:39},{name:"VN",date:"May 5 \u2013 11, 2019",hasData:!0,value:43}],[{name:"US",date:"May 12 \u2013 18, 2019",hasData:!0,value:31},{name:"CA",date:"May 12 \u2013 18, 2019",hasData:!0,value:31},{name:"MX",date:"May 12 \u2013 18, 2019",hasData:!0,value:35},{name:"RU",date:"May 12 \u2013 18, 2019",hasData:!0,value:34},{name:"DE",date:"May 12 \u2013 18, 2019",hasData:!0,value:25},{name:"TR",date:"May 12 \u2013 18, 2019",hasData:!0,value:34},{name:"GB",date:"May 12 \u2013 18, 2019",hasData:!0,value:23},{name:"FR",date:"May 12 \u2013 18, 2019",hasData:!0,value:19},{name:"IT",date:"May 12 \u2013 18, 2019",hasData:!0,value:16},{name:"ES",date:"May 12 \u2013 18, 2019",hasData:!0,value:26},{name:"UA",date:"May 12 \u2013 18, 2019",hasData:!0,value:19},{name:"PL",date:"May 12 \u2013 18, 2019",hasData:!0,value:23},{name:"RO",date:"May 12 \u2013 18, 2019",hasData:!0,value:24},{name:"CN",date:"May 12 \u2013 18, 2019",hasData:!0,value:31},{name:"IN",date:"May 12 \u2013 18, 2019",hasData:!0,value:24},{name:"ID",date:"May 12 \u2013 18, 2019",hasData:!0,value:35},{name:"PK",date:"May 12 \u2013 18, 2019",hasData:!0,value:53},{name:"JP",date:"May 12 \u2013 18, 2019",hasData:!0,value:36},{name:"PH",date:"May 12 \u2013 18, 2019",hasData:!0,value:25},{name:"VN",date:"May 12 \u2013 18, 2019",hasData:!0,value:19}],[{name:"US",date:"May 19 \u2013 25, 2019",hasData:!0,value:21},{name:"CA",date:"May 19 \u2013 25, 2019",hasData:!0,value:23},{name:"MX",date:"May 19 \u2013 25, 2019",hasData:!0,value:25},{name:"RU",date:"May 19 \u2013 25, 2019",hasData:!0,value:33},{name:"DE",date:"May 19 \u2013 25, 2019",hasData:!0,value:21},{name:"TR",date:"May 19 \u2013 25, 2019",hasData:!0,value:28},{name:"GB",date:"May 19 \u2013 25, 2019",hasData:!0,value:15},{name:"FR",date:"May 19 \u2013 25, 2019",hasData:!0,value:10},{name:"IT",date:"May 19 \u2013 25, 2019",hasData:!0,value:12},{name:"ES",date:"May 19 \u2013 25, 2019",hasData:!0,value:16},{name:"UA",date:"May 19 \u2013 25, 2019",hasData:!0,value:38},{name:"PL",date:"May 19 \u2013 25, 2019",hasData:!0,value:17},{name:"RO",date:"May 19 \u2013 25, 2019",hasData:!0,value:19},{name:"CN",date:"May 19 \u2013 25, 2019",hasData:!0,value:31},{name:"IN",date:"May 19 \u2013 25, 2019",hasData:!0,value:19},{name:"ID",date:"May 19 \u2013 25, 2019",hasData:!0,value:19},{name:"PK",date:"May 19 \u2013 25, 2019",hasData:!0,value:27},{name:"JP",date:"May 19 \u2013 25, 2019",hasData:!0,value:17},{name:"PH",date:"May 19 \u2013 25, 2019",hasData:!0,value:17},{name:"VN",date:"May 19 \u2013 25, 2019",hasData:!0,value:13}],[{name:"US",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:18},{name:"CA",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:17},{name:"MX",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:19},{name:"RU",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:22},{name:"DE",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:13},{name:"TR",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:26},{name:"GB",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:14},{name:"FR",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:11},{name:"IT",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:8},{name:"ES",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:15},{name:"UA",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:20},{name:"PL",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:15},{name:"RO",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:13},{name:"IN",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:18},{name:"ID",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:21},{name:"PK",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:24},{name:"JP",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:10},{name:"PH",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:13},{name:"VN",date:"May 26 \u2013 Jun 1, 2019",hasData:!0,value:13}],[{name:"US",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:14},{name:"CA",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:13},{name:"MX",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:17},{name:"RU",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:24},{name:"DE",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:10},{name:"TR",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:31},{name:"GB",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:9},{name:"FR",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:7},{name:"IT",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:8},{name:"ES",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:13},{name:"UA",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:38},{name:"PL",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:13},{name:"RO",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:10},{name:"CN",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:36},{name:"IN",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:13},{name:"ID",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:17},{name:"PK",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:23},{name:"JP",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:22},{name:"PH",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:10},{name:"VN",date:"Jun 2 \u2013 8, 2019",hasData:!0,value:11}],[{name:"US",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:12},{name:"CA",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:11},{name:"MX",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:15},{name:"RU",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:29},{name:"DE",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:10},{name:"TR",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:19},{name:"GB",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:9},{name:"FR",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:8},{name:"IT",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:7},{name:"ES",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:15},{name:"UA",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:30},{name:"PL",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:10},{name:"RO",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:10},{name:"IN",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:11},{name:"ID",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:14},{name:"PK",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:14},{name:"JP",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:16},{name:"PH",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:10},{name:"VN",date:"Jun 9 \u2013 15, 2019",hasData:!0,value:9}],[{name:"US",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:11},{name:"CA",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:11},{name:"MX",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:13},{name:"RU",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:29},{name:"DE",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:8},{name:"TR",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:17},{name:"GB",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:7},{name:"FR",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:6},{name:"IT",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:7},{name:"ES",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:13},{name:"UA",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:20},{name:"PL",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:8},{name:"RO",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:11},{name:"CN",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:31},{name:"IN",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:10},{name:"ID",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:11},{name:"PK",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:15},{name:"JP",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:15},{name:"PH",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:6},{name:"VN",date:"Jun 16 \u2013 22, 2019",hasData:!0,value:6}],[{name:"US",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:11},{name:"CA",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:12},{name:"MX",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:15},{name:"RU",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:34},{name:"DE",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:6},{name:"TR",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:13},{name:"GB",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:8},{name:"FR",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:6},{name:"IT",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:6},{name:"ES",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:12},{name:"UA",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:70},{name:"PL",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:13},{name:"RO",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:8},{name:"IN",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:8},{name:"ID",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:10},{name:"PK",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:15},{name:"JP",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:14},{name:"PH",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:7},{name:"VN",date:"Jun 23 \u2013 29, 2019",hasData:!0,value:7}],[{name:"US",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:12},{name:"CA",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:12},{name:"MX",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:11},{name:"RU",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:33},{name:"DE",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:8},{name:"TR",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:15},{name:"GB",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:7},{name:"FR",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:6},{name:"IT",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:5},{name:"ES",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:13},{name:"UA",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:30},{name:"PL",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:6},{name:"RO",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:8},{name:"CN",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:32},{name:"IN",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:7},{name:"ID",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:12},{name:"PK",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:20},{name:"JP",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:8},{name:"PH",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:7},{name:"VN",date:"Jun 30 \u2013 Jul 6, 2019",hasData:!0,value:6}],[{name:"US",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:11},{name:"CA",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:13},{name:"MX",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:14},{name:"RU",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:30},{name:"DE",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:9},{name:"TR",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:16},{name:"GB",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:9},{name:"FR",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:7},{name:"IT",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:7},{name:"ES",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:9},{name:"UA",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:57},{name:"PL",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:9},{name:"RO",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:12},{name:"CN",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:64},{name:"IN",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:7},{name:"ID",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:10},{name:"PK",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:12},{name:"JP",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:13},{name:"PH",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:5},{name:"VN",date:"Jul 7 \u2013 13, 2019",hasData:!0,value:9}],[{name:"US",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:10},{name:"CA",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:11},{name:"MX",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:12},{name:"RU",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:30},{name:"DE",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:10},{name:"TR",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:16},{name:"GB",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:8},{name:"FR",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:6},{name:"IT",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:9},{name:"ES",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:13},{name:"UA",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:49},{name:"PL",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:10},{name:"RO",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:10},{name:"IN",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:9},{name:"ID",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:9},{name:"PK",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:13},{name:"JP",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:5},{name:"PH",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:6},{name:"VN",date:"Jul 14 \u2013 20, 2019",hasData:!0,value:7}],[{name:"US",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:10},{name:"CA",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:10},{name:"MX",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:10},{name:"RU",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:20},{name:"DE",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:11},{name:"TR",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:15},{name:"GB",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:9},{name:"FR",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:6},{name:"IT",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:8},{name:"ES",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:14},{name:"UA",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:96},{name:"PL",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:10},{name:"RO",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:9},{name:"IN",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:8},{name:"ID",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:9},{name:"PK",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:16},{name:"JP",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:15},{name:"PH",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:5},{name:"VN",date:"Jul 21 \u2013 27, 2019",hasData:!0,value:8}],[{name:"US",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:11},{name:"CA",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:10},{name:"MX",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:12},{name:"RU",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:33},{name:"DE",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:9},{name:"TR",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:13},{name:"GB",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:9},{name:"FR",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:8},{name:"IT",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:7},{name:"ES",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:11},{name:"UA",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:58},{name:"PL",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:10},{name:"RO",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:10},{name:"IN",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:9},{name:"ID",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:7},{name:"PK",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:19},{name:"JP",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:14},{name:"PH",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:6},{name:"VN",date:"Jul 28 \u2013 Aug 3, 2019",hasData:!0,value:9}],[{name:"US",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:10},{name:"CA",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:10},{name:"MX",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:13},{name:"RU",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:30},{name:"DE",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:9},{name:"TR",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:14},{name:"GB",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:9},{name:"FR",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:7},{name:"IT",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:7},{name:"ES",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:11},{name:"UA",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:58},{name:"PL",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:8},{name:"RO",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:12},{name:"CN",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:35},{name:"IN",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:8},{name:"ID",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:9},{name:"PK",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:16},{name:"JP",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:15},{name:"PH",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:6},{name:"VN",date:"Aug 4 \u2013 10, 2019",hasData:!0,value:9}],[{name:"US",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:11},{name:"CA",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:13},{name:"MX",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:9},{name:"RU",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:29},{name:"DE",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:10},{name:"TR",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:14},{name:"GB",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:8},{name:"FR",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:5},{name:"IT",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:7},{name:"ES",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:12},{name:"UA",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:19},{name:"PL",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:10},{name:"RO",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:12},{name:"IN",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:8},{name:"ID",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:5},{name:"PK",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:18},{name:"JP",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:8},{name:"PH",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:6},{name:"VN",date:"Aug 11 \u2013 17, 2019",hasData:!0,value:7}],[{name:"US",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:10},{name:"CA",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:13},{name:"MX",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:11},{name:"RU",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:29},{name:"DE",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:11},{name:"TR",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:12},{name:"GB",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:8},{name:"FR",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:7},{name:"IT",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:5},{name:"ES",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:15},{name:"UA",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:30},{name:"PL",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:7},{name:"RO",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:12},{name:"IN",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:7},{name:"ID",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:8},{name:"PK",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:14},{name:"JP",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:13},{name:"PH",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:7},{name:"VN",date:"Aug 18 \u2013 24, 2019",hasData:!0,value:4}],[{name:"US",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:10},{name:"CA",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:9},{name:"MX",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:7},{name:"RU",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:23},{name:"DE",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:8},{name:"TR",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:13},{name:"GB",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:9},{name:"FR",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:7},{name:"IT",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:8},{name:"ES",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:13},{name:"UA",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:100},{name:"PL",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:9},{name:"RO",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:9},{name:"IN",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:6},{name:"ID",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:6},{name:"PK",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:13},{name:"JP",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:15},{name:"PH",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:5},{name:"VN",date:"Aug 25 \u2013 31, 2019",hasData:!0,value:4}],[{name:"US",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:9},{name:"CA",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:7},{name:"MX",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:7},{name:"RU",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:12},{name:"DE",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:13},{name:"TR",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:10},{name:"GB",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:9},{name:"FR",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:5},{name:"IT",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:5},{name:"ES",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:8},{name:"UA",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:28},{name:"PL",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:5},{name:"RO",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:10},{name:"IN",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:7},{name:"ID",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:5},{name:"PK",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:14},{name:"JP",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:17},{name:"PH",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:3},{name:"VN",date:"Sep 1 \u2013 7, 2019",hasData:!0,value:5}],[{name:"US",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:7},{name:"CA",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:6},{name:"MX",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:7},{name:"RU",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:27},{name:"DE",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:9},{name:"TR",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:8},{name:"GB",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:7},{name:"FR",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:4},{name:"IT",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:5},{name:"ES",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:6},{name:"UA",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:45},{name:"PL",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:4},{name:"RO",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:6},{name:"IN",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:7},{name:"ID",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:6},{name:"PK",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:15},{name:"JP",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:10},{name:"PH",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:4},{name:"VN",date:"Sep 8 \u2013 14, 2019",hasData:!0,value:4}],[{name:"US",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:6},{name:"CA",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:7},{name:"MX",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:7},{name:"RU",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:20},{name:"DE",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:7},{name:"TR",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:10},{name:"GB",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:7},{name:"FR",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:3},{name:"IT",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:4},{name:"ES",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:7},{name:"UA",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:53},{name:"PL",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:5},{name:"RO",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:8},{name:"CN",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:33},{name:"IN",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:5},{name:"ID",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:6},{name:"PK",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:10},{name:"JP",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:5},{name:"PH",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:4},{name:"VN",date:"Sep 15 \u2013 21, 2019",hasData:!0,value:3}],[{name:"US",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:6},{name:"CA",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:7},{name:"MX",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:7},{name:"RU",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:18},{name:"DE",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:7},{name:"TR",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:7},{name:"GB",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:6},{name:"FR",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:2},{name:"IT",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:3},{name:"ES",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:5},{name:"UA",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:27},{name:"PL",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:6},{name:"RO",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:5},{name:"IN",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:6},{name:"ID",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:5},{name:"PK",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:10},{name:"JP",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:10},{name:"PH",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:3},{name:"VN",date:"Sep 22 \u2013 28, 2019",hasData:!0,value:3}],[{name:"US",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:6},{name:"CA",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:6},{name:"MX",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:7},{name:"RU",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:22},{name:"DE",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:12},{name:"TR",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:5},{name:"GB",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:5},{name:"FR",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:4},{name:"IT",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:3},{name:"ES",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:6},{name:"UA",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:35},{name:"PL",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:4},{name:"RO",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:9},{name:"IN",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:9},{name:"ID",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:6},{name:"PK",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:9},{name:"JP",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:5},{name:"PH",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:3},{name:"VN",date:"Sep 29 \u2013 Oct 5, 2019",hasData:!0,value:4}],[{name:"US",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:6},{name:"CA",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:6},{name:"MX",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:6},{name:"RU",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:14},{name:"DE",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:6},{name:"TR",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:7},{name:"GB",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:6},{name:"FR",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:3},{name:"IT",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:3},{name:"ES",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:7},{name:"UA",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:44},{name:"PL",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:4},{name:"RO",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:7},{name:"CN",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:36},{name:"IN",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:8},{name:"ID",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:5},{name:"PK",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:11},{name:"JP",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:7},{name:"PH",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:3},{name:"VN",date:"Oct 6 \u2013 12, 2019",hasData:!0,value:4}],[{name:"US",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:6},{name:"CA",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:6},{name:"MX",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:5},{name:"RU",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:34},{name:"DE",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:4},{name:"TR",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:6},{name:"GB",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:5},{name:"FR",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:3},{name:"IT",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:3},{name:"ES",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:6},{name:"UA",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:28},{name:"PL",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:4},{name:"RO",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:5},{name:"IN",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:5},{name:"ID",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:4},{name:"PK",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:9},{name:"JP",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:7},{name:"PH",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:2},{name:"VN",date:"Oct 13 \u2013 19, 2019",hasData:!0,value:4}],[{name:"US",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:5},{name:"CA",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:5},{name:"MX",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:5},{name:"RU",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:13},{name:"DE",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:5},{name:"TR",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:7},{name:"GB",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:6},{name:"FR",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:5},{name:"IT",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:4},{name:"ES",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:6},{name:"UA",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:17},{name:"PL",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:3},{name:"RO",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:4},{name:"IN",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:5},{name:"ID",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:4},{name:"PK",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:9},{name:"JP",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:12},{name:"PH",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:4},{name:"VN",date:"Oct 20 \u2013 26, 2019",hasData:!0,value:2}],[{name:"US",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:5},{name:"CA",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:7},{name:"MX",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:5},{name:"RU",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:18},{name:"DE",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:6},{name:"TR",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:8},{name:"GB",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:5},{name:"FR",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:3},{name:"IT",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:3},{name:"ES",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:6},{name:"UA",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:17},{name:"PL",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:4},{name:"RO",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:5},{name:"CN",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:35},{name:"IN",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:5},{name:"ID",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:3},{name:"PK",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:4},{name:"PH",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:2},{name:"VN",date:"Oct 27 \u2013 Nov 2, 2019",hasData:!0,value:2}],[{name:"US",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:5},{name:"CA",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:4},{name:"MX",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:6},{name:"RU",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:14},{name:"DE",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:4},{name:"TR",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:7},{name:"GB",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:4},{name:"FR",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:2},{name:"IT",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:3},{name:"ES",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:5},{name:"UA",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:33},{name:"PL",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:4},{name:"RO",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:6},{name:"CN",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:35},{name:"IN",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:4},{name:"ID",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:3},{name:"PK",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:11},{name:"JP",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:5},{name:"PH",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:4},{name:"VN",date:"Nov 3 \u2013 9, 2019",hasData:!0,value:2}],[{name:"US",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:6},{name:"CA",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:5},{name:"MX",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:5},{name:"RU",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:22},{name:"DE",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:6},{name:"TR",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:7},{name:"GB",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:4},{name:"FR",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:3},{name:"IT",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:3},{name:"ES",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:5},{name:"UA",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:34},{name:"PL",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:6},{name:"RO",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:6},{name:"CN",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:34},{name:"IN",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:5},{name:"ID",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:3},{name:"PK",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:6},{name:"JP",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:12},{name:"PH",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:3},{name:"VN",date:"Nov 10 \u2013 16, 2019",hasData:!0,value:3}],[{name:"US",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:8},{name:"CA",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:5},{name:"MX",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:6},{name:"RU",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:14},{name:"DE",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:5},{name:"TR",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:6},{name:"GB",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:4},{name:"FR",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:4},{name:"IT",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:2},{name:"ES",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:7},{name:"UA",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:41},{name:"PL",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:3},{name:"RO",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:4},{name:"IN",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:4},{name:"ID",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:3},{name:"PK",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:7},{name:"JP",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:7},{name:"PH",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:4},{name:"VN",date:"Nov 17 \u2013 23, 2019",hasData:!0,value:2}],[{name:"US",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:7},{name:"CA",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:4},{name:"MX",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:5},{name:"RU",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:17},{name:"DE",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:4},{name:"TR",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:5},{name:"GB",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:5},{name:"FR",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:3},{name:"IT",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:3},{name:"ES",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:6},{name:"UA",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:16},{name:"PL",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:2},{name:"RO",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:4},{name:"CN",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:35},{name:"IN",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:4},{name:"ID",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:3},{name:"PK",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:7},{name:"JP",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:15},{name:"PH",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:2},{name:"VN",date:"Nov 24 \u2013 30, 2019",hasData:!0,value:4}],[{name:"US",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:7},{name:"CA",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:5},{name:"MX",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:5},{name:"DE",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:7},{name:"TR",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:4},{name:"GB",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:4},{name:"FR",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:2},{name:"IT",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:3},{name:"ES",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:4},{name:"PL",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:6},{name:"RO",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:6},{name:"IN",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:4},{name:"ID",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:4},{name:"PK",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:3},{name:"JP",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:5},{name:"PH",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:4},{name:"VN",date:"Dec 1 \u2013 7, 2019",hasData:!0,value:4}],[{name:"US",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:6},{name:"CA",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:6},{name:"MX",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:4},{name:"RU",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:17},{name:"DE",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:5},{name:"TR",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:5},{name:"GB",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:5},{name:"FR",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:2},{name:"IT",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:3},{name:"ES",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:6},{name:"UA",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:32},{name:"PL",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:5},{name:"RO",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:6},{name:"IN",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:3},{name:"ID",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:4},{name:"PK",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:9},{name:"JP",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:5},{name:"PH",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:4},{name:"VN",date:"Dec 8 \u2013 14, 2019",hasData:!0,value:5}],[{name:"US",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:6},{name:"CA",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:4},{name:"MX",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:5},{name:"RU",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:21},{name:"DE",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:5},{name:"TR",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:5},{name:"GB",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:4},{name:"FR",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:3},{name:"IT",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:3},{name:"ES",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:5},{name:"UA",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:16},{name:"PL",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:4},{name:"RO",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:6},{name:"IN",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:4},{name:"ID",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:5},{name:"PK",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:8},{name:"JP",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:5},{name:"PH",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:3},{name:"VN",date:"Dec 15 \u2013 21, 2019",hasData:!0,value:3}],[{name:"US",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:7},{name:"CA",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:5},{name:"MX",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:7},{name:"RU",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:12},{name:"DE",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:8},{name:"TR",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:4},{name:"GB",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:8},{name:"FR",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:7},{name:"IT",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:5},{name:"ES",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:10},{name:"UA",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:16},{name:"PL",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:12},{name:"RO",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:34},{name:"IN",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:4},{name:"ID",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:5},{name:"PK",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:8},{name:"PH",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:3},{name:"VN",date:"Dec 22 \u2013 28, 2019",hasData:!0,value:3}],[{name:"US",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:7},{name:"CA",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:7},{name:"MX",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:8},{name:"RU",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:31},{name:"DE",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:5},{name:"TR",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:6},{name:"GB",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:8},{name:"FR",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:6},{name:"IT",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:3},{name:"ES",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:10},{name:"UA",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:26},{name:"PL",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:4},{name:"RO",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:12},{name:"CN",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:41},{name:"IN",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:5},{name:"ID",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:5},{name:"PK",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:6},{name:"JP",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:12},{name:"PH",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:4},{name:"VN",date:"Dec 29, 2019 \u2013 Jan 4, 2020",hasData:!0,value:4}]],Em={data:[{name:"US",keyword:"Infinity War",query:"Infinity War",data:[{name:"US",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:38},{name:"US",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:31},{name:"US",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:23},{name:"US",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:21},{name:"US",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:21},{name:"US",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:19},{name:"US",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:17},{name:"US",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:18},{name:"US",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:21},{name:"US",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:31},{name:"US",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:27},{name:"US",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:29},{name:"US",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:32},{name:"US",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:28},{name:"US",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:30},{name:"US",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:95},{name:"US",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"US",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:51},{name:"US",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:32},{name:"US",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:21},{name:"US",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:18},{name:"US",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:14},{name:"US",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:12},{name:"US",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:11},{name:"US",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:12},{name:"US",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:12},{name:"US",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:11},{name:"US",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:10},{name:"US",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:10},{name:"US",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:11},{name:"US",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:10},{name:"US",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:11},{name:"US",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:10},{name:"US",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:9},{name:"US",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:8},{name:"US",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:7},{name:"US",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:7},{name:"US",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:6},{name:"US",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:5},{name:"US",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:6},{name:"US",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:6},{name:"US",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:5},{name:"US",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:6},{name:"US",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:5},{name:"US",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:6},{name:"US",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:8},{name:"US",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:7},{name:"US",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:7},{name:"US",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:6},{name:"US",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:6},{name:"US",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:7},{name:"US",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:7}]},{name:"CA",keyword:"Infinity War",query:"Infinity War",data:[{name:"CA",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:46},{name:"CA",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:30},{name:"CA",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:25},{name:"CA",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:24},{name:"CA",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:22},{name:"CA",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:19},{name:"CA",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:20},{name:"CA",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:17},{name:"CA",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:22},{name:"CA",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:35},{name:"CA",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:29},{name:"CA",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:30},{name:"CA",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:31},{name:"CA",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:30},{name:"CA",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:34},{name:"CA",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:88},{name:"CA",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"CA",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:53},{name:"CA",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:31},{name:"CA",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:22},{name:"CA",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:17},{name:"CA",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:13},{name:"CA",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:12},{name:"CA",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:11},{name:"CA",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:10},{name:"CA",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:13},{name:"CA",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:14},{name:"CA",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:12},{name:"CA",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:11},{name:"CA",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:11},{name:"CA",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:10},{name:"CA",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:13},{name:"CA",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:12},{name:"CA",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:10},{name:"CA",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:8},{name:"CA",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:6},{name:"CA",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:7},{name:"CA",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:6},{name:"CA",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:5},{name:"CA",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:6},{name:"CA",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:7},{name:"CA",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:6},{name:"CA",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:7},{name:"CA",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:5},{name:"CA",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:6},{name:"CA",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:5},{name:"CA",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:5},{name:"CA",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:6},{name:"CA",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"CA",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:5},{name:"CA",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:6},{name:"CA",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:7}]},{name:"MX",keyword:"Infinity War",query:"Infinity War",data:[{name:"MX",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:25},{name:"MX",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:27},{name:"MX",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:20},{name:"MX",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:18},{name:"MX",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:22},{name:"MX",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:17},{name:"MX",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:18},{name:"MX",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:20},{name:"MX",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:19},{name:"MX",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:32},{name:"MX",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:40},{name:"MX",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:34},{name:"MX",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:45},{name:"MX",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:43},{name:"MX",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:50},{name:"MX",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"MX",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:96},{name:"MX",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:51},{name:"MX",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:35},{name:"MX",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:23},{name:"MX",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:18},{name:"MX",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:16},{name:"MX",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:16},{name:"MX",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:14},{name:"MX",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:15},{name:"MX",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:11},{name:"MX",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:14},{name:"MX",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:12},{name:"MX",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:11},{name:"MX",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:12},{name:"MX",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:13},{name:"MX",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:11},{name:"MX",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:11},{name:"MX",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:7},{name:"MX",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:7},{name:"MX",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:7},{name:"MX",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:7},{name:"MX",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:8},{name:"MX",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:7},{name:"MX",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:6},{name:"MX",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:4},{name:"MX",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:4},{name:"MX",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:5},{name:"MX",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:6},{name:"MX",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:8}]},{name:"RU",keyword:"Infinity War",query:"Infinity War",data:[{name:"RU",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:42},{name:"RU",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:40},{name:"RU",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:17},{name:"RU",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:16},{name:"RU",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:24},{name:"RU",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:12},{name:"RU",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:21},{name:"RU",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:27},{name:"RU",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:41},{name:"RU",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:39},{name:"RU",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:42},{name:"RU",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:41},{name:"RU",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:32},{name:"RU",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:26},{name:"RU",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:29},{name:"RU",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:57},{name:"RU",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"RU",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:60},{name:"RU",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:36},{name:"RU",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:21},{name:"RU",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:18},{name:"RU",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:28},{name:"RU",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:25},{name:"RU",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:31},{name:"RU",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:47},{name:"RU",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:35},{name:"RU",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:32},{name:"RU",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:32},{name:"RU",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:23},{name:"RU",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:61},{name:"RU",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:42},{name:"RU",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:35},{name:"RU",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:29},{name:"RU",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:13},{name:"RU",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:15},{name:"RU",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:23},{name:"RU",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:14},{name:"RU",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:25},{name:"RU",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:20},{name:"RU",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:17},{name:"RU",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:12},{name:"RU",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:42},{name:"RU",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:17},{name:"RU",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:13},{name:"RU",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:19},{name:"RU",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:11},{name:"RU",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:16},{name:"RU",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:16},{name:"RU",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:8},{name:"RU",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:25},{name:"RU",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:14},{name:"RU",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:15}]},{name:"DE",keyword:"Infinity War",query:"Infinity War",data:[{name:"DE",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:19},{name:"DE",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:17},{name:"DE",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:13},{name:"DE",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:13},{name:"DE",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:15},{name:"DE",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:13},{name:"DE",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:14},{name:"DE",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:14},{name:"DE",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:20},{name:"DE",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:26},{name:"DE",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:19},{name:"DE",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:20},{name:"DE",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:26},{name:"DE",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:31},{name:"DE",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:36},{name:"DE",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"DE",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:87},{name:"DE",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:47},{name:"DE",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:28},{name:"DE",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:24},{name:"DE",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:13},{name:"DE",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:10},{name:"DE",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:11},{name:"DE",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:8},{name:"DE",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:5},{name:"DE",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:9},{name:"DE",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:9},{name:"DE",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:10},{name:"DE",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:12},{name:"DE",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:9},{name:"DE",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:8},{name:"DE",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:11},{name:"DE",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:11},{name:"DE",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:10},{name:"DE",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:13},{name:"DE",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:10},{name:"DE",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:8},{name:"DE",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:8},{name:"DE",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:12},{name:"DE",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:6},{name:"DE",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:5},{name:"DE",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:6},{name:"DE",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:6},{name:"DE",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:4},{name:"DE",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:5},{name:"DE",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:5},{name:"DE",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:6},{name:"DE",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:7},{name:"DE",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"DE",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:4},{name:"DE",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:8},{name:"DE",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:5}]},{name:"TR",keyword:"Infinity War",query:"Infinity War",data:[{name:"TR",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:30},{name:"TR",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:33},{name:"TR",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:29},{name:"TR",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:29},{name:"TR",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:23},{name:"TR",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:21},{name:"TR",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:15},{name:"TR",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:18},{name:"TR",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:22},{name:"TR",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:31},{name:"TR",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:29},{name:"TR",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:30},{name:"TR",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:26},{name:"TR",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:28},{name:"TR",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:38},{name:"TR",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"TR",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:98},{name:"TR",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:43},{name:"TR",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:35},{name:"TR",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:27},{name:"TR",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:29},{name:"TR",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:27},{name:"TR",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:26},{name:"TR",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:16},{name:"TR",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:15},{name:"TR",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:16},{name:"TR",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:18},{name:"TR",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:13},{name:"TR",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:15},{name:"TR",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:16},{name:"TR",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:14},{name:"TR",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:16},{name:"TR",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:12},{name:"TR",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:14},{name:"TR",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:14},{name:"TR",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:9},{name:"TR",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:10},{name:"TR",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:9},{name:"TR",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:8},{name:"TR",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:8},{name:"TR",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:8},{name:"TR",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:7},{name:"TR",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:7},{name:"TR",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:10},{name:"TR",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:6},{name:"TR",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:9},{name:"TR",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:6},{name:"TR",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:5},{name:"TR",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:6},{name:"TR",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:6},{name:"TR",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:5},{name:"TR",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:9}]},{name:"GB",keyword:"Infinity War",query:"Infinity War",data:[{name:"GB",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:22},{name:"GB",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:19},{name:"GB",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:17},{name:"GB",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:13},{name:"GB",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:13},{name:"GB",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:13},{name:"GB",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:13},{name:"GB",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:13},{name:"GB",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:14},{name:"GB",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:24},{name:"GB",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:22},{name:"GB",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:24},{name:"GB",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:27},{name:"GB",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:25},{name:"GB",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:31},{name:"GB",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"GB",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:79},{name:"GB",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:40},{name:"GB",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:23},{name:"GB",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:14},{name:"GB",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:13},{name:"GB",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:9},{name:"GB",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:10},{name:"GB",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:7},{name:"GB",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:9},{name:"GB",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:6},{name:"GB",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:7},{name:"GB",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:9},{name:"GB",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:6},{name:"GB",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:6},{name:"GB",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:5},{name:"GB",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:5},{name:"GB",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:6},{name:"GB",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:5},{name:"GB",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"GB",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:4},{name:"GB",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:8},{name:"GB",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:8}]},{name:"FR",keyword:"Infinity War",query:"Infinity War",data:[{name:"FR",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:9},{name:"FR",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:9},{name:"FR",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:7},{name:"FR",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:7},{name:"FR",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:7},{name:"FR",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:5},{name:"FR",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:7},{name:"FR",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:11},{name:"FR",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:14},{name:"FR",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:14},{name:"FR",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:11},{name:"FR",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:18},{name:"FR",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:18},{name:"FR",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:21},{name:"FR",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"FR",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:74},{name:"FR",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:33},{name:"FR",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:19},{name:"FR",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:11},{name:"FR",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:8},{name:"FR",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:5},{name:"FR",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:7},{name:"FR",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:7},{name:"FR",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:8},{name:"FR",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:8},{name:"FR",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:6},{name:"FR",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:5},{name:"FR",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:4},{name:"FR",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:4},{name:"FR",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:3},{name:"FR",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:4},{name:"FR",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:3},{name:"FR",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:3},{name:"FR",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:5},{name:"FR",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:3},{name:"FR",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:2},{name:"FR",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:2},{name:"FR",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:4},{name:"FR",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:3},{name:"FR",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:2},{name:"FR",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:3},{name:"FR",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:3},{name:"FR",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:8},{name:"FR",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:4}]},{name:"IT",keyword:"Infinity War",query:"Infinity War",data:[{name:"IT",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:21},{name:"IT",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:15},{name:"IT",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:12},{name:"IT",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:12},{name:"IT",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:12},{name:"IT",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IT",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IT",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:12},{name:"IT",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:17},{name:"IT",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:16},{name:"IT",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:14},{name:"IT",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:18},{name:"IT",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:17},{name:"IT",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:22},{name:"IT",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"IT",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:66},{name:"IT",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:27},{name:"IT",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:16},{name:"IT",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:11},{name:"IT",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:6},{name:"IT",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:6},{name:"IT",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:6},{name:"IT",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IT",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IT",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:6},{name:"IT",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IT",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IT",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:6},{name:"IT",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IT",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IT",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IT",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:2},{name:"IT",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:3},{name:"IT",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IT",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:3}]},{name:"ES",keyword:"Infinity War",query:"Infinity War",data:[{name:"ES",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:21},{name:"ES",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:17},{name:"ES",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:19},{name:"ES",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ES",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ES",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:14},{name:"ES",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:11},{name:"ES",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ES",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ES",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:25},{name:"ES",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:29},{name:"ES",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:24},{name:"ES",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:24},{name:"ES",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:26},{name:"ES",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:30},{name:"ES",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:93},{name:"ES",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"ES",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:41},{name:"ES",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:25},{name:"ES",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:17},{name:"ES",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:14},{name:"ES",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:12},{name:"ES",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ES",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:14},{name:"ES",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:12},{name:"ES",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:13},{name:"ES",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:10},{name:"ES",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:13},{name:"ES",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:12},{name:"ES",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:12},{name:"ES",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:9},{name:"ES",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:11},{name:"ES",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:14},{name:"ES",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:13},{name:"ES",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:8},{name:"ES",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ES",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:7},{name:"ES",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ES",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ES",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:7},{name:"ES",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ES",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ES",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ES",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ES",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ES",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ES",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ES",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ES",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ES",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ES",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:9},{name:"ES",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:9}]},{name:"UA",keyword:"Infinity War",query:"Infinity War",data:[{name:"UA",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:43},{name:"UA",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:21},{name:"UA",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:26},{name:"UA",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:67},{name:"UA",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:20},{name:"UA",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:33},{name:"UA",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:33},{name:"UA",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:20},{name:"UA",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:21},{name:"UA",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:34},{name:"UA",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:41},{name:"UA",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:42},{name:"UA",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:44},{name:"UA",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:43},{name:"UA",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:43},{name:"UA",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"UA",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:83},{name:"UA",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:56},{name:"UA",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:44},{name:"UA",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:43},{name:"UA",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:44},{name:"UA",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:44},{name:"UA",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:34},{name:"UA",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:31},{name:"UA",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:53},{name:"UA",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:30},{name:"UA",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:66},{name:"UA",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:53},{name:"UA",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:44},{name:"UA",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:88},{name:"UA",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:37},{name:"UA",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:43},{name:"UA",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:45},{name:"UA",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:60},{name:"UA",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:50},{name:"UA",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:62},{name:"UA",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:67},{name:"UA",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:31},{name:"UA",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:40},{name:"UA",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:33},{name:"UA",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:35},{name:"UA",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:20},{name:"UA",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:30},{name:"UA",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:47},{name:"UA",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:38},{name:"UA",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:44},{name:"UA",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:28},{name:"UA",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:28},{name:"UA",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:27},{name:"UA",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:18},{name:"UA",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!1,value:0},{name:"UA",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:20}]},{name:"PL",keyword:"Infinity War",query:"Infinity War",data:[{name:"PL",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:14},{name:"PL",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:12},{name:"PL",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:8},{name:"PL",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PL",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PL",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PL",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:12},{name:"PL",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PL",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:12},{name:"PL",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:16},{name:"PL",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:15},{name:"PL",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:15},{name:"PL",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:20},{name:"PL",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:15},{name:"PL",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:18},{name:"PL",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:87},{name:"PL",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"PL",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:28},{name:"PL",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:23},{name:"PL",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:17},{name:"PL",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:13},{name:"PL",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:12},{name:"PL",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PL",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PL",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PL",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PL",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PL",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PL",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PL",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PL",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PL",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PL",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PL",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:8},{name:"PL",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PL",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PL",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PL",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PL",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PL",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PL",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:2},{name:"PL",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PL",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PL",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PL",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PL",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PL",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PL",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:6},{name:"PL",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PL",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PL",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PL",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:6}]},{name:"RO",keyword:"Infinity War",query:"Infinity War",data:[{name:"RO",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:28},{name:"RO",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:21},{name:"RO",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:24},{name:"RO",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:20},{name:"RO",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:19},{name:"RO",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:16},{name:"RO",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:14},{name:"RO",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:15},{name:"RO",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:14},{name:"RO",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:13},{name:"RO",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:23},{name:"RO",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:11},{name:"RO",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:19},{name:"RO",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:26},{name:"RO",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:26},{name:"RO",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:63},{name:"RO",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"RO",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:43},{name:"RO",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:23},{name:"RO",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:10},{name:"RO",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:19},{name:"RO",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:11},{name:"RO",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:12},{name:"RO",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:12},{name:"RO",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:14},{name:"RO",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:7},{name:"RO",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:16},{name:"RO",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:7},{name:"RO",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:15},{name:"RO",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:16},{name:"RO",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:13},{name:"RO",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:8},{name:"RO",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:6},{name:"RO",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:16},{name:"RO",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:8},{name:"RO",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:8},{name:"RO",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:7},{name:"RO",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:7},{name:"RO",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:8},{name:"RO",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:7},{name:"RO",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:9},{name:"RO",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:7},{name:"RO",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:5},{name:"RO",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:6},{name:"RO",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:8},{name:"RO",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:6},{name:"RO",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:3},{name:"RO",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:6},{name:"RO",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:2},{name:"RO",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:11},{name:"RO",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:33},{name:"RO",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:9}]},{name:"CN",keyword:"Infinity War",query:"Infinity War",data:[{name:"CN",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:76},{name:"CN",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:59},{name:"CN",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:52},{name:"CN",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:53},{name:"CN",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:52},{name:"CN",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:49},{name:"CN",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"CN",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:50},{name:"CN",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:52},{name:"CN",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:60},{name:"CN",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:53},{name:"CN",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:54},{name:"CN",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:53},{name:"CN",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:59},{name:"CN",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:61},{name:"CN",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:59},{name:"CN",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:57},{name:"CN",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:58},{name:"CN",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!1,value:0},{name:"CN",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!1,value:0}]},{name:"IN",keyword:"Infinity War",query:"Infinity War",data:[{name:"IN",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:16},{name:"IN",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:15},{name:"IN",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:15},{name:"IN",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:14},{name:"IN",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:14},{name:"IN",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:13},{name:"IN",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:13},{name:"IN",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:13},{name:"IN",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:18},{name:"IN",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:27},{name:"IN",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:29},{name:"IN",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:30},{name:"IN",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:29},{name:"IN",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:32},{name:"IN",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:40},{name:"IN",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:100},{name:"IN",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:76},{name:"IN",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:39},{name:"IN",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:24},{name:"IN",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:19},{name:"IN",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:17},{name:"IN",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:13},{name:"IN",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:11},{name:"IN",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:10},{name:"IN",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IN",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IN",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IN",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IN",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IN",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:9},{name:"IN",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IN",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:8},{name:"IN",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IN",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:6},{name:"IN",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IN",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IN",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IN",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:6},{name:"IN",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:9},{name:"IN",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:7},{name:"IN",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IN",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IN",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IN",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IN",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:5},{name:"IN",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IN",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IN",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IN",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IN",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IN",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:4},{name:"IN",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:4}]},{name:"ID",keyword:"Infinity War",query:"Infinity War",data:[{name:"ID",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:17},{name:"ID",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ID",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ID",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:18},{name:"ID",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:14},{name:"ID",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:15},{name:"ID",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:11},{name:"ID",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:11},{name:"ID",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:28},{name:"ID",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:32},{name:"ID",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:27},{name:"ID",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:25},{name:"ID",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:24},{name:"ID",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:18},{name:"ID",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:27},{name:"ID",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:72},{name:"ID",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"ID",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:60},{name:"ID",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:34},{name:"ID",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:20},{name:"ID",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:23},{name:"ID",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:17},{name:"ID",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:14},{name:"ID",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:11},{name:"ID",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:10},{name:"ID",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:11},{name:"ID",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:11},{name:"ID",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:9},{name:"ID",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:9},{name:"ID",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:8},{name:"ID",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:9},{name:"ID",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ID",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:8},{name:"ID",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ID",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ID",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ID",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:6},{name:"ID",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ID",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ID",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ID",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ID",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ID",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ID",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ID",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ID",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:3},{name:"ID",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:3},{name:"ID",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ID",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:4},{name:"ID",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ID",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:5},{name:"ID",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:6}]},{name:"PK",keyword:"Infinity War",query:"Infinity War",data:[{name:"PK",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:28},{name:"PK",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:21},{name:"PK",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:28},{name:"PK",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:24},{name:"PK",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:25},{name:"PK",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:20},{name:"PK",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:17},{name:"PK",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:20},{name:"PK",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:26},{name:"PK",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:22},{name:"PK",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:28},{name:"PK",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:29},{name:"PK",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:36},{name:"PK",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:50},{name:"PK",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:38},{name:"PK",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:80},{name:"PK",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"PK",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:60},{name:"PK",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:52},{name:"PK",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:31},{name:"PK",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:28},{name:"PK",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:28},{name:"PK",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:19},{name:"PK",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:13},{name:"PK",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:15},{name:"PK",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:19},{name:"PK",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PK",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:14},{name:"PK",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:18},{name:"PK",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:19},{name:"PK",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:14},{name:"PK",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:18},{name:"PK",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:14},{name:"PK",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:14},{name:"PK",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:15},{name:"PK",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:15},{name:"PK",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PK",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PK",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PK",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PK",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:8},{name:"PK",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PK",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PK",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:12},{name:"PK",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:8},{name:"PK",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PK",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PK",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PK",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:12},{name:"PK",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PK",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PK",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:6}]},{name:"JP",keyword:"Infinity War",query:"Infinity War",data:[{name:"JP",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:8},{name:"JP",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:26},{name:"JP",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:15},{name:"JP",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:12},{name:"JP",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:24},{name:"JP",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:12},{name:"JP",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:19},{name:"JP",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:16},{name:"JP",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:14},{name:"JP",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:25},{name:"JP",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:27},{name:"JP",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:11},{name:"JP",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:31},{name:"JP",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:33},{name:"JP",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:27},{name:"JP",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:57},{name:"JP",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"JP",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:61},{name:"JP",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:38},{name:"JP",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:17},{name:"JP",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:9},{name:"JP",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:25},{name:"JP",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:15},{name:"JP",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:16},{name:"JP",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:18},{name:"JP",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:9},{name:"JP",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:16},{name:"JP",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:5},{name:"JP",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:16},{name:"JP",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:15},{name:"JP",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:15},{name:"JP",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:7},{name:"JP",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:11},{name:"JP",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:15},{name:"JP",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:15},{name:"JP",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:11},{name:"JP",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:9},{name:"JP",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:11},{name:"JP",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:5},{name:"JP",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:10},{name:"JP",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:8},{name:"JP",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:22},{name:"JP",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!1,value:0},{name:"JP",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:6},{name:"JP",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:8},{name:"JP",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:7},{name:"JP",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:11},{name:"JP",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:6},{name:"JP",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:5},{name:"JP",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:11},{name:"JP",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:5},{name:"JP",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:13}]},{name:"PH",keyword:"Infinity War",query:"Infinity War",data:[{name:"PH",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:18},{name:"PH",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:14},{name:"PH",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PH",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:8},{name:"PH",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PH",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:8},{name:"PH",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:10},{name:"PH",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:8},{name:"PH",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:11},{name:"PH",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:19},{name:"PH",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:16},{name:"PH",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:18},{name:"PH",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:20},{name:"PH",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:23},{name:"PH",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:34},{name:"PH",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:96},{name:"PH",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"PH",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:39},{name:"PH",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:22},{name:"PH",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:16},{name:"PH",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:13},{name:"PH",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PH",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:9},{name:"PH",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PH",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PH",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:6},{name:"PH",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:6},{name:"PH",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PH",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:6},{name:"PH",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:5},{name:"PH",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PH",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:7},{name:"PH",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:2},{name:"PH",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:3},{name:"PH",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:4},{name:"PH",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:4}]},{name:"VN",keyword:"Infinity War",query:"Infinity War",data:[{name:"VN",date:"Jan 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:8},{name:"VN",date:"Jan 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:9},{name:"VN",date:"Jan 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:7},{name:"VN",date:"Jan 27 \u2013 Feb 2, 2019",query:"Infinity War",hasData:!0,value:12},{name:"VN",date:"Feb 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:14},{name:"VN",date:"Feb 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:8},{name:"VN",date:"Feb 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:8},{name:"VN",date:"Feb 24 \u2013 Mar 2, 2019",query:"Infinity War",hasData:!0,value:7},{name:"VN",date:"Mar 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:12},{name:"VN",date:"Mar 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:17},{name:"VN",date:"Mar 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:12},{name:"VN",date:"Mar 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:9},{name:"VN",date:"Mar 31 \u2013 Apr 6, 2019",query:"Infinity War",hasData:!0,value:10},{name:"VN",date:"Apr 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:12},{name:"VN",date:"Apr 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:17},{name:"VN",date:"Apr 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:48},{name:"VN",date:"Apr 28 \u2013 May 4, 2019",query:"Infinity War",hasData:!0,value:100},{name:"VN",date:"May 5 \u2013 11, 2019",query:"Infinity War",hasData:!0,value:44},{name:"VN",date:"May 12 \u2013 18, 2019",query:"Infinity War",hasData:!0,value:23},{name:"VN",date:"May 19 \u2013 25, 2019",query:"Infinity War",hasData:!0,value:15},{name:"VN",date:"May 26 \u2013 Jun 1, 2019",query:"Infinity War",hasData:!0,value:13},{name:"VN",date:"Jun 2 \u2013 8, 2019",query:"Infinity War",hasData:!0,value:10},{name:"VN",date:"Jun 9 \u2013 15, 2019",query:"Infinity War",hasData:!0,value:10},{name:"VN",date:"Jun 16 \u2013 22, 2019",query:"Infinity War",hasData:!0,value:8},{name:"VN",date:"Jun 23 \u2013 29, 2019",query:"Infinity War",hasData:!0,value:7},{name:"VN",date:"Jun 30 \u2013 Jul 6, 2019",query:"Infinity War",hasData:!0,value:7},{name:"VN",date:"Jul 7 \u2013 13, 2019",query:"Infinity War",hasData:!0,value:10},{name:"VN",date:"Jul 14 \u2013 20, 2019",query:"Infinity War",hasData:!0,value:7},{name:"VN",date:"Jul 21 \u2013 27, 2019",query:"Infinity War",hasData:!0,value:6},{name:"VN",date:"Jul 28 \u2013 Aug 3, 2019",query:"Infinity War",hasData:!0,value:5},{name:"VN",date:"Aug 4 \u2013 10, 2019",query:"Infinity War",hasData:!0,value:6},{name:"VN",date:"Aug 11 \u2013 17, 2019",query:"Infinity War",hasData:!0,value:6},{name:"VN",date:"Aug 18 \u2013 24, 2019",query:"Infinity War",hasData:!0,value:5},{name:"VN",date:"Aug 25 \u2013 31, 2019",query:"Infinity War",hasData:!0,value:5},{name:"VN",date:"Sep 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:3},{name:"VN",date:"Sep 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:4},{name:"VN",date:"Sep 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:3},{name:"VN",date:"Sep 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:3},{name:"VN",date:"Sep 29 \u2013 Oct 5, 2019",query:"Infinity War",hasData:!0,value:3},{name:"VN",date:"Oct 6 \u2013 12, 2019",query:"Infinity War",hasData:!0,value:5},{name:"VN",date:"Oct 13 \u2013 19, 2019",query:"Infinity War",hasData:!0,value:2},{name:"VN",date:"Oct 20 \u2013 26, 2019",query:"Infinity War",hasData:!0,value:4},{name:"VN",date:"Oct 27 \u2013 Nov 2, 2019",query:"Infinity War",hasData:!0,value:3},{name:"VN",date:"Nov 3 \u2013 9, 2019",query:"Infinity War",hasData:!0,value:4},{name:"VN",date:"Nov 10 \u2013 16, 2019",query:"Infinity War",hasData:!0,value:4},{name:"VN",date:"Nov 17 \u2013 23, 2019",query:"Infinity War",hasData:!0,value:3},{name:"VN",date:"Nov 24 \u2013 30, 2019",query:"Infinity War",hasData:!0,value:3},{name:"VN",date:"Dec 1 \u2013 7, 2019",query:"Infinity War",hasData:!0,value:4},{name:"VN",date:"Dec 8 \u2013 14, 2019",query:"Infinity War",hasData:!0,value:2},{name:"VN",date:"Dec 15 \u2013 21, 2019",query:"Infinity War",hasData:!0,value:5},{name:"VN",date:"Dec 22 \u2013 28, 2019",query:"Infinity War",hasData:!0,value:4},{name:"VN",date:"Dec 29, 2019 \u2013 Jan 4, 2020",query:"Infinity War",hasData:!0,value:2}]}]};let Am=(()=>{class t{constructor(){this.originalArray=Em,this._original=new Jh(this.originalArray),this.original=this._original.asObservable(),this.byDateArray=km,this._byDate=new Jh(this.byDateArray),this.byDate=this._byDate.asObservable(),this.sendData=[],this._sentData=new Jh(this.sendData),this.sentData=this._sentData.asObservable(),this.Index=0,this._sliderIndex=new Jh(this.Index),this.sliderIndex=this._sliderIndex.asObservable(),this._Loading=new Jh(this.isLoading),this.Loading=this._Loading.asObservable()}saveOriginal(t){this._original.next(t)}setLoading(t){this._Loading.next(t)}saveByDate(t){this._byDate.next(t)}parseSendData(t){let e=[],n={name:t,series:[]};this._original.value.data.forEach(e=>{if(e.name==t)for(let t=0;t<52;t++)n.series.push({name:t.toString(),date:e.data[t].date,query:e.data[t].query,value:e.data[t].value})}),e.push(n),this._sentData.next(e)}parseCountries(t){let e=[];for(var n=0;n<t.data[0].data.length;n++){let r=[];t.data.forEach(t=>{t.data[n]&&"Global"!=t.data[n].name&&r.push(t.data[n])}),e.push(r)}this._byDate.next(e)}getCountriesData(t){this._sliderIndex.next(t)}ngOnDestroy(){this._byDate.unsubscribe(),this._sliderIndex.unsubscribe(),this._original.unsubscribe(),this._Loading.unsubscribe(),this._sentData.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Tm=n("xexB");class Rm{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&console.warn(`Platform ${this.platformName} has already been set. `+`Overwriting the platform with ${e}.`),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}get(t){return t in this.flags||(this.flags[t]=this.evaluateFlag(t)),this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=function(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("="))),e}(this.global.location.search);"tfjsflags"in t&&t.tfjsflags.split(",").forEach(t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}(e,n)})}}function Mm(){return Om}let Nm,Om=null;function Pm(){if(null==Nm){let t;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}Nm=t}return Nm}function Fm(t,e){const n=function(){const t=Pm();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Lm=Fm("kernelRegistry",()=>new Map),zm=Fm("gradRegistry",()=>new Map);function $m(t,e){const n=Um(t,e);return Lm.get(n)}function Bm(t){return zm.get(t)}function Wm(t){const e=Lm.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[a,s]=i,[o]=a.split("_");o===t&&n.push(s)}return n}function qm(t){const{kernelName:e,backendName:n}=t,r=Um(e,n);Lm.has(r)&&console.warn(`The kernel '${e}' for backend `+`'${n}' is already registered`),Lm.set(r,t)}function Vm(t){const{kernelName:e}=t;zm.has(e)&&console.warn(`Overriding the gradient for '${e}'`),zm.set(e,t)}function Um(t,e){return`${e}_${t}`}function jm(t){let e=t.length,n=0,r=0;for(;e>0;)r=Math.random()*e|0,e--,n=t[e],t[e]=t[r],t[r]=n}function Hm(t,e,n){return Math.max(t,Math.min(e,n))}function Gm(t){return t%2==0?t:t+1}function Jm(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function Xm(t,e){const n=Math.random();return e*n+(1-n)*t}function Km(t,e){let n=0;for(let r=0;r<t.length;r++){const i=Number(t[r])-Number(e[r]);n+=i*i}return n}function Zm(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function Ym(t,e,n=""){Zm(rg(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Qm(t){Zm(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function tg(t,e=[],n=!1){if(null==e&&(e=[]),Array.isArray(t)||vg(t)&&!n)for(let r=0;r<t.length;++r)tg(t[r],e,n);else e.push(t);return e}function eg(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function ng(t){return 0===t.length}function rg(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ig(t){return t%1==0}function ag(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function sg(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function og(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return jm(e),e}function lg(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function ug(t,e=(t=>0),n){return new Promise((r,i)=>{let a=0;const s=()=>{if(t())return void r();a++;const o=e(a);null!=n&&a>=n?i():setTimeout(s,o)};s()})}function cg(t,e){let n=1,r=-1;for(let a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(-1===t[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+`Found -1 at dim ${r} and dim ${a}`);r=a}else if(t[a]<0)throw Error(`Shapes can not be < 0. Found ${t[a]} at dim ${a}`);if(-1===r){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===n)throw Error(`Cannot infer the missing size in [${t}] when `+"there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. "+`Got ${e} / ${n}`);const i=t.slice();return i[r]=e/n,i}function hg(t,e){const n=e.length;return Zm((t=null==t?e.map((t,e)=>e):[].concat(t)).every(t=>t>=-n&&t<n),()=>`All values in axis param must be in range [-${n}, ${n}) but `+`got axis ${t}`),Zm(t.every(t=>ig(t)),()=>"All values in axis param must be integers but "+`got axis ${t}`),t.map(t=>t<0?n+t:t)}function dg(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:hg(e,t).sort();let s=0;for(let o=0;o<t.length;++o){if(null!=a){if(a[s]===o&&1!==t[o])throw new Error(`Can't squeeze axis ${o} since its dim '${t[o]}' is not 1`);(null==a[s]||a[s]>o)&&1===t[o]&&(n.push(t[o]),r.push(o)),a[s]<=o&&s++}1!==t[o]&&(n.push(t[o]),r.push(o))}return{newShape:n,keptDims:r}}function pg(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error(`Unknown data type ${t}`);n=new Uint8Array(e)}return n}function fg(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error(`Unknown data type ${t}`);n=new Array(e)}return n}function mg(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function gg(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function yg(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function vg(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function _g(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error(`Unknown dtype ${t}`)}function bg(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}function xg(t){return"string"==typeof t||t instanceof String}function wg(t){return"boolean"==typeof t}function Sg(t){return"number"==typeof t}function Cg(t){return Array.isArray(t)?Cg(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":Sg(t)?"float32":xg(t)?"string":wg(t)?"bool":"float32"}function Dg(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Ig(t,e){for(let n=e;n<t;++n)if(t%n==0)return n;return t}function kg(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function Eg(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=tg(t)),n&&mg(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error(`Unknown data type ${e}`)}function Ag(t,e){if(0===t.length)return e[0];const n=t.reduce((t,e)=>t*e);if(0===n)return[];if(n!==e.length)throw new Error(`[${t}] does not match the input size.`);return function t(e,n,r){const i=new Array;if(1===n.length){const t=n[0];for(let n=0;n<t;n++)i[n]=r[e+n]}else{const a=n[0],s=n.slice(1),o=s.reduce((t,e)=>t*e);for(let n=0;n<a;n++)i[n]=t(e+n*o,s,r)}return i}(0,t,e)}function Tg(t,e){const n=Rg(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Rg(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function Mg(){return Mm().platform.now()}function Ng(t){t.forEach(e=>{Zm(Number.isInteger(e)&&e>=0,()=>"Tensor must have a shape comprised of positive integers but got "+`shape [${t}].`)})}function Og(t,e){return Mm().platform.fetch(t,e)}function Pg(t,e="utf-8"){return e=e||"utf-8",Mm().platform.encode(t,e)}function Fg(t,e="utf-8"){return e=e||"utf-8",Mm().platform.decode(t,e)}function Lg(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function zg(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}class $g{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new Bg)}profileKernel(t,e,n){let r;const i=this.backendTimer.time(()=>{r=n()});return r.forEach(n=>{n.data().then(r=>{!function(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn(`Found ${e} in the result of '${n}'`),!0}}(r,n.dtype,t),i.then(i=>{let a="";null!=i.getExtraProfileInfo&&(a=i.getExtraProfileInfo()),this.logger.logKernelProfile(t,n,r,i.kernelMs,e,a)})})}),r}}class Bg{logKernelProfile(t,e,n,r,i,a){const s="number"==typeof r?lg(`${r}ms`,9):r.error,o=lg(t,25),l=e.rank,u=e.size,c=lg(e.shape.toString(),14);let h="";for(const d in i){const t=i[d].shape||e.shape,n=t.length;h+=`${d}: ${n}D ${n>0?t:""} `}console.log(`%c${o}\t%c${s}\t%c${l}D ${c}\t%c${u}\t%c${h}\t%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function Wg(t,e,n){let r;return r=Array.isArray(t)?`${parseFloat(t[0].toFixed(7))} + `+`${parseFloat(t[1].toFixed(7))}j`:xg(t)?`'${t}'`:"bool"===n?qg(t):parseFloat(t.toFixed(7)).toString(),lg(r,e)}function qg(t){return 0===t?"false":"true"}function Vg(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}class Ug{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=eg(t),null!=n){const t=n.length;Zm(t===this.size,()=>`Length of values '${t}' does not match the size `+`inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||fg(e,this.size),this.strides=kg(t)}set(t,...e){0===e.length&&(e=[0]),Zm(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must `+`match the rank (${this.rank})`);const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e])throw new Error(`Requested out of range element at ${t}. `+`  Buffer shape=${this.shape}`);e++}let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return jg().makeTensor(this.values,this.shape,this.dtype)}}let jg=null,Hg=null,Gg=null;class Jg{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=eg(t),this.strides=kg(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}flatten(){return this.throwIfDisposed(),this.as1D()}asScalar(){return this.throwIfDisposed(),Zm(1===this.size,()=>"The array must have only 1 element."),this.reshape([])}as1D(){return this.throwIfDisposed(),this.reshape([this.size])}as2D(t,e){return this.throwIfDisposed(),this.reshape([t,e])}as3D(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])}as4D(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])}as5D(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])}asType(t){return this.throwIfDisposed(),Hg.cast(this,t)}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Hg.buffer(this.shape,this.dtype,t)}bufferSync(){return Hg.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Ag(this.shape,t)}arraySync(){return Ag(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=jg().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map(t=>Fg(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=jg().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>Fg(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await jg().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(jg().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}toFloat(){return this.asType("float32")}toInt(){return this.asType("int32")}toBool(){return this.asType("bool")}print(t=!1){return Hg.print(this,t)}reshape(t){return this.throwIfDisposed(),Hg.reshape(this,t)}reshapeAs(t){return this.throwIfDisposed(),this.reshape(t.shape)}expandDims(t=0){return Hg.expandDims(this,t)}cumsum(t=0,e=!1,n=!1){return Hg.cumsum(this,t,e,n)}squeeze(t){return this.throwIfDisposed(),Hg.squeeze(this,t)}clone(){return this.throwIfDisposed(),Hg.clone(this)}toString(t=!1){return function(t,e,n,r){const i=kg(e),a=function(t,e,n,r){const i=eg(e),a=r[r.length-1],s=new Array(a).fill(0),o=e.length,l="complex64"===n?Vg(t):t;if(o>1)for(let u=0;u<i/a;u++){const t=u*a;for(let e=0;e<a;e++)s[e]=Math.max(s[e],Wg(l[t+e],0,n).length)}return s}(t,e,n,i),s=e.length,o=function t(e,n,r,i,a,s=!0){const o="complex64"===r?2:1,l=n[0],u=n.length;if(0===u)return"complex64"===r?[Wg(Vg(e)[0],0,r)]:"bool"===r?[qg(e[0])]:[e[0].toString()];if(1===u){if(l>20){let t=Array.from(e.slice(0,3*o)),n=Array.from(e.slice((l-3)*o,l*o));return"complex64"===r&&(t=Vg(t),n=Vg(n)),["["+t.map((t,e)=>Wg(t,a[e],r)).join(", ")+", ..., "+n.map((t,e)=>Wg(t,a[l-3+e],r)).join(", ")+"]"]}return["["+("complex64"===r?Vg(e):Array.from(e)).map((t,e)=>Wg(t,a[e],r)).join(", ")+"]"]}const c=n.slice(1),h=i.slice(1),d=i[0]*o,p=[];if(l>20){for(let n=0;n<3;n++){const i=n*d;p.push(...t(e.slice(i,i+d),c,r,h,a,!1))}p.push("...");for(let n=l-3;n<l;n++){const i=n*d;p.push(...t(e.slice(i,i+d),c,r,h,a,n===l-1))}}else for(let g=0;g<l;g++){const n=g*d;p.push(...t(e.slice(n,n+d),c,r,h,a,g===l-1))}const f=2===u?",":"";p[0]="["+p[0]+f;for(let g=1;g<p.length-1;g++)p[g]=" "+p[g]+f;let m=",\n";for(let g=2;g<u;g++)m+="\n";return p[p.length-1]=" "+p[p.length-1]+"]"+(s?"":m),p}(t,e,n,i,a),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(t=>"    "+t).join("\n")),l.join("\n")}(this.dataSync(),this.shape,this.dtype,t)}gather(t,e=0){return this.throwIfDisposed(),Hg.gather(this,t,e)}norm(t="euclidean",e=null,n=!1){return this.throwIfDisposed(),Hg.norm(this,t,e,n)}slice(t,e){return this.throwIfDisposed(),Hg.slice(this,t,e)}reverse(t){return this.throwIfDisposed(),Hg.reverse(this,t)}stack(t,e=0){return Hg.stack([this,t],e)}unstack(t=0){return Hg.unstack(this,t)}all(t=null,e=!1){return this.throwIfDisposed(),Hg.all(this,t,e)}any(t=null,e=!1){return this.throwIfDisposed(),Hg.any(this,t,e)}logSumExp(t=null,e=!1){return this.throwIfDisposed(),Hg.logSumExp(this,t,e)}sum(t=null,e=!1){return this.throwIfDisposed(),Hg.sum(this,t,e)}prod(t=null,e=!1){return this.throwIfDisposed(),Hg.prod(this,t,e)}mean(t=null,e=!1){return this.throwIfDisposed(),Hg.mean(this,t,e)}min(t=null,e=!1){return this.throwIfDisposed(),Hg.min(this,t,e)}argMin(t=null){return this.throwIfDisposed(),Hg.argMin(this,t)}argMax(t=null){return this.throwIfDisposed(),Hg.argMax(this,t)}cast(t){return this.throwIfDisposed(),Hg.cast(this,t)}addStrict(t){return this.throwIfDisposed(),Hg.addStrict(this,t)}atan2(t){return this.throwIfDisposed(),Hg.atan2(this,t)}subStrict(t){return this.throwIfDisposed(),Hg.subStrict(this,t)}pow(t){return this.throwIfDisposed(),Hg.pow(this,t)}powStrict(t){return this.throwIfDisposed(),Hg.powStrict(this,t)}mul(t){return this.throwIfDisposed(),Hg.mul(this,t)}mulStrict(t){return this.throwIfDisposed(),Hg.mulStrict(this,t)}floorDiv(t){return this.throwIfDisposed(),Hg.floorDiv(this,t)}divStrict(t){return this.throwIfDisposed(),Hg.divStrict(this,t)}minimum(t){return this.throwIfDisposed(),Hg.minimum(this,t)}minimumStrict(t){return this.throwIfDisposed(),Hg.minimumStrict(this,t)}maximum(t){return this.throwIfDisposed(),Hg.maximum(this,t)}maximumStrict(t){return this.throwIfDisposed(),Hg.maximumStrict(this,t)}mod(t){return this.throwIfDisposed(),Hg.mod(this,t)}modStrict(t){return this.throwIfDisposed(),Hg.modStrict(this,t)}squaredDifferenceStrict(t){return this.throwIfDisposed(),Hg.squaredDifferenceStrict(this,t)}notEqualStrict(t){return this.throwIfDisposed(),Hg.notEqualStrict(this,t)}lessStrict(t){return this.throwIfDisposed(),Hg.lessStrict(this,t)}equalStrict(t){return this.throwIfDisposed(),Hg.equalStrict(this,t)}lessEqualStrict(t){return this.throwIfDisposed(),Hg.lessEqualStrict(this,t)}greaterStrict(t){return this.throwIfDisposed(),Hg.greaterStrict(this,t)}greaterEqualStrict(t){return this.throwIfDisposed(),Hg.greaterEqualStrict(this,t)}logicalAnd(t){return this.throwIfDisposed(),Hg.logicalAnd(this,t)}logicalOr(t){return this.throwIfDisposed(),Hg.logicalOr(this,t)}logicalNot(){return this.throwIfDisposed(),Hg.logicalNot(this)}logicalXor(t){return this.throwIfDisposed(),Hg.logicalXor(this,t)}where(t,e){return this.throwIfDisposed(),Hg.where(t,this,e)}neg(){return this.throwIfDisposed(),Hg.neg(this)}ceil(){return this.throwIfDisposed(),Hg.ceil(this)}floor(){return this.throwIfDisposed(),Hg.floor(this)}sign(){return this.throwIfDisposed(),Hg.sign(this)}isNaN(){return this.throwIfDisposed(),Hg.isNaN(this)}isInf(){return this.throwIfDisposed(),Hg.isInf(this)}isFinite(){return this.throwIfDisposed(),Hg.isFinite(this)}exp(){return this.throwIfDisposed(),Hg.exp(this)}expm1(){return this.throwIfDisposed(),Hg.expm1(this)}log(){return this.throwIfDisposed(),Hg.log(this)}log1p(){return this.throwIfDisposed(),Hg.log1p(this)}sqrt(){return this.throwIfDisposed(),Hg.sqrt(this)}rsqrt(){return this.throwIfDisposed(),Hg.rsqrt(this)}square(){return this.throwIfDisposed(),Hg.square(this)}reciprocal(){return this.throwIfDisposed(),Hg.reciprocal(this)}abs(){return this.throwIfDisposed(),Hg.abs(this)}clipByValue(t,e){return this.throwIfDisposed(),Hg.clipByValue(this,t,e)}relu(){return this.throwIfDisposed(),Hg.relu(this)}relu6(){return this.throwIfDisposed(),Hg.relu6(this)}elu(){return this.throwIfDisposed(),Hg.elu(this)}selu(){return this.throwIfDisposed(),Hg.selu(this)}leakyRelu(t=.2){return this.throwIfDisposed(),Hg.leakyRelu(this,t)}prelu(t){return this.throwIfDisposed(),Hg.prelu(this,t)}sigmoid(){return this.throwIfDisposed(),Hg.sigmoid(this)}logSigmoid(){return this.throwIfDisposed(),Hg.logSigmoid(this)}softplus(){return this.throwIfDisposed(),Hg.softplus(this)}zerosLike(){return this.throwIfDisposed(),Hg.zerosLike(this)}onesLike(){return this.throwIfDisposed(),Hg.onesLike(this)}sin(){return this.throwIfDisposed(),Hg.sin(this)}cos(){return this.throwIfDisposed(),Hg.cos(this)}tan(){return this.throwIfDisposed(),Hg.tan(this)}asin(){return this.throwIfDisposed(),Hg.asin(this)}acos(){return this.throwIfDisposed(),Hg.acos(this)}atan(){return this.throwIfDisposed(),Hg.atan(this)}sinh(){return this.throwIfDisposed(),Hg.sinh(this)}cosh(){return this.throwIfDisposed(),Hg.cosh(this)}tanh(){return this.throwIfDisposed(),Hg.tanh(this)}asinh(){return this.throwIfDisposed(),Hg.asinh(this)}acosh(){return this.throwIfDisposed(),Hg.acosh(this)}atanh(){return this.throwIfDisposed(),Hg.atanh(this)}erf(){return this.throwIfDisposed(),Hg.erf(this)}round(){return this.throwIfDisposed(),Hg.round(this)}step(t=0){return this.throwIfDisposed(),Hg.step(this,t)}softmax(t=-1){return this.throwIfDisposed(),Hg.softmax(this,t)}logSoftmax(t=-1){return this.throwIfDisposed(),Hg.logSoftmax(this,t)}resizeBilinear(t,e=!1){return this.throwIfDisposed(),Hg.image.resizeBilinear(this,t,e)}resizeNearestNeighbor(t,e=!1){return this.throwIfDisposed(),Hg.image.resizeNearestNeighbor(this,t,e)}avgPool(t,e,n,r){return this.throwIfDisposed(),Hg.avgPool(this,t,e,n,r)}maxPool(t,e,n,r){return this.throwIfDisposed(),Hg.maxPool(this,t,e,n,r)}pool(t,e,n,r,i){return this.throwIfDisposed(),Hg.pool(this,t,e,n,r,i)}variable(t=!0,e,n){return this.throwIfDisposed(),jg().makeVariable(this,t,e,n)}unsortedSegmentSum(t,e){return this.throwIfDisposed(),Hg.unsortedSegmentSum(this,t,e)}topk(t=1,e=!0){return this.throwIfDisposed(),Hg.topk(this,t,e)}stridedSlice(t,e,n,r=0,i=0,a=0,s=0,o=0){return this.throwIfDisposed(),Hg.stridedSlice(this,t,e,n,r,i,a,s,o)}fft(){return this.throwIfDisposed(),Hg.spectral.fft(this)}ifft(){return this.throwIfDisposed(),Hg.spectral.ifft(this)}rfft(){return this.throwIfDisposed(),Hg.spectral.rfft(this)}irfft(){return this.throwIfDisposed(),Hg.spectral.irfft(this)}}Object.defineProperty(Jg,Symbol.hasInstance,{value:t=>!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype});class Xg extends Jg{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and `+`previous value (${this.dtype}) must match`);if(!rg(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and `+`previous value (${this.shape}) must match`);jg().disposeTensor(this),this.dataId=t.dataId,jg().incRef(this,null)}dispose(){jg().disposeVariable(this),this.isDisposedInternal=!0}}var Kg,Zg,Yg,Qg,ty;Object.defineProperty(Xg,Symbol.hasInstance,{value:t=>t instanceof Jg&&null!=t.assign&&t.assign instanceof Function}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(Kg||(Kg={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Zg||(Zg={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(Yg||(Yg={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Qg||(Qg={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(ty||(ty={}));const ey={float32:Qg,int32:Zg,bool:Yg,complex64:ty};function ny(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return ey[t][e]}function ry(t){return ny(t,"int32")}function iy(t,e){if(t.dtype===e.dtype)return[t,e];const n=ny(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function ay(t,e){Zm(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and`+` second(${e.dtype}) input must match`)}function sy(t,e){return e.some(e=>e.id===t.id)}function oy(t){const e=[];return function t(e,n,r){if(null==e)return;if(e instanceof Jg)return void n.push(e);if(i=e,!Array.isArray(i)&&"object"!=typeof i)return;var i;const a=e;for(const s in a){const e=a[s];r.has(e)||(r.add(e),t(e,n,r))}}(t,e,new Set),e}class ly{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class uy{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ly}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void(await this.setBackend(n))}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make `+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been `+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(console.warn(`${t} backend was already registered. `+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new $g(this.backendInstance),!0}setupRegisteredKernels(){Wm(this.backendName).forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Wm(t).forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(Promise.resolve(n)===n){const e=++this.pendingBackendInitId,r=n.then(n=>!(e<this.pendingBackendInitId||(this.registry[t]=n,this.pendingBackendInit=null,0))).catch(n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}return this.registry[t]=n,{success:!0,asyncInit:!1}}catch(n){return console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return uy.nextTensorId++}nextVariableId(){return uy.nextVariableId++}clone(t){const e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype);return this.addTapeNode(this.state.activeScope.name,{x:t},[e],t=>({x:()=>t.toFloat()}),[],{}),e}runKernel(t,e,n,r,i){return this.runKernelFunc(null,e,null,t,n,r,i)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach(t=>{i+="complex64"===t.dtype?3:1});const a=r-e-i-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak `+`(${a} data ids) after running '${t}'`)}runKernelFunc(t,e,n,r,i,a,s){let o,l=[];const u=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");const c=this.state.numBytes,h=this.state.numTensors;let d;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const p=$m(r,this.backendName);let f;if(null!=p)d=()=>{const t=this.backend.numDataIds();f=p.kernelFunc({inputs:e,attrs:i,backend:this.backend});const n=Array.isArray(f)?f:[f];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(r,t,n);const o=n.map(({dataId:t,shape:e,dtype:n})=>this.makeTensorFromDataId(t,e,n));if(u){let t=this.getTensorsForGradient(r,e,o);if(null==t){null==s&&(s=[]);const e=o.filter((t,e)=>s[e]);t=(a||[]).slice().concat(e)}l=this.saveTensorsForBackwardMode(t)}return o};else{const e=t=>{u&&(l=t.map(t=>this.keep(this.clone(t))))};d=()=>{const n=this.backend.numDataIds();f=this.tidy(()=>t(this.backend,e));const i=Array.isArray(f)?f:[f];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(r,n,i),i}}return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{o=this.ENV.getBool("DEBUG")?this.profiler.profileKernel(r,e,()=>d()):d()}),u&&this.addTapeNode(r,e,o,n,l,i),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-h,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(t=>e[t].shape),outputShapes:o.map(t=>t.shape)}),Array.isArray(f)?o:o[0]}saveTensorsForBackwardMode(t){return t.map(t=>this.keep(this.clone(t)))}getTensorsForGradient(t,e,n){const r=Bm(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(Zm(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(e).map(t=>e[t])):a=t.map(t=>e[t]);const s=n.filter((t,e)=>i[e]);return a.concat(s)}return null}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");r=r||this.backend;let i=t;"string"===(n=n||"float32")&&xg(t[0])&&(i=t.map(t=>Pg(t)));const a=r.write(i,e,n),s=new Jg(e,n,a,this.nextTensorId());if(this.incRef(s,r),"string"===n){const t=this.state.tensorInfo.get(a),e=bg(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return s}makeTensorFromDataId(t,e,n,r){const i=new Jg(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,r),i}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));const i=new Xg(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}incRef(t,e){const n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*_g(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n,refCount:0}),this.state.numBytes+=n}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Xg||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;const e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}disposeVariables(){for(const t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;return this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,a){const s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},o=Bm(t);null!=o&&(r=o.gradFunc),null!=r&&(s.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=n[e],r=Rg(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t}),r(t.length>1?t:t[0],i,a))),this.state.activeTape.push(s)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=oy(t),n=new Set(e.map(t=>t.id));for(let i=0;i<this.state.activeScope.track.length;i++){const t=this.state.activeScope.track[i];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==r.id||this.track(t)})}gradients(t,e,n,r=!1){if(Zm(e.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));Zm(i instanceof Jg,()=>"The result y returned by f() must be a tensor.");const a=function(t,e,n){const r={},i={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const n=t[l],a=n.inputs;for(const t in a){const s=a[t];let o=!1;for(let t=0;t<e.length;t++)if(r[s.id]){n.outputs.forEach(t=>r[t.id]=!0),o=!0,i[n.id]=!0;break}if(o)break}}const a={};a[n.id]=!0;const s={};for(let l=t.length-1;l>=0;l--){const e=t[l],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(a[e.outputs[t].id]){for(const t in n)a[n[t].id]=!0,s[e.id]=!0;break}}const o=[];for(let l=0;l<t.length;l++){const e=t[l];if(i[e.id]&&s[e.id]){const t={};for(const i in e.inputs){const n=e.inputs[i];r[n.id]&&(t[i]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,o.push(n)}}return o}(this.state.activeTape,e,i);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[i.id]=null==n?function(t){const e=Tg(eg(t),"float32");return cy.makeTensor(e,t,"float32")}(i.shape):n,function(t,e,n){for(let r=e.length-1;r>=0;r--){const i=e[r],a=[];if(i.outputs.forEach(e=>{const n=t[e.id];a.push(null!=n?n:null)}),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+`for ${i.kernelName}.`);const s=i.gradient(a);for(const e in i.inputs){if(!(e in s))throw new Error(`Cannot backprop through input ${e}. `+`Available gradients found: ${Object.keys(s)}.`);const r=n(()=>s[e]());if("float32"!==r.dtype)throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input `+`${e} must have 'float32' dtype, but has '${r.dtype}'`);const a=i.inputs[e];if(!rg(r.shape,a.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input `+`'${e}' has shape '${r.shape}', which does not match `+`the shape of the input '${a.shape}'`);if(null==t[a.id])t[a.id]=r;else{const e=t[a.id];t[a.id]=e.add(r),e.dispose()}}}}(t,a,t=>this.tidy(t));const r=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:i,grads:r}})}customGrad(t){return Zm(Dg(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{let n;Zm(e.every(t=>t instanceof Jg),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const r={};return e.forEach((t,e)=>{r[e]=t}),this.runKernelFunc((r,i)=>(n=t(...e,i),Zm(n.value instanceof Jg,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Zm(Dg(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),r,(t,r)=>{const i=n.gradFunc(t,r),a=Array.isArray(i)?i:[i];Zm(a.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Zm(a.every(t=>t instanceof Jg),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const s={};return a.forEach((t,e)=>{s[e]=()=>t}),s})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=Mg(),n=await this.backend.time(t);return n.wallMs=Mg()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ly;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}uy.nextTensorId=0,uy.nextVariableId=0;const cy=function(){const t=Pm();if(null==t._tfengine){const e=new Rm(t);t._tfengine=new uy(e)}return Om=t._tfengine.ENV,jg=()=>t._tfengine,t._tfengine}();function hy(){if("undefined"!=typeof navigator&&null!=navigator){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function dy(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}const py=Mm();function fy(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=n-1-i,s=t[a]||1;(e[e.length-1-i]||1)>1&&1===s&&r.unshift(a)}return r}function my(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],a=e.length-r-1,s=e[a];(null==i||1===i&&s>1)&&n.unshift(a)}return n}function gy(t,e){const n=[],r=Math.max(t.length,e.length);for(let i=0;i<r;i++){let r=t[t.length-i-1];null==r&&(r=1);let a=e[e.length-i-1];if(null==a&&(a=1),1===r)n.unshift(a);else if(1===a)n.unshift(r);else{if(r!==a)throw Error("Operands could not be broadcast together with shapes "+`${t} and ${e}.`);n.unshift(r)}}return n}py.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),py.registerFlag("IS_BROWSER",()=>dy()),py.registerFlag("IS_NODE",()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node),py.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),py.registerFlag("PROD",()=>!1),py.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>py.getBool("DEBUG")),py.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),py.registerFlag("IS_TEST",()=>!1);const yy={kernelName:"Add",inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=gy(n.shape,r.shape);return{a:()=>{let e=t;const r=my(n.shape,i);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},b:()=>{let e=t;const n=my(r.shape,i);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)}}}};function vy(t,e){let n=t;if(vg(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||vg(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&Mm().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],!Array.isArray(e)&&!vg(e))return void Zm(0===n.length,()=>`Element arr[${r.join("][")}] is a primitive, `+`but should be an array/TypedArray of ${n[0]} elements`);Zm(n.length>0,()=>`Element arr[${r.join("][")}] should be a primitive, `+`but is an array of ${e.length} elements`),Zm(e.length===n[0],()=>`Element arr[${r.join("][")}] should have ${n[0]} `+`elements, but has ${e.length} elements`);const i=n.slice(1);for(let a=0;a<e.length;++a)t(e[a],i,r.concat(a))}(t,r,[]),r}function _y(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error(`Argument '${n}' passed to '${r}' must `+`be ${t} tensor, but got ${e} tensor`)}function by(t,e,n,r="numeric"){if(t instanceof Jg)return _y(r,t.dtype,e,n),t;let i=Cg(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),_y(r,i,e,n),null==t||!vg(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error(`Argument '${e}' passed to '${n}' must be a `+`Tensor or TensorLike, but got '${null==t?"null":t.constructor.name}'`);const a=vy(t,i);vg(t)||Array.isArray(t)||(t=[t]);const s="string"!==i?Eg(t,i,Mm().getBool("DEBUG")):tg(t,[],!0);return cy.makeTensor(s,a,i)}function xy(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a `+"`Tensor[]` or `TensorLike[]`");return t.map((t,r)=>by(t,`${e}[${r}]`,n),r)}function wy(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Sy(t,e,n){const r=t.length+e.length,i=[];let a=0,s=0;for(let o=0;o<r;o++)-1===n.indexOf(o)?i.push(t[a++]):i.push(e[s++]);return i}function Cy(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map(e=>t[e])]}function Dy(t,e){return Sy(t,e.map(t=>1),e)}function Iy(t,e,n){Zm(wy(e,n),()=>`${t} supports only inner-most axes for now. `+`Got axes ${e} and rank-${n} input.`)}function ky(t,e){if(wy(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach(t=>n.push(t)),n}function Ey(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function Ay(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}function Ty(t,e){const n=t[0].length;t.forEach((t,e)=>{Zm(t.length===n,()=>`Error in concat${n}D: rank of tensors[${e}] must be the same `+`as the rank of the rest (${n})`)}),Zm(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((t,i)=>{for(let a=0;a<n;a++)Zm(a===e||t[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${i}] (${t}) `+`does not match the shape of the rest (${r}) `+`along the non-concatenated axis ${i}.`)})}function Ry(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}function My(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+`${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));const i=(...t)=>{cy.startScope(n);try{const e=r(...t);return e instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),cy.endScope(e),e}catch(e){throw cy.endScope(null),e}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}const Ny=My({complex_:function(t,e){const n=by(t,"real","complex"),r=by(e,"imag","complex");return Ym(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, `+"must match in call to tf.complex()."),cy.runKernelFunc(t=>t.complex(n,r),{$real:n,$imag:r})}}),Oy=My({real_:function(t){const e=by(t,"input","real");return cy.runKernelFunc(t=>t.real(e),{$input:e})}}),Py=My({imag_:function(t){const e=by(t,"input","imag");return cy.runKernelFunc(t=>t.imag(e),{$input:e})}});function Fy(t,e,n){return Ly(t,e,vy(t,n),n)}function Ly(t,e,n,r){if(null==r&&(r=Cg(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!vg(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Ng(e);const t=eg(e),r=eg(n);Zm(t===r,()=>`Based on the provided shape, [${e}], the tensor should have `+`${t} values but has ${r}`);for(let i=0;i<n.length;++i){const t=n[i],r=i!==n.length-1||t!==eg(e.slice(i));Zm(n[i]===e[i]||!r,()=>"Error creating a new Tensor. Inferred shape "+`(${n}) does not match the provided `+`shape (${e}). `)}}return vg(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?Eg(t,r,Mm().getBool("DEBUG")):tg(t,[],!0),cy.makeTensor(t,e,r)}function zy(t,e){if((vg(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&vg(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ly(t,[],[],e)}function $y(t,e){Qm(t);const n=vy(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ly(t,null,n,e)}function By(t,e,n){if(Qm(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=vy(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ly(t,e,r,n)}function Wy(t,e,n){if(Qm(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=vy(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ly(t,e,r,n)}function qy(t,e,n){if(Qm(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=vy(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ly(t,e,r,n)}function Vy(t,e,n){if(Qm(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=vy(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ly(t,e,r,n)}function Uy(t,e,n){if(Qm(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=vy(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ly(t,e=e||r,r,n)}function jy(t,e=!0,n,r){return cy.makeVariable(t,e,n,r)}function Hy(t,e="float32"){if("complex64"===e){const e=Hy(t,"float32"),n=Gy(t,"float32");return Ny(e,n)}const n=Tg(eg(t),e);return cy.makeTensor(n,t,e)}function Gy(t,e="float32"){if("complex64"===e){const e=Gy(t,"float32"),n=Gy(t,"float32");return Ny(e,n)}const n=Rg(eg(t),e);return cy.makeTensor(n,t,e)}function Jy(t,e,n){return cy.runKernelFunc(r=>r.fill(t,e,n),{})}function Xy(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return cy.runKernelFunc(r=>r.linspace(t,e,n),{})}function Ky(t,e,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return Gy([0],r);const i=Rg(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(let a=1;a<i.length;a++)i[a]=i[a-1]+n;return $y(i,r)}const Zy=My({onesLike_:function(t){const e=by(t,"x","onesLike");if("complex64"===e.dtype){const t=Zy(Oy(e)),n=Yy(Py(e));return Ny(t,n)}return cy.runKernelFunc(t=>t.onesLike(e),{x:e},(t,e)=>({x:()=>Yy(t)}),"OnesLike")}}),Yy=My({zerosLike_:function(t){const e=by(t,"x","zerosLike");return cy.runKernelFunc(t=>t.zerosLike(e),{x:e},(t,e)=>({x:()=>Yy(t)}),"ZerosLike")}}),Qy=My({concat_:function(t,e=0){Zm(t.length>=1,()=>"Pass at least one tensor to concat");let n=xy(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach(t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)});const r=hg(e,n[0].shape)[0],i=Ry(n.map(t=>t.shape),r);return 0===eg(i)?Fy([],i):(n=n.filter(t=>t.size>0),1===n.length?n[0]:(Ty(n.map(t=>t.shape),r),cy.runKernelFunc((t,r)=>{const i=hg(e,n[0].shape)[0],a=t.concat(n,i);return r(n),a},n,null,"Concat",{axis:e})))}});function tv(t,e="float32",n){return e=e||"float32",Ng(t),new Ug(t,e,n)}function ev(t,e=!1){console.log(t.toString(e))}const nv=My({cast_:function(t,e){const n=by(t,"x","cast");if(!gg(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return cy.runKernelFunc(t=>t.cast(n,e),{x:n},t=>({x:()=>t.clone()}),"Cast",{dtype:e})}}),rv=My({cumsum_:function(t,e=0,n=!1,r=!1){const i=by(t,"x","cumsum"),a=ky([e|=0],i.rank);let s=i;null!=a&&(s=i.transpose(a));const o=Ay(1,i.rank)[0];let l=cy.runKernelFunc(t=>t.cumsum(s,o,n,r),{permutedX:s},t=>({permutedX:()=>t.cumsum(e,n,!r)}));return null!=a&&(l=l.transpose(a)),l}}),iv=My({expandDims_:function(t,e=0){const n=by(t,"x","expandDims",null);Zm(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r=n.shape.slice();return e<0&&(Zm(-(n.rank+1)<=e,()=>`Axis must be in the interval [${-(n.rank+1)}, ${n.rank}]`),e=n.rank+e+1),r.splice(e,0,1),av(n,r)}}),av=My({reshape_:function(t,e){const n=by(t,"x","reshape",null);return e=cg(e,n.size),Zm(n.size===eg(e),()=>"new shape and old shape must have the same number of elements."),cy.runKernelFunc(t=>t.reshape(n,e),{x:n},t=>({x:()=>t.reshape(n.shape)}),"Reshape",{shape:e})}}),sv=My({squeeze_:function(t,e){const n=by(t,"x","squeeze");return av(n,dg(n.shape,e).newShape)}}),ov=My({stack_:function(t,e=0){const n=xy(t,"tensors","stack");if(Zm(n.length>=1,()=>"Pass at least one tensor to tf.stack"),1===n.length)return n[0].expandDims(e);const r=n[0].shape,i=n[0].dtype;Zm(e<=n[0].rank,()=>"Axis must be <= rank of the tensor"),n.forEach(t=>{Ym(r,t.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(t=>{Zm(i===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=n.map(t=>t.expandDims(e));return Qy(a,e)}}),lv=My({unstack_:function(t,e=0){e=e||0;const n=by(t,"x","unstack");return Zm(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`),e<0&&(e+=n.shape.length),cy.runKernelFunc(t=>t.unstack(n,e),{x:n},t=>({x:()=>ov(t,e)}),"Unpack",{axis:e})}}),uv=async function(t,e){const n=by(t,"x","setdiff1d"),r=by(e,"y","setdiff1d");Zm(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),Zm(1===n.rank,()=>`x should be 1D tensor, but got x (${n.shape}).`),Zm(1===r.rank,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await n.data(),a=await r.data(),s=new Set(a);let o=0;for(let c=0;c<i.length;c++)s.has(i[c])||o++;const l=new Ug([o],n.dtype),u=new Ug([o],"int32");for(let c=0,h=0;c<i.length;c++)s.has(i[c])||(l.values[h]=i[c],u.values[h]=c,h++);return[l.toTensor(),u.toTensor()]},cv=My({matMul_:function(t,e,n=!1,r=!1){let i=by(t,"a","matMul"),a=by(e,"b","matMul");[i,a]=iy(i,a),Zm(i.rank>=2&&a.rank>=2&&i.rank===a.rank,()=>"Error in matMul: inputs must have the same rank of at least 2, "+`got ranks ${i.rank} and ${a.rank}.`);const s=n?i.shape[i.rank-2]:i.shape[i.rank-1],o=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],u=r?a.shape[a.rank-2]:a.shape[a.rank-1],c=i.shape.slice(0,-2),h=a.shape.slice(0,-2),d=eg(c),p=eg(h);Zm(rg(c,h),()=>`Error in matMul: outer dimensions (${c}) and (`+`${h}) of Tensors with shapes ${i.shape} and `+`${a.shape} must match.`),Zm(s===o,()=>`Error in matMul: inner shapes (${s}) and (`+`${o}) of Tensors with shapes ${i.shape} and `+`${a.shape} and transposeA=${n}`+` and transposeB=${r} must match.`);const f=i.shape.slice(0,-2).concat([l,u]),m=av(i,n?[d,s,l]:[d,l,s]),g=av(a,r?[p,u,o]:[p,o,u]),y=cy.runKernelFunc((t,e)=>(e([m,g]),t.batchMatMul(m,g,n,r)),{a:m,b:g},null,"BatchMatMul",{transposeA:n,transposeB:r});return av(y,f)}}),hv={kernelName:"BatchMatMul",inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,i]=e,{transposeA:a,transposeB:s}=n;return a||s?!a&&s?{a:()=>cv(t,i,!1,!1),b:()=>cv(t,r,!0,!1)}:a&&!s?{a:()=>cv(i,t,!1,!0),b:()=>cv(r,t,!1,!1)}:{a:()=>cv(i,t,!0,!0),b:()=>cv(t,r,!0,!0)}:{a:()=>cv(t,i,!1,!0),b:()=>cv(r,t,!0,!1)}}},dv=My({spaceToBatchND_:function(t,e,n){const r=by(t,"x","spaceToBatchND");return Zm(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),Zm(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),Zm(r.shape.reduce((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`),cy.runKernelFunc(t=>t.spaceToBatchND(r,e,n),{x:r},null,"SpaceToBatchND",{blockShape:e,paddings:n})}}),pv={kernelName:"BatchToSpaceND",gradFunc:(t,e,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>dv(t,r,i)}}};function fv(t){return cy.customGrad(t)}function mv(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(Dy(e.shape,r))),t.rank<n.rank&&(t=t.reshape(Dy(t.shape,r))),{x:()=>{const r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}const gv=My({all_:function(t,e=null,n=!1){let r=by(t,"x","all","bool");const i=hg(e,r.shape);let a=i;const s=ky(a,r.rank);null!=s&&(r=r.transpose(s),a=Ay(a.length,r.rank));const o=cy.runKernelFunc(t=>t.all(r,a),{$x:r});if(n){const t=Dy(o.shape,i);return o.reshape(t)}return o}}),yv=My({any_:function(t,e=null,n=!1){let r=by(t,"x","any","bool");const i=hg(e,r.shape);let a=i;const s=ky(a,r.rank);null!=s&&(r=r.transpose(s),a=Ay(a.length,r.rank));const o=cy.runKernelFunc(t=>t.any(r,a),{$x:r});if(n){const t=Dy(o.shape,i);return o.reshape(t)}return o}}),vv=My({argMax_:function(t,e=0){let n=by(t,"x","argMax");null==e&&(e=0);let r=hg(e,n.shape);const i=ky(r,n.rank);return null!=i&&(n=n.transpose(i),r=Ay(r.length,n.rank)),cy.runKernelFunc((t,e)=>{const i=t.argMax(n,r[0]);return e([n]),i},{x:n},(t,e)=>{const[n]=e;return{x:()=>Yy(n)}},"ArgMax",{axis:r[0]},[n])}}),_v=My({argMin_:function(t,e=0){let n=by(t,"x","argMin");null==e&&(e=0);let r=hg(e,n.shape);const i=ky(r,n.rank);return null!=i&&(n=n.transpose(i),r=Ay(r.length,n.rank)),cy.runKernelFunc((t,e)=>{const i=t.argMin(n,r[0]);return e([n]),i},{$x:n},(t,e)=>{const[n]=e;return{$x:()=>Yy(n)}})}}),bv=My({logSumExp_:function(t,e=null,n=!1){const r=by(t,"x","logSumExp"),i=hg(e,r.shape),a=r.max(i,!0),s=r.sub(a).exp().sum(i).log(),o=a.reshape(s.shape).add(s);if(n){const t=Dy(o.shape,i);return o.reshape(t)}return o}}),xv=My({mean_:function(t,e=null,n=!1){const r=by(t,"x","mean"),i=hg(e,r.shape),a=eg(Cy(r.shape,i)[1]);return fv(t=>{const r=zy(a);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:e=>{const n=t.shape.slice();return i.forEach(t=>{n[t]=1}),e.reshape(n).mul(Hy(t.shape,"float32")).div(a)}}})(r)}}),wv=My({min_:function(t,e=null,n=!1){let r=by(t,"x","min");const i=r,a=hg(e,r.shape);let s=a;const o=ky(s,r.rank);null!=o&&(r=r.transpose(o),s=Ay(s.length,r.rank));let l=cy.runKernelFunc((t,e)=>{const n=t.min(r,s);return e([i,n]),n},{x:r},(t,e)=>mv(t,e[1],e[0],a,o),"Min",{axes:s},[r],[!0]);if(n){const t=Dy(l.shape,a);l=l.reshape(t)}return l}}),Sv=My({moments_:function(t,e=null,n=!1){const r=hg(e,(t=by(t,"x","moments")).shape),i=t.mean(r,n);let a=i.shape;n||(a=Dy(i.shape,r));const s=t.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:s.mean(r,n)}}}),Cv=My({sum_:function(t,e=null,n=!1){let r=by(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());const i=hg(e,r.shape);return fv(t=>{const e=ky(i,t.rank);let r=i,a=t;null!=e&&(a=t.transpose(e),r=Ay(r.length,t.rank));const s=e=>{const n=t.shape.slice();return i.forEach(t=>{n[t]=1}),e.reshape(n).mul(Hy(t.shape,"float32"))};let o=cy.runKernelFunc(t=>t.sum(a,r),{x:a},t=>({x:()=>s(t)}),"Sum",{axes:r});if(n){const t=Dy(o.shape,i);o=o.reshape(t)}return{value:o,gradFunc:s}})(r)}}),Dv=My({prod_:function(t,e=null,n=!1){let r=by(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());const i=hg(e,r.shape),a=ky(i,r.rank);let s=i,o=r;null!=a&&(o=r.transpose(a),s=Ay(s.length,r.rank));let l=cy.runKernelFunc(t=>t.prod(o,s),{permutedX:o});if(n){const t=Dy(l.shape,i);l=l.reshape(t)}return l}}),Iv={kernelName:"BroadcastTo",gradFunc:(t,e,n)=>{const r=n.inputShape,i=n.shape,a=Array.from(i);for(let o=r.length-1;o>=0;o--)if(r[o]===i[o])a[o]=1;else if(1!==r[o])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const s=[];for(let o=0;o<a.length;o++)a[o]>1&&s.push(o);return{x:()=>Cv(t,s,!0)}}},kv=My({split_:function(t,e,n=0){const r=by(t,"x","split"),i=hg(n,r.shape)[0];let a;return"number"==typeof e?(Zm(r.shape[i]%e==0,()=>"Number of splits must evenly divide the axis."),a=new Array(e).fill(r.shape[i]/e)):(Zm(r.shape[i]===e.reduce((t,e)=>t+e),()=>"The sum of sizes must match the size of the axis dimension."),a=e),cy.runKernelFunc((t,e)=>t.split(r,a,i),{x:r},null,"SplitV",{numOrSizeSplits:e,axis:n})}}),Ev={kernelName:"Concat",saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(t=>t.shape),{axis:i}=n,a=hg(i,e[0].shape)[0],s=r.map(t=>t[a]);return kv(t,s,a).map(t=>()=>t)}};function Av(t,e,n,r,i,a,s="channelsLast"){const[o,l]=Ov(e);let u;if("channelsLast"===s)u=[o,l,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);u=[o,l,t[1],t[1]]}return Rv(t,u,n,r,i,a,!1,s)}function Tv(t,e,n,r,i,a,s="NDHWC"){const[o,l,u]=Pv(e);let c,h;if("NDHWC"===s)h="channelsLast",c=[o,l,u,t[4],t[4]];else{if("NCDHW"!==s)throw new Error(`Unknown dataFormat ${s}`);h="channelsFirst",c=[o,l,u,t[1],t[1]]}return Mv(t,c,n,r,i,!1,h,a)}function Rv(t,e,n,r,i,a,s=!1,o="channelsLast"){let[l,u,c,h]=[-1,-1,-1,-1];if("channelsLast"===o)[l,u,c,h]=t;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[l,h,u,c]=t}const[d,p,,f]=e,[m,g]=Ov(n),[y,v]=Ov(r),_=Fv(d,y),b=Fv(p,v),{padInfo:x,outHeight:w,outWidth:S}=function(t,e,n,r,i,a,s,o){let l,u,c;if("number"==typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,i){null==r&&(r=Nv(t,e,n));const a=t[1],s=Lv((t[0]-e+2*r)/n+1,i);Zm(ig(s),()=>`The output # of rows (${s}) must be an integer. `+"Change the stride and/or zero pad parameters");const o=Lv((a-e+2*r)/n+1,i);return Zm(ig(o),()=>`The output # of columns (${o}) must be an integer. `+"Change the stride and/or zero pad parameters"),[s,o]}([e,n],a,r,t,o);u=i[0],c=i[1]}else if("same"===t){u=Math.ceil(e/r),c=Math.ceil(n/i);const t=Math.max(0,(u-1)*r+a-e),o=Math.max(0,(c-1)*i+s-n),h=Math.floor(t/2),d=t-h,p=Math.floor(o/2);l={top:h,bottom:d,left:p,right:o-p,type:"SAME"}}else{if("valid"!==t)throw Error(`Unknown padding parameter: ${t}`);l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-a+1)/r),c=Math.ceil((n-s+1)/i)}return{padInfo:l,outHeight:u,outWidth:c}}(i,u,c,m,g,_,b,a),C=s?f*h:f;let D;return"channelsFirst"===o?D=[l,C,w,S]:"channelsLast"===o&&(D=[l,w,S,C]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:h,outHeight:w,outWidth:S,outChannels:C,padInfo:x,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:_,effectiveFilterWidth:b,dilationHeight:y,dilationWidth:v,inShape:t,outShape:D,filterShape:e}}function Mv(t,e,n,r,i,a=!1,s="channelsLast",o){let[l,u,c,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[l,u,c,h,d]=t;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[l,d,u,c,h]=t}const[p,f,m,,g]=e,[y,v,_]=Pv(n),[b,x,w]=Pv(r),S=Fv(p,b),C=Fv(f,x),D=Fv(m,w),{padInfo:I,outDepth:k,outHeight:E,outWidth:A}=function(t,e,n,r,i,a,s,o,l,u,c){let h,d,p,f;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const a=function(t,e,n,r,i,a){null==i&&(i=Nv(t,e,r));const s=t[1],o=t[2],l=Lv((t[0]-e+2*i)/r+1,a);Zm(ig(l),()=>`The output # of depths (${l}) must be an integer. `+"Change the stride and/or zero pad parameters");const u=Lv((s-e+2*i)/r+1,a);Zm(ig(u),()=>`The output # of rows (${u}) must be an integer. `+"Change the stride and/or zero pad parameters");const c=Lv((o-e+2*i)/r+1,a);return Zm(ig(c),()=>`The output # of columns (${c}) must be an integer. `+"Change the stride and/or zero pad parameters"),[l,u,c,1]}([e,n,r,1],o,0,i,t,c);d=a[0],p=a[1],f=a[2]}else if("same"===t){d=Math.ceil(e/i),p=Math.ceil(n/a),f=Math.ceil(r/s);const t=(d-1)*i+o-e,c=(p-1)*a+l-n,m=(f-1)*s+u-r,g=Math.floor(t/2),y=t-g,v=Math.floor(c/2),_=c-v,b=Math.floor(m/2);h={top:v,bottom:_,left:b,right:m-b,front:g,back:y,type:"SAME"}}else{if("valid"!==t)throw Error(`Unknown padding parameter: ${t}`);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-o+1)/i),p=Math.ceil((n-l+1)/a),f=Math.ceil((r-u+1)/s)}return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}(i,u,c,h,y,v,_,S,C,D,o),T=a?g*d:g;let R;return"channelsFirst"===s?R=[l,T,k,E,A]:"channelsLast"===s&&(R=[l,k,E,A,T]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:h,inChannels:d,outDepth:k,outHeight:E,outWidth:A,outChannels:T,padInfo:I,strideDepth:y,strideHeight:v,strideWidth:_,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:C,effectiveFilterWidth:D,dilationDepth:b,dilationHeight:x,dilationWidth:w,inShape:t,outShape:R,filterShape:e}}function Nv(t,e,n,r=1){const i=Fv(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function Ov(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function Pv(t){return"number"==typeof t?[t,t,t]:t}function Fv(t,e){return e<=1?t:t+(t-1)*(e-1)}function Lv(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function zv(t){const[e,n,r]=Ov(t);return 1===e&&1===n&&1===r}function $v(t,e){return zv(t)||zv(e)}function Bv(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}const Wv=My({conv2DBackpropFilter_:function(t,e,n,r,i,a="NHWC",s){let o=t;3===t.rank&&(o=av(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=av(e,[1,e.shape[0],e.shape[1],e.shape[2]])),Zm(4===o.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+`${o.shape}.`),Zm(4===l.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+`${l.shape}.`),Zm(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+`${n}.`);const u="NHWC"===a?o.shape[3]:o.shape[1],c="NHWC"===a?l.shape[3]:l.shape[1];return Zm(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must `+`match input depth in filter (${n[2]}.`),Zm(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must `+`match output depth for filter (${n[3]}).`),null!=s&&Zm(ig(i),()=>"Error in conv2dDerFilter: pad must be an integer when using, "+`dimRoundingMode ${s} but got pad ${i}.`),cy.runKernelFunc(t=>{const e=Bv(a),u=Rv(o.shape,n,r,1,i,s,!1,e);return t.conv2dDerFilter(o,l,u)},{x:o,dy:l},null,"Conv2DBackpropFilter",{strides:r,pad:i,dataFormat:a,dimRoundingMode:s})}}),qv=My({conv2DBackpropInput_:function(t,e,n,r,i,a="NHWC",s){Zm(t.length===e.rank,()=>"Length of inShape "+`(${t.length}) and rank of dy (${e.rank}) must match`);let o=t,l=e,u=!1;3===e.rank&&(u=!0,l=av(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,t[0],t[1],t[2]]),Zm(4===o.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+`${o.length}.`),Zm(4===l.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+`rank ${l.rank}`),Zm(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+`rank ${n.rank}`);const c="NHWC"===a?o[3]:o[1],h="NHWC"===a?l.shape[3]:l.shape[1];Zm(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must `+`match input depth for filter ${n.shape[2]}.`),Zm(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must `+`match output depth for filter ${n.shape[3]}.`),null!=s&&Zm(ig(i),()=>"Error in conv2dDerInput: pad must be an integer when using, "+`dimRoundingMode ${s} but got pad ${i}.`);const d=cy.runKernelFunc((t,e)=>{const u=Bv(a),c=Rv(o,n.shape,r,1,i,s,!1,u),h=t.conv2dDerInput(l,n,c);return e([l,n]),h},{dy:l,filter:n},null,"Conv2DBackpropInput",{strides:r,pad:i,dataFormat:a,dimRoundingMode:s});return u?av(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Vv={kernelName:"Conv2D",inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{dilations:a,strides:s,pad:o,dataFormat:l}=n;return Zm(zv(a),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+`are not yet supported in gradients. Got dilations '${a}'`),{x:()=>qv(r.shape,t,i,s,o,l),filter:()=>Wv(r,t,i.shape,s,o,l)}}},Uv=My({conv2d_:function(t,e,n,r,i="NHWC",a=[1,1],s){const o=by(t,"x","conv2d"),l=by(e,"filter","conv2d");let u=o,c=!1;3===o.rank&&(c=!0,u=av(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Zm(4===u.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),Zm(4===l.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+`${l.rank}.`),null!=s&&Zm(ig(r),()=>"Error in conv2d: pad must be an integer when using, "+`dimRoundingMode ${s} but got pad ${r}.`);const h="NHWC"===i?u.shape[3]:u.shape[1];Zm(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match `+`input depth for filter ${l.shape[2]}.`),Zm($v(n,a),()=>"Error in conv2D: Either strides or dilations must be 1. "+`Got strides ${n} and dilations '${a}'`);const d=cy.runKernelFunc((t,e)=>{const o=Bv(i),c=Rv(u.shape,l.shape,n,a,r,s,!1,o),h=t.conv2d(u,l,c);return e([u,l]),h},{x:u,filter:l},null,"Conv2D",{strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s});return c?av(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),jv={kernelName:"Conv2DBackpropInput",inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{strides:a,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>Uv(t,i,a,s,o,1,l),filter:()=>Wv(t,r,i.shape,a,s,o,l)}}},Hv=My({conv3DBackpropFilter_:function(t,e,n,r,i){let a=t;4===t.rank&&(a=av(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let s=e;return 4===s.rank&&(s=av(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),Zm(5===a.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+`${a.shape}.`),Zm(5===s.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+`${s.shape}.`),Zm(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+`${n}.`),Zm(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must `+`match input depth in filter (${n[3]}.`),Zm(s.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must `+`match output depth for filter (${n[4]}).`),cy.runKernelFunc(t=>{const e=Mv(a.shape,n,r,1,i);return t.conv3dDerFilter(a,s,e)},{x:a,y:s},null,"Conv3DBackpropFilterV2",{strides:r,pad:i})}}),Gv=My({conv3DBackpropInput_:function(t,e,n,r,i){Zm(t.length===e.rank,()=>"Length of inShape "+`(${t.length}) and rank of dy (${e.rank}) must match`);let a=t,s=e,o=!1;4===e.rank&&(o=!0,s=av(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);const l=a[4],u=s.shape[4];Zm(5===a.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+`${a.length}.`),Zm(5===s.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+`rank ${s.rank}`),Zm(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+`rank ${n.rank}`),Zm(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must `+`match input depth for filter ${n.shape[3]}.`),Zm(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must `+`match output depth for filter ${n.shape[4]}.`);const c=cy.runKernelFunc(t=>{const e=Mv(a,n.shape,r,1,i);return t.conv3dDerInput(s,n,e)},{dy:s},null,"Conv3DBackpropInputV2",{pad:i});return o?av(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),Jv={kernelName:"Conv3D",inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a}=n;Zm(zv(r),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+`not yet supported in gradients. Got dilations '${r}'`);const[s,o]=e;return{x:()=>Gv(s.shape,t,o,i,a),filter:()=>Hv(s,t,o.shape,i,a)}}},Xv=My({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r){let i=t;3===t.rank&&(i=av(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let a=e;return 3===a.rank&&(a=av(e,[1,e.shape[0],e.shape[1],e.shape[2]])),cy.runKernelFunc(t=>t.depthwiseConv2DDerFilter(i,a,r),{x:i,dy:a},null,"DepthwiseConv2dNativeBackpropFilter")}}),Kv=My({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r){let i=e,a=!1;3===e.rank&&(a=!0,i=av(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const s=cy.runKernelFunc(t=>t.depthwiseConv2DDerInput(i,n,r),{dy:i},null,"DepthwiseConv2dNativeBackpropInput");return a?av(s,[s.shape[1],s.shape[2],s.shape[3]]):s}}),Zv={kernelName:"DepthwiseConv2dNative",inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a,dimRoundingMode:s}=n,o=null==r?[1,1]:r;Zm(zv(o),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+`'${o}'`);const[l,u]=e;Zm(4===l.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be "+`rank 4, but got rank ${l.rank}.`),Zm(4===u.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+`rank 4, but got rank ${u.rank}.`),Zm(l.shape[3]===u.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+`channels (${l.shape[3]}) must match the inChannels dimension `+`in filter ${u.shape[2]}.`),Zm($v(i,o),()=>"Error in gradient of depthwiseConv2d: Either strides or "+`dilations must be  1. Got strides ${i} and dilations `+`'${o}'.`),null!=s&&Zm(ig(a),()=>"Error in depthwiseConv2d: pad must be an integer when using, "+`dimRoundingMode ${s} but got pad ${a}.`);const c=Rv(l.shape,u.shape,i,o,a,s,!0);return{x:()=>Kv(l.shape,t,u,c),filter:()=>Xv(l,t,u.shape,c)}}};function Yv(t){Mm().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Qv(){return cy}function t_(){return cy.memory()}function e_(t,e){return cy.tidy(t,e)}function n_(t){oy(t).forEach(t=>t.dispose())}function r_(t){return cy.keep(t)}function i_(t,e,n=1){return cy.registerBackend(t,e,n)}Gg=Yv;const a_=My({add_:function(t,e){let n=by(t,"a","add"),r=by(e,"b","add");return[n,r]=iy(n,r),cy.runKernelFunc((t,e)=>{const i=t.add(n,r);return e([n,r]),i},{a:n,b:r},null,"Add")}}),s_=My({abs_:function(t){const e=by(t,"x","abs");return"complex64"===e.dtype?cy.runKernelFunc(t=>t.complexAbs(e),{$x:e}):cy.runKernelFunc((t,n)=>{const r=t.abs(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.mul(n.toFloat().step(-1))}},"Abs")}}),o_=My({acos_:function(t){const e=by(t,"x","acos");return cy.runKernelFunc((t,n)=>{const r=t.acos(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>{const e=n.toFloat().square(),r=zy(1).sub(e).sqrt();return t.div(r).neg()}}})}}),l_=My({acosh_:function(t){const e=by(t,"x","acosh");return cy.runKernelFunc((t,n)=>{const r=t.acosh(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>{const e=n.toFloat().square().sub(1).sqrt();return t.div(e)}}})}}),u_=My({asin_:function(t){const e=by(t,"x","asin");return cy.runKernelFunc((t,n)=>{const r=t.asin(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(zy(1).sub(n.toFloat().square()).sqrt())}})}}),c_=My({asinh_:function(t){const e=by(t,"x","asinh");return cy.runKernelFunc((t,n)=>{const r=t.asinh(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>{const e=zy(1).add(n.toFloat().square()).sqrt();return t.div(e)}}})}}),h_=My({atan_:function(t){const e=by(t,"x","atan");return cy.runKernelFunc((t,n)=>{const r=t.atan(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.toFloat().square().add(1))}})}}),d_=My({atanh_:function(t){const e=by(t,"x","atanh");return cy.runKernelFunc((t,n)=>{const r=t.atanh(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(zy(1).sub(n.toFloat().square()))}})}}),p_=My({ceil_:function(t){const e=by(t,"x","ceil");return cy.runKernelFunc(t=>t.ceil(e),{$x:e},t=>({$x:()=>Yy(t)}))}}),f_=My({clipByValue_:function(t,e,n){const r=by(t,"x","clipByValue");return Zm(e<=n,()=>`Error in clip: min (${e}) must be `+`less than or equal to max (${n}).`),cy.runKernelFunc((t,i)=>{const a=t.clip(r,e,n);return i([r]),a},{x:r},(t,r)=>{const[i]=r;return{x:()=>t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),Yy(t))}},"ClipByValue",{min:e,max:n},[r])}}),m_=My({cos_:function(t){const e=by(t,"x","cos");return cy.runKernelFunc((t,n)=>{const r=t.cos(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>n.toFloat().sin().neg().mul(t)}},"Cos",{},[e])}}),g_=My({cosh_:function(t){const e=by(t,"x","cosh");return cy.runKernelFunc((t,n)=>{const r=t.cosh(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>n.toFloat().sinh().mul(t)}})}}),y_=My({erf_:function(t){let e=by(t,"x","erf");return Zm("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=e.toFloat()),cy.runKernelFunc((t,n)=>{const r=t.erf(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}})}}),v_=My({exp_:function(t){const e=by(t,"x","exp");return cy.runKernelFunc((t,n)=>{const r=t.exp(e);return n([r]),r},{x:e},(t,e)=>({x:()=>t.mul(e[0])}),"Exp",{},[],[!0])}}),__=My({expm1_:function(t){const e=by(t,"x","expm1");return cy.runKernelFunc((t,n)=>{const r=t.expm1(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.exp())}})}}),b_=My({floor_:function(t){const e=by(t,"x","floor");return cy.runKernelFunc(t=>t.floor(e),{$x:e},t=>({$x:()=>Yy(t)}))}}),x_=My({log_:function(t){const e=by(t,"x","log");return cy.runKernelFunc((t,n)=>{const r=t.log(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.div(n.toFloat())}},"Log",{},[e])}}),w_=My({log1p_:function(t){const e=by(t,"x","log1p");return cy.runKernelFunc((t,n)=>{const r=t.log1p(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.add(1))}})}}),S_=My({logSigmoid_:function(t){const e=by(t,"x","logSigmoid");return cy.runKernelFunc((t,n)=>{const r=t.softplus(e.neg()).neg();return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.neg().sigmoid())}})}}),C_=My({neg_:function(t){const e=by(t,"x","neg");return cy.runKernelFunc(t=>t.neg(e),{x:e},t=>({x:()=>t.neg()}),"Neg",{},[e])}}),D_=My({reciprocal_:function(t){const e=by(t,"x","reciprocal");return cy.runKernelFunc((t,n)=>{const r=t.reciprocal(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.square().neg())}})}}),I_=My({round_:function(t){const e=by(t,"x","round");return cy.runKernelFunc(t=>t.round(e),{$x:e},t=>({$x:()=>Yy(t)}))}}),k_=My({rsqrt_:function(t){const e=by(t,"x","rsqrt");return cy.runKernelFunc((t,n)=>{const r=t.rsqrt(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.div(n.pow(1.5).mul(2)).neg()}},"Rsqrt",{},[e])}}),E_=My({sigmoid_:function(t){const e=by(t,"x","sigmoid");return cy.runKernelFunc((t,n)=>{const r=t.sigmoid(e);return n([r]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.mul(n.mul(zy(1).sub(n)))}},"Sigmoid")}}),A_=My({sign_:function(t){const e=by(t,"x","sign");return cy.runKernelFunc(t=>t.sign(e),{$x:e},t=>({$x:()=>Yy(t)}))}}),T_=My({isNaN_:function(t){const e=by(t,"x","isNaN");return cy.runKernelFunc(t=>t.isNaN(e),{$x:e},t=>({$x:()=>Yy(t)}))}}),R_=My({isInf_:function(t){const e=by(t,"x","isInf");return cy.runKernelFunc(t=>t.isInf(e),{$x:e},t=>({$x:()=>Yy(t)}))}}),M_=My({isFinite_:function(t){const e=by(t,"x","isFinite");return cy.runKernelFunc(t=>t.isFinite(e),{$x:e},t=>({$x:()=>Yy(t)}))}}),N_=My({sin_:function(t){const e=by(t,"x","sin");return cy.runKernelFunc((t,n)=>{const r=t.sin(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>n.toFloat().cos().mul(t)}},"Sin",{},[e])}}),O_=My({sinh_:function(t){const e=by(t,"x","sinh");return cy.runKernelFunc((t,n)=>{const r=t.sinh(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>n.toFloat().cosh().mul(t)}})}}),P_=My({softplus_:function(t){const e=by(t,"x","softplus");return cy.runKernelFunc((t,n)=>{const r=t.softplus(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.sigmoid())}})}}),F_=My({sqrt_:function(t){const e=by(t,"x","sqrt");return cy.runKernelFunc((t,n)=>{const r=t.sqrt(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.div(n.toFloat().sqrt().mul(2))}},"Sqrt",{})}}),L_=My({step_:function(t,e=0){const n=by(t,"x","step");return cy.runKernelFunc(t=>t.step(n,e),{$x:n},t=>({$x:()=>Yy(t)}))}}),z_=My({tan_:function(t){const e=by(t,"x","tan");return cy.runKernelFunc((t,n)=>{const r=t.tan(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.cos().square())}})}}),$_=My({tanh_:function(t){const e=by(t,"x","tanh");return cy.runKernelFunc((t,n)=>{const r=t.tanh(e);return n([r]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>zy(1).sub(n.square()).mul(t)}},"Tanh",{},null,[!0])}}),B_=My({addStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","addStrict"),r=by(e,"b","addStrict");return Ym(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),W_=My({atan2_:function(t,e){let n=by(t,"a","atan2"),r=by(e,"b","atan2");[n,r]=iy(n,r);const i=gy(n.shape,r.shape);return cy.runKernelFunc((t,e)=>{const i=t.atan2(n,r);return e([n,r]),i},{$a:n,$b:r},(t,e)=>{const[n,r]=e;return{$a:()=>{const e=a_(n.square(),r.square());let a=t.mul(r.div(e));const s=my(n.shape,i);return s.length>0&&(a=a.sum(s)),a.reshape(n.shape)},$b:()=>{const e=a_(n.square(),r.square());let a=C_(t.mul(n.div(e)));const s=my(r.shape,i);return s.length>0&&(a=a.sum(s)),a.reshape(r.shape)}}})}}),q_=My({divStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","div"),r=by(e,"b","div");return Ym(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),V_=My({floorDiv_:function(t,e){let n=by(t,"a","floorDiv"),r=by(e,"b","floorDiv");[n,r]=iy(n,r);const i=gy(n.shape,r.shape);return cy.runKernelFunc((t,e)=>{const i=t.floorDiv(n,r);return e([n,r]),i},{a:n,b:r},(t,e)=>{const[n,r]=e;return{a:()=>{const e=t.div(r.toFloat()),a=my(n.shape,i);return a.length>0?e.sum(a).reshape(n.shape):e},b:()=>{let e=t.mul(n.toFloat());const a=my(r.shape,i);a.length>0&&(e=e.sum(a).reshape(r.shape));const s=r.square();return e.div(s.toFloat()).neg()}}},"FloorDiv")}}),U_=My({maximum_:function(t,e){let n=by(t,"a","maximum"),r=by(e,"b","maximum");return[n,r]=iy(n,r),"bool"===n.dtype&&(n=n.toInt(),r=r.toInt()),gy(n.shape,r.shape),cy.runKernelFunc((t,e)=>{const i=t.maximum(n,r);return e([n,r]),i},{a:n,b:r},(t,e)=>{const[n,r]=e;return{a:()=>t.mul(n.greaterEqual(r).toFloat()),b:()=>t.mul(n.less(r).toFloat())}},"Maximum")}}),j_=My({maximumStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","maximumStrict"),r=by(e,"b","maximumStrict");return Ym(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),H_=My({minimum_:function(t,e){let n=by(t,"a","minimum"),r=by(e,"b","minimum");return[n,r]=iy(n,r),"bool"===n.dtype&&(n=n.toInt(),r=r.toInt()),gy(n.shape,r.shape),cy.runKernelFunc((t,e)=>{const i=t.minimum(n,r);return e([n,r]),i},{a:n,b:r},(t,e)=>{const[n,r]=e;return{a:()=>t.mul(n.lessEqual(r).toFloat()),b:()=>t.mul(n.greater(r).toFloat())}},"Minimum")}}),G_=My({minimumStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","minimumStrict"),r=by(e,"b","minimumStrict");return Ym(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),J_=My({mod_:function(t,e){let n=by(t,"a","mod"),r=by(e,"b","mod");[n,r]=iy(n,r);const i=gy(n.shape,r.shape);return cy.runKernelFunc((t,e)=>{const i=t.mod(n,r);return e([n,r]),i},{$a:n,$b:r},(t,e)=>{const[n,r]=e;return{$a:()=>{const e=my(n.shape,i);return e.length>0?t.sum(e).reshape(n.shape):t},$b:()=>{const e=t.mul(n.div(r).floor().neg()),a=my(r.shape,i);return a.length>0?e.sum(a).reshape(r.shape):e}}})}}),X_=My({modStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","modStrict"),r=by(e,"b","modStrict");return Ym(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),K_=My({mul_:function(t,e){let n=by(t,"a","mul"),r=by(e,"b","mul");[n,r]=iy(n,r);const i=gy(n.shape,r.shape);return cy.runKernelFunc((t,e)=>{const i=t.multiply(n,r);return e([n,r]),i},{a:n,b:r},(t,e)=>{const[n,r]=e;return{a:()=>{const e=t.mul(r.toFloat()),a=my(n.shape,i);return a.length>0?e.sum(a).reshape(n.shape):e},b:()=>{const e=t.mul(n.toFloat()),a=my(r.shape,i);return a.length>0?e.sum(a).reshape(r.shape):e}}},"Mul")}}),Z_=My({mulStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","mul"),r=by(e,"b","mul");return Ym(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Y_=My({pow_:function(t,e){let n=by(t,"base","pow"),r=by(e,"exp","pow");[n,r]=iy(n,r);const i=gy(n.shape,r.shape);return cy.runKernelFunc((t,e)=>{const i=t.pow(n,r);return e([n,r,i]),i},{a:n,b:r},(t,e)=>{const[n,r,a]=e;return{a:()=>{const e=r.toFloat();let a=t.mul(e.mul(n.pow(e.sub(zy(1)))));const s=my(n.shape,i);return s.length>0&&(a=a.sum(s)),a.reshape(n.shape)},b:()=>{const e=n.greater(0),s=n.log().where(e,Yy(n));let o=t.mul(a.mul(s));const l=my(r.shape,i);return l.length>0&&(o=o.sum(l)),o.reshape(r.shape)}}},"Pow",{},[n,r],[!0])}}),Q_=My({powStrict_:function(t,e){return Yv("strict variants of ops have been deprecated and will be removed in future"),Ym(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),tb=My({squaredDifferenceStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","squaredDifferenceStrict"),r=by(e,"b","squaredDifferenceStrict");return Ym(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),eb=My({subStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","subStrict"),r=by(e,"b","subStrict");return Ym(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),nb=My({div_:function(t,e){let n=by(t,"a","div"),r=by(e,"b","div");return[n,r]=iy(n,r),"int32"===n.dtype&&"int32"===r.dtype?V_(n,r):cy.runKernelFunc((t,e)=>{const i=t.realDivide(n,r);return e([n,r]),i},{a:n,b:r},null,"Div",{})}}),rb=My({square_:function(t){const e=by(t,"x","square");return cy.runKernelFunc((t,n)=>(n([e]),t.square(e)),{x:e},null,"Square",{},[e],[])}}),ib={kernelName:"Div",inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=gy(n.shape,r.shape);return{a:()=>{const e=nb(t,r.toFloat()),a=my(n.shape,i);return a.length>0?Cv(e,a).reshape(n.shape):e},b:()=>{let e=K_(t,n.toFloat());const a=my(r.shape,i);a.length>0&&(e=av(Cv(e,a),r.shape));const s=rb(r);return C_(nb(e,s.toFloat()))}}}},ab=My({sub_:function(t,e){let n=by(t,"a","sub"),r=by(e,"b","sub");return[n,r]=iy(n,r),cy.runKernelFunc((t,e)=>{const i=t.subtract(n,r);return e([n,r]),i},{a:n,b:r},null,"Sub")}}),sb=My({tile_:function(t,e){const n=by(t,"x","tile",null);return Zm(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} `+`must match length of reps ${e}.`),cy.runKernelFunc((t,r)=>{const i=t.tile(n,e);return r([n]),i},{x:n},null,"Tile",{reps:e},[n])}}),ob={kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[i,a,s,o]=e,l=null==o?zy(1):o,u=my(a.shape,i.shape),c=[];if(1===a.rank){for(let t=0;t<i.shape.length-1;++t)c.push(i.shape[t]);c.push(1)}const h=ab(i,a),d=K_(t,l),p=k_(a_(s,zy(r))),f=K_(K_(K_(p,p),p),zy(-.5));return{x:()=>av(K_(K_(t,1===a.rank?sb(p.as4D(1,1,1,a.shape[0]),c):p),l),i.shape),mean:()=>{let t=K_(K_(p,zy(-1)),d);return 1===a.rank&&(t=Cv(t,u)),av(t,a.shape)},variance:()=>{let t=K_(K_(f,h),d);return 1===a.rank&&(t=Cv(t,u)),av(t,a.shape)},scale:()=>{const e=K_(h,p);let n=K_(t,e);return 1===a.rank&&(n=Cv(n,u)),av(n,a.shape)},offset:()=>{let e=t;return 1===a.rank&&(e=Cv(e,u)),av(e,a.shape)}}}},lb={kernelName:"GreaterEqual",inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Yy(n),b:()=>Yy(r)}}},ub=My({localResponseNormalizationBackprop_:function(t,e,n,r=5,i=1,a=1,s=.5){return cy.runKernelFunc(o=>o.LRNGrad(n,t,e,r,i,a,s),{x:t,y:e,dy:n},null,"LRNBackprop",{depthRadius:r,bias:i,alpha:a,beta:s})}}),cb={kernelName:"LRN",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{depthRadius:a,bias:s,alpha:o,beta:l}=n;return{x:()=>ub(r,i,t,a,s,o,l)}}},hb=My({transpose_:function(t,e){const n=by(t,"x","transpose");return null==e&&(e=n.shape.map((t,e)=>e).reverse()),Zm(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} `+`must match length of perm ${e}.`),e.forEach(t=>{Zm(t>=0&&t<n.rank,()=>`All entries in 'perm' must be between 0 and ${n.rank-1}`+` but got ${e}`)}),n.rank<=1?n.clone():cy.runKernelFunc(t=>t.transpose(n,e),{x:n},null,"Transpose",{perm:e})}}),db={kernelName:"Max",inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:i}=r,[a,s]=e,o=hg(i,a.shape),l=ky(o,a.rank),u=mv(t,s,a,o,l);return{x:()=>{let t=u.x();return null!=l&&(t=hb(t)),t}}}},pb={kernelName:"OneHot",inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Gy(n.shape,"float32")}}},fb=My({batchToSpaceND_:function(t,e,n){const r=by(t,"x","batchToSpaceND"),i=e.reduce((t,e)=>t*e);return Zm(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),Zm(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),Zm(r.shape[0]%i==0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of `+`the elements of blockShape ${e.join(" * ")} === ${i}`),cy.runKernelFunc(t=>t.batchToSpaceND(r,e,n),{x:r},null,"BatchToSpaceND",{blockShape:e,crops:n})}}),mb={kernelName:"SpaceToBatchND",gradFunc:(t,e,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>fb(t,r,i)}}},gb={kernelName:"SplitV",gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>Qy(t,r)}}},yb={kernelName:"Square",inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>K_(t,K_(n.toFloat(),2))}}},vb={kernelName:"SquaredDifference",inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=zy(2);return{a:()=>K_(t,K_(i,ab(n,r))),b:()=>K_(t,K_(i,ab(r,n)))}}},_b={kernelName:"Sub",inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=gy(n.shape,r.shape);return{a:()=>{let e=t;const r=my(n.shape,i);return r.length>0&&(e=Cv(e,r)),av(e,n.shape)},b:()=>{let e=t;const n=my(r.shape,i);return n.length>0&&(e=Cv(e,n)),av(C_(e),r.shape)}}}},bb=My({pad_:function(t,e,n=0){const r=by(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return cy.runKernelFunc((t,i)=>(i([r]),t.pad(r,e,n)),{x:r},null,"PadV2",{paddings:e,constantValue:n})}});function xb(t,e,n){Zm(t.rank===e.length,()=>`Error in slice${t.rank}D: Length of begin ${e} must `+`match the rank of the array (${t.rank}).`),Zm(t.rank===n.length,()=>`Error in slice${t.rank}D: Length of size ${n} must `+`match the rank of the array (${t.rank}).`);for(let r=0;r<t.rank;++r)Zm(e[r]+n[r]<=t.shape[r],()=>`Error in slice${t.rank}D: begin[${r}] + size[${r}] `+`(${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function wb(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Sb(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function Cb(t,e,n,r,i){let a=e[i];(t&1<<i||null==a)&&(a=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const s=r[i];return a<0&&(a+=s),a=Hm(0,a,s-1),a}function Db(t,e,n,r,i){let a=e[i];const s=n[i]||1;(t&1<<i||null==a)&&(a=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const o=r[i];return a<0&&(a+=o),a=s>0?Hm(0,a,o):Hm(-1,a,o-1),a}function Ib(t,e,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function kb(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}const Eb=My({slice_:function(t,e,n){const r=by(t,"x","slice");if(0===r.rank)throw new Error("Slicing scalar is not possible");let i,a;i="number"==typeof e?[e,...new Array(r.rank-1).fill(0)]:e.length<r.rank?e.concat(new Array(r.rank-e.length).fill(0)):e.slice(),i.forEach(t=>{Zm(-1!==t,()=>"slice() does not support negative begin indexing.")}),a=null==n?new Array(r.rank).fill(-1):"number"==typeof n?[n,...new Array(r.rank-1).fill(-1)]:n.length<r.rank?n.concat(new Array(r.rank-n.length).fill(-1)):n,a=a.map((t,e)=>t>=0?t:(Zm(-1===t,()=>"Negative size values should be exactly -1 but got "+`${t} for the slice() size at index ${e}.`),r.shape[e]-i[e])),xb(r,i,a);const s=r.shape;return cy.runKernelFunc(t=>t.slice(r,i,a),{x:r},t=>{const e=[];for(let n=0;n<t.rank;n++)e.push([i[n],s[n]-i[n]-a[n]]);return{x:()=>bb(t,e)}},"Slice",{begin:i,size:a})}}),Ab=My({slice1d_:function(t,e,n){const r=by(t,"x","slice1d");return Zm(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Eb(r,[e],[n])}}),Tb=My({slice2d_:function(t,e,n){const r=by(t,"x","slice2d");return Zm(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Eb(r,e,n)}}),Rb=My({slice3d_:function(t,e,n){const r=by(t,"x","slice3d");return Zm(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Eb(r,e,n)}}),Mb=My({slice4d_:function(t,e,n){const r=by(t,"x","slice4d");return Zm(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Eb(r,e,n)}}),Nb=[yy,{kernelName:"AddN",saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((e,r)=>{n[r]=()=>t.clone()}),n}},hv,pv,Iv,Ev,Vv,jv,Jv,Zv,ib,ob,lb,{kernelName:"Identity",gradFunc:t=>({x:()=>t.toFloat()})},cb,pb,{kernelName:"PadV2",inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map(t=>t[0]);return{x:()=>t.slice(a,r.shape)}}},gb,db,mb,yb,vb,{kernelName:"Tile",inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:i}=n;return{x:()=>{let e=Yy(r);if(1===r.rank)for(let n=0;n<i[0];++n)e=a_(e,Eb(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)e=a_(e,Eb(t,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let s=0;s<i[2];++s)e=a_(e,Eb(t,[n*r.shape[0],a*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+`${r.rank} tensors yet.`);for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let s=0;s<i[2];++s)for(let o=0;o<i[3];++o)e=a_(e,Eb(t,[n*r.shape[0],a*r.shape[1],s*r.shape[2],o*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:"Transpose",gradFunc:(t,e,n)=>{const r=n,{perm:i}=r,a=Ey(i);return{x:()=>hb(t,a)}}},_b];for(const l9 of Nb)Vm(l9);let Ob;Mm().get("IS_BROWSER")&&Mm().setPlatform("browser",new class{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}),Mm().get("IS_NODE")&&Mm().setPlatform("node",new class{constructor(){this.util=n(2),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=Mm().global.fetch?Mm().global.fetch(t,e):(null==Ob&&(Ob=n(1)),Ob(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}});const Pb={float32:4,int32:4,uint16:2,uint8:1,bool:1};async function Fb(t,e){const n=[],r=[],i=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);for(let a=0;a<i.length;++a){const s=i[a],o=Array.isArray(t)?t[a].tensor:t[s];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype)throw new Error(`Unsupported dtype in weight '${s}': ${o.dtype}`);const l={name:s,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){const t=new Promise(async t=>{const e=await o.bytes(),n=e.reduce((t,e)=>t+e.length,0)+4*e.length,r=new Uint8Array(n);let i=0;for(let a=0;a<e.length;a++){const t=e[a],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,i),i+=4,r.set(t,i),i+=t.length}t(r)});r.push(t)}else r.push(o.data());null!=e&&(l.group=e),n.push(l)}return{data:zb(await Promise.all(r)),specs:n}}function Lb(t,e){const n={};let r=0;for(const i of e){const e=i.name,a=i.dtype,s=i.shape,o=eg(s);let l;if("quantization"in i){const n=i.quantization;if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Weight ${i.name} has unknown `+`quantization dtype ${n.dtype}. `+"Supported quantization dtypes are: 'uint8' and 'uint16'.");const s=Pb[n.dtype],u=t.slice(r,r+o*s),c="uint8"===n.dtype?new Uint8Array(u):new Uint16Array(u);if("float32"===a){l=new Float32Array(c.length);for(let t=0;t<c.length;t++)l[t]=c[t]*n.scale+n.min}else{if("int32"!==a)throw new Error(`Unsupported dtype in weight '${e}': ${a}`);l=new Int32Array(c.length);for(let t=0;t<c.length;t++)l[t]=Math.round(c[t]*n.scale+n.min)}r+=o*s}else if("string"===a){const e=eg(i.shape);l=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(r,r+4))[0];r+=4;const n=new Uint8Array(t.slice(r,r+e));l.push(n),r+=e}}else{const n=Pb[a],i=t.slice(r,r+o*n);if("float32"===a)l=new Float32Array(i);else if("int32"===a)l=new Int32Array(i);else{if("bool"!==a)throw new Error(`Unsupported dtype in weight '${e}': ${a}`);l=new Uint8Array(i)}r+=o*n}n[e]=Fy(l,s,a)}return n}function zb(t){if(null===t)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${t.constructor.name}`)});const r=new Uint8Array(e);let i=0;return n.forEach(t=>{r.set(new Uint8Array(t.buffer),i),i+=t.byteLength}),r.buffer}const $b="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Bb(t){return $b?Buffer.byteLength(t):new Blob([t]).size}function Wb(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(t=>{n.set(new Uint8Array(t),r),r+=t.byteLength}),n.buffer}function qb(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function Vb(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Bb(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Bb(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}class Ub{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Ub.instance&&(Ub.instance=new Ub),Ub.instance}static registerSaveRouter(t){Ub.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Ub.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Ub.getHandlers(t,"save")}static getLoadHandlers(t,e){return Ub.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[];return("load"===e?Ub.getInstance().loadRouters:Ub.getInstance().saveRouters).forEach(e=>{const i=e(t,n);null!==i&&r.push(i)}),r}}const jb=t=>Ub.registerSaveRouter(t),Hb=t=>Ub.registerLoadRouter(t),Gb=t=>Ub.getSaveHandlers(t),Jb=(t,e)=>Ub.getLoadHandlers(t,e);class Xb{constructor(){this.managers={}}static getInstance(){return null==Xb.instance&&(Xb.instance=new Xb),Xb.instance}static registerManager(t,e){Zm(null!=t,()=>"scheme must not be undefined or null."),t.endsWith("://")&&(t=t.slice(0,t.indexOf("://"))),Zm(t.length>0,()=>"scheme must not be an empty string.");const n=Xb.getInstance();Zm(null==n.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),n.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function Kb(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+`${Xb.getSchemes().join(",")}`);return{scheme:t.split("://")[0],path:t.split("://")[1]}}async function Zb(t,e,n=!1){Zm(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Ub.getLoadHandlers(t);Zm(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),Zm(r.length<2,()=>`Copying failed because more than one (${r.length}) `+`load handlers for source URL ${t}.`);const i=r[0],a=Ub.getSaveHandlers(e);Zm(a.length>0,()=>"Copying failed because no save handler is found for destination "+`URL ${e}.`),Zm(a.length<2,()=>`Copying failed because more than one (${r.length}) `+`save handlers for destination URL ${e}.`);const s=a[0],o=Kb(t).scheme,l=Kb(t).path,u=o===Kb(t).scheme,c=await i.load();n&&u&&await Xb.getManager(o).removeModel(l);const h=await s.save(c);return n&&!u&&await Xb.getManager(o).removeModel(l),h.modelArtifactsInfo}async function Yb(){const t=Xb.getSchemes(),e={};for(const n of t){const t=await Xb.getManager(n).listModels();for(const r in t)e[n+"://"+r]=t[r]}return e}async function Qb(t){const e=Kb(t);return Xb.getManager(e.scheme).removeModel(e.path)}async function tx(t,e){return Zb(t,e,!1)}async function ex(t,e){return Zb(t,e,!0)}function nx(){if(!Mm().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function rx(t){const e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}class ix{constructor(t){if(this.indexedDB=nx(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,n)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>rx(r),r.onsuccess=()=>{const i=r.result;if(null==e){const e=i.transaction("models_store","readonly"),r=e.objectStore("models_store").get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' `+"in IndexedDB."));t(r.result.modelArtifacts)},r.onerror=t=>(i.close(),n(r.error)),e.oncomplete=()=>i.close()}else{const r=Vb(e),a=i.transaction("model_info_store","readwrite");let s=a.objectStore("model_info_store");const o=s.put({modelPath:this.modelPath,modelArtifactsInfo:r});let l;o.onsuccess=()=>{l=i.transaction("models_store","readwrite");const o=l.objectStore("models_store").put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r});o.onsuccess=()=>t({modelArtifactsInfo:r}),o.onerror=t=>{s=a.objectStore("model_info_store");const e=s.delete(this.modelPath);e.onsuccess=()=>(i.close(),n(o.error)),e.onerror=t=>(i.close(),n(o.error))}},o.onerror=t=>(i.close(),n(o.error)),a.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}}},r.onerror=t=>n(r.error)})}}ix.URL_SCHEME="indexeddb://";const ax=t=>{return Mm().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ix.URL_SCHEME)?(e=t.slice(ix.URL_SCHEME.length),new ix(e)):null;var e};Ub.registerSaveRouter(ax),Ub.registerLoadRouter(ax);class sx{constructor(){this.indexedDB=nx()}async listModels(){return new Promise((t,e)=>{const n=this.indexedDB.open("tensorflowjs",1);n.onupgradeneeded=()=>rx(n),n.onsuccess=()=>{const r=n.result,i=r.transaction("model_info_store","readonly"),a=i.objectStore("model_info_store").getAll();a.onsuccess=()=>{const e={};for(const t of a.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},a.onerror=t=>(r.close(),e(a.error)),i.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)})}async removeModel(t){var e;return t=(e=t).startsWith(ix.URL_SCHEME)?e.slice(ix.URL_SCHEME.length):e,new Promise((e,n)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>rx(r),r.onsuccess=()=>{const i=r.result,a=i.transaction("model_info_store","readwrite"),s=a.objectStore("model_info_store"),o=s.get(t);let l;o.onsuccess=()=>{if(null==o.result)return i.close(),n(new Error(`Cannot find model with path '${t}' `+"in IndexedDB."));{const r=s.delete(t),a=()=>{l=i.transaction("models_store","readwrite");const r=l.objectStore("models_store").delete(t);r.onsuccess=()=>e(o.result.modelArtifactsInfo),r.onerror=t=>n(o.error)};r.onsuccess=a,r.onerror=t=>(a(),i.close(),n(o.error))}},o.onerror=t=>(i.close(),n(o.error)),a.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}},r.onerror=t=>n(r.error)})}}if(Mm().getBool("IS_BROWSER"))try{Xb.registerManager(ix.URL_SCHEME,new sx)}catch(s9){}const ox="tensorflowjs_models",lx="info",ux="model_topology",cx="weight_specs",hx="weight_data",dx="model_metadata";function px(t){return{info:[ox,t,lx].join("/"),topology:[ox,t,ux].join("/"),weightSpecs:[ox,t,cx].join("/"),weightData:[ox,t,hx].join("/"),modelMetadata:[ox,t,dx].join("/")}}function fx(t){const e=t.split("/");if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join("/")}class mx{constructor(t){if(!Mm().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=px(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Vb(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if($b)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),{modelArtifactsInfo:r}}catch(s9){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: `+"size quota being exceeded is a possible cause of this failure: "+`modelTopologyBytes=${r.modelTopologyBytes}, `+`weightSpecsBytes=${r.weightSpecsBytes}, `+`weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' `+"is missing.");e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' `+"are missing.");e.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const t=JSON.parse(i);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,e.userDefinedMetadata=t.userDefinedMetadata}const a=this.LS.getItem(this.keys.weightData);if(null==a)throw new Error("In local storage, the binary weight values of model "+`'${this.modelPath}' are missing.`);return e.weightData=function(t){if($b){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}(a),e}}mx.URL_SCHEME="localstorage://";const gx=t=>{return Mm().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(mx.URL_SCHEME)?(e=t.slice(mx.URL_SCHEME.length),new mx(e)):null;var e};Ub.registerSaveRouter(gx),Ub.registerLoadRouter(gx);class yx{constructor(){Zm(Mm().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Zm("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=ox+"/",n="/"+lx;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);i.startsWith(e)&&i.endsWith(n)&&(t[fx(i)]=JSON.parse(this.LS.getItem(i)))}return t}async removeModel(t){var e;const n=px(t=(e=t).startsWith(mx.URL_SCHEME)?e.slice(mx.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),r}}if(Mm().getBool("IS_BROWSER"))try{Xb.registerManager(mx.URL_SCHEME,new yx)}catch(s9){}function vx(t){return new Promise(t=>setTimeout(t)).then(t)}class _x{constructor(t){if(!Mm().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(_x.URL_SCHEME)&&(t=t.slice(_x.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor;if(r.download=this.modelTopologyFileName,r.href=n,await vx(()=>r.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await vx(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Vb(t)}}}}_x.URL_SCHEME="downloads://";class bx{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+`but received ${t}`);this.files=t}async load(){const t=this.files[0],e=this.files.slice(1);return new Promise((n,r)=>{const i=new FileReader;i.onload=i=>{const a=JSON.parse(i.target.result),s=a.modelTopology;if(null==s)return void r(new Error(`modelTopology field is missing from file ${t.name}`));0===e.length&&n({modelTopology:s});const o=a.weightsManifest;if(null==o)return void r(new Error(`weightManifest field is missing from file ${t.name}`));let l;try{l=this.checkManifestAndWeightFiles(o,e)}catch(s9){return void r(s9)}const u=[],c=[],h=[];o.forEach(t=>{t.paths.forEach(t=>{c.push(t),h.push(null)}),u.push(...t.weights)}),o.forEach(t=>{t.paths.forEach(t=>{const e=new FileReader;e.onload=e=>{const r=e.target.result,i=c.indexOf(t);h[i]=r,-1===h.indexOf(null)&&n({modelTopology:s,weightSpecs:u,weightData:Wb(h),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy,userDefinedMetadata:a.userDefinedMetadata})},e.onerror=e=>r(`Failed to weights data from file of path '${t}'.`),e.readAsArrayBuffer(l[t])})})},i.onerror=e=>r("Failed to read model topology and weights manifest JSON "+`from file '${t.name}'. BrowserFiles supports loading `+"Keras-style tf.Model artifacts only."),i.readAsText(t)})}checkManifestAndWeightFiles(t,e){const n=[],r=e.map(t=>qb(t.name)),i={};for(const a of t)a.paths.forEach(t=>{const a=qb(t);if(-1!==n.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: "+`'${a}'`);if(n.push(a),-1===r.indexOf(a))throw new Error(`Weight file with basename '${a}' is not provided.`);i[t]=e[r.indexOf(a)]});if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest "+`(${n.length}) and the number of weight files provided `+`(${e.length}).`);return i}}function xx(t){return new bx(t)}function wx(t,e,n,r){!function(t){Zm(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}(t),function(t,e){Zm(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but "+`got startFraction ${t}`),Zm(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but "+`got endFraction ${e}`),Zm(e>=t,()=>"startFraction must be no more than endFraction, but "+`got startFraction ${t} and endFraction `+`${e}`)}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(t.map(a=>(a.then(a=>{const s=n+ ++i/t.length*(r-n);return e(s),a}),a)))}async function Sx(t,e){null==e&&(e={});const n=null==e.fetchFunc?Mm().platform.fetch:e.fetchFunc,r=t.map(t=>n(t,e.requestInit,{isBinary:!0})),i=(null==e.onProgress?await Promise.all(r):await wx(r,e.onProgress,0,.5)).map(t=>t.arrayBuffer());return null==e.onProgress?await Promise.all(i):await wx(i,e.onProgress,.5,1)}async function Cx(t,e="",n,r){return Dx(t=>Sx(t,{requestInit:r}))(t,e,n)}function Dx(t){return async(e,n="",r)=>{const i=e.map(()=>!1),a={},s=null!=r?r.map(()=>!1):[],o=[];if(e.forEach((t,e)=>{let n=0;t.weights.forEach(t=>{const l=Pb["quantization"in t?t.quantization.dtype:t.dtype]*eg(t.shape),u=()=>{i[e]=!0,null==a[e]&&(a[e]=[]),a[e].push({manifestEntry:t,groupOffset:n,sizeBytes:l})};null!=r?r.forEach((e,n)=>{e===t.name&&(u(),s[n]=!0)}):u(),o.push(t.name),n+=l})}),!s.every(t=>t)){const t=r.filter((t,e)=>!s[e]);throw new Error("Could not find weights in manifest with names: "+`${t.join(", ")}. \n`+"Manifest JSON has weights with names: "+`${o.join(", ")}.`)}const l=i.reduce((t,e,n)=>(e&&t.push(n),t),[]),u=[];l.forEach(t=>{e[t].paths.forEach(t=>{const e=n+(n.endsWith("/")?"":"/")+t;u.push(e)})});const c=await t(u),h={};let d=0;return l.forEach(t=>{const n=e[t].paths.length;let r=0;for(let e=0;e<n;e++)r+=c[d+e].byteLength;const i=new ArrayBuffer(r),s=new Uint8Array(i);let o=0;for(let e=0;e<n;e++){const t=new Uint8Array(c[d+e]);s.set(t,o),o+=t.byteLength}a[t].forEach(t=>{const e=Lb(i.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(const n in e)h[n]=e[n]}),d+=n}),h}}Ub.registerSaveRouter(t=>Mm().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(_x.URL_SCHEME)?function(t="model"){return new _x(t)}(t.slice(_x.URL_SCHEME.length)):null);class Ix{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(Zm("function"==typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=Mm().platform.fetch,Zm(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&Zm(2===t.length,()=>"URL paths for http must have a length of 2, "+`(actual length is ${t.length}).`),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const n=await this.fetch(this.path,e);if(n.ok)return{modelArtifactsInfo:Vb(t),responses:[n]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+`${n.status}.`)}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code `+`${t.status}. Please verify this URL points to `+"the model JSON of the model to load.");let e;try{e=await t.json()}catch(c){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,r=e.weightsManifest,i=e.generatedBy,a=e.convertedBy,s=e.format,o=e.userDefinedMetadata;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model `+"topology or manifest for weights.");let l,u;if(null!=r){const t=await this.loadWeights(r);[l,u]=t}return{modelTopology:n,weightSpecs:l,weightData:u,userDefinedMetadata:o,generatedBy:i,convertedBy:a,format:s}}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),i=this.weightPathPrefix||n,a=[];for(const o of t)a.push(...o.weights);const s=[];return t.forEach(t=>{t.paths.forEach(t=>{s.push(i+t+r)})}),[a,Wb(await Sx(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress}))]}}function kx(t){return null!=t.match(Ix.URL_SCHEME_REGEX)}Ix.URL_SCHEME_REGEX=/^https?:\/\//;const Ex=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every(t=>kx(t)):kx(t),n)return Ax(t,e)}return null};function Ax(t,e){return new Ix(t,e)}function Tx(t,e){return Ax(t,e)}Ub.registerSaveRouter(Ex),Ub.registerLoadRouter(Ex);class Rx{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class Mx{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function Nx(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Rx(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Rx({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Rx({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function Ox(t){return new Mx(t)}const Px=My({oneHot_:function(t,e,n=1,r=0){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);let i=by(t,"indices","oneHot","int32");const a=[...i.shape,e];return i=i.flatten(),cy.runKernelFunc((t,s)=>(s([i]),av(t.oneHot(i,e,n,r),a)),{indices:i},null,"OneHot",{depth:e,onValue:n,offValue:r})}});let Fx;async function Lx(t,e){let n=by(t,"img","toPixels");if(!(t instanceof Jg)){const t=n;n=t.toInt(),t.dispose()}if(2!==n.rank&&3!==n.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,i]=n.shape.slice(0,2),a=2===n.rank?1:n.shape[2];if(a>4||2===a)throw new Error("toPixels only supports depth of size "+`1, 3 or 4 but got ${a}`);const s=await n.data(),o=n.min(),l=n.max(),u=await Promise.all([o.data(),l.data()]),c=u[0][0],h=u[1][0];if(o.dispose(),l.dispose(),"float32"===n.dtype){if(c<0||h>1)throw new Error("Tensor values for a float32 Tensor must be in the "+`range [0 - 1] but got range [${c} - ${h}].`)}else{if("int32"!==n.dtype)throw new Error(`Unsupported type for toPixels: ${n.dtype}.`+" Please use float32 or int32 tensors.");if(c<0||h>255)throw new Error("Tensor values for a int32 Tensor must be in the "+`range [0 - 255] but got range [${c} - ${h}].`)}const d="float32"===n.dtype?255:1,p=new Uint8ClampedArray(i*r*4);for(let f=0;f<r*i;++f){let t,e,n,r;1===a?(t=s[f]*d,e=s[f]*d,n=s[f]*d,r=255):3===a?(t=s[3*f]*d,e=s[3*f+1]*d,n=s[3*f+2]*d,r=255):4===a&&(t=s[4*f]*d,e=s[4*f+1]*d,n=s[4*f+2]*d,r=s[4*f+3]*d);const i=4*f;p[i+0]=Math.round(t),p[i+1]=Math.round(e),p[i+2]=Math.round(n),p[i+3]=Math.round(r)}if(null!=e){e.width=i,e.height=r;const t=e.getContext("2d"),n=new ImageData(p,i,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),p}My({confusionMatrix_:function(t,e,n){const r=by(t,"labels","confusionMatrix"),i=by(e,"predictions","confusionMatrix");Zm(null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, "+`but got ${n}`),Zm(1===r.rank,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),Zm(1===i.rank,()=>"Expected the rank of predictions to be 1, "+`but got ${i.rank}`),Zm(r.shape[0]===i.shape[0],()=>"Mismatch in the number of examples: "+`${r.shape[0]} vs. ${i.shape[0]}. `+"Labels and predictions should have the same number of elements."),Zm(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got "+`${n}`);const a=Px(r.asType("int32"),n),s=Px(i.asType("int32"),n);return a.transpose().matMul(s).asType("int32")}});const zx=My({fromPixels_:function(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,a=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+`but was ${t.constructor.name}`);s=!0}if(i){const e=2;if(i&&t.readyState<e)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=$m("FromPixels",cy.backendName))return cy.runKernel("FromPixels",{pixels:t},{numChannels:e});const[o,l]=i?[t.videoWidth,t.videoHeight]:[t.width,t.height];let u,c;if(s?u=t.getContext("2d").getImageData(0,0,o,l).data:r||n?u=t.data:(a||i)&&(null==Fx&&(Fx=document.createElement("canvas").getContext("2d")),Fx.canvas.width=o,Fx.canvas.height=l,Fx.drawImage(t,0,0,o,l),u=Fx.getImageData(0,0,o,l).data),4===e)c=new Int32Array(u);else{const t=o*l;c=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)c[n*e+t]=u[4*n+t]}return Wy(c,[l,o,e],"int32")}});function $x(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+` but the rank was ${t.rank}.`);if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+` but the rank was ${e.rank}.`);if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+` but the dtype was ${e.dtype}.`);if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+`${e.shape[e.rank-1]} vs. ${t.rank}`);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty."+` Input shape: ${t.shape}.`);const n=e.shape,r=n[n.length-1];let i=1;for(let u=0;u<n.length-1;++u)i*=n[u];const a=t.shape,s=n.slice();s.pop();let o=1;for(let u=r;u<t.rank;++u)o*=a[u],s.push(a[u]);const l=[...kg(t.shape).map(t=>t/o),1].slice(0,r);return[s,i,o,l]}function Bx(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+`shape[sliceDim:], got updates.shape: ${n.shape}`+`, indices.shape: ${e.shape}, shape: ${t}`+`, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(t.length<r+(n.rank-i))throw new Error(a+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+t.length-r)throw new Error(a+` update.rank != ${i+t.length-r}`);for(let s=0;s<i;++s)if(n.shape[s]!==e.shape[s])throw new Error(a+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${e.shape[s]}).`);for(let s=0;s<n.rank-i;++s)if(n.shape[s+i]!==t[s+r])throw new Error(a+` updates.shape[${s+i}] (${n.shape[s+i]}) != shape[${s+i}] (${t[s+i]})`)}function Wx(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+` but the rank was ${e.rank}.`);if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+` but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===e.size)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(0===t.size)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}Bx(n,e,t)}function qx(t,e,n){const r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length;let s=1;for(let l=i;l<a;++l)s*=n[l];const o=i<1?1:i;return{sliceRank:i,numUpdates:eg(e.shape)/o,sliceSize:s,strides:[...kg(n.slice(0,i)),1],outputSize:eg(n)}}class Vx{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class Ux{constructor(){this.classNameMap={}}static getMap(){return null==Ux.instance&&(Ux.instance=new Ux),Ux.instance}static register(t){Ux.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function jx(t){Zm(null!=t.className,()=>"Class being registered does not have the static className property defined."),Zm("string"==typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),Zm(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Ux.register(t)}const Hx=My({addN_:function(t){Zm(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),Zm(t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+`${t.length}`);const e=t.map((t,e)=>by(t,`tensors${e}`,"addN")),n=e[0];return e.forEach(t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!rg(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),cy.runKernelFunc((t,n)=>{const r=t.addN(e);return n(e),r},e,null,"AddN")}});function Gx(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}const Jx=My({batchNorm_:function(t,e,n,r,i,a){null==a&&(a=.001);const s=by(t,"x","batchNorm"),o=by(e,"mean","batchNorm"),l=by(n,"variance","batchNorm");let u,c;null!=i&&(u=by(i,"scale","batchNorm")),null!=r&&(c=by(r,"offset","batchNorm")),Zm(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Zm(null==c||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Zm(null==u||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h=function(t){let e;return e=0===t.rank||1===t.rank?t.as4D(1,1,1,t.size):2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t,e}(s),d=cy.runKernelFunc((t,e)=>(e([h,o,l,u]),t.batchNorm(h,Gx(o),Gx(l),Gx(c),Gx(u),a)),{x:h,scale:u,offset:c,mean:o,variance:l},null,"FusedBatchNorm",{varianceEpsilon:a});return av(d,s.shape)}}),Xx=My({batchNorm2d_:function(t,e,n,r,i,a){const s=by(t,"x","batchNorm"),o=by(e,"mean","batchNorm"),l=by(n,"variance","batchNorm");let u,c;return null!=i&&(u=by(i,"scale","batchNorm")),null!=r&&(c=by(r,"offset","batchNorm")),Zm(2===s.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+`${s.rank}.`),Zm(2===o.rank||1===o.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+`got rank ${o.rank}.`),Zm(2===l.rank||1===l.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+`but got rank ${l.rank}.`),null!=u&&Zm(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+`but got rank ${u.rank}.`),null!=c&&Zm(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+`but got rank ${c.rank}.`),Jx(s,o,l,c,u,a)}}),Kx=My({batchNorm3d_:function(t,e,n,r,i,a){const s=by(t,"x","batchNorm"),o=by(e,"mean","batchNorm"),l=by(n,"variance","batchNorm");let u,c;return null!=i&&(u=by(i,"scale","batchNorm")),null!=r&&(c=by(r,"offset","batchNorm")),Zm(3===s.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+`${s.rank}.`),Zm(3===o.rank||1===o.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+`got rank ${o.rank}.`),Zm(3===l.rank||1===l.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+`but got rank ${l.rank}.`),null!=u&&Zm(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+`but got rank ${u.rank}.`),null!=c&&Zm(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+`but got rank ${c.rank}.`),Jx(s,o,l,c,u,a)}}),Zx=My({batchNorm4d_:function(t,e,n,r,i,a){const s=by(t,"x","batchNorm"),o=by(e,"mean","batchNorm"),l=by(n,"variance","batchNorm");let u,c;return null!=i&&(u=by(i,"scale","batchNorm")),null!=r&&(c=by(r,"offset","batchNorm")),Zm(4===s.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+`${s.rank}.`),Zm(4===o.rank||1===o.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+`got rank ${o.rank}.`),Zm(4===l.rank||1===l.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+`but got rank ${l.rank}.`),null!=u&&Zm(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+`but got rank ${u.rank}.`),null!=c&&Zm(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+`but got rank ${c.rank}.`),Jx(s,o,l,c,u,a)}}),Yx=My({clone_:function(t){const e=by(t,"x","clone",null);return cy.runKernelFunc(()=>cy.makeTensorFromDataId(e.dataId,e.shape,e.dtype),{x:e},null,"Identity")}}),Qx=My({broadcastTo_:function(t,e){let n=by(t,"broadcastTo","x");const r=n.shape;if(e.some(t=>!(t>0)||t%1!=0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=av(n,t)}const i=n.shape,a=Array.from(e);for(let s=e.length-1;s>=0;s--)if(i[s]===e[s])a[s]=1;else if(1!==n.shape[s])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);return 0===a.map((t,e)=>t>1?e:-1).filter(t=>t>=0).length?Yx(n):cy.runKernelFunc(t=>t.tile(n,a),{x:n},null,"BroadcastTo",{shape:e,inputShape:i})}}),tw=My({concat1d_:function(t){return Qy(t,0)}}),ew=My({concat2d_:function(t,e){return Qy(t,e)}}),nw=My({concat3d_:function(t,e){return Qy(t,e)}}),rw=My({concat4d_:function(t,e){return Qy(t,e)}}),iw=My({conv1d_:function(t,e,n,r,i="NWC",a=1,s){const o=by(t,"x","conv1d"),l=by(e,"filter","conv1d");let u=o,c=!1;2===o.rank&&(c=!0,u=av(o,[1,o.shape[0],o.shape[1]])),Zm(3===u.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),Zm(3===l.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+`${l.rank}.`),null!=s&&Zm(ig(r),()=>"Error in conv1d: pad must be an integer when using, "+`dimRoundingMode ${s} but got pad ${r}.`),Zm(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match `+`input depth for filter ${l.shape[1]}.`),Zm($v(n,a),()=>"Error in conv1D: Either stride or dilation must be 1. "+`Got stride ${n} and dilation '${a}'`),Zm("NWC"===i,()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const h=av(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=av(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=Uv(d,h,[1,n],r,"NHWC",[1,a],s);return av(p,c?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}}),aw=My({conv2dTranspose_:function(t,e,n,r,i,a){const s=by(t,"x","conv2dTranspose"),o=by(e,"filter","conv2dTranspose");return qv(n,s,o,r,i,"NHWC",a)}}),sw=My({conv3d_:function(t,e,n,r,i="NDHWC",a=[1,1,1]){const s=by(t,"x","conv3d"),o=by(e,"filter","conv3d");let l=s,u=!1;4===s.rank&&(u=!0,l=av(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Zm(5===l.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),Zm(5===o.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+`${o.rank}.`),Zm(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match `+`input depth for filter ${o.shape[3]}.`),Zm($v(n,a),()=>"Error in conv3D: Either strides or dilations must be 1. "+`Got strides ${n} and dilations '${a}'`),Zm("NDHWC"===i,()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`);const c=cy.runKernelFunc((t,e)=>{const i=Mv(l.shape,o.shape,n,a,r),s=t.conv3d(l,o,i);return e([l,o]),s},{x:l,filter:o},null,"Conv3D",{strides:n,pad:r,dataFormat:i,dilations:a});return u?c.as4D(c.shape[1],c.shape[2],c.shape[3],c.shape[4]):c}}),ow=My({conv3dTranspose_:function(t,e,n,r,i){const a=by(t,"x","conv3dTranspose"),s=by(e,"filter","conv3dTranspose");return Gv(n,a,s,r,i)}}),lw=My({depthToSpace_:function(t,e,n="NHWC"){const r=by(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];return Zm(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${e}  for depthToSpace with input shape\n    ${r.shape}`),Zm(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${e} for depthToSpace with input shape\n        ${r.shape}`),Zm(s%(e*e)==0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${s} for depthToSpace with input shape ${r.shape}`),cy.runKernelFunc(t=>t.depthToSpace(r,e,n),{x:r},null,"DepthToSpace",{blockSize:e,dataFormat:n})}}),uw=My({depthwiseConv2d_:function(t,e,n,r,i="NHWC",a=[1,1],s){const o=by(t,"x","depthwiseConv2d"),l=by(e,"filter","depthwiseConv2d");let u=o,c=!1;3===o.rank&&(c=!0,u=av(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Zm(4===u.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+`rank ${u.rank}.`),Zm(4===l.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+`${l.rank}.`),Zm(u.shape[3]===l.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+`(${u.shape[3]}) must match the inChannels dimension in `+`filter ${l.shape[2]}.`),null!=s&&Zm(ig(r),()=>"Error in depthwiseConv2d: pad must be an integer when using, "+`dimRoundingMode ${s} but got pad ${r}.`);const h=cy.runKernelFunc((t,e)=>{null==a&&(a=[1,1]),Zm($v(n,a),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+`1. Got strides ${n} and dilations '${a}'`);const i=Rv(u.shape,l.shape,n,a,r,s,!0),o=t.depthwiseConv2D(u,l,i);return e([u,l]),o},{x:u,filter:l},null,"DepthwiseConv2dNative",{strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s});return c?av(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),cw=My({diag_:function(t){const e=by(t,"x","diag").flatten();return cy.runKernelFunc(n=>{const r=n.diag(e),i=[...t.shape,...t.shape];return av(r,i)},{x:e},null,"Diag")}});function hw(t,e){const n=[];for(let a=0;a<e.length;a++)e[a]&&n.push(a);const r=tv(t,"int32"),i=tv([n.length,t.length],"int32");for(let a=0;a<n.length;a++){const e=r.indexToLoc(n[a]);i.values.set(e,a*t.length)}return i.toTensor()}const dw=My({logicalAnd_:function(t,e){const n=by(t,"a","logicalAnd","bool"),r=by(e,"b","logicalAnd","bool");return gy(n.shape,r.shape),cy.runKernelFunc(t=>t.logicalAnd(n,r),{a:n,b:r},null,"LogicalAnd")}}),pw=My({logicalNot_:function(t){const e=by(t,"x","logicalNot","bool");return cy.runKernelFunc(t=>t.logicalNot(e),{$x:e})}}),fw=My({logicalOr_:function(t,e){const n=by(t,"a","logicalOr","bool"),r=by(e,"b","logicalOr","bool");return gy(n.shape,r.shape),cy.runKernelFunc(t=>t.logicalOr(n,r),{$a:n,$b:r})}}),mw=My({logicalXor_:function(t,e){const n=by(t,"a","logicalXor","bool"),r=by(e,"b","logicalXor","bool");return gy(n.shape,r.shape),fw(t,e).logicalAnd(dw(t,e).logicalNot())}}),gw=My({where_:function(t,e,n){const r=by(e,"a","where"),i=by(n,"b","where"),a=by(t,"condition","where","bool");return Ym(r.shape,i.shape,"Error in where: "),1===a.rank?Zm(a.shape[0]===r.shape[0],()=>"The first dimension of `a` must match the size of `condition`."):Ym(a.shape,i.shape,"Error in where: "),cy.runKernelFunc((t,e)=>{const n=t.select(a,r,i);return e([a]),n},{$condition:a,$a:r,$b:i},(t,e)=>{const[n]=e;return{$condition:()=>Yy(n).toFloat(),$a:()=>t.mul(n.cast(t.dtype)),$b:()=>t.mul(n.logicalNot().cast(t.dtype))}})}}),yw=async function(t){const e=by(t,"condition","whereAsync","bool"),n=await e.data(),r=hw(e.shape,n);return t!==e&&e.dispose(),r},vw=My({divNoNan_:function(t,e){let n=by(t,"a","div"),r=by(e,"b","div");[n,r]=iy(n,r);const i=nb(n,r),a=Yy(i),s=r.equal(a);return gw(s,a,i)}}),_w=My({dot_:function(t,e){const n=by(t,"t1","dot"),r=by(e,"t2","dot");Zm(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+`${n.rank} and ${r.rank}.`);const i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(Zm(i===a,()=>"Error in dot: inner dimensions of inputs must match, but got "+`${i} and ${a}.`),1===n.rank&&1===r.rank){const t=av(n,[1,-1]),e=av(r,[-1,1]),i=cv(t,e);return av(i,[])}if(1===n.rank&&2===r.rank){const t=av(n,[1,-1]),e=av(r,[r.shape[0],r.shape[1]]),i=cv(t,e);return av(i,[i.size])}if(2===n.rank&&1===r.rank){const t=av(r,[-1,1]),e=cv(n,t);return av(e,[e.size])}{const t=av(r,[r.shape[0],r.shape[1]]);return cv(n,t)}}}),bw=My({equal_:function(t,e){let n=by(t,"a","equal"),r=by(e,"b","equal");return[n,r]=iy(n,r),gy(n.shape,r.shape),cy.runKernelFunc(t=>t.equal(n,r),{a:n,b:r},null,"Equal")}}),xw=My({eye_:function(t,e,n,r="float32"){null==e&&(e=t);const i=tv([t,e],r),a=t<=e?t:e;for(let o=0;o<a;++o)i.set(1,o,o);const s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return sb(iv(s,0),[n[0],1,1]);if(2===n.length)return sb(iv(iv(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return sb(iv(iv(iv(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+`batchShapes, but received ${n.length}D.`)}}),ww=My({greater_:function(t,e){let n=by(t,"a","greater"),r=by(e,"b","greater");return[n,r]=iy(n,r),gy(n.shape,r.shape),cy.runKernelFunc(t=>t.greater(n,r),{a:n,b:r},null,"Greater")}}),Sw=My({greaterEqual_:function(t,e){let n=by(t,"a","greaterEqual"),r=by(e,"b","greaterEqual");return[n,r]=iy(n,r),gy(n.shape,r.shape),cy.runKernelFunc((t,e)=>{const i=t.greaterEqual(n,r);return e([n,r]),i},{a:n,b:r},null,"GreaterEqual")}}),Cw=My({less_:function(t,e){let n=by(t,"a","less"),r=by(e,"b","less");return[n,r]=iy(n,r),gy(n.shape,r.shape),cy.runKernelFunc(t=>t.less(n,r),{a:n,b:r},null,"Less")}}),Dw=My({lessEqual_:function(t,e){let n=by(t,"a","lessEqual"),r=by(e,"b","lessEqual");return[n,r]=iy(n,r),gy(n.shape,r.shape),cy.runKernelFunc((t,e)=>{const i=t.lessEqual(n,r);return e([n,r]),i},{a:n,b:r},null,"LessEqual")}}),Iw=My({localResponseNormalization_:function(t,e=5,n=1,r=1,i=.5){const a=by(t,"x","localResponseNormalization");Zm(4===a.rank||3===a.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${a.rank}.`),Zm(ig(e),()=>"Error in localResponseNormalization: depthRadius must be an "+`integer but got depthRadius ${e}.`);let s=a,o=!1;3===a.rank&&(o=!0,s=av(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l=cy.runKernelFunc((t,a)=>{const o=t.localResponseNormalization4D(s,e,n,r,i);return a([s,o]),o},{x:s},null,"LRN",{depthRadius:e,bias:n,alpha:r,beta:i});return o?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),kw=My({max_:function(t,e=null,n=!1){const r=by(t,"x","max"),i=cy.runKernelFunc((t,n)=>{let i=hg(e,r.shape);const a=ky(i,r.rank);let s=r;null!=a&&(s=hb(r,a),i=Ay(i.length,s.rank));const o=t.max(s,i);return n([r,o]),null!=a&&t.disposeData(s.dataId),o},{x:r},null,"Max",{reductionIndices:e,keepDims:n});return n?av(i,Dy(i.shape,hg(e,r.shape))):i}}),Ew=My({multinomial_:function(t,e,n,r=!1){const i=by(t,"logits","multinomial"),a=i.size,s=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+`${a}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);n=n||Math.random();const o=1===s?i.as2D(1,-1):i,l=cy.runKernelFunc(t=>t.multinomial(o,r,e,n),{logits2D:o});return 1===s?l.as1D():l}}),Aw=My({notEqual_:function(t,e){let n=by(t,"a","notEqual"),r=by(e,"b","notEqual");return[n,r]=iy(n,r),gy(n.shape,r.shape),cy.runKernelFunc(t=>t.notEqual(n,r),{a:n,b:r},null,"NotEqual")}}),Tw=My({outerProduct_:function(t,e){const n=by(t,"v1","outerProduct"),r=by(e,"v2","outerProduct");Zm(1===n.rank&&1===r.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+`${n.rank} and ${r.rank}.`);const i=av(n,[-1,1]),a=av(r,[1,-1]);return cv(i,a)}}),Rw=My({pad1d_:function(t,e,n=0){return Zm(2===e.length,()=>"Invalid number of paddings. Must be length of 2."),bb(t,[e],n)}}),Mw=My({pad2d_:function(t,e,n=0){return Zm(2===e.length&&2===e[0].length&&2===e[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),bb(t,e,n)}}),Nw=My({pad3d_:function(t,e,n=0){return Zm(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),bb(t,e,n)}}),Ow=My({pad4d_:function(t,e,n=0){return Zm(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),bb(t,e,n)}}),Pw=My({rand_:function(t,e,n){const r=eg(t);let i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error(`Unknown data type ${n}`);i=new Uint8Array(r)}for(let a=0;a<r;a++)i[a]=e();return cy.makeTensor(i,t,n)}});var Fw=n("YSVl");class Lw{constructor(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const a=i||Math.random();this.random=Fw.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,i,a;do{r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i}while(a>=1||0===a);const s=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*r*s,e=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class zw{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const i=r||Math.random();this.randu=Fw.alea(i.toString()),this.randn=new Lw(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,i,a;for(;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-a+Math.log(a)),i=this.randu(),i<e||Math.log(i)<n)break}return a*=1/this.beta*this.d,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class $w{constructor(t=0,e=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=Fw.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const Bw=My({randomGamma_:function(t,e,n=1,r="float32",i){if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error(`Unsupported data type ${r}`);const a=new zw(e,n,r,i),s=tv(t,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}}),Ww=My({randomNormal_:function(t,e=0,n=1,r,i){if(null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const a=new Lw(e,n,r,!1,i),s=tv(t,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}}),qw=My({randomUniform_:function(t,e=0,n=1,r="float32",i){const a=tv(t,r),s=new $w(e,n,null,i);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}}),Vw=My({separableConv2d_:function(t,e,n,r,i,a=[1,1],s="NHWC"){const o=by(t,"x","separableConv2d"),l=by(e,"depthwiseFilter","separableConv2d"),u=by(n,"pointwiseFilter","separableConv2d");let c=o,h=!1;if(3===o.rank&&(h=!0,c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Zm(4===c.rank,()=>"Error in separableConv2d: input must be rank 4, but got "+`rank ${c.rank}.`),Zm(4===l.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+`got rank ${l.rank}.`),Zm(4===u.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+`got rank ${l.rank}.`),Zm(1===u.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter "+` must be 1, but got ${u.shape[0]}.`),Zm(1===u.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise "+`filter must be 1, but got ${u.shape[1]}.`);const d=l.shape[2],p=l.shape[3];Zm(u.shape[2]===d*p,()=>"Error in separableConv2d: the third dimension of pointwise filter "+`must be ${d*p}, `+`but got ${u.shape[2]}.`);const f=uw(c,l,r,i,s,a),m=Uv(f,u,1,"valid",s);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Uw=My({squaredDifference_:function(t,e){let n=by(t,"a","squaredDifference"),r=by(e,"b","squaredDifference");return[n,r]=iy(n,r),gy(n.shape,r.shape),cy.runKernelFunc((t,e)=>{const i=t.squaredDifference(n,r);return e([n,r]),i},{a:n,b:r},null,"SquaredDifference",{})}}),jw=My({truncatedNormal_:function(t,e=0,n=1,r,i){if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const a=new Lw(e,n,r,!0,i),s=tv(t,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}}),Hw=30;function Gw(t){return t<=Hw?t:Ig(t,Math.floor(Math.sqrt(t)))}function Jw(t,e){let n,r=!1;for(t<=Hw?(n=t,r=!0):n=Ig(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Ig(t,n+1);return n}function Xw(t,e,n){const r=[],i=t.length;for(let a=0;a<i;a++)r.push(a!==e?t[a]:n);return r}function Kw(t,e,n){const r=t.shape[n],i=[];let a=1,s=1;for(let o=0;o<n;o++)i.push(t.shape[o]),a*=t.shape[o];for(let o=0;o<e.rank;o++)i.push(e.shape[o]);for(let o=n+1;o<t.rank;o++)i.push(t.shape[o]),s*=t.shape[o];return{batchSize:a,sliceSize:s,dimSize:r,outputShape:i}}function Zw(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function Yw(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}const Qw=My({gather_:function(t,e,n=0){const r=by(t,"x","gather"),i=by(e,"indices","gather","int32");n=hg(n,r.shape)[0];const a=Kw(r,i,n);return cy.runKernelFunc((t,e)=>{const a=t.gather(r,i.flatten(),n);return e([i]),a},{x:r,indices:i},(t,e)=>{const[i]=e;return{x:()=>{const e=r.shape,a=i.size,s=e.slice(0,n),o=s.length,l=e.slice(n,e.length).slice(1),u=l.length,c=Zw(0,o),h=Zw(o+1,o+1+u),d=Yw([s,[a],l]),p=t.reshape(d),f=i.reshape([a]),m=Yw([[o],c,h]),g=p.transpose(m);let y=tS(g,f,r.shape[n]);const v=Ey(m);return y=y.transpose(v),y},indices:()=>i}},"Gather",{axis:n}).reshape(a.outputShape)}}),tS=My({unsortedSegmentSum_:function(t,e,n){const r=by(t,"x","unsortedSegmentSum"),i=by(e,"segmentIds","unsortedSegmentSum","int32");return Zm(ig(n),()=>"numSegments must be of dtype int"),cy.runKernelFunc((t,e)=>{const a=t.unsortedSegmentSum(r,i,n);return e([i]),a},{$x:r},(t,e)=>{const[n]=e;return{$x:()=>function(t,e){const n=U_(e,Yy(e)),r=Qw(t,n);let i=Sw(e,zy(0,"int32"));const a=r.rank-i.rank;for(let o=0;o<a;++o)i=iv(i,o+1);i=dw(i,Hy(r.shape,"bool"));const s=Yy(r);return gw(i,r,s)}(t,n)}})}}),eS=async function(t,e,n){const r=by(t,"tensor","boolMask"),i=by(e,"mask","boolMask","bool"),a=null==n?0:n,s=i.rank,o=r.shape;Zm(s>0,()=>"mask cannot be scalar"),Ym(o.slice(a,a+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=a;m<a+s;m++)l*=o[m];const u=o.slice(0,a).concat([l],o.slice(a+s)),c=r.reshape(u),h=i.reshape([-1]),d=await yw(h),p=d.squeeze([1]),f=Qw(c,p,a);return t!==r&&r.dispose(),e!==i&&i.dispose(),p.dispose(),c.dispose(),h.dispose(),d.dispose(),f},nS=My({reverse_:function(t,e){const n=by(t,"x","reverse");if(0===n.rank)return n.clone();const r=hg(e,n.shape);return cy.runKernelFunc(t=>t.reverse(n,r),{$x:n},t=>({$x:()=>t.reverse(r)})).reshapeAs(n)}}),rS=My({reverse1d_:function(t){const e=by(t,"x","reverse");return Zm(1===e.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),nS(e,0)}}),iS=My({reverse2d_:function(t,e){const n=by(t,"x","reverse");return Zm(2===n.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),nS(n,e)}}),aS=My({reverse3d_:function(t,e){const n=by(t,"x","reverse");return Zm(3===n.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),nS(n,e)}}),sS=My({reverse4d_:function(t,e){const n=by(t,"x","reverse");return Zm(4===n.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),nS(n,e)}});function oS(t,e,n,r,i,a){const s=by(t,"x","maxPool");let o=s,l=!1;3===s.rank&&(l=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),null==r&&(r=[1,1]),Zm(4===o.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),Zm($v(n,r),()=>"Error in maxPool: Either strides or dilations must be 1. "+`Got strides ${n} and dilations '${r}'`),null!=a&&Zm(ig(i),()=>"Error in maxPool: pad must be an integer when using, "+`dimRoundingMode ${a} but got pad ${i}.`);const u=Av(o.shape,e,n,r,i,a);if(1===u.filterWidth&&1===u.filterHeight&&rg(u.inShape,u.outShape))return s.clone();const c=cy.runKernelFunc((t,e)=>{const n=t.maxPool(o,u);return e([o,n]),n},{x:o},(t,a)=>{const[s,o]=a;return{x:()=>function(t,e,n,r,i,a,s,o){const l=by(t,"dy","maxPoolBackprop"),u=by(e,"input","maxPoolBackprop"),c=by(n,"output","maxPoolBackprop");Zm(u.rank===l.rank,()=>`Rank of input (${u.rank}) does not match rank of dy `+`(${l.rank})`),null==a&&(a=[1,1]),Zm($v(i,a),()=>"Error in maxPoolBackProp: Either strides or dilations must be 1. "+`Got strides ${i} and dilations '${a}'`),Zm(4===l.rank,()=>"Error in maxPoolBackprop: dy must be rank 4 but got rank "+`${l.rank}.`),Zm(4===u.rank,()=>"Error in maxPoolBackprop: input must be rank 4 but got rank "+`${u.rank}.`);const h=Av(u.shape,r,i,a,s,void 0);return cy.runKernelFunc(t=>t.maxPoolBackprop(l,u,c,h),{$dy:l,$input:u})}(t,s,o,e,n,r,i)}},"MaxPool",u,[o]);return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function lS(t,e,n,r,i,a){const s=by(t,"x","avgPool","float32");null==r&&(r=[1,1]),Zm($v(n,r),()=>"Error in avgPool: Either strides or dilations must be 1. "+`Got strides ${n} and dilations '${r}'`);let o=s,l=!1;3===s.rank&&(l=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),Zm(4===o.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),null!=a&&Zm(ig(i),()=>"Error in avgPool: pad must be an integer when using, "+`dimRoundingMode ${a} but got pad ${i}.`);const u=Av(o.shape,e,n,r,i,a);if(1===u.filterWidth&&1===u.filterHeight&&rg(u.inShape,u.outShape))return s.clone();let c=cy.runKernelFunc(t=>t.avgPool(o,u),{x:o},t=>({x:()=>function(t,e,n,r,i,a){const s=by(t,"dy","avgPoolBackprop"),o=by(e,"input","avgPoolBackprop");Zm(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`),null==i&&(i=[1,1]),Zm($v(r,i),()=>"Error in avgPoolBackprop: Either strides or dilations must be 1. "+`Got strides ${r} and dilations '${i}'`);let l=o,u=s,c=!1;3===o.rank&&(c=!0,l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]),u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),Zm(4===u.rank,()=>"Error in avgPoolBackprop: dy must be rank 4 but got rank "+`${u.rank}.`),Zm(4===l.rank,()=>"Error in avgPoolBackprop: input must be rank 4 but got rank "+`${l.rank}.`);const h=Av(l.shape,n,r,i,a),d=cy.runKernelFunc(t=>t.avgPoolBackprop(u,l,h),{dy4D:u,input4D:l});return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(t,o,e,n,r,i)}),"AvgPool",u);return c=c.cast(s.dtype),l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}const uS=My({maxPool_:function(t,e,n,r,i){return oS(t,e,n,1,r,i)}}),cS=My({avgPool_:function(t,e,n,r,i){return lS(t,e,n,1,r,i)}}),hS=My({pool_:function(t,e,n,r,i,a){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");const s=by(t,"x","maxPool");let o=s,l=!1;3===s.rank&&(l=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),Zm($v(a,i),()=>"Error in pool: Either strides or dilations must be 1. "+`Got strides ${a} and dilations '${i}'`);const u=Av(o.shape,e,a,i,r),c=[u.dilationHeight,u.dilationWidth];let h;h="same"===r?function(t,e){const n=t.map((t,n)=>t+(t-1)*(e[n]-1)).map(t=>t-1),r=n.map(t=>Math.floor(t/2)),i=n.map((t,e)=>t-r[e]);return n.map((t,e)=>[r[e],i[e]])}([u.filterHeight,u.filterWidth],c):[[0,0],[0,0]];const d=1===c[0]&&1===c[1],[p,f]=function(t,e,n){const r=n.map(t=>t[0]),i=n.map(t=>t[1]),a=t.concat(r,i),s=e.map((t,e)=>(t-a[e]%t)%t),o=i.map((t,e)=>t+s[e]);return[e.map((t,e)=>[r[e],o[e]]),e.map((t,e)=>[0,s[e]])]}([u.inHeight,u.inWidth],c,h),m=d?r:"valid",g=d?o:dv(o,c,p),y=("avg"===n?()=>lS(g,e,a,1,m):()=>oS(g,e,a,1,m))(),v=d?y:fb(y,c,f);return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),dS=My({maxPool3d_:function(t,e,n,r,i,a="NDHWC",s){const o=by(t,"x","maxPool3d");let l=o,u=!1;4===o.rank&&(u=!0,l=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),null==s&&(s=[1,1,1]),Zm(5===l.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),Zm("NDHWC"===a,()=>"Error in maxPool3d: Only NDHWC is currently supported, "+`but got dataFormat of ${a}`),Zm($v(n,s),()=>"Error in maxPool3d: Either strides or dilations must be 1. "+`Got strides ${n} and dilations '${s}'`),null!=i&&Zm(ig(r),()=>"Error in maxPool3d: pad must be an integer when using, "+`dimRoundingMode ${i} but got pad ${r}.`);const c=Tv(l.shape,e,n,s,r,i,a),h=cy.runKernelFunc((t,e)=>{const n=t.maxPool3d(l,c);return e([l,n]),n},{x:l},(t,a)=>{const[o,l]=a;return{x:()=>function(t,e,n,r,i,a,s,o){const l=by(t,"dy","maxPool3dBackprop"),u=by(e,"input","maxPool3dBackprop"),c=by(n,"output","maxPool3dBackprop");let h=l,d=u,p=c,f=!1;4===u.rank&&(f=!0,h=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),d=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),p=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3])),Zm(5===h.rank,()=>"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+`${h.rank}.`),Zm(5===d.rank,()=>"Error in maxPool3dBackprop: input must be rank 5 but got rank "+`${d.rank}.`),Zm(5===p.rank,()=>"Error in maxPool3dBackprop: output must be rank 5 but got rank "+`${p.rank}.`),null==a&&(a=[1,1,1]),Zm($v(i,a),()=>"Error in maxPool3dBackprop: Either strides or dilations "+`must be 1. Got strides ${i} and dilations '${a}'`),null!=o&&Zm(ig(s),()=>"Error in maxPool3dBackprop: pad must be an integer when "+`using, dimRoundingMode ${o} but got pad ${s}.`);const m=Tv(d.shape,r,i,a,s,o),g=cy.runKernelFunc(t=>t.maxPool3dBackprop(h,d,p,m),{dy5D:h,input5D:d});return f?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(t,o,l,e,n,s,r,i)}});return u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),pS=My({avgPool3d_:function(t,e,n,r,i,a="NDHWC",s){const o=by(t,"x","avgPool3d","float32");let l=o,u=!1;4===o.rank&&(u=!0,l=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),null==s&&(s=[1,1,1]),Zm(5===l.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),Zm("NDHWC"===a,()=>"Error in avgPool3d: Only NDHWC is currently supported, "+`but got dataFormat of ${a}`),Zm($v(n,s),()=>"Error in avgPool3d: Either strides or dilations must be 1. "+`Got strides ${n} and dilations '${s}'`),null!=i&&Zm(ig(r),()=>"Error in avgPool3d: pad must be an integer when using, "+`dimRoundingMode ${i} but got pad ${r}.`);const c=Tv(l.shape,e,n,s,r,i,a);let h=cy.runKernelFunc(t=>t.avgPool3d(l,c),{x:l},t=>({x:()=>function(t,e,n,r,i,a,s){const o=by(t,"dy","avgPool3dBackprop"),l=by(e,"input","avgPool3dBackprop");let u=o,c=l,h=!1;4===l.rank&&(h=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]),c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),Zm(5===u.rank,()=>"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+`${u.rank}.`),Zm(5===c.rank,()=>"Error in avgPool3dBackprop: input must be rank 5 but got rank "+`${c.rank}.`),null==i&&(i=[1,1,1]),Zm($v(r,i),()=>"Error in avgPool3dBackprop: Either strides or dilations "+`must be 1. Got strides ${r} and dilations '${i}'`),null!=s&&Zm(ig(a),()=>"Error in maxPool3dBackprop: pad must be an integer when "+`using, dimRoundingMode ${s} but got pad ${a}.`);const d=Tv(c.shape,n,r,i,a,s),p=cy.runKernelFunc(t=>t.avgPool3dBackprop(u,c,d),{dy5D:u,input5D:c});return h?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}(t,l,e,n,s,r,i)}));return h=h.cast(l.dtype),u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),fS=My({maxPoolWithArgmax_:function(t,e,n,r,i=!1){const a=by(t,"x","maxPoolWithArgmax"),s=cy.runKernel("MaxPoolWithArgmax",{x:a},{filterSize:e,strides:n,pad:r,includeBatchInIndex:i});return{result:s[0],indexes:s[1]}}}),mS=My({equalStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","equalStrict"),r=by(e,"b","equalStrict");return Ym(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),gS=My({greaterEqualStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","greaterEqualStrict"),r=by(e,"b","greaterEqualStrict");return Ym(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),yS=My({greaterStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","greaterStrict"),r=by(e,"b","greaterStrict");return Ym(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),vS=My({lessEqualStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","lessEqualStrict"),r=by(e,"b","lessEqualStrict");return Ym(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),_S=My({lessStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","lessStrict"),r=by(e,"b","lessStrict");return Ym(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),bS=My({notEqualStrict_:function(t,e){Yv("strict variants of ops have been deprecated and will be removed in future");const n=by(t,"a","notEqualStrict"),r=by(e,"b","notEqualStrict");return Ym(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}}),xS=1.7580993408473768,wS=1.0507009873554805,SS=My({elu_:function(t){const e=by(t,"x","elu");return cy.runKernelFunc((t,n)=>{const r=t.elu(e);return n([r]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>cy.runKernelFunc(e=>e.eluDer(t,n),{dy:t,y:n})}})}}),CS=My({leakyRelu_:function(t,e=.2){const n=by(t,"x","leakyRelu");return U_(zy(e).mul(n),n)}}),DS=My({prelu_:function(t,e){const n=by(t,"x","prelu"),r=by(e,"alpha","prelu");return cy.runKernelFunc((t,e)=>{const i=t.prelu(n,r);return e([n,r]),i},{x:n,alpha:r},(t,e)=>{const[n,r]=e,i=n.greater(0);return{x:()=>gw(i,t,t.mul(r)),alpha:()=>{let e=gw(i,Yy(t),t.mul(n));const a=my(r.shape,t.shape);return a.length>0&&(e=e.sum(a)),e.reshape(r.shape)}}},"Prelu")}}),IS=My({relu_:function(t){const e=by(t,"x","relu");return"bool"===e.dtype?e.toInt():cy.runKernelFunc((t,n)=>{const r=t.relu(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e;return{x:()=>K_(t,n.step().toFloat())}},"Relu")}}),kS=My({relu6_:function(t){const e=by(t,"x","relu6");return"bool"===e.dtype?e.toInt():cy.runKernelFunc((t,n)=>{const r=t.relu6(e);return n([e]),r},{x:e},(t,e)=>{const[n]=e,r=n.lessEqual(6).mul(n.step());return{x:()=>K_(t,r.toFloat())}},"Relu6")}}),ES=My({selu_:function(t){const e=by(t,"x","selu");return cy.runKernelFunc((t,n)=>{const r=t.selu(e);return n([e]),r},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>{const e=n.greater(zy(0)),r=zy(xS),i=zy(wS),a=t.mul(i),s=t.mul(r).mul(n.toFloat().exp());return gw(e,a,s)}}})}}),AS=My({softmax_:function(t,e=-1){const n=by(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+`Logits was rank ${n.rank} and dim was ${e}`);return cy.runKernelFunc((t,r)=>{const i=t.softmax(n,e);return r([i]),i},{logits:n},(t,n)=>{const[r]=n,i=t.mul(r);return{logits:()=>i.sub(i.sum([e],!0).mul(r))}},"Softmax",{dim:e},[],[!0])}}),TS=My({logSoftmax_:function(t,e=-1){const n=by(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+`Logits was rank ${n.rank} and axis was ${e}`);return fv((t,n)=>{const r=t.max(e,!0),i=t.sub(r),a=i.toFloat().sub(i.exp().sum(e,!0).log());return n([a]),{value:a,gradFunc:(t,n)=>{const[r]=n,i=r.exp();return t.sub(t.sum(e,!0).mul(i))}}})(n)}}),RS=My({norm_:function(t,e="euclidean",n=null,r=!1){const i=function t(e,n,r=null){if(0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(zy(2,"int32")).sum(r).sqrt();throw new Error(`Error in norm: invalid ord value: ${n}`)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error(`Error in norm: invalid ord value: ${n}`)}throw new Error(`Error in norm: invalid axis: ${r}`)}(t=by(t,"x","norm"),e,n);let a=i.shape;if(r){const e=hg(n,t.shape);a=Dy(i.shape,e)}return i.reshape(a)}}),MS=My({basicLSTMCell_:function(t,e,n,r,i,a){const s=by(t,"forgetBias","basicLSTMCell"),o=by(e,"lstmKernel","basicLSTMCell"),l=by(n,"lstmBias","basicLSTMCell"),u=by(r,"data","basicLSTMCell"),c=by(i,"c","basicLSTMCell"),h=by(a,"h","basicLSTMCell"),d=u.concat(h,1).matMul(o).add(l),p=d.shape[1]/4,f=[d.shape[0],p],m=d.slice([0,0],f),g=d.slice([0,p],f),y=d.slice([0,2*p],f),v=d.slice([0,3*p],f),_=m.sigmoid().mul(g.tanh()).add(c.mul(s.add(y).sigmoid())),b=_.tanh().mul(v.sigmoid());return[_,b]}}),NS=My({multiRNNCell_:function(t,e,n,r){const i=by(e,"data","multiRNNCell"),a=xy(n,"c","multiRNNCell"),s=xy(r,"h","multiRNNCell");let o=i;const l=[];for(let h=0;h<t.length;h++){const e=t[h](o,a[h],s[h]);l.push(e[0]),l.push(e[1]),o=e[1]}const u=[],c=[];for(let h=0;h<l.length;h+=2)u.push(l[h]),c.push(l[h+1]);return[u,c]}}),OS=My({movingAverage_:function(t,e,n,r,i=!0){const a=by(t,"v","movingAverage"),s=by(e,"x","movingAverage"),o=by(n,"decay","movingAverage");ay(a,s),Zm(rg(a.shape,s.shape),()=>"Shape mismatch in v and x");const l=zy(1),u=l.sub(o);let c=s.sub(a).mul(u);if(i){Zm(null!=r,()=>"When using zeroDebias: true, step is required.");const t=by(r,"step","movingAverage");c=c.div(l.sub(Y_(o,t)))}return a.add(c)}}),PS=My({stridedSlice_:function(t,e,n,r,i=0,a=0,s=0,o=0,l=0){if(null==r&&(r=new Array(e.length)),0!==s)throw new Error("ellipsis mask is not yet supported");let u=by(t,"x","stridedSlice");const c=wb(o),h=u.shape.slice();c.forEach(t=>{e[t]=0,n[t]=1,h.splice(t,0,1)}),u=u.reshape(h);for(let m=0;m<u.rank;m++)e[m]=Cb(i,e,r,u.shape,m),n[m]=Db(a,n,r,u.shape,m),r[m]=r[m]||1;const d=wb(l);d.forEach(t=>{n[t]=e[t]+1,r[t]=1});const p=Sb(e,n,r),f=p.filter((t,e)=>-1===d.indexOf(e));return r.every(t=>1===t)?Eb(u,e,p).reshape(f):cy.runKernelFunc(t=>t.stridedSlice(u,e,n,r),{$x:u}).reshape(f)}}),FS=My({topk_:function(t,e=1,n=!0){const r=by(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) `+`but got ${e}`);const[a,s]=cy.runKernelFunc(t=>t.topk(r,e,n),{$x:r});return{values:a,indices:s}}}),LS=My({scatterND_:function(t,e,n){const r=by(t,"indices","scatterND","int32"),i=by(e,"updates","scatterND");return Wx(i,r,n),cy.runKernelFunc(t=>t.scatterND(r,i,n),{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),zS=My({fft_:function(t){Zm("complex64"===t.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 "+`but got ${t.dtype}.`);const e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return cy.runKernelFunc(t=>t.fft(n),{input:t}).reshape(t.shape)}}),$S=My({ifft_:function(t){Zm("complex64"===t.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 "+`but got ${t.dtype}.`);const e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return cy.runKernelFunc(t=>t.ifft(n),{input:t}).reshape(t.shape)}}),BS=My({rfft_:function(t,e){Zm("float32"===t.dtype,()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let i;if(null!=e&&e<n){const r=t.shape.map(t=>0),a=t.shape.map(t=>t);a[t.shape.length-1]=e,i=t.slice(r,a),n=e}else if(null!=e&&e>n){const r=t.shape.map(t=>t);r[t.shape.length-1]=e-n,i=t.concat(Gy(r),t.shape.length-1),n=e}else i=t;const a=i.zerosLike(),s=Ny(i,a).as2D(r,n),o=zS(s),l=Math.floor(n/2)+1,u=Oy(o),c=Py(o),h=u.split([l,n-l],u.shape.length-1),d=c.split([l,n-l],c.shape.length-1),p=i.shape.slice();return p[i.shape.length-1]=l,Ny(h[0],d[0]).reshape(p)}}),WS=My({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){const r=t.as2D(n,e),i=$S(r);return Oy(i)}{const r=[n,2*(e-1)],i=Oy(t).as2D(n,e),a=Py(t).as2D(n,e),s=i.slice([0,1],[n,e-2]).reverse(1),o=a.slice([0,1],[n,e-2]).reverse(1).mul(zy(-1)),l=i.concat(s,1),u=a.concat(o,1),c=Ny(l,u).as2D(r[0],r[1]),h=$S(c);return Oy(h)}}}),qS=My({sparseToDense_:function(t,e,n,r=0){const i=by(t,"sparseIndices","sparseToDense","int32"),a=by(e,"sparseValues","sparseToDense"),s=by(r,"defaultValue","sparseToDense",a.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+` but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+` but got shape ${t.shape}.`);const i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:,"+` ${n.length}, should be: ${a}.`);if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+`${e.shape}, should be [] or [${i}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,s),cy.runKernelFunc(t=>t.sparseToDense(i,a,n,s),{$sparseIndices:i,$sparseValues:a,$defaultValue:s})}}),VS=My({gatherND_:function(t,e){const n=by(e,"indices","gatherND","int32"),r=by(t,"x","gatherND");return cy.runKernelFunc(t=>t.gatherND(r,n),{x:r,indices:n},null,"GatherNd")}}),US=My({dropout_:function(t,e,n,r){const i=by(t,"x","dropout");if(Zm("float32"===i.dtype,()=>"x has to be a floating point tensor since it's going to be "+`scaled, but got a ${i.dtype} tensor instead.`),Zm(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),0===e)return t instanceof Jg?i.clone():i;const a=function(t,e){if(null==e)return t.shape.slice();if(rg(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)n.push(null==e[r]&&null!=t.shape[r]?t.shape[r]:e[r]);return n}return e}(i,n),s=1-e,o=qw(a,0,1,"float32",r).add(s).floor().div(s);return i.mul(o)}});function jS(t,e,n){const r=1-t%2,i=new Float32Array(t);for(let a=0;a<t;++a){const s=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(s)}return $y(i,"float32")}const HS=My({hannWindow_:function(t){return jS(t,.5,.5)}}),GS=My({hammingWindow_:function(t){return jS(t,.54,.46)}}),JS=My({frame_:function(t,e,n,r=!1,i=0){let a=0;const s=[];for(;a+e<=t.size;)s.push(Eb(t,a,e)),a+=n;if(r)for(;a<t.size;){const r=a+e-t.size,o=Qy([Eb(t,a,e-r),Jy([r],i)]);s.push(o),a+=n}return 0===s.length?By([],[0,e]):Qy(s).as2D(s.length,e)}}),XS=My({stft_:function(t,e,n,r,i=HS){null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));const a=JS(t,e,n),s=K_(a,i(e)),o=[];for(let l=0;l<a.shape[0];l++)o.push(BS(s.slice([l,0],[1,e]),r));return Qy(o)}}),KS=async function(t,e,n=1){const r=by(t,"predictions","inTopK"),i=by(e,"targets","inTopK");Zm(r.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+`but got ${r.rank}`),Zm(r.rank-1===i.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+`${r.rank} and targets rank ${i.rank}`),Ym(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];Zm(n>0&&n<=a,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+`dimension (${a}), but got ${n}`);const s=await r.data(),o=await i.data(),[l,u]=[s.length/a,a],c=pg("bool",l);for(let h=0;h<l;h++){const t=h*u,e=s.subarray(t,t+u),r=[];for(let n=0;n<e.length;n++)r.push({value:e[n],index:n});r.sort((t,e)=>e.value-t.value),c[h]=0;for(let i=0;i<n;i++)if(r[i].index===o[h]){c[h]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),Fy(c,i.shape,"bool")};var ZS;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(ZS||(ZS={}));const YS=My({absoluteDifference_:function(t,e,n,r=ZS.SUM_BY_NONZERO_WEIGHTS){const i=by(t,"labels","absoluteDifference"),a=by(e,"predictions","absoluteDifference");let s=null;null!=n&&(s=by(n,"weights","absoluteDifference")),Ym(i.shape,a.shape,"Error in absoluteDifference: ");const o=i.sub(a).abs();return QS(o,s,r)}}),QS=My({computeWeightedLoss_:function(t,e,n=ZS.SUM_BY_NONZERO_WEIGHTS){const r=by(t,"losses","computeWeightedLoss");let i=null;null!=e&&(i=by(e,"weights","computeWeightedLoss"));const a=null==i?r:r.mul(i);if(n===ZS.NONE)return a;if(n===ZS.SUM)return a.sum();if(n===ZS.MEAN){if(null==i)return a.mean();{const t=r.size/i.size,e=a.sum().div(i.sum());return t>1?e.div(zy(t)):e}}if(n===ZS.SUM_BY_NONZERO_WEIGHTS){if(null==i)return a.sum().div(zy(r.size));{const t=i.mul(Hy(r.shape)).notEqual(zy(0)).sum().toFloat();return a.sum().div(t)}}throw Error(`Unknown reduction: ${n}`)}}),tC=My({cosineDistance_:function(t,e,n,r,i=ZS.SUM_BY_NONZERO_WEIGHTS){const a=by(t,"labels","cosineDistance"),s=by(e,"predictions","cosineDistance");let o=null;null!=r&&(o=by(r,"weights","cosineDistance")),Ym(a.shape,s.shape,"Error in cosineDistance: ");const l=zy(1).sub(a.mul(s).sum(n,!0));return QS(l,o,i)}}),eC=My({hingeLoss_:function(t,e,n,r=ZS.SUM_BY_NONZERO_WEIGHTS){let i=by(t,"labels","hingeLoss");const a=by(e,"predictions","hingeLoss");let s=null;null!=n&&(s=by(n,"weights","hingeLoss")),Ym(i.shape,a.shape,"Error in hingeLoss: ");const o=zy(1);i=zy(2).mul(i).sub(o);const l=o.sub(i.mul(a)).relu();return QS(l,s,r)}}),nC=My({huberLoss_:function(t,e,n,r=1,i=ZS.SUM_BY_NONZERO_WEIGHTS){const a=by(t,"labels","huberLoss"),s=by(e,"predictions","huberLoss");let o=null;null!=n&&(o=by(n,"weights","huberLoss")),Ym(a.shape,s.shape,"Error in huberLoss: ");const l=zy(r),u=s.sub(a).abs(),c=H_(u,l),h=u.sub(c),d=zy(.5).mul(c.square()).add(l.mul(h));return QS(d,o,i)}}),rC=My({logLoss_:function(t,e,n,r=1e-7,i=ZS.SUM_BY_NONZERO_WEIGHTS){const a=by(t,"labels","logLoss"),s=by(e,"predictions","logLoss");let o=null;null!=n&&(o=by(n,"weights","logLoss")),Ym(a.shape,s.shape,"Error in logLoss: ");const l=zy(1),u=zy(r),c=a.mul(s.add(u).log()).neg().sub(l.sub(a).mul(l.sub(s).add(u).log()));return QS(c,o,i)}}),iC=My({meanSquaredError_:function(t,e,n,r=ZS.SUM_BY_NONZERO_WEIGHTS){const i=by(t,"labels","meanSquaredError"),a=by(e,"predictions","meanSquaredError");let s=null;null!=n&&(s=by(n,"weights","meanSquaredError")),Ym(i.shape,a.shape,"Error in meanSquaredError: ");const o=i.squaredDifference(a);return QS(o,s,r)}}),aC=My({sigmoidCrossEntropy_:function(t,e,n,r=0,i=ZS.SUM_BY_NONZERO_WEIGHTS){let a=by(t,"multiClassLabels","sigmoidCrossEntropy");const s=by(e,"logits","sigmoidCrossEntropy");let o=null;if(null!=n&&(o=by(n,"weights","sigmoidCrossEntropy")),Ym(a.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=zy(r),e=zy(1),n=zy(.5);a=a.mul(e.sub(t)).add(n.mul(t))}const l=function(t,e){const n=by(t,"labels","sigmoidCrossEntropyWithLogits"),r=by(e,"logits","sigmoidCrossEntropyWithLogits");Ym(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=r.relu(),a=r.mul(n),s=r.abs().neg().exp().log1p();return i.sub(a).add(s)}(a,s);return QS(l,o,i)}}),sC=My({softmaxCrossEntropy_:function(t,e,n,r=0,i=ZS.SUM_BY_NONZERO_WEIGHTS){let a=by(t,"onehotLabels","softmaxCrossEntropy");const s=by(e,"logits","softmaxCrossEntropy");let o=null;if(null!=n&&(o=by(n,"weights","softmaxCrossEntropy")),Ym(a.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){const t=zy(r),e=zy(1),n=zy(a.shape[1]);a=a.mul(e.sub(t)).add(t.div(n))}const l=function(t,e,n=-1){if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+`supported. Labels / logits was rank ${e.rank} `+`and dim was ${n}`);return fv((t,e,r)=>{const i=e.logSumExp([n],!0),a=e.toFloat().sub(i);return r([t,a]),{value:a.mul(t).neg().sum([n]),gradFunc:(t,e)=>{const[r,i]=e,a=Dy(t.shape,[n]);return[t.reshape(a).mul(r.toFloat().sub(i.exp())),t.reshape(a).mul(i.exp().sub(r.toFloat()))]}}})(t,e)}(a,s);return QS(l,o,i)}});function oC(t,e=!1){return cy.tidy(()=>{if(2!==t.shape.length)throw new Error(`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let i=xw(n),a=t.clone();const s=By([[1]],[1,1]);let o=s.clone();const l=n>=r?r:n;for(let t=0;t<l;++t){const e=a,l=o,u=i;[o,a,i]=cy.tidy(()=>{const e=a.slice([t,t],[n-t,1]),l=e.norm(),u=a.slice([t,t],[1,1]),c=By([[-1]]).where(u.greater(0),By([[1]])),h=u.sub(c.mul(l)),d=e.div(h);o=1===d.shape[0]?s.clone():s.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);const p=c.matMul(h).div(l).neg(),f=a.slice([t,0],[n-t,r]),m=p.mul(o),g=o.transpose();if(0===t)a=f.sub(m.matMul(g.matMul(f)));else{const e=f.sub(m.matMul(g.matMul(f)));a=a.slice([0,0],[t,r]).concat(e,0)}const y=m.transpose(),v=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=v.sub(v.matMul(o).matMul(y));else{const e=v.sub(v.matMul(o).matMul(y));i=i.slice([0,0],[n,t]).concat(e,1)}return[o,a,i]}),n_([e,l,u])}return!e&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]})}const lC=My({bandPart_:function(t,e,n){if(e%1!=0)throw new Error(`bandPart(): numLower must be an integer, got ${e}.`);if(n%1!=0)throw new Error(`bandPart(): numUpper must be an integer, got ${n}.`);const r=by(t,"a","bandPart");if(r.rank<2)throw new Error(`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[a,s]=r.shape.slice(-2);if(!(e<=a))throw new Error(`bandPart(): numLower (${e})`+` must not be greater than the number of rows (${a}).`);if(!(n<=s))throw new Error(`bandPart(): numUpper (${n})`+` must not be greater than the number of columns (${s}).`);e<0&&(e=a),n<0&&(n=s);const o=Ky(0,a,1,"int32").reshape([-1,1]),l=Ky(0,s,1,"int32"),u=ab(o,l),c=dw(u.lessEqual(zy(+e,"int32")),u.greaterEqual(zy(-n,"int32"))),h=Gy([a,s],r.dtype);return ov(lv(r.reshape([-1,a,s])).map(t=>gw(c,t,h))).reshape(i)}}),uC=My({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,Zm(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=t[0].shape[0];for(let e=1;e<t.length;++e)Zm(t[e].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+`(${t[e].shape[0]} vs. ${n})`)}else e=!0,t=kv(t,t.shape[0],0).map(t=>sv(t,[0]));Zm(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds `+`number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let i=0;i<t.length;++i)n.push(cy.tidy(()=>{let t=r[i];if(i>0)for(let e=0;e<i;++e){const r=Cv(n[e].mul(t)).mul(n[e]);t=t.sub(r)}return t.div(RS(t,"euclidean"))}));return e?ov(n,0):n}}),cC=My({qr_:function(t,e=!1){if(t.rank<2)throw new Error(`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`);if(2===t.rank)return oC(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),r=lv(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];return r.forEach(t=>{const[n,r]=oC(t,e);i.push(n),a.push(r)}),[ov(i,0).reshape(t.shape),ov(a,0).reshape(t.shape)]}}});function hC(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,i=t.length,a=0,s=!1;for(;r<i;){a=r+(i-r>>>1);const o=n(e,t[a]);o>0?r=a+1:(i=a,s=!o)}return s?r:-r-1}(t,e,n||dC)}(t,e,n);t.splice(r<0?-(r+1):r,0,e)}function dC(t,e){return t>e?1:t<e?-1:0}function pC(t,e,n,r,i){const a=mC(t,e,n,r,i,0);return a.selectedScores.dispose(),a.numValidOutputs.dispose(),a.selectedIndices}function fC(t,e,n,r,i,a){const s=mC(t,e,n,r,i,a,!0);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function mC(t,e,n,r,i,a,s=!1,o=!1){const l=Array.from(e).map((t,e)=>({score:t,boxIndex:e,suppressBeginIndex:0})).filter(t=>t.score>i).sort(vC),u=a>0?-.5/a:0,c=[],h=[];for(;c.length<n&&l.length>0;){const e=l.pop(),{score:n,boxIndex:a,suppressBeginIndex:s}=e;if(n<i)break;let o=!1;for(let l=c.length-1;l>=s;--l){const n=gC(t,a,c[l]);if(n>=r){o=!0;break}if(e.score=e.score*yC(r,u,n),e.score<=i)break}e.suppressBeginIndex=c.length,o||(e.score===n?(c.push(a),h.push(e.score)):e.score>i&&hC(l,e,vC))}const d=c.length;return o&&(c.fill(0,d),h.fill(0,d)),{selectedIndices:$y(c,"int32"),selectedScores:$y(h,"float32"),numValidOutputs:zy(d,"int32")}}function gC(t,e,n){const r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),p=(o-a)*(l-s),f=(h-u)*(d-c);if(p<=0||f<=0)return 0;const m=Math.max(a,u),g=Math.max(s,c),y=Math.min(o,h),v=Math.min(l,d),_=Math.max(y-m,0)*Math.max(v-g,0);return _/(p+f-_)}function yC(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function vC(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function _C(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);const s=t.shape[0];return n=Math.min(n,s),Zm(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),Zm(2===t.rank,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),Zm(4===t.shape[1],()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),Zm(1===e.rank,()=>"scores must be a 1D tensor"),Zm(e.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, `+`but was ${e.shape[0]}`),Zm(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}const bC=My({nonMaxSuppression_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=by(t,"boxes","nonMaxSuppression"),s=by(e,"scores","nonMaxSuppression"),o=_C(a,s,n,r,i);return cy.runKernelFunc(t=>t.nonMaxSuppression(a,s,n,r,i),{boxes:a,scores:s},null,"NonMaxSuppressionV3",{maxOutputSize:n=o.maxOutputSize,iouThreshold:r=o.iouThreshold,scoreThreshold:i=o.scoreThreshold})}}),xC=My({resizeBilinear_:function(t,e,n=!1){const r=by(t,"images","resizeBilinear");Zm(3===r.rank||4===r.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+`rank ${r.rank}.`),Zm(2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+`${e}.`);let i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));const[s,o]=e,l=cy.runKernelFunc((t,e)=>(e([i]),t.resizeBilinear(i,s,o,n)),{x:i},(t,e)=>({x:()=>cy.runKernelFunc(r=>r.resizeBilinearBackprop(t,e[0],n),{})}),"ResizeBilinear",{alignCorners:n,newHeight:s,newWidth:o});return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),wC=My({resizeNearestNeighbor_:function(t,e,n=!1){const r=by(t,"images","resizeNearestNeighbor");Zm(3===r.rank||4===r.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+`rank ${r.rank}.`),Zm(2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+`${e}.`),Zm("float32"===r.dtype||"int32"===r.dtype,()=>"`images` must have `int32` or `float32` as dtype");let i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));const[s,o]=e,l=cy.runKernelFunc((t,e)=>(e([i]),t.resizeNearestNeighbor(i,s,o,n)),{batchImages:i},(t,e)=>({batchImages:()=>cy.runKernelFunc(r=>r.resizeNearestNeighborBackprop(t,e[0],n),{})}));return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),SC=async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=by(t,"boxes","nonMaxSuppressionAsync"),s=by(e,"scores","nonMaxSuppressionAsync"),o=_C(a,s,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l=await Promise.all([a.data(),s.data()]),u=pC(l[0],l[1],n,r,i);return a!==t&&a.dispose(),s!==e&&s.dispose(),u},CC=My({nonMaxSuppressionWithScore_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=by(t,"boxes","nonMaxSuppression"),o=by(e,"scores","nonMaxSuppression"),l=_C(s,o,n,r,i,a),u=cy.runKernel("NonMaxSuppressionV5",{boxes:s,scores:o},{maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:i=l.scoreThreshold,softNmsSigma:a=l.softNmsSigma});return{selectedIndices:u[0],selectedScores:u[1]}}}),DC=async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=by(t,"boxes","nonMaxSuppressionAsync"),o=by(e,"scores","nonMaxSuppressionAsync"),l=_C(s,o,n,r,i,a);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const u=await Promise.all([s.data(),o.data()]),c=fC(u[0],u[1],n,r,i,a);return s!==t&&s.dispose(),o!==e&&o.dispose(),c},IC=My({cropAndResize_:function(t,e,n,r,i,a){const s=by(t,"image","cropAndResize"),o=by(e,"boxes","cropAndResize","float32"),l=by(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;const u=o.shape[0];return Zm(4===s.rank,()=>"Error in cropAndResize: image must be rank 4,"+`but got rank ${s.rank}.`),Zm(2===o.rank&&4===o.shape[1],()=>`Error in cropAndResize: boxes must be have size [${u},4] `+`but had shape ${o.shape}.`),Zm(1===l.rank&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] `+`but had shape ${o.shape}.`),Zm(2===r.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+`length ${r.length}.`),Zm(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),Zm("bilinear"===i||"nearest"===i,()=>`method must be bilinear or nearest, but was ${i}`),cy.runKernelFunc((t,e)=>t.cropAndResize(s,o,l,r,i,a),{images:s,boxes:o,boxInd:l},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),kC=(t,e)=>!(t>0)||"linear"===e,EC=(t,e,n)=>{if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error(`Gradient for activation ${n} has not been `+"implemented yet.")},AC=(t,e)=>{let n=e;const r=my(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},TC=(t,e,n)=>{if("linear"===e)return t;if("relu"===e)return IS(t);if("elu"===e)return SS(t);if("relu6"===e)return kS(t);if("prelu"===e)return DS(t,n);throw new Error(`Unknown fused activation ${e}.`)},RC=My({fusedMatMul_:function({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:i,activation:a="linear",preluActivationWeights:s}){if(!1===kC(cy.state.gradientDepth,a)){let o=cv(t,e,n,r);return null!=i&&(o=a_(o,i)),TC(o,a,s)}let o=by(t,"a","fused matMul"),l=by(e,"b","fused matMul");[o,l]=iy(o,l);const u=n?o.shape[o.rank-2]:o.shape[o.rank-1],c=r?l.shape[l.rank-1]:l.shape[l.rank-2],h=n?o.shape[o.rank-1]:o.shape[o.rank-2],d=r?l.shape[l.rank-2]:l.shape[l.rank-1],p=o.shape.slice(0,-2),f=l.shape.slice(0,-2),m=eg(p),g=eg(f);Zm(o.rank>=2&&l.rank>=2&&o.rank===l.rank,()=>"Error in fused matMul: inputs must have the same rank of at least "+`2, got ranks ${o.rank} and ${l.rank}.`),Zm(rg(p,f),()=>`Error in fused matMul: outer dimensions (${p}) and (`+`${f}) of Tensors with shapes ${o.shape} and `+`${l.shape} must match.`),Zm(u===c,()=>`Error in fused matMul: inner shapes (${u}) and (`+`${c}) of Tensors with shapes ${o.shape} and `+`${l.shape} and transposeA=${n}`+` and transposeB=${r} must match.`);const y=o.shape.slice(0,-2).concat([h,d]),v=n?o.as3D(m,u,h):o.as3D(m,h,u),_=r?l.as3D(g,d,c):l.as3D(g,c,d);let b,x;null!=i&&(b=by(i,"bias","fused matMul"),[b]=iy(b,o),gy(y,b.shape)),null!=s&&(x=by(s,"prelu weights","fused matMul"));const w={a:v,b:_};return null!=i&&(w.bias=b),null!=s&&(w.preluActivationWeights=x),cy.runKernelFunc((t,e)=>{const i=t.fusedBatchMatMul({a:v,b:_,transposeA:n,transposeB:r,bias:b,activation:a,preluActivationWeights:x});return e([v,_,i]),i},w,(t,e)=>{const[s,o,l]=e,u=EC(t,l,a);let c={};return null!=i&&(c={bias:()=>AC(b,u)}),Object.assign(n||r?!n&&r?{a:()=>u.matMul(o,!1,!1),b:()=>u.matMul(s,!0,!1)}:n&&!r?{a:()=>o.matMul(u,!1,!0),b:()=>s.matMul(u,!1,!1)}:{a:()=>o.matMul(u,!0,!0),b:()=>u.matMul(s,!0,!0)}:{a:()=>u.matMul(o,!1,!0),b:()=>s.matMul(u,!0,!1)},c)},"_FusedMatMul",{transposeA:n,transposeB:r,activation:a},[v,_],[!0]).reshape(y)}}),MC=My({fusedConv2d_:function({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u}){if(!1===kC(cy.state.gradientDepth,l=l||"linear")){let c=Uv(t,e,n,r,i,a,s);return null!=o&&(c=a_(c,o)),TC(c,l,u)}const c=by(t,"x","conv2d"),h=by(e,"filter","conv2d");let d=c,p=!1;3===c.rank&&(p=!0,d=c.as4D(1,c.shape[0],c.shape[1],c.shape[2])),Zm(4===d.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+`${d.rank}.`),Zm(4===h.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+`${h.rank}.`),null!=s&&Zm(ig(r),()=>"Error in fused conv2d: pad must be an integer when using, "+`dimRoundingMode ${s} but got pad ${r}.`),Zm(d.shape[3]===h.shape[2],()=>`Error in conv2d: depth of input (${d.shape[3]}) must match `+`input depth for filter ${h.shape[2]}.`),Zm($v(n,a),()=>"Error in conv2D: Either strides or dilations must be 1. "+`Got strides ${n} and dilations '${a}'`),Zm("NHWC"===i,()=>`Error in conv2d: got dataFormat of ${i} but only NHWC is currently supported.`);const f=Rv(d.shape,h.shape,n,a,r,s);let m,g;null!=o&&(m=by(o,"bias","fused conv2d"),[m]=iy(m,c),gy(f.outShape,m.shape)),null!=u&&(g=by(u,"prelu weights","fused conv2d"));const y={x:d,filter:h};null!=o&&(y.bias=m),null!=u&&(y.preluActivationWeights=g);const v=cy.runKernelFunc((t,e)=>{const n=t.fusedConv2d({input:d,filter:h,convInfo:f,bias:m,activation:l,preluActivationWeights:g});return e([h,d,n]),n},y,(t,e)=>{const[i,s,u]=e,c=EC(t,u,l);Zm(zv(a),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+`are not yet supported in gradients. Got dilations '${a}'`);let h={};return null!=o&&(h={bias:()=>AC(m,c)}),Object.assign({x:()=>qv(s.shape,c,i,n,r),filter:()=>Wv(s,c,i.shape,n,r)},h)},"FusedConv2D",{convInfo:f,activation:l},[h,d],[!0]);return p?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),NC=My({fusedDepthwiseConv2d_:function({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u}){if(!1===kC(cy.state.gradientDepth,l)){let c=uw(t,e,n,r,i,a,s);return null!=o&&(c=a_(c,o)),TC(c,l,u)}const c=by(t,"x","depthwiseConv2d"),h=by(e,"filter","depthwiseConv2d");let d=c,p=!1;3===c.rank&&(p=!0,d=c.as4D(1,c.shape[0],c.shape[1],c.shape[2])),Zm(4===d.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+`rank ${d.rank}.`),Zm(4===h.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+`but got rank ${h.rank}.`),Zm(d.shape[3]===h.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+`(${d.shape[3]}) must match the inChannels dimension in `+`filter ${h.shape[2]}.`),null==a&&(a=[1,1]),Zm($v(n,a),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+`be 1. Got strides ${n} and dilations '${a}'`),null!=s&&Zm(ig(r),()=>"Error in fused depthwiseConv2d: pad must be an integer when "+`using dimRoundingMode ${s} but got pad ${r}.`);const f=Rv(d.shape,h.shape,n,a,r,s,!0);let m,g;null!=o&&(m=by(o,"bias","fused conv2d"),[m]=iy(m,c),gy(f.outShape,m.shape)),null!=u&&(g=by(u,"prelu weights","fused depthwiseConv2d"));const y={x:d,filter:h};null!=o&&(y.bias=m),null!=u&&(y.preluActivationWeights=g);const v=cy.runKernelFunc((t,e)=>{const n=t.fusedDepthwiseConv2D({input:d,filter:h,convInfo:f,bias:m,activation:l,preluActivationWeights:g});return e([h,d,n]),n},y,(t,e)=>{Zm(zv(a),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+`'${a}'`);const[n,r,i]=e,s=EC(t,i,l);let u={};return null!=o&&(u={bias:()=>AC(m,s)}),Object.assign({x:()=>Kv(r.shape,s,n,f),filter:()=>Xv(r,s,n.shape,f)},u)},"FusedDepthwiseConv2D",{convInfo:f,activation:l},[h,d],[!0]);return p?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}});class OC extends Vx{minimize(t,e=!1,n){const{value:r,grads:i}=this.computeGradients(t,n);if(null!=n){const t=n.map(t=>({name:t.name,tensor:i[t.name]}));this.applyGradients(t)}else this.applyGradients(i);return n_(i),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return function(t,e){Zm(Dg(t),()=>"The f passed in variableGrads(f) must be a function"),Zm(null==e||Array.isArray(e)&&e.every(t=>t instanceof Xg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=e;if(!n){e=[];for(const t in cy.registeredVariables)e.push(cy.registeredVariables[t])}const r=n?e.filter(t=>!t.trainable):null,i=e.length;Zm((e=e.filter(t=>t.trainable)).length>0,()=>"variableGrads() expects at least one of the input variables to "+`be trainable, but none of the ${i} variables is `+"trainable.");const{value:a,grads:s}=cy.gradients(t,e,null,!0);Zm(s.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Zm(0===a.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it "+`returned a rank-${a.rank} tensor`);const o={};return e.forEach((t,e)=>{null!=s[e]&&(o[t.name]=s[e])}),null!=r&&r.forEach(t=>o[t.name]=null),{value:a,grads:o}}(t,e)}dispose(){null!=this.iterations_&&n_(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:zy(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+`${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(OC,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});class PC extends OC{constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=cy.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=cy.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${e}/accum_grad`,variable:e_(()=>Yy(r).variable(!1))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${e}/accum_var`,variable:e_(()=>Yy(r).variable(!1))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;e_(()=>{const t=a.mul(this.rho).add(i.square().mul(1-this.rho)),e=s.add(this.epsilon).sqrt().div(a.add(this.epsilon).sqrt()).mul(i),n=s.mul(this.rho).add(e.square().mul(1-this.rho));a.assign(t),s.assign(n);const o=e.mul(-this.learningRate).add(r);r.assign(o)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(n_(this.accumulatedGrads.map(t=>t.variable)),n_(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}PC.className="Adadelta",jx(PC);class FC extends OC{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=cy.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:`${e}/accumulator`,variable:e_(()=>Jy(r.shape,this.initialAccumulatorValue).variable(t))}}const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedGrads[n].variable;e_(()=>{const t=a.add(i.square());a.assign(t);const e=i.div(t.add(cy.backend.epsilon()).sqrt()).mul(-this.learningRate).add(r);r.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&n_(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}FC.className="Adagrad",jx(FC);class LC extends OC{constructor(t,e,n,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],e_(()=>{this.accBeta1=zy(e).variable(),this.accBeta2=zy(n).variable()}),null==r&&(this.epsilon=cy.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e_(()=>{const n=ab(1,this.accBeta1),r=ab(1,this.accBeta2);e.forEach((e,i)=>{const a=cy.registeredVariables[e];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${e}/m`,variable:e_(()=>Yy(a).variable(!1))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:`${e}/v`,variable:e_(()=>Yy(a).variable(!1))});const s=Array.isArray(t)?t[i].tensor:t[e];if(null==s)return;const o=this.accumulatedFirstMoment[i].variable,l=this.accumulatedSecondMoment[i].variable,u=o.mul(this.beta1).add(s.mul(1-this.beta1)),c=l.mul(this.beta2).add(s.square().mul(1-this.beta2)),h=u.div(n),d=c.div(r);o.assign(u),l.assign(c);const p=h.div(d.sqrt().add(this.epsilon)).mul(-this.learningRate).add(a);a.assign(p)}),this.accBeta1.assign(this.accBeta1.mul(this.beta1)),this.accBeta2.assign(this.accBeta2.mul(this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&n_(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&n_(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),e_(()=>{this.accBeta1.assign(Y_(this.beta1,this.iterations_+1)),this.accBeta2.assign(Y_(this.beta2,this.iterations_+1))});const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}LC.className="Adam",jx(LC);class zC extends OC{constructor(t,e,n,r=null,i=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],e_(()=>{this.iteration=zy(0).variable(),this.accBeta1=zy(e).variable()}),null==r&&(this.epsilon=cy.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e_(()=>{const n=ab(1,this.accBeta1),r=nb(-this.learningRate,this.iteration.mul(this.decay).add(1));e.forEach((e,i)=>{const a=cy.registeredVariables[e];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${e}/m`,variable:Yy(a).variable(!1)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:`${e}/v`,variable:Yy(a).variable(!1)});const s=Array.isArray(t)?t[i].tensor:t[e];if(null==s)return;const o=this.accumulatedFirstMoment[i].variable,l=this.accumulatedWeightedInfNorm[i].variable,u=o.mul(this.beta1).add(s.mul(1-this.beta1)),c=l.mul(this.beta2),h=s.abs(),d=c.maximum(h);o.assign(u),l.assign(d);const p=r.div(n).mul(u.div(d.add(this.epsilon))).add(a);a.assign(p)}),this.iteration.assign(this.iteration.add(1)),this.accBeta1.assign(this.accBeta1.mul(this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&n_(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&n_(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}zC.className="Adamax",jx(zC);class $C extends OC{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const i=cy.registeredVariables[e];e_(()=>{const t=this.c.mul(r).add(i);i.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=r_(zy(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}$C.className="SGD",jx($C);class BC extends $C{constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=zy(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=cy.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:`${e}/momentum`,variable:e_(()=>Yy(r).variable(t))}}const i=this.accumulations[n].variable,a=Array.isArray(t)?t[n].tensor:t[e];null!=a&&e_(()=>{let t;const e=this.m.mul(i).add(a);t=this.useNesterov?this.c.mul(a.add(e.mul(this.m))).add(r):this.c.mul(e).add(r),i.assign(e),r.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&n_(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}BC.className="Momentum",jx(BC);class WC extends OC{constructor(t,e=.9,n=0,r=null,i=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=cy.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=cy.registeredVariables[e];null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${e}/rms`,variable:e_(()=>Yy(r).variable(!1))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${e}/momentum`,variable:e_(()=>Yy(r).variable(!1))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${e}/mg`,variable:e_(()=>Yy(r).variable(!1))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;e_(()=>{const t=a.mul(this.decay).add(i.square().mul(1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,o=e.mul(this.decay).add(i.mul(1-this.decay)),l=s.mul(this.momentum).add(i.mul(this.learningRate).div(t.sub(o.square().add(this.epsilon)).sqrt()));a.assign(t),e.assign(o),s.assign(l);const u=r.sub(l);r.assign(u)}else{const t=a.mul(this.decay).add(i.square().mul(1-this.decay)),e=s.mul(this.momentum).add(i.mul(this.learningRate).div(t.add(this.epsilon).sqrt()));a.assign(t),s.assign(e);const n=r.sub(e);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&n_(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&n_(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&n_(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}WC.className="RMSProp",jx(WC);class qC{static sgd(t){return new $C(t)}static momentum(t,e,n=!1){return new BC(t,e,n)}static rmsprop(t,e=.9,n=0,r=null,i=!1){return new WC(t,e,n,r,i)}static adam(t=.001,e=.9,n=.999,r=null){return new LC(t,e,n,r)}static adadelta(t=.001,e=.95,n=null){return new PC(t,e,n)}static adamax(t=.002,e=.9,n=.999,r=null,i=0){return new zC(t,e,n,r,i)}static adagrad(t,e=.1){return new FC(t,e)}}const VC={sgd:qC.sgd,momentum:qC.momentum,adadelta:qC.adadelta,adagrad:qC.adagrad,rmsprop:qC.rmsprop,adamax:qC.adamax,adam:qC.adam},UC="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:t=>t();function jC(){return new Promise(t=>UC(()=>t()))}function HC(t,e,n,r=!0){let i=[];if(r)i=i.concat(e.slice(0)),i.push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)i=i.concat([t[r+1]/e[r],e[r]]);i=i.concat(t.slice(n+1))}return i}function GC(t,e,n=!0){const r=[];if(n){r.push(e);for(let n=e+1;n<t;++n)n<=2*e?(r.push(n),r.push(n-(e+1))):r.push(n)}else{const n=[],i=[];for(let r=1;r<t;++r)r>=2*e+1||r%2==1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function JC(t,e,n,r=!0){const i=[];i.push(r?t[0]/n:t[0]*n);for(let a=1;a<t.length;++a)i.push(a<=e.length?r?e[a-1]*t[a]:t[a]/e[a-1]:t[a]);return i}function XC(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function KC(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}const ZC=.3275911,YC=.254829592,QC=-.284496736,tD=1.421413741,eD=-1.453152027,nD=1.061405429;function rD(...t){Mm().getBool("IS_TEST")||console.warn(...t)}function iD(...t){Mm().getBool("IS_TEST")||console.log(...t)}function aD(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+`${t.length}, imag: ${e.length}.`);const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function sD(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function oD(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function lD(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function uD(t,e){return{real:t[2*e],imag:t[2*e+1]}}function cD(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function hD(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function dD(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function pD(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();const e=Gy(t.shape),r=t.toFloat(),i=n.complex(r,e);return e.dispose(),r.dispose(),i}if(!yg(t.dtype,e))return cy.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){const r=n.real(t),i=r.cast(e);return r.dispose(),i}if("int32"===e)return n.int(t);if("bool"===e){const e=zy(0,t.dtype),r=n.notEqual(t,e);return e.dispose(),r}throw new Error(`Error in Cast: failed to cast ${t.dtype} to ${e}`)}function fD(t,e){return cy.makeTensorFromDataId(t.dataId,e,t.dtype)}function mD(t,e,n){const r=(e-t)/(n-1),i=Rg(n,"float32");i[0]=t;for(let a=1;a<i.length;a++)i[a]=i[a-1]+r;return $y(i,"float32")}function gD(t,e,n){const r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map(e=>{const a=[...i];a[n]=e;const s=t.slice(r,a);return r[n]+=e,s})}function yD(t,e){const n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=t.shape[i]*e[i];const r=tv(n,t.dtype);for(let i=0;i<r.values.length;++i){const e=r.indexToLoc(i),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const a=t.locToIndex(n);r.values[i]=t.values[a]}return r.toTensor()}function vD(t,e,n,r,i){const a=e[e.length-1],[s,o]=[t.length/a,a],l=pg(n,s*r),u=pg("int32",s*r);for(let h=0;h<s;h++){const e=h*o,n=t.subarray(e,e+o),i=[];for(let t=0;t<n.length;t++)i.push({value:n[t],index:t});i.sort((t,e)=>e.value-t.value);const a=h*r,s=l.subarray(a,a+r),c=u.subarray(a,a+r);for(let t=0;t<r;t++)s[t]=i[t].value,c[t]=i[t].index}const c=e.slice();return c[c.length-1]=r,[Fy(l,c,n),Fy(u,c,"int32")]}class _D{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class bD{time(t){return xD("time")}read(t){return xD("read")}readSync(t){return xD("readSync")}numDataIds(){return xD("numDataIds")}disposeData(t){return xD("disposeData")}write(t,e,n){return xD("write")}move(t,e,n,r){return xD("move")}memory(){return xD("memory")}floatPrecision(){return xD("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}batchMatMul(t,e,n,r){return xD("batchMatMul")}fusedBatchMatMul({}){return xD("fusedBatchMatMul")}slice(t,e,n){return xD("slice")}stridedSlice(t,e,n,r){return xD("stridedSlice")}unstack(t,e){return xD("unstack")}reverse(t,e){return xD("reverse")}concat(t,e){return xD("concat")}neg(t){return xD("neg")}add(t,e){return xD("add")}addN(t){return xD("addN")}subtract(t,e){return xD("subtract")}multiply(t,e){return xD("multiply")}realDivide(t,e){return xD("realDivide")}floorDiv(t,e){return xD("floorDiv")}sum(t,e){return xD("sum")}prod(t,e){return xD("prod")}unsortedSegmentSum(t,e,n){return xD("unsortedSegmentSum")}argMin(t,e){return xD("argMin")}argMax(t,e){return xD("argMax")}equal(t,e){return xD("equal")}notEqual(t,e){return xD("notEqual")}less(t,e){return xD("less")}lessEqual(t,e){return xD("lessEqual")}greater(t,e){return xD("greater")}greaterEqual(t,e){return xD("greaterEqual")}logicalNot(t){return xD("logicalNot")}logicalAnd(t,e){return xD("logicalAnd")}logicalOr(t,e){return xD("logicalOr")}where(t){return xD("where")}select(t,e,n){return xD("select")}topk(t,e,n){return xD("topk")}min(t,e){return xD("min")}minimum(t,e){return xD("minimum")}mod(t,e){return xD("mod")}max(t,e){return xD("max")}maximum(t,e){return xD("maximum")}all(t,e){return xD("all")}any(t,e){return xD("any")}squaredDifference(t,e){return xD("squaredDifference")}ceil(t){return xD("ceil")}floor(t){return xD("floor")}round(t){return xD("round")}sign(t){return xD("sign")}isNaN(t){return xD("isNaN")}isInf(t){return xD("isInf")}isFinite(t){return xD("isFinite")}pow(t,e){return xD("pow")}exp(t){return xD("exp")}expm1(t){return xD("expm1")}softmax(t,e){return xD("softmax")}log(t){return xD("log")}log1p(t){return xD("log1p")}sqrt(t){return xD("sqrt")}rsqrt(t){return xD("rsqrt")}square(t){return xD("square")}reciprocal(t){return xD("reciprocal")}relu(t){return xD("relu")}relu6(t){return xD("relu6")}prelu(t,e){return xD("prelu")}elu(t){return xD("elu")}eluDer(t,e){return xD("eluDer")}selu(t){return xD("selu")}int(t){return xD("int")}clip(t,e,n){return xD("clip")}abs(t){return xD("abs")}complexAbs(t){return xD("complexAbs")}sigmoid(t){return xD("sigmoid")}softplus(t){return xD("softplus")}sin(t){return xD("sin")}cos(t){return xD("cos")}tan(t){return xD("tan")}asin(t){return xD("asin")}acos(t){return xD("acos")}atan(t){return xD("atan")}atan2(t,e){return xD("atan2")}sinh(t){return xD("sinh")}cosh(t){return xD("cosh")}tanh(t){return xD("tanh")}asinh(t){return xD("asinh")}acosh(t){return xD("acosh")}atanh(t){return xD("atanh")}erf(t){return xD("erf")}step(t,e){return xD("step")}fusedConv2d({}){return xD("fusedConv2d")}conv2d(t,e,n){return xD("conv2d")}conv2dDerInput(t,e,n){return xD("conv2dDerInput")}conv2dDerFilter(t,e,n){return xD("conv2dDerFilter")}fusedDepthwiseConv2D({}){return xD("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,n){return xD("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,n){return xD("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,n){return xD("depthwiseConv2DDerFilter")}conv3d(t,e,n){return xD("conv3d")}conv3dDerInput(t,e,n){return xD("conv3dDerInput")}conv3dDerFilter(t,e,n){return xD("conv3dDerFilter")}maxPool(t,e){return xD("maxPool")}maxPoolBackprop(t,e,n,r){return xD("maxPoolBackprop")}avgPool(t,e){return xD("avgPool")}avgPoolBackprop(t,e,n){return xD("avgPoolBackprop")}avgPool3d(t,e){return xD("avgPool3d")}avgPool3dBackprop(t,e,n){return xD("avgPool3dBackprop")}maxPool3d(t,e){return xD("maxPool3d")}maxPool3dBackprop(t,e,n,r){return xD("maxPool3dBackprop")}reshape(t,e){return xD("reshape")}cast(t,e){return xD("cast")}tile(t,e){return xD("tile")}pad(t,e,n){return xD("pad")}transpose(t,e){return xD("transpose")}gather(t,e,n){return xD("gather")}gatherND(t,e){return xD("gatherND")}scatterND(t,e,n){return xD("scatterND")}batchToSpaceND(t,e,n){return xD("batchToSpaceND")}spaceToBatchND(t,e,n){return xD("spaceToBatchND")}resizeBilinear(t,e,n,r){return xD("resizeBilinear")}resizeBilinearBackprop(t,e,n){return xD("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,n,r){return xD("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,n){return xD("resizeNearestNeighborBackprop")}batchNorm(t,e,n,r,i,a){return xD("batchNorm")}localResponseNormalization4D(t,e,n,r,i){return xD("localResponseNormalization4D")}LRNGrad(t,e,n,r,i,a,s){return xD("LRNGrad")}multinomial(t,e,n,r){return xD("multinomial")}oneHot(t,e,n,r){return xD("oneHot")}cumsum(t,e,n,r){return xD("cumsum")}nonMaxSuppression(t,e,n,r,i){return xD("nonMaxSuppression")}fft(t){return xD("fft")}ifft(t){return xD("ifft")}complex(t,e){return xD("complex")}real(t){return xD("real")}imag(t){return xD("imag")}cropAndResize(t,e,n,r,i,a){return xD("cropAndResize")}depthToSpace(t,e,n){return xD("depthToSpace")}split(t,e,n){return xD("split")}sparseToDense(t,e,n,r){return xD("sparseToDense")}diag(t){return xD("diag")}fill(t,e,n){return xD("fill")}onesLike(t){return xD("onesLike")}zerosLike(t){return xD("zerosLike")}linspace(t,e,n){return xD("linspace")}dispose(){return xD("dispose")}}function xD(t){throw new Error(`'${t}' not yet implemented or not found in the registry. `+"Did you forget to import the kernel?")}let wD;function SD(){return null==wD&&(wD=cy.backend.epsilon()),wD}Jg.prototype.add=function(t){return this.throwIfDisposed(),a_(this,t)},Jg.prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),Jx(this,t,e,n,r,i)},Jg.prototype.broadcastTo=function(t){return this.throwIfDisposed(),Qx(this,t)},Jg.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),fb(this,t,e)},Jg.prototype.max=function(t,e){return this.throwIfDisposed(),kw(this,t,e)},Jg.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Jg&&(t=[t]),Qy([this,...t],e)},Jg.prototype.conv1d=function(t,e,n,r,i,a){return this.throwIfDisposed(),iw(this,t,e,n,r,i,a)},Jg.prototype.conv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Uv(this,t,e,n,r,i,a)},Jg.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),aw(this,t,e,n,r,i)},Jg.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),lw(this,t,e)},Jg.prototype.depthwiseConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),uw(this,t,e,n,r,i,a)},Jg.prototype.depthwiseConv2D=function(t,e,n,r,i,a){return Yv("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),uw(this,t,e,n,r,i,a)},Jg.prototype.div=function(t){return this.throwIfDisposed(),nb(this,t)},Jg.prototype.divNoNan=function(t){return this.throwIfDisposed(),vw(this,t)},Jg.prototype.dot=function(t){return this.throwIfDisposed(),_w(this,t)},Jg.prototype.equal=function(t){return this.throwIfDisposed(),bw(this,t)},Jg.prototype.greater=function(t){return this.throwIfDisposed(),ww(this,t)},Jg.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Sw(this,t)},Jg.prototype.less=function(t){return this.throwIfDisposed(),Cw(this,t)},Jg.prototype.lessEqual=function(t){return this.throwIfDisposed(),Dw(this,t)},Jg.prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),Iw(this,t,e,n,r)},Jg.prototype.matMul=function(t,e,n){return this.throwIfDisposed(),cv(this,t,e,n)},Jg.prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),Px(this,t,e,n)},Jg.prototype.notEqual=function(t){return this.throwIfDisposed(),Aw(this,t)},Jg.prototype.pad=function(t,e){return this.throwIfDisposed(),bb(this,t,e)},Jg.prototype.separableConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),Vw(this,t,e,n,r,i,a)},Jg.prototype.split=function(t,e){return this.throwIfDisposed(),kv(this,t,e)},Jg.prototype.squaredDifference=function(t){return this.throwIfDisposed(),Uw(this,t)},Jg.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),dv(this,t,e)},Jg.prototype.sub=function(t){return this.throwIfDisposed(),ab(this,t)},Jg.prototype.tile=function(t){return this.throwIfDisposed(),sb(this,t)},Jg.prototype.transpose=function(t){return this.throwIfDisposed(),hb(this,t)},Hg=y;class CD extends Error{constructor(t){super(t),Object.setPrototypeOf(this,CD.prototype)}}class DD extends Error{constructor(t){super(t),Object.setPrototypeOf(this,DD.prototype)}}class ID extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ID.prototype)}}class kD extends Error{constructor(t){super(t),Object.setPrototypeOf(this,kD.prototype)}}class ED extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ED.prototype)}}function AD(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function TD(t,e){if(!t)throw new ED(e)}function RD(t,e){let n=0;for(const r of t)r===e&&n++;return n}function MD(t){return 1===t.length?t[0]:t}function ND(t){return Array.isArray(t)?t:[t]}function OD(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function PD(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}Error;let FD={};function LD(t){if(null==t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function zD(t,e={},n={},r="object",i=!1){if("string"==typeof t){const i=t;let a;if(i in n)a=n[i];else if(i in FD)a=FD[i];else if(a=e[i],null==a)throw new ID(`Unknown ${r}: ${t}. `+"This may be due to one of the following reasons:\n"+`1. The ${r} is defined in Python, in which `+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+`2. The custom ${r} is defined in JavaScript, `+"but is not registered properly with tf.serialization.registerClass().");return a}{const a=t;if(null==a.className||null==a.config)throw new ID(`${r}: Improper config format: `+`${JSON.stringify(a)}.\n`+"'className' and 'config' must set.");const s=a.className;let o,l;if(s in n?[o,l]=n[s]:s in FD?[o,l]=FD.className:s in e&&([o,l]=e[s]),null==o)throw new ID(`Unknown ${r}: ${s}. `+"This may be due to one of the following reasons:\n"+`1. The ${r} is defined in Python, in which `+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+`2. The custom ${r} is defined in JavaScript, `+"but is not registered properly with tf.serialization.registerClass().");if(null!=l){const t={};for(const n of Object.keys(FD))t[n]=FD[n];for(const i of Object.keys(n))t[i]=n[i];a.config.customObjects=t;const e=Object.assign({},FD);for(const i of Object.keys(n))FD[i]=n[i];!function t(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach(e=>t(e));else{const n=Object.keys(e);for(const r of n){const n=e[r];null!=n&&"object"==typeof n&&(Array.isArray(n)||"ndarray"!==n.type||"number"!=typeof n.value?t(n):e[r]=n.value)}}}(a.config);const r=l(o,a.config,n,i);return FD=Object.assign({},e),r}{const t=Object.assign({},FD);for(const r of Object.keys(n))FD[r]=n[r];const e=new o(a.config);return FD=Object.assign({},t),e}}}function $D(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function BD(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function WD(t){if(null==t)throw new ID(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function qD(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new ID(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function VD(t,e,n=0,r=1/0){return TD(n>=0),TD(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(t=>typeof t===e)}function UD(t,e){Array.isArray(t)?(r.assert(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((t,n)=>UD(t,`element ${n+1} of ${e}`))):r.assert(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got `+`${function t(e){return null===e?"null":Array.isArray(e)?"["+e.map(e=>t(e)).join(",")+"]":"string"==typeof e?`"${e}"`:`${e}`}(t)}.`)}function jD(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function HD(t,e){return e_(()=>F_(Cv(K_(t,t),e,!0)))}class GD extends u.Serializable{getConfig(){return{}}}class JD extends GD{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return e_(()=>{const e=HD(t,this.axis),n=f_(e,0,this.maxValue);return K_(t,nb(n,a_(SD(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}JD.className="MaxNorm",u.registerClass(JD);class XD extends GD{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return e_(()=>nb(t,a_(SD(),HD(t,this.axis))))}getConfig(){return{axis:this.axis}}}XD.className="UnitNorm",u.registerClass(XD);class KD extends GD{apply(t){return IS(t)}}KD.className="NonNeg",u.registerClass(KD);class ZD extends GD{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return e_(()=>{const e=HD(t,this.axis),n=a_(K_(this.rate,f_(e,this.minValue,this.maxValue)),K_(1-this.rate,e));return K_(t,nb(n,a_(SD(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}ZD.className="MinMaxNorm",u.registerClass(ZD);const YD={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function QD(t){return LD(t)}function tI(t,e={}){return zD(t,u.SerializationMap.getMap().classNameMap,e,"constraint")}function eI(t){return null==t?null:"string"==typeof t?tI({className:t in YD?YD[t]:t,config:{}}):t instanceof GD?t:tI(t)}const nI=["channelsFirst","channelsLast"],rI=["valid","same","causal"],iI=["max","avg"],aI=["sum","mul","concat","ave"],sI=new Map;function oI(t){qD(nI,"DataFormat",t)}function lI(t){qD(rI,"PaddingMode",t)}function uI(t){qD(iI,"PoolMode",t)}const cI=[];function hI(t,e){cI.push(t);try{const t=e();return cI.pop(),t}catch(n){throw cI.pop(),n}}function dI(t){if(!mI(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===cI.length?"":cI.join("/")+"/")+t}function pI(t){if(!mI(t))throw new Error("Not a valid tensor name: '"+t+"'");sI.has(t)||sI.set(t,0);const e=sI.get(t);if(sI.set(t,sI.get(t)+1),e>0){const n=`${t}_${e}`;return sI.set(n,1),n}return t}const fI=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function mI(t){return!!t.match(fI)}function gI(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let i=e;i<n;++i)r*=t[i];return r}function yI(t){return $y(t=Array.isArray(t)?new Float32Array(t):t)}function vI(t){return wv(yI(t)).dataSync()[0]}function _I(t){return kw(yI(t)).dataSync()[0]}function bI(t,e){if(e<t)throw new ID(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}function xI(t,e){return t.asType(e)}function wI(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function SI(t,e,n){return e_(()=>{switch(t.rank){case 1:return Ab(t,e,n);case 2:return Tb(t,[e,0],[n,t.shape[1]]);case 3:return Rb(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Mb(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Eb(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Eb(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new ID("sliceAlongFirstAxis() received an unsupported tensor rank: "+`${t.rank}`)}})}function CI(t,e,n){return e_(()=>{switch(t.rank){case 1:return Ab(t,e,n);case 2:return Tb(t,[0,e],[t.shape[0],n]);case 3:return Rb(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Mb(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new ID("sliceAlongLastAxis() received an unsupported tensor rank: "+`${t.rank}`)}})}function DI(t,e,n,r){return e_(()=>{switch(t.rank){case 1:return Ab(t,e,n);case 2:switch(r){case 1:return SI(t,e,n);case 2:return CI(t,e,n);default:throw new ID("The axis is not within the rank of the tensor "+`${r}`)}case 3:switch(r){case 1:return SI(t,e,n);case 2:return Rb(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return CI(t,e,n);default:throw new ID("The axis is not within the rank of the tensor "+`${r}`)}case 4:switch(r){case 1:return SI(t,e,n);case 2:return Mb(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Mb(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return CI(t,e,n);default:throw new ID("The axis is not within the rank of the tensor "+`${r}`)}default:throw new ID("sliceAlongLastAxis() received an unsupported tensor rank: "+`${t.rank}`)}})}function II(t,e=-1){let n;return e<0&&(n=t[0].rank,e=0!==n?n:0),e===t[0].rank&&(e=-1),Qy(t,e)}function kI(t,e){switch(t.rank){case 1:return tw([t,e]);case 2:return ew([t,e],0);case 3:return nw([t,e],0);case 4:return rw([t,e],0);default:throw new ID("concatAlongFirstAxis() received an unsupported "+`tensor rank: ${t.rank}`)}}function EI(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new ID(`The length of input n (${e.length}) does not match `+`the number of dimensions in input x (${t.rank})`);return sb(t,e)}function AI(t,e=0,n=1,r,i){return Ww(t,e,n,r,i)}function TI(t,e,n,r){if(t.rank<2||e.rank<2)throw new kD("dot requires both inputs to be rank >= 2"+` but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3&&t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new kD("If rank y >= 3, then the second last dim"+` of y must equal the last dim of x but got x shape = ${t.shape} and `+` y shape = ${e.shape}`);if(2===t.rank&&2===e.rank)return g.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?NI(t.rank,r,"channelsLast"):null,activation:n});{const i=t.shape.slice(),a=i.pop();t=t.reshape([-1,a]);const s=e.shape.slice(),o=s.pop(),l=s.pop(),u=[...s,o],c=Array.from({length:e.rank},(t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n);e=e.transpose(c).reshape([l,-1]);const h=[...i,...u];return g.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?NI(t.rank,r,"channelsLast"):null,activation:n}).reshape(h)}}function RI(t,e,n){return e_(()=>(e=Array.isArray(e)?$y(e,"int32"):e.toInt(),Qw(t,e,n)))}function MI(t){return K_(t,t)}function NI(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new ID(`Unexpected bias dimensions: ${e.rank}`+`; expected it to be 1 or ${t}`);if(5===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(t<3)return e;throw new ID(`Unsupported input rank by biasAdd: ${e.rank}`)}function OI(t,e,n){return e_(()=>(null==n&&(n="channelsLast"),oI(n),t.add(NI(t.rank,e,n))))}function PI(t,e,n,r){return e_(()=>US(t,e,n,r))}function FI(t,e,n=!1){return n?t():e()}const LI=["fanIn","fanOut","fanAvg"],zI=["normal","uniform","truncatedNormal"];class $I extends u.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class BI extends $I{apply(t,e){return Gy(t,e)}}BI.className="Zeros",u.registerClass(BI);class WI extends $I{apply(t,e){return Hy(t,e)}}WI.className="Ones",u.registerClass(WI);class qI extends $I{constructor(t){if(super(),"object"!=typeof t)throw new ID(`Expected argument of type ConstantConfig but got ${t}`);if(void 0===t.value)throw new ID(`config must have value set but got ${t}`);this.value=t.value}apply(t,e){return e_(()=>K_(zy(this.value),Hy(t,e)))}getConfig(){return{value:this.value}}}qI.className="Constant",u.registerClass(qI);class VI extends $I{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return qw(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}VI.className="RandomUniform",u.registerClass(VI);class UI extends $I{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new kD(`randomNormal does not support dType ${e}.`);return AI(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}UI.className="RandomNormal",u.registerClass(UI);class jI extends $I{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new kD(`truncatedNormal does not support dType ${e}.`);return jw(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}jI.className="TruncatedNormal",u.registerClass(jI);class HI extends $I{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return e_(()=>{if(2!==t.length||t[0]!==t[1])throw new ID("Identity matrix initializer can only be used for 2D square matrices.");return K_(this.gain,xw(t[0]))})}getConfig(){return{gain:this.gain}}}HI.className="Identity",u.registerClass(HI);class GI extends $I{constructor(t){if(super(),t.scale<0)throw new ID(`scale must be a positive float. Got: ${t.scale}`);this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,qD(LI,"FanMode",this.mode),this.distribution=null==t.distribution?"normal":t.distribution,function(t){qD(zI,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const n=function(t,e="channelsLast"){let n,r;if(oI(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=gI(t,2);n=t[1]*e,r=t[0]*e}else if("channelsLast"===e){const e=gI(t,0,t.length-2);n=t[t.length-2]*e,r=t[t.length-1]*e}}else{const e=gI(t);n=Math.sqrt(e),r=Math.sqrt(e)}return[n,r]}(t),r=n[0],i=n[1];let a=this.scale;if(a/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,i):Math.max(1,(r+i)/2),"normal"===this.distribution){const n=Math.sqrt(a);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new kD(`${this.getClassName()} does not support dType ${e}.`);return jw(t,0,n,e,this.seed)}{const n=Math.sqrt(3*a);return qw(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}GI.className="VarianceScaling",u.registerClass(GI);class JI extends GI{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return GI.className}}JI.className="GlorotUniform",u.registerClass(JI);class XI extends GI{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return GI.className}}XI.className="GlorotNormal",u.registerClass(XI);class KI extends GI{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return GI.className}}KI.className="HeNormal",u.registerClass(KI);class ZI extends GI{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return GI.className}}ZI.className="HeUniform",u.registerClass(ZI);class YI extends GI{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return GI.className}}YI.className="LeCunNormal",u.registerClass(YI);class QI extends GI{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return GI.className}}QI.className="LeCunNormal",u.registerClass(QI);class tk extends $I{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new kD("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return e_(()=>{if(2!==t.length)throw new kD("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+`than 2000 (${t[0]*t[1]}) elements: `+"Slowness may result.");const e=AI(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let n=f.gramSchmidt(e);return t[0]>t[1]&&(n=n.transpose()),K_(this.gain,n)})}getConfig(){return{gain:this.gain,seed:this.seed}}}tk.className="Orthogonal",u.registerClass(tk);const ek={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function nk(t,e={}){return zD(t,u.SerializationMap.getMap().classNameMap,e,"initializer")}function rk(t){return LD(t)}function ik(t){if("string"==typeof t){const e=t in ek?ek[t]:t;if("GlorotNormal"===e)return new XI;if("GlorotUniform"===e)return new JI;if("HeNormal"===e)return new KI;if("HeUniform"===e)return new ZI;if("LeCunNormal"===e)return new YI;if("LeCunUniform"===e)return new QI;{const t={};return t.className=e,t.config={},nk(t)}}return t instanceof $I?t:nk(t)}let ak=0;function sk(){return ak++}const ok={};function lk(t=""){return t in ok||(ok[t]=0),ok[t]+=1,t+ok[t].toString()}function uk(t){return Array.isArray(t)&&Array.isArray(t[0])}function ck(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function hk(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new ID(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function dk(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new ID(`Expected exactly 1 Shape; got ${t.length}`)}return t}function pk(t){let e=0;for(const n of t)e+=0===n.shape.length?1:n.shape.reduce((t,e)=>t*e);return e}class fk{constructor(t,e="float32",n="Variable",r=!0,i=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=sk(),this.originalName=dI(n=null==n?"Variable":n),this.name=pI(this.originalName),this.trainable_=r,this.constraint=i,this.val=jy(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function mk(t){return t.map(t=>t.read())}function gk(t){t.forEach(t=>{t[0].write(t[1])})}class yk{constructor(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class vk{constructor(t,e,n,r,i,a,s){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=s,this.id=sk(),null!=a&&(this.originalName=dI(a),this.name=pI(this.originalName)),this.rank=e.length}}let _k=0;class bk{constructor(t,e){this.callArgs=e,this.id=_k++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)t.push(null!=e?e.name:null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let xk=0;class wk extends u.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=xk++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=OD(t)+"_"+lk(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}this.initialWeights=null!=t.weights?t.weights:null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new DD("The layer has never been called "+`and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new ID(`Asked to get ${e} at node ${t}, `+`but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return MD(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return MD(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new CD(`Layer ${this.name}`+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new CD(`Layer ${this.name}`+" is not connected, no input to return.");return MD(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new CD(`Layer ${this.name}`+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new CD(`Layer ${this.name}`+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return MD(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=ND(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=ND(this.inputSpec);if(t.length!==e.length)throw new ID(`Layer ${this.name} expects ${e.length} inputs, `+`but it received ${t.length} input tensors. `+`Input received: ${t}`);for(let n=0;n<t.length;n++){const r=t[n],i=e[n];if(null==i)continue;const a=r.rank;if(null!=i.ndim&&a!==i.ndim)throw new ID(`Input ${n} is incompatible with layer ${this.name}: `+`expected ndim=${i.ndim}, found ndim=${a}`);if(null!=i.maxNDim&&a>i.maxNDim)throw new ID(`Input ${n} is incompatible with layer ${this.name}`+`: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(null!=i.minNDim&&a<i.minNDim)throw new ID(`Input ${n} is incompatible with layer ${this.name}`+`: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(null!=i.dtype&&r.dtype!==i.dtype)throw new ID(`Input ${n} is incompatible with layer ${this.name} `+`: expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const t=r.shape;for(const e in i.axes){const r=Number(e),a=i.axes[e],s=r>=0?t[r]:t[t.length+r];if(null!=a&&-1===[a,null].indexOf(s))throw new ID(`Input ${n} is incompatible with layer `+`${this.name}: expected axis ${r} of input shape to `+`have value ${a} but got shape ${t}.`)}}if(null!=i.shape)for(let t=0;t<i.shape.length;++t){const e=i.shape[t],a=r.shape[t];if(null!=e&&null!=a&&e!==a)throw new ID(`Input ${n} is incompatible with layer `+`${this.name}: expected shape=${i.shape}, `+`found shape=${r.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=ND(t);let r=!0;for(const a of n)if(!(a instanceof vk)){r=!1;break}let i=!0;for(const a of n)if(a instanceof vk){i=!1;break}if(r===i)throw new ID("Arguments to apply() must be all SymbolicTensors or all Tensors");return hI(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of ND(t))e.push(n.shape);this.build(MD(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(t),i){let r=this.call(t,e);const i=ND(r),a=[];for(let t of i)-1!==n.indexOf(t)&&(t=t.clone()),a.push(t);if(r=MD(a),null!=this.activityRegularizer)throw new kD("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(t){t=ND(t);const e=[];for(const n of t)e.push(n.shape);return MD(e)}(t),r=this.computeOutputShape(n);let i;const a="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,r)=>new vk(a,n,this,ND(t),e,this.name,r)):new vk(a,r,this,ND(t),e,this.name),this.addInboundNode(t,i,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new kD("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+`${JSON.stringify(t)}) does not match that of the `+`batchInputShape (${JSON.stringify(this.batchInputShape)}) `+`of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)}),e&&console.warn("The shape of the input tensor "+`(${JSON.stringify(t)}) does not `+`match the expectation of layer ${this.name}: `+`${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new CD(`The layer ${this.name} has never been called and thus has no `+"defined output shape.");const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new CD(`The layer ${this.name} has multiple inbound nodes with different `+'output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new DD(`You tried to call countParams() on ${this.name}, `+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return pk(this.weights)}build(t){this.built=!0}getWeights(t=!1){return mk(t?this.trainableWeights:this.weights)}setWeights(t){e_(()=>{const e=this.weights;if(e.length!==t.length)throw new ID(`You called setWeights(weights) on layer "${this.name}" `+`with a weight list of length ${t.length}, `+`but the layer was expecting ${e.length} weights. `+`Provided weights: ${t}...`);if(0===e.length)return;const n=[],i=mk(e);for(let a=0;a<i.length;++a){const s=i[a],o=e[a],l=t[a];if(!r.arraysEqual(s.shape,l.shape))throw new ID(`Layer weight shape ${s.shape} `+`not compatible with provided weight shape ${l.shape}`);n.push([o,l])}gk(n)})}addWeight(t,e,n,r,i,a,s){if(-1!==this._addedWeightNames.indexOf(t))throw new ID(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=ik("zeros"));const o=r.apply(e,n),l=new fk(o,n,t,a,s);return o.dispose(),null!=i&&this.addLoss(()=>i.apply(l.read())),null==a&&(a=!0),a?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=ND(t),null!=this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, `+"but was passed an inputMask.");e.forEach(t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, `+"but was passed an inputMask.")})}return null}return e}addInboundNode(t,e,n,r,i,a,s=null){const o=ND(t);e=ND(e),n=ND(n),r=ND(r),i=ck(i),a=ck(a);const l=[],u=[],c=[];for(const h of o)l.push(h.sourceLayer),u.push(h.nodeIndex),c.push(h.tensorIndex);new bk({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:o,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},s);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been `+"built yet.");if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used `+"yet.");this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}class Sk extends wk{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:lk("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new ID("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new ID("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new ID("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new vk(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new bk({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new ID("Cannot pass any input to an "+`InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}async function Ck(t){if(null==t)return;const e=[],n=[],r=[];for(const i in t){const a=t[i];if("number"!=typeof a){const t=a;e.push(t.data()),n.push(i),r.push(t)}}if(e.length>0){const i=await Promise.all(e);for(let e=0;e<i.length;++e)t[n[e]]=i[e][0];n_(r)}}function Dk(t){if(null!=t)for(const e in t){const n=t[e];"number"!=typeof n&&n.dispose()}}var Ik;Sk.className="InputLayer",u.registerClass(Sk),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(Ik||(Ik={}));class kk{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class Ek{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class Ak extends kk{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const r in e){const t=e[r];if("number"==typeof t)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+t*n;else{let e;r in this.totals?e=this.totals[r]:this.totals[r]=0;const i=e_(()=>a_(this.totals[r],K_(t,n)));this.totals[r]=i,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params.metrics)null!=this.totals[n]&&("number"==typeof this.totals[n]?e[n]=this.totals[n]/this.seen:e_(()=>{const t=K_(nb(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),r_(e[n])}))}}class Tk extends kk{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const i in this.history){const r=this.history[i];for(let a=0;a<r.length;++a)"number"!=typeof r[a]&&(t.push(r[a].data()),e.push(i),n.push(a))}const r=await Promise.all(t);for(let i=0;i<r.length;++i)this.history[e[i]][n[i]].dispose(),this.history[e[i]][n[i]]=r[i][0]}}class Rk extends kk{constructor(t,e){if(super(),this.currentEpoch=0,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");r.isNumber(this.yieldEvery)&&(this.maybeWait=function(t,e){let n,i=r.now();return(...a)=>{const s=r.now();return s-i<e||(i=s,n=t(...a)),n}}(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await Ck(n),r.push(this.yield(t,e,n))),r.push(jC()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await Ck(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await Ck(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(jC()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await Ck(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await Ck(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(jC()):r.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await Ck(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await Ck(t),await this.trainEnd(t))}}function Mk(t,e){return null==t&&(t={}),t instanceof kk?[t]:Array.isArray(t)&&t[0]instanceof kk?t:ND(t).map(t=>new Rk(t,e))}class Nk{constructor(){}static registerCallbackConstructor(t,e){r.assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, "+`but got ${t}`),Nk.checkForDuplicate(e),null==Nk.constructors[t]&&(Nk.constructors[t]=[]),Nk.constructors[t].push(e)}static checkForDuplicate(t){for(const e in Nk.constructors)Nk.constructors[+e].forEach(e=>{if(e===t)throw new ID("Duplicate callback constructor.")})}static clear(){Nk.constructors={}}static createCallbacks(t){const e=[];for(const n in Nk.constructors){const r=+n;t>=r&&e.push(...Nk.constructors[r])}return e.map(t=>new t)}}function Ok(t,e,n,r,i,a,s,o,l){const u=new Tk,c=[new Ak,...Nk.createCallbacks(e)];null!=t&&c.push(...t),c.push(u);const h=new Ek(c);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:s,verbose:e,doValidation:o,metrics:l}),{callbackList:h,history:u}}function Pk(t,e={},n=!1){return zD(t,u.SerializationMap.getMap().classNameMap,e,"layer",n)}function Fk(t,e){return e_(()=>{"float32"!==t.dtype&&(t=t.asType("float32"));const n=Cv(MI(t),e,!0),r=Jy(n.shape,SD()),i=F_(U_(n,r));return nb(t,i)})}function Lk(t,e){return e_(()=>xv(MI(ab(e,t)),-1))}function zk(t,e){return e_(()=>xv(s_(ab(e,t)),-1))}function $k(t,e){return e_(()=>{const n=ab(t,e),r=f_(s_(t),SD(),Number.MAX_VALUE),i=s_(nb(n,r));return K_(100,xv(i,-1))})}function Bk(t,e,n=!1){return e_(()=>{if(n)e=AS(e);else{const t=Cv(e,e.shape.length-1,!0);e=nb(e,t)}return e=f_(e,SD(),1-SD()),C_(Cv(K_(t.toFloat(),x_(e)),e.shape.length-1))})}function Wk(t,e,n=!1){return e_(()=>{const r=b_(function(t){const e=[gI(t.shape)];return t.reshape(e)}(t)).toInt(),i=(e=f_(e,SD(),1-SD())).shape;return Bk(Px(r,i[i.length-1]).reshape(i),e,n)})}function qk(t,e){return e_(()=>{let n;return n=f_(e,SD(),1-SD()),n=x_(nb(n,ab(1,n))),xv(function(t,e){if(!r.arraysEqual(t.shape,e.shape))throw new ID("logits and labels must have the same shape, but got shapes "+`${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return e_(()=>{const n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())})}(t,n),-1)})}function Vk(t,e){return e_(()=>{const n=Fk(t,-1),r=Fk(e,-1),i=K_(n,r);return C_(Cv(i,-1))})}Nk.constructors={};const Uk={meanSquaredError:Lk,meanAbsoluteError:zk,meanAbsolutePercentageError:$k,meanSquaredLogarithmicError:function(t,e){return e_(()=>{const n=f_(e,SD(),Number.MAX_VALUE),r=x_(a_(1,n)),i=f_(t,SD(),Number.MAX_VALUE),a=x_(a_(1,i));return xv(MI(ab(r,a)),-1)})},squaredHinge:function(t,e){return e_(()=>{const n=U_(0,ab(1,K_(t,e)));return xv(MI(n),-1)})},hinge:function(t,e){return e_(()=>{const n=U_(0,ab(1,K_(t,e)));return xv(n,-1)})},categoricalHinge:function(t,e){return e_(()=>{const n=Cv(K_(t,e),-1),r=kw(K_(ab(1,t),e),-1);return U_(0,a_(1,ab(r,n)))})},logcosh:function(t,e){return e_(()=>{const n=Math.log(2),r=ab(e,t),i=ab(a_(r,P_(K_(-2,r))),n);return xv(i,-1)})},categoricalCrossentropy:Bk,sparseCategoricalCrossentropy:Wk,binaryCrossentropy:qk,kullbackLeiblerDivergence:function(t,e){return e_(()=>{const n=f_(t,SD(),1),r=f_(e,SD(),1);return Cv(K_(t,x_(nb(n,r))),-1)})},poisson:function(t,e){return e_(()=>{const n=x_(a_(SD(),e));return xv(ab(e,K_(t,n)),-1)})},cosineProximity:Vk};function jk(t){if("string"==typeof t){if(t in Uk)return Uk[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. `+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ID(e)}return t}function Hk(t,e){return e_(()=>{const n=K_(.5,Zy(e)),r=xI(ww(e,n),t.dtype);return xv(bw(t,r),-1)})}function Gk(t,e){return e_(()=>xI(bw(vv(t,-1),vv(e,-1)),"float32"))}function Jk(t,e){return qk(t,e)}function Xk(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),bw(t,e).asType("float32")}const Kk=Bk,Zk=Wk,Yk={binaryAccuracy:Hk,categoricalAccuracy:Gk,precision:function(t,e){return e_(()=>{const n=function(t,e){return e_(()=>dw(t.equal(1),e.equal(1)).sum().cast("float32"))}(t,e),r=function(t,e){return e_(()=>dw(t.equal(0),e.equal(1)).sum().cast("float32"))}(t,e),i=n.add(r);return gw(ww(i,0),n.div(i),0).cast("float32")})},categoricalCrossentropy:Kk,sparseCategoricalCrossentropy:Zk,mse:Lk,MSE:Lk,mae:zk,MAE:zk,mape:$k,MAPE:$k,cosine:Vk};function Qk(t){if("string"==typeof t&&t in Yk)return Yk[t];if("string"!=typeof t&&null!=t)return t;throw new ID(`Unknown metric ${t}`)}function tE(t){if(TD(null!==t,`Unknown LossOrMetricFn ${t}`),"string"==typeof t)return t;{let e;for(const n of Object.keys(Uk))if(Uk[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(Yk))if(Yk[n]===t){e=n;break}return void 0!==e?e:t.name}}function eE(t,e,n=!1){if(null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!function t(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const n=Object.keys(e);for(const r of n){if("string"!=typeof r)return!1;if(!t(e[r]))return!1}return!0}if(Array.isArray(e)){for(const n of e)if(!t(n))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>1048576&&console.warn(`User-defined metadata of model "${e}" is too large in `+`size (length=${n.length} when serialized). It is not `+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.")}}function nE(t,e,n=console.log){let r="";for(let i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=t[i],r=r.slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function rE(t,e,n){let r;try{r=JSON.stringify(t.outputShape)}catch(s9){r="multiple"}nE([`${t.name} (${t.getClassName()})`,r,t.countParams().toString()],e,n)}function iE(t,e,n,r){let i;try{i=JSON.stringify(t.outputShape)}catch(s9){i="multiple"}const a=[];for(const u of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(let t=0;t<u.inboundLayers.length;++t)a.push(`${u.inboundLayers[t].name}[${u.nodeIndices[t]}][${u.tensorIndices[t]}]`);const s=t.name,o=t.getClassName(),l=0===a.length?"":a[0];nE([`${s} (${o})`,i,t.countParams().toString(),l],e,r);for(let u=1;u<a.length;++u)nE(["","","",a[u]],e,r)}function aE(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function sE(t,e){if(null===t)return null;if("string"==typeof t)return PD(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];aE(e,i,r)?n.push(r):n.push(sE(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"==typeof r)e[n]=r;else{const t=PD(n);e[t]=sE(r,t)}}return e}}class oE{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof oE)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new ID(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return nv(e,t.dtype)}catch(s9){throw new ID(`The dtype of the feed (${e.dtype}) can not be cast to the dtype `+`of the key '${t.name}' (${t.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof vk){if(null==this.id2Value[t.id])throw new ID(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new ID(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof vk){if(null==this.id2Value[t.id])throw new ID(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new ID(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&n_(this.id2Mask)}}const lE={},uE={};function cE(t,e,n,i){const a=null!=n&&n.training,s=Array.isArray(t),o=s?t:[t],l=o.map(t=>t.name),u=[],c=e.names();for(const r of l)-1!==c.indexOf(r)?u.push(e.getValue(r)):u.push(null);null!=i&&(i.maxNumTensors=-1/0,i.minNumTensors=1/0);const h=l.join(",")+"|"+e.names().join(",");let d,p;if(null==lE[h]){const t=function(t,e){r.assert(null!=t&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],i={};if(1===t.length){const r=dE(t[0],e);n=r.sorted,i=r.recipientMap}else{const r=new Set;for(const a of t){const{sorted:t,recipientMap:s}=dE(a,e);for(const e of t)r.has(e.name)||(n.push(e),r.add(e.name));for(const e in s)null==i[e]&&(i[e]=new Set),s[e].forEach(t=>i[e].add(t))}}return{sorted:n,recipientCounts:hE(i)}}(o,e);d=t.sorted,p=t.recipientCounts,lE[h]=d,uE[h]=p}d=lE[h],p={},a||Object.assign(p,uE[h]);const f=new oE(e);for(let r=0;r<d.length;++r){if(null!=i){const t=t_().numTensors;t>i.maxNumTensors&&(i.maxNumTensors=t),t<i.minNumTensors&&(i.minNumTensors=t)}const t=d[r],s=t.sourceLayer;if(s instanceof Sk)continue;const o=[],c=[],h=[];let m=!1;for(const n of t.inputs){const t=f.getValue(n),r=f.getMask(n);o.push(t),c.push(r),null!=r&&(m=!0),a||(p[n.name]--,0!==p[n.name]||e.hasKey(n)||-1!==l.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||h.push(t))}m&&((n=n||{}).mask=c[0]);const g=ND(s.apply(o,n));let y=null;s.supportsMasking&&(y=s.computeMask(o,c));const v=pE(t),_=Array.isArray(v)?v:[v];for(let e=0;e<_.length;++e){f.hasKey(_[e])||f.add(_[e],g[e],Array.isArray(y)?y[0]:y);const t=l.indexOf(_[e].name);-1!==t&&(u[t]=g[e])}a||n_(h)}return f.disposeMasks(),s?u:u[0]}function hE(t){const e={};for(const n in t)e[n]=t[n].size;return e}function dE(t,e){const n=new Set,r=[],i={};for(const o of e.names())n.add(o);const a=[],s=[];for(a.push(t);a.length>0;){const t=a[a.length-1];if(n.has(t.name)){a.pop();continue}const e=s[s.length-1]===a.length-1;if(0===t.inputs.length||e)a.pop(),r.push(t),n.add(t.name),e&&s.pop();else{s.push(a.length-1);for(const e of t.inputs)null==i[e.name]&&(i[e.name]=new Set),i[e.name].add(t.name),n.has(e.name)||a.push(e)}}return{sorted:r,recipientMap:i}}function pE(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}class fE extends wk{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=lk(t)}if(this.supportsMasking=!1,this.trainable_=!0,this.inputs=Array.isArray(t.inputs)?t.inputs.slice():[t.inputs],this.outputs=Array.isArray(t.outputs)?t.outputs.slice():[t.outputs],BD(this.inputs).length!==this.inputs.length)throw new ID("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+`${this.inputs.map(t=>t.name)}`);BD(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+`${this.outputs.map(t=>t.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const t=y.nodeIndex,e=y.tensorIndex;this.outputLayers.push(y.sourceLayer),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(e)}for(const y of this.inputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;TD(0===e,"input layer has >1 nodes"),TD(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const e=this.inputLayers[y];if(!(e instanceof Sk))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+`Received inputs: ${t.inputs}. `+`Input ${y} (0-based) originates `+`from layer type ${e.getClassName()}.`);this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(t=>t.shape),this.internalOutputShapes=this.outputs.map(t=>t.shape);const e={},n={},r={},i={},a={},s=[],o=(t,e,n,r,i,l)=>{null!=r&&null!=i&&null!=l||(r=t.sourceLayer,i=t.nodeIndex,l=t.tensorIndex);const u=r.inboundNodes[i];if(-1!==n.indexOf(u))throw new DD(`The tensor ${t.name} at layer "${r.name}" `+"is part of a cycle.");if(-1!==e.indexOf(u))return;this.containerNodes.add(fE.nodeKey(r,i)),r.id in a||(a[r.id]=Object.keys(a).length),-1===n.indexOf(u)&&n.push(u);const c=u.inboundLayers.length;for(let a=0;a<c;a++)o(u.inputTensors[a],e,n,u.inboundLayers[a],u.nodeIndices[a],u.tensorIndices[a]);for(e.push(u);n.indexOf(u)>=0;)n.splice(n.indexOf(u),1);s.push(u)},l=[],u=[];for(const y of this.outputs)o(y,l,u);const c=s.slice().reverse();for(const y of c){n[y.id]=y,y.id in e||(e[y.id]=0);let t=e[y.id];t=Math.max(t,null==r[y.outboundLayer.id]?0:r[y.outboundLayer.id]),r[y.outboundLayer.id]=t,i[y.outboundLayer.id]=y.outboundLayer,e[y.id]=t;for(let r=0;r<y.inboundLayers.length;r++){const i=y.inboundLayers[r].inboundNodes[y.nodeIndices[r]];e[i.id]=Math.max(t+1,null==e[i.id]?0:e[i.id]),n[i.id]=i}}const h={};for(const y in e){const t=e[y];t in h||(h[t]=[]),h[t].push(n[y])}const d={};for(const y in r){const t=r[y];t in d||(d[t]=[]),d[t].push(i[y])}let p=Object.keys(d).map(t=>parseInt(t,10)).sort($D);this.layers=[];for(const y of p){const t=d[y];t.sort((t,e)=>{const n=a[t.id],r=a[e.id];return n<r?-1:n>r?1:0});for(const e of t)e instanceof fE&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,p=Object.keys(h).map(t=>parseInt(t,10)).sort($D);const f=this.inputs.slice(),m=[];for(const y of p)for(const t of h[y]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===f.indexOf(n))throw new DD(`Graph disconnected: cannot obtain value for tensor ${n}`+` at layer "${e.name}". `+"The following previous layers were accessed without "+`issue: ${m}`);for(const e of t.outputTensors)f.push(e);m.push(e.name)}}this.nodesByDepth=h;const g=this.layers.map(t=>t.name);for(const y of g){const t=g.filter(t=>t===y).length;if(1!==t)throw new DD(`The name "${y}" is used ${t} times `+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new bk({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(t=>null),outputMasks:this.outputs.map(t=>null),inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs.map(t=>t.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(e=>e.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new ID("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const n={};let r=0;for(const a of this.layers)for(const t of a.weights){if(null!=n[t.originalName])throw new ID(`Duplicate weight name: ${t.originalName}`);n[t.originalName]=t,r++}const i=[];for(const a in t){if(null!=n[a])i.push([n[a],t[a]]);else if(e)throw new ID(`Provided weight data has no target variable: ${a}`);delete n[a]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new ID(`${t.length} of ${r} weights are not set: `+`${t}`)}gk(i)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 2.0.0",e.backend="TensorFlow.js",e}toJSON(t,e=!0){const n=function t(e,n){if(null==e)return null;if("string"==typeof e)return OD(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){const r=[],i=e.length;for(let a=0;a<i;++a){const i=e[a];aE(n,a,i)?r.push(i):r.push(t(i,n))}return r}{const n={};for(const r of Object.keys(e)){const i=e[r];n[OD(r)]="name"!==r&&"className"!==r||"string"!=typeof i?t(i,r):i}return n}}(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return e_(()=>{t=ND(t);const n=new oE;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return cE(this.outputs,n,e)})}computeMask(t,e){return e_(()=>{let n;return t=ND(t),n=null==e?AD(null,t.length):ND(e),this.runInternalGraph(t,n)[1]})}computeOutputShape(t){const e=ck(t);if(e.length!==this.inputLayers.length)throw new ID(`Invalid inputShape argument ${t}: `+`model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let s=0;s<e.length;s++)n[this.inputLayers[s].name+"_0_0"]=e[s];const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort($D);if(r.length>1)for(const s of r){const t=this.nodesByDepth[s];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map(t=>t.id).indexOf(t.id))continue;const r=[];for(let s=0;s<e.inboundLayers.length;s++)r.push(n[`${e.inboundLayers[s].name}_${e.nodeIndices[s]}_${e.tensorIndices[s]}`]);const i=ck(t.computeOutputShape(MD(r))),a=t.inboundNodes.indexOf(e);for(let e=0;e<i.length;e++)n[`${t.name}_${a}_${e}`]=i[e]}}const i=[],a=[];for(let s=0;s<this.outputLayers.length;s++)a.push(`${this.outputLayers[s].name}_${this.outputLayersNodeIndices[s]}_${this.outputLayersTensorIndices[s]}`);for(let s=0;s<a.length;s++){const t=a[s];TD(t in n),i.push(n[t])}return MD(i)}runInternalGraph(t,e){null==e&&(e=AD(null,t.length));const n={};for(let o=0;o<this.inputs.length;++o)n[this.inputs[o].id]=[t[o],e[o]];const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort($D);for(const o of r){const t=this.nodesByDepth[o];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,i=e.outputTensors,a=new Array;for(const e of r)e.id in n&&a.push(n[e.id]);if(a.length===r.length){let r,s,o,l,u={};if(null!=e.callArgs&&(u=e.callArgs),1===a.length){const[e,n]=a[0];null==u.mask&&(u.mask=n),o=ND(t.call(e,u)),l=ND(t.computeMask(e,n)),r=[e],s=[n]}else r=a.map(t=>t[0]),s=a.map(t=>t[1]),null==u.mask&&(u.mask=s),o=ND(t.call(r,u)),l=ND(t.computeMask(r,s));if(t.activityRegularizer)throw new kD("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<i.length;++t)n[i[t].id]=[o[t],l[t]]}}}const i=[],a=[],s=[];for(const o of this.outputs){TD(o.id in n,`Could not compute output ${o.name} : ${o.id}`);const[t,e]=n[o.id];s.push(t.shape),i.push(t),a.push(e)}return[i,a,s]}buildNodeConversionMap(t){const e={};let n;for(const r of this.layers){n=r instanceof fE?1:0;for(let t=0;t<r.inboundNodes.length;t++){const i=fE.nodeKey(r,t);this.containerNodes.has(i)&&(e[i]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new ID(`Was asked to retrieve layer at index ${e}, but model only `+`has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new ID("Provide either a layer name or layer index");for(const n of this.layers)if(n.name===t)return n;throw new ID(`No such layer: ${t}`)}calculateLosses(){return e_(()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=fE.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const a of this.layers){const t=a.getClassName(),r=a.getConfig(),i=[];for(let n=0;n<a.inboundNodes.length;n++){const t=a.inboundNodes[n],r=fE.nodeKey(a,n);let s={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),s=t.callArgs}catch(s9){console.warn(`Layer ${a.name} was passed `+"non-serializable keyword arguments: "+`${t.callArgs}. They will not be included `+"in the serialized model (and thus will be missing at deserialization time)."),s={}}if(t.inboundLayers.length>0){const n=[];for(let r=0;r<t.inboundLayers.length;r++){const i=t.inboundLayers[r],a=t.tensorIndices[r];let o=e[fE.nodeKey(i,t.nodeIndices[r])];null==o&&(o=0),n.push([i.name,o,a,s])}i.push(n)}}}const s={};s.name=a.name,s.className=t,s.config=r,s.inboundNodes=i,n.push(s)}t.layers=n;const r=[];for(let a=0;a<this.inputLayers.length;a++){const t=this.inputLayers[a],n=fE.nodeKey(t,this.inputLayersNodeIndices[a]);if(!this.containerNodes.has(n))continue;let i=e[n];null==i&&(i=0),r.push([t.name,i,this.inputLayersTensorIndices[a]])}t.inputLayers=r;const i=[];for(let a=0;a<this.outputLayers.length;a++){const t=this.outputLayers[a],n=fE.nodeKey(t,this.outputLayersNodeIndices[a]);if(!this.containerNodes.has(n))continue;let r=e[n];null==r&&(r=0),i.push([t.name,r,this.outputLayersTensorIndices[a]])}return t.outputLayers=i,t}static fromConfig(t,e,n={},r=!1){const i={},a={};function s(t,e){t.name in a?a[t.name].push(e):a[t.name]=[e]}function o(t,e){const n=[];let r;for(const a of e){const o=a[0],l=a[1],u=a[2];if(r=null==a[3]?{}:a[3],!(o in i))return void s(t,e);const c=i[o];if(c.inboundNodes.length<=l)return void s(t,e);n.push(c.inboundNodes[l].outputTensors[u])}n.length>0&&t.apply(MD(n),r)}function l(t){const n=t.name,a=Pk(t,null!=e.customObjects?e.customObjects:{});a.setFastWeightInitDuringBuild(r),i[n]=a,t.inboundNodes.forEach(t=>{if(!(t instanceof Array))throw new ID(`Corrupted configuration, expected array for nodeData: ${t}`);s(a,t)})}const u=e.name,c=e.layers;for(const m of c)l(m);for(;!WD(a);)for(const t of c){const e=i[t.name];if(e.name in a){const t=a[e.name];delete a[e.name];for(const n of t)o(e,n)}}const h=[],d=[],p=e.inputLayers;for(const m of p){const t=m[0],e=m[1],n=m[2];TD(t in i),h.push(i[t].inboundNodes[e].outputTensors[n])}const f=e.outputLayers;for(const m of f){const t=m[0],e=m[1],n=m[2];TD(t in i),d.push(i[t].inboundNodes[e].outputTensors[n])}return new t({inputs:h,outputs:d,name:u})}get stateful(){if(this._stateful)throw new ID("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){e_(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}function mE(t,e){return function(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>null);if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided classWeight is an array of ${t.length} `+`element(s), but the model has ${r} outputs. `+"Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){const n=[];return e.forEach(e=>{n.push(e in t?t[e]:null)}),n}throw new Error(`The model has multiple (${r}) outputs, `+"so classWeight must be either an array with "+`${r} elements or an object with ${e} keys. `+`Provided classWeight not understood: ${JSON.stringify(t)}`)}(t,e)}async function gE(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=e_(()=>{if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) `+"during handling of class weights. The size is expected to be >= 1.")}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during `+"handling of class weights. The rank is expected to be 1 or 2.")}),r=Array.from(await e.data());n_(e);const i=[];return r.forEach(t=>{if(null==n[t])throw new Error("classWeight must contain all classes in the training data. "+`The class ${t} exists in the data but not in `+"classWeight");i.push(n[t])}),$y(i,"float32")}return null}function yE(t,e){return K_(t,e)}function vE(t,e){let n,i;n=e.xs,i=e.ys,r.assert(null!=n&&null!=i,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+`${e}`);const a=_E("input",t.inputNames,n),s=_E("output",t.outputNames,i),o=a[0].shape[0];r.assert(a.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset `+`provides ${a.length} inputs.  (Expected input keys: `+`${JSON.stringify(t.inputNames)})`),r.assert(s.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset `+`provides ${s.length} outputs.  (Expected output keys: `+`${JSON.stringify(t.outputNames)})`);for(let l=0;l<a.length;l++)r.assert(a[l].shape[0]===o,()=>"Batch size mismatch: input "+`${t.inputNames[l]} has ${a[l].shape[0]}; `+`expected  ${o} based on input ${t.inputNames[0]}.`);for(let l=0;l<s.length;l++)r.assert(s[l].shape[0]===o,()=>"Batch size mismatch: output "+`${t.outputNames[l]} has ${s[l].shape[0]}; `+`expected  ${o} based on input ${t.inputNames[0]}.`);return{xs:a,ys:s}}function _E(t,e,n){if(n instanceof Jg)return[n];if(Array.isArray(n))return r.assert(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const i of e){if(null==n[i])throw new ID("The feature data generated by the dataset lacks the required "+`${t} key '${i}'.`);r.push(n[i])}return r}}function bE(t){return"function"==typeof t.iterator}function xE(t){r.assert(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function wE(t,e,n){return null==t?[null]:Array.isArray(t)?t.map(t=>SI(t,e,n-e)):SI(t,e,n-e)}function SE(t,e){return e_(()=>null==t?null:Array.isArray(t)?t.map(t=>SE(t,e)):RI(t,"int32"===e.dtype?e:e.toInt()))}function CE(t,e){const n=[];let r=0,i=null;for(;r<t;)i=r+e,i>=t&&(i=t),n.push([r,i]),r=i;return n}function DE(t){const e=[];t instanceof Jg&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(wI(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function IE(t,e){if(null==t)return;const n=[];if(e instanceof Jg)n.push(e.id);else if(Array.isArray(e))e.forEach(t=>n.push(t.id));else if(null!=e)for(const i in e)n.push(e[i].id);const r=[];if(t instanceof Jg)-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach(t=>{-1===n.indexOf(t.id)&&r.push(t)});else if(null!=t)for(const i in t){const e=t[i];-1===n.indexOf(e.id)&&r.push(e)}r.forEach(t=>{t.isDisposed||t.dispose()})}function kE(t){return Array.isArray(t)}function EE(t){return!function(t){return t instanceof Jg}(t)&&!kE(t)}function AE(t,e,n,r=!0,i=""){if(null==e||0===e.length){if(null!=t){let e=!1;if(kE(t)&&t.length>0)e=!0;else if(EE(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new ID(`Error when checking model ${i} expected no data, `+`but got ${t}`)}return[]}if(null==t)return e.map(t=>null);let a;if(EE(t)){t=t,a=[];for(const n of e){if(null==t[n])throw new ID(`No data provided for "${n}". Need data for each key in: `+`${e}`);a.push(t[n])}}else if(kE(t)){if((t=t).length!==e.length)throw new ID(`Error when checking model ${i}: the Array of `+"Tensors that you are passing to your model is not the size the "+`model expected. Expected to see ${e.length} Tensor(s), but `+`instead got the following list of Tensor(s): ${t}`);a=t}else{if(t=t,e.length>1)throw new ID(`The model ${i} expects ${e.length} Tensor(s), `+`but only received one Tensor. Found: Tensor with shape ${t.shape}`);a=[t]}if(a=DE(a),null!=n)for(let s=0;s<e.length;++s){if(null==n[s])continue;const t=a[s];if(t.shape.length!==n[s].length)throw new ID(`Error when checking ${i}: expected ${e[s]} `+`to have ${n[s].length} dimension(s). but got array with `+`shape ${t.shape}`);for(let a=0;a<n[s].length;++a){if(0===a&&!r)continue;const o=t.shape[a],l=n[s][a];if(null!=l&&l>=0&&o!==l)throw new ID(`Error when checking ${i}: expected ${e[s]} `+`to have shape [${n[s]}], but got array with shape `+`[${t.shape}].`)}}return a}function TE(t,e,n,r=!0,i=""){let a;if(Array.isArray(t)){if(t.length!==e.length)throw new ID(`Error when checking model ${i}: the Array of `+"Tensors that you are passing to your model is not the size the "+`the model expected. Expected to see ${e.length} Tensor(s),`+` but instead got ${t.length} Tensors(s).`);a=t}else{if(e.length>1)throw new ID(`The model expects ${e.length} ${i} Tensors, `+"but only received one Tensor. Found: array with shape "+`${JSON.stringify(t.shape)}.`);a=[t]}if(null!=n)for(let s=0;s<e.length;++s){if(null==n[s])continue;const t=a[s];if(t.shape.length!==n[s].length)throw new ID(`Error when checking ${i}: expected ${e[s]} `+`to have ${n[s].length} dimension(s), but got array with `+`shape ${JSON.stringify(t.shape)}`);for(let a=0;a<n[s].length;++a){if(0===a&&!r)continue;const o=t.shape[a],l=n[s][a];if(null!=l&&l!==o)throw new ID(`Error when checking ${i}: expected `+`${e[s]} to have shape ${JSON.stringify(n[s])} but `+`got array with shape ${JSON.stringify(t.shape)}.`)}}}class RE extends fE{constructor(t){super(t),this.isTraining=!1}summary(t,e,n=console.log){if(!this.built)throw new ID("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,r=console.log){const i=function(t){let e=!0;const n=[],r=[];for(const i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(const i of n){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){e=!1;break}r.push(...i)}if(e)for(const i of t.layers){let t=!1;for(const n of i.inboundNodes)if(-1!==r.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),a=["Layer (type)","Output shape","Param #"];let s;if(i?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(t=>Math.floor(e*t))),!i){a.push("Receives inputs"),s=[];for(const e in t.nodesByDepth)s.push(...t.nodesByDepth[e])}r("_".repeat(e)),nE(a,n,r),r("=".repeat(e));const o=t.layers;for(let c=0;c<o.length;++c)i?rE(o[c],n,r):iE(o[c],n,s,r),r((c===o.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=function(t){let e;return e=pk(null!=t.collectedTrainableWeights?t.collectedTrainableWeights:t.trainableWeights),e}(t),u=pk(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>VC.adagrad(.01),Adadelta:()=>VC.adadelta(1,.95,SD()),Adam:()=>VC.adam(.001,.9,.999,SD()),Adamax:()=>VC.adamax(.002,.9,.999,SD(),0),RMSProp:()=>VC.rmsprop(.001,.9,0,SD()),SGD:()=>VC.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new ID(`Unknown Optimizer ${t}`)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof OC))throw new ID("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new ID("When passing an Array as loss, it should have one entry per "+`model output. The model has ${this.outputs.length} output(s), `+`but you passed loss=${t.loss}.`);e=t.loss.map(t=>jk(t))}else{const n=jk(t.loss);this.outputs.forEach(t=>{e.push(n)})}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new ID(`Unknown entry in loss dictionary: "${e}". `+`Only expected the following keys: ${this.outputNames}`);for(const n of this.outputNames)null==t.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume `+"this was done on purpose, and we will not be expecting data "+`to be passed to ${n} during training`),e.push(jk(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const t=this.internalOutputShapes[a];this.feedOutputNames.push(this.outputNames[a]),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[a])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],hI("loss",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}});const r=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>[]);let n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+`function, Array, or Object, found: ${t}`);n=t}if(Array.isArray(n))return e.map(t=>n);{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),i=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};hI("metric",()=>{for(let t=0;t<this.outputs.length;++t)-1===n.indexOf(t)&&(e=>{let n,r,a;for(const s of e){if("string"==typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){const e=this.internalOutputShapes[t];let i;1===e[e.length-1]||this.lossFunctions[t]===qk?-1!==["accuracy","acc"].indexOf(s)?r=Hk:-1!==["crossentropy","ce"].indexOf(s)&&(r=Jk):this.lossFunctions[t]===Wk?-1!==["accuracy","acc"].indexOf(s)?r=Xk:-1!==["crossentropy","ce"].indexOf(s)&&(r=Zk):-1!==["accuracy","acc"].indexOf(s)?r=Gk:-1!==["crossentropy","ce"].indexOf(s)&&(r=Kk),-1!==["accuracy","acc"].indexOf(s)?i="acc":-1!==["crossentropy","ce"].indexOf(s)&&(i="ce"),a=r,n=""+i}else{const t=Qk(s);a=t,n=""+tE(s)}let e;hI(n,()=>{e=a}),i(t,n,e)}})(r[t])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,n={}){const r=null==n.batchSize?32:n.batchSize;xE(r);const i=this.standardizeUserDataXY(t,e,!0,r);try{const a=i[0].concat(i[1]);return this.makeTestFunction(),MD(this.testLoop(this.testFunction,a,r,n.verbose,n.steps))}finally{IE(i[0],t),IE(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const i=null!=(n=n||{}).batches,a=t.testFunction;let s=[];if(n.verbose>0)throw new kD("Verbose mode is not implemented yet.");r.assert(!i||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but "+`received ${JSON.stringify(n.batches)}`);const o="function"==typeof e.next?e:await e.iterator();let l=0,u=0;for(;!i||u<n.batches;){const e=await o.next();if(s=e_(()=>{if(e.value){const{xs:n,ys:r}=vE(t,e.value),i=n.concat(r),o=e_(()=>a(i));if(n_(i),0===u)for(let t=0;t<o.length;++t)s.push(zy(0));const c=i[0].shape[0];for(let t=0;t<o.length;++t){const e=o[t],n=s[t];s[t]=e_(()=>a_(s[t],K_(c,e))),u>0&&n_(n)}n_(o),l+=c,++u}return s}),e.done){i&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+`batches (in this case, ${n.batches} batches). `+"You may need to use the repeat() function when building your dataset.");break}}for(let r=0;r<s.length;++r){const t=s[r];s[r]=nb(s[r],l),n_(t)}return MD(s)}(this,t,e)}checkNumSamples(t,e,n,r="steps"){let i;if(null!=n){if(i=null,null!=e)throw new ID(`If ${r} is set, batchSize must be null or undefined.`+`Got batchSize = ${e}`)}else{if(null==t)throw new ID("Either the input data should have a defined shape, or "+`${r} shoud be specified.`);i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new ID("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=this.retrieveSymbolicTensors(n?e:[e]),i=new oE;if(t instanceof Jg&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new ID(`The number of inputs provided (${t.length}) `+"does not match the number of inputs of this model "+`(${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)i.add(this.inputs[e],t[e])}else for(const s of this.inputs){const e=t[s.name];if(null==e)throw new ID(`No value is provided for the model's input ${s.name}`);i.add(s,e)}const a=cE(r,i);return n?a:a[0]}retrieveSymbolicTensors(t){const e=AD(null,t.length);let n=t.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],a=i.map(t=>t.name);for(let r=0;r<t.length;++r){const s=a.indexOf(t[r]);if(-1!==s&&(e[r]=i[s],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach((e,r)=>{null==e&&n.push(t[r])}),new ID("Cannot find SymbolicTensors for output name(s): "+`${JSON.stringify(n)}`)}return e}predictLoop(t,e=32,n=!1){return e_(()=>{const r=this.checkNumSamples(t);if(n)throw new kD("Verbose predictLoop() is not implemented yet.");const i=CE(r,e),a=this.outputs.map(t=>[]);for(let e=0;e<i.length;++e)e_(()=>{const n=wE(t,i[e][0],i[e][1]),r=[];if(Array.isArray(n))for(let t=0;t<n.length;++t)r.push({key:this.inputs[t],value:n[t]});else r.push({key:this.inputs[0],value:n});const a=new oE(r);return cE(this.outputs,a)}).forEach((t,e)=>a[e].push(t));return MD(a.map(t=>Qy(t,0)))})}predict(t,e={}){const n=DE(t);TE(n,this.inputNames,this.feedInputShapes,!1);try{const r=null==e.batchSize?32:e.batchSize;return xE(r),this.predictLoop(n,r)}finally{IE(n,t)}}predictOnBatch(t){TE(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,n=!0,i){if(null==this.optimizer_)throw new DD("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let r=0;r<this.feedOutputShapes.length;++r){const t=this.feedOutputShapes[r];a.push(this.feedLossFns[r]===Wk?t.slice(0,t.length-1).concat([1]):t)}if(function(t,e,n){const i=BD(t.map(t=>t.shape[0]));i.sort();const a=BD(e.map(t=>t.shape[0]));if(a.sort(),i.length>1)throw new ID("All input Tensors (x) should have the same number of samples. Got array shapes: "+`${JSON.stringify(t.map(t=>t.shape))}`);if(a.length>1)throw new ID("All target Tensors (y) should have the same number of samples. Got array shapes: "+`${JSON.stringify(e.map(t=>t.shape))}`);if(i.length>0&&a.length>0&&!r.arraysEqual(i,a))throw new ID("Input Tensors should have the same number of samples as target "+`Tensors. Found ${i[0]} input sample(s) and ${a[0]} target `+"sample(s).")}(t=AE(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=AE(e,this.feedOutputNames,a,!1,"target")),function(t,e,n){const r=[Lk,qk,Bk];for(let i=0;i<t.length;++i){const a=t[i],s=e[i],o=n[i];if(null!=s){if(s===Bk&&1===a.shape[a.shape.length-1])throw new ID(`You are passing a target array of shape ${a.shape} while using `+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(s)){const t=a.shape.slice(1),e=o.slice(1);for(let n=0;n<t.length;++n){const r=t[n],i=e[n];if(null!=i&&r!==i)throw new ID(`A target Tensor with shape ${a.shape} was passed for an `+`output of shape ${o}, while using a loss function that `+"expects targets to have the same shape as the output.")}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=i&&i>0&&t[0].shape[0]%i!=0)throw new ID("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+`${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,n,r,i=!0,a){const[s,o]=this.standardizeUserDataXY(t,e,i,a);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){const t=mE(r,this.outputNames);l=[];for(let e=0;e<t.length;++e)l.push(await gE(o[e],null,t[e]))}return[s,o,l]}testLoop(t,e,n,r=0,i){return e_(()=>{const a=this.checkNumSamples(e,n,i,"steps"),s=[];if(r>0)throw new kD("Verbose mode is not implemented yet.");if(null!=i)throw new kD("steps mode in testLoop() is not implemented yet");{const r=CE(a,n),i=$y(bI(0,a));for(let n=0;n<r.length;++n){const a=r[n][0],o=r[n][1],l=SI(i,a,o-a),u=SE(e,l),c=t(u);if(0===n)for(let t=0;t<c.length;++t)s.push(zy(0));for(let t=0;t<c.length;++t)s[t]=a_(s[t],K_(o-a,c[t]))}for(let t=0;t<s.length;++t)s[t]=nb(s[t],a)}return s})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let i=r;RD(t,r)>1&&(i+=`_${RD(t.slice(0,n),r)}`),e.push(i)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],s=this.collectedTrainableWeights.map(t=>t.read());return[this.optimizer_.minimize(()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const s=new oE(t),o=cE(this.outputs,s,{training:!0});let l;for(let n=0;n<this.lossFunctions.length;++n){let t=(0,this.lossFunctions[n])(r[n],o[n]);null!=i[n]&&(t=yE(t,i[n]));const a=xv(t);e.push(a),l=0===n?t:a_(l,t)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][1];t=xv((0,this.metricsTensors[n][0])(r[e],o[e]))}r_(t),a.push(t)}return l=xv(l),this.calculateLosses().forEach(t=>{l=a_(l,t)}),l},!0,s)].concat(a)}}makeTestFunction(){this.testFunction=t=>e_(()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let t=0;t<this.inputs.length;++t)a.push({key:this.inputs[t],value:r[t]});const s=new oE(a),o=cE(this.outputs,s);for(let t=0;t<this.lossFunctions.length;++t){const r=xv((0,this.lossFunctions[t])(i[t],o[t]));n=0===t?r:a_(n,r),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][1],r=xv((0,this.metricsTensors[t][0])(i[n],o[n]));e.push(r)}return e})}async fit(t,e,n={}){return async function(t,e,n,i={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let a,s,o,l,u,c,h;t.isTraining=!0;try{const d=null==i.batchSize?32:i.batchSize;xE(d);const p=!1,f=await t.standardizeUserData(e,n,i.sampleWeight,i.classWeight,p,d);a=f[0],s=f[1],h=f[2];let m,g=!1;if(null!=i.validationData&&i.validationData.length>0){if(g=!0,2!==i.validationData.length)throw 3===i.validationData.length?new kD("validationData including sample weights is not supported yet."):new ID("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+`${i.validationData} is invalid.`);o=i.validationData[0],l=i.validationData[1];const e=!0,n=await t.standardizeUserData(o,l,null,null,e,d);u=n[0],c=n[1],m=u.concat(c)}else if(null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1){g=!0;const t=Math.floor(a[0].shape[0]*(1-i.validationSplit)),e=a[0].shape[0];u=wE(a,t,e),a=wE(a,0,t),c=wE(s,t,e),s=wE(s,0,t),m=u.concat(c)}else null!=i.validationSteps&&(g=!0);const y=a.concat(s).concat(h);t.checkTrainableWeightsConsistency();const v=t.makeTrainFunction(),_=t.getDedupedMetricsNames();let b,x;g?(t.makeTestFunction(),b=t.testFunction,x=_.slice().concat(_.map(t=>"val_"+t))):(b=null,m=[],x=_.slice());const w=Mk(i.callbacks,i.yieldEvery);return await async function(t,e,n,i,a,s,o,l,u,c,h,d,p,f,m){null==a&&(a=32),null==s&&(s=1),null==h&&(h=!0),null==p&&(p=0);let g=!1;null!=u&&null!=c&&(g=!0);const y=t.checkNumSamples(n,a,null,"steps_per_epoch");let v;null!=y&&(v=bI(0,y)),null==o&&(o=1);const{callbackList:_,history:b}=Ok(l,o,s,p,y,null,a,g,d);_.setModel(t),t.history=b,await _.onTrainBegin(),t.stopTraining_=!1;for(let x=p;x<s;++x){await _.onEpochBegin(x);const s={};{if("batch"===h)throw new kD("batch shuffling is not implemneted yet");h&&r.shuffle(v);const o=$y(v),l=CE(y,a);for(let r=0;r<l.length;++r){const h={};if(await _.onBatchBegin(r,h),e_(()=>{const d=l[r][0],p=l[r][1],f=SI(o,d,p-d);h.batch=r,h.size=p-d;const m=SE(n,f),y=e(m);for(let t=0;t<i.length;++t){const e=y[t];h[i[t]]=e,r_(e)}if(r===l.length-1&&g){const e=t.testLoop(u,c,a);for(let t=0;t<i.length;++t){const n=i[t],r=e[t];r_(r),s["val_"+n]=r}}}),await _.onBatchEnd(r,h),Dk(h),t.stopTraining_)break}o.dispose()}if(await _.onEpochEnd(x,s),t.stopTraining_)break}return await _.onTrainEnd(),await t.history.syncData(),t.history}(t,v,y,_,d,i.epochs,i.verbose,w,b,m,i.shuffle,x,i.initialEpoch)}finally{t.isTraining=!1,IE(a,e),IE(s,n),IE(u,o),IE(c,l),null!=h&&n_(h)}}(this,t,e,n)}async fitDataset(t,e){return async function(t,e,n){const i=null!=n.batchesPerEpoch;if(r.assert(null!=t.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),r.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),r.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+`integer, but got ${n.epochs}`),r.assert(!i||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+`positive integer if specified, but got ${n.batchesPerEpoch}`),r.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const a=null!=n.validationData;let s,o;if(a)if(bE(n.validationData))r.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+`but got ${n.validationBatches}`);else{const t=function(t){if(3===t.length)throw new kD("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);s=t.xs,o=t.ys}const l=t.makeTrainFunction(),u=t.getDedupedMetricsNames();let c;c=a?u.slice().concat(u.map(t=>"val_"+t)):u.slice();const h=Mk(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:p,history:f}=Ok(h,d,n.epochs,null,null,function(t,e){let n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,a,c);p.setModel(t),t.history=f,await p.onTrainBegin(),t.stopTraining_=!1;let m=null==n.initialEpoch?0:n.initialEpoch,g=await e.iterator();for(;m<n.epochs;){const r={};await p.onEpochBegin(m);let c=0,h=0;for(i||(g=await e.iterator());!i||c<n.batchesPerEpoch;){const e=await g.next();if(i&&e.done){console.warn("You provided `batchesPerEpoch` as "+`${n.batchesPerEpoch}, `+"but your dataset iterator ran out of data after "+`${c} batches; `+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+`${n.batchesPerEpoch*n.epochs} batches). `+"You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:i}=vE(t,e.value),a={};a.batch=h,a.size=r[0].shape[0],await p.onBatchBegin(h,a);const s=[];if(null!=n.classWeight){const e=mE(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)s.push(await gE(i[t],null,e[t]))}const o=r.concat(i).concat(s),d=l(o);n_(o);for(let t=0;t<u.length;++t){const e=d[t];a[u[t]]=e,r_(e)}await p.onBatchEnd(h,a),Dk(a),h++,c++}if(i?c>=n.batchesPerEpoch:e.done){if(a){let e;e=bE(n.validationData)?ND(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):ND(t.evaluate(s,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)r[`val_${t.metricsNames[n]}`]=e[n]}break}if(t.stopTraining_)break}if(await p.onEpochEnd(m,r),m++,t.stopTraining_)break}return await p.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],i=n[1],a=this.makeTrainFunction()(r.concat(i)),s=[];for(const o of a){const t=await o.data();s.push(t[0])}return n_(a),MD(s)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let a=0;a<r.length;++a)n&&!r[a].trainable||e.push({name:r[a].originalName,tensor:i[a]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=t_().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-t_().numTensors}return t}getLossIdentifiers(){let t;if("string"==typeof this.loss)t=OD(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!=typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(t=>OD(t))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!=typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=OD(n[r])}}return t}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[OD(tE(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>OD(tE(t)));{const t={};for(const e in this.metrics)t[e]=OD(tE(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=Pk(sE(t.optimizer_config));let n,r;if("string"==typeof t.loss)n=PD(t.loss);else if(Array.isArray(t.loss))n=t.loss.map(t=>PD(t));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=PD(t.loss[e])}if(Array.isArray(t.metrics))r=t.metrics.map(t=>PD(t));else if(null!=t.metrics){r={};for(const e in t.metrics)r[e]=PD(t.metrics[e])}this.compile({loss:n,metrics:r,optimizer:e})}async save(t,e){if("string"==typeof t){const e=o.getSaveHandlers(t);if(0===e.length)throw new ID(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new ID(`Found more than one (${e.length}) save handlers for `+`URL '${t}'`);t=e[0]}if(null==t.save)throw new ID("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await o.encodeWeights(this.getNamedWeights(e)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v2.0.0",convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:i}=await o.encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...i),n.data=o.concatenateArrayBuffers([n.data,e])}return null!=this.userDefinedMetadata&&(eE(this.userDefinedMetadata,this.name,!0),r.userDefinedMetadata=this.userDefinedMetadata),r.weightData=n.data,r.weightSpecs=n.specs,t.save(r)}setUserDefinedMetadata(t){eE(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}RE.className="Model",u.registerClass(RE);class ME extends RE{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:lk("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new ID("Negative dimension size caused by adding layer "+`${t.name} with input shape [`+`${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const e=t instanceof ME||t instanceof RE;let n;if(e){if(n=t,1!==n.outputs.length)throw new ID("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new ID("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new ID("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=function(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new ID("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;return null==n&&(n="float32"),new Sk({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new ID("A layer added to a Sequential model must not already be "+`connected somewhere else. LayersModel received layer ${t.name} `+`which has ${t.inboundNodes.length} pre-existing inbound `+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new ID("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=function t(e,n,r){if((null==n||null!=r&&r>0)&&(n=e.sourceLayer,r=e.nodeIndex),0===n.inboundNodes.length)return[e];{const e=n.inboundNodes[r];if(0===e.inboundLayers.length)return e.inputTensors;{const n=[];for(let r=0;r<e.inboundLayers.length;r++){const i=t(e.inputTensors[r],e.inboundLayers[r],e.nodeIndices[r]);for(const t of i)-1===n.indexOf(t)&&n.push(t)}return n}}}(this.outputs[0])}this.inboundNodes=[],new bk({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:AD(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(dk(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new RE({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,n=console.log){this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,n={}){if(!this.built)throw new DD("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new DD("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,n={}){if(!this.built)throw new DD("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new DD("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,n={},i=!1){let a,s={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new ID("Legacy serialization format not supported yet.");a=e}else r.assert(null!=e.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=e.layers,delete e.layers,s=e;const o=new t(s);if(!(o instanceof ME))throw new kD(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const r of a){const t=Pk(r,void 0,i);i&&t.setFastWeightInitDuringBuild(!0),o.add(t)}return o}set stopTraining(t){if(null==this.model)throw new ID("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new ID("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}ME.className="Sequential",u.registerClass(ME);class NE extends u.Serializable{getConfig(){return{}}}class OE extends NE{apply(t,e=1){return function(t,e=1){if(1!==e)throw new kD(`Support for alpha values other than 1 (${e}) is not implemented `+"yet.");return SS(t)}(t,e)}}OE.className="elu",u.registerClass(OE);class PE extends NE{apply(t){return ES(t)}}PE.className="selu",u.registerClass(PE);class FE extends NE{apply(t){return IS(t)}}FE.className="relu",u.registerClass(FE);class LE extends NE{apply(t){return e_(()=>H_(6,IS(t)))}}LE.className="relu6",u.registerClass(LE);class zE extends NE{apply(t){return t}}zE.className="linear",u.registerClass(zE);class $E extends NE{apply(t){return E_(t)}}$E.className="sigmoid",u.registerClass($E);class BE extends NE{apply(t){return function(t){return e_(()=>{const e=a_(.5,K_(.2,t));return f_(e,0,1)})}(t)}}BE.className="hardSigmoid",u.registerClass(BE);class WE extends NE{apply(t){return P_(t)}}WE.className="softplus",u.registerClass(WE);class qE extends NE{apply(t){return function(t){return e_(()=>nb(t,s_(t).add(1)))}(t)}}qE.className="softsign",u.registerClass(qE);class VE extends NE{apply(t){return $_(t)}}VE.className="tanh",u.registerClass(VE);class UE extends NE{apply(t,e=-1){return AS(t,e)}}UE.className="softmax",u.registerClass(UE);class jE extends NE{apply(t,e=-1){return TS(t,e)}}function HE(t){return t.getClassName()}function GE(t,e={}){return zD(t,u.SerializationMap.getMap().classNameMap,e,"activation")}function JE(t){if(null==t)return GE({className:"linear",config:{}});if("string"==typeof t){const e={};return e.className=t,e.config={},GE(e)}return t instanceof NE?t:GE(t)}jE.className="logSoftmax",u.registerClass(jE);class XE extends u.Serializable{}class KE extends XE{constructor(t){super(),function(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+`object, but received: ${t}`)}(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return e_(()=>{let e=Gy([1]);return this.hasL1&&(e=a_(e,Cv(K_(this.l1,s_(t))))),this.hasL2&&(e=a_(e,Cv(K_(this.l2,MI(t))))),e.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}KE.className="L1L2",u.registerClass(KE);const ZE={l1l2:"L1L2"};function YE(t){return LD(t)}function QE(t,e={}){return zD(t,u.SerializationMap.getMap().classNameMap,e,"regularizer")}function tA(t){return null==t?null:"string"==typeof t?QE({className:t in ZE?ZE[t]:t,config:{}}):t instanceof XE?t:QE(t)}class eA extends wk{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=hk(t);let n=IS(t);return null!=this.maxValue&&(n=f_(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}eA.className="ReLU",u.registerClass(eA);class nA extends wk{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=hk(t);return CS(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}nA.className="LeakyReLU",u.registerClass(nA);class rA extends wk{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=ik(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=tA(t.alphaRegularizer),this.alphaConstraint=eI(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!=typeof t.sharedAxes)throw new ID("Expected sharedAxes to be a number or an array of numbers, "+`but got ${t.sharedAxes}`);this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=dk(t)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<t.length;++r)n[r]=t[r];this.inputSpec=[new yk({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=hk(t),DS(t,this.alpha.read())}getConfig(){const t={alphaInitializer:rk(this.alphaInitializer),alphaRegularizer:YE(this.alphaRegularizer),alphaConstraint:QD(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}rA.className="PReLU",u.registerClass(rA);class iA extends wk{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new kD(`Non-default alpha value (${t.alpha}) is not supported by the `+"ELU layer yet.");this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=hk(t);return SS(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}iA.className="ELU",u.registerClass(iA);class aA extends wk{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=hk(t);return n.mul(xI(n.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}aA.className="ThresholdedReLU",u.registerClass(aA);class sA extends wk{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new UE).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=hk(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function oA(t,e,n){if("number"==typeof t)return AD(t,e);if(t.length!==e)throw new ID(`The ${n} argument must be an integer or tuple of ${e} integers.`+` Received: ${t.length} elements.`);for(let i=0;i<e;++i){const a=t[i];if((r=a)!==parseInt(r.toString(),10))throw new ID(`The ${n} argument must be an integer or tuple of ${e}`+` integers. Received: ${JSON.stringify(t)} including a`+` non-integer number ${a}`)}return t;var r}function lA(t,e,n,r,i=1){if(null==t)return t;let a;return a="same"===n?t:t-(e+(e-1)*(i-1))+1,Math.floor((a+r-1)/r)}function uA(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+_I([n-e,0]);else{if("same"!==r)throw new ID(`Unsupport padding mode: ${r}.`);t*=e}return t}function cA(t,e){return e_(()=>(oI(e),"channelsFirst"===e?hb(t,[0,2,3,1]):t))}function hA(t,e){return e_(()=>(oI(e),"channelsFirst"===e?hb(t,[0,2,3,4,1]):t))}function dA(t,e,n,r=[1,1],i="valid",a,s,o=null){return e_(()=>{if(null==a&&(a="channelsLast"),oI(a),3!==t.rank&&4!==t.rank)throw new ID("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+`but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new ID("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+`but received ${t.rank}.`);let l=cA(t,a);if("causal"===i)throw new kD("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=g.conv2d({x:l,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===a&&(l=hb(l,[0,3,1,2])),l})}sA.className="Softmax",u.registerClass(sA);class pA extends wk{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",pA.verifyArgs(e),this.rank=t,UD(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new kD(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is `+"not implemented yet.");if(this.kernelSize=oA(e.kernelSize,t,"kernelSize"),this.strides=oA(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,lI(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,oI(this.dataFormat),this.activation=JE(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=ik(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=eI(e.biasConstraint),this.biasRegularizer=tA(e.biasRegularizer),this.activityRegularizer=tA(e.activityRegularizer),this.dilationRate=oA(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new ID("dilationRate must be a number or an array of a single number for 1D convolution, but received "+`${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new ID("dilationRate must be a number or array of two numbers for 2D "+`convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new ID("dilationRate must be a number or array of three numbers for 3D "+`convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(t){if(TD("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!VD(t.kernelSize,"number",1,3))throw new ID("BaseConv expects config.kernelSize to be number or number[] with "+`length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:HE(this.activation),useBias:this.useBias,biasInitializer:rk(this.biasInitializer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),biasConstraint:QD(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class fA extends pA{constructor(t,e){super(t,e),this.kernel=null,fA.verifyArgs(e),this.filters=e.filters,UD(this.filters,"filters"),this.kernelInitializer=ik(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=eI(e.kernelConstraint),this.kernelRegularizer=tA(e.kernelRegularizer)}build(t){t=dk(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new ID("The channel dimension of the input should be defined. "+`Found ${t[e]}`);const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return e_(()=>{let e;t=hk(t);const n=null==this.bias?null:this.bias.read(),r=jD(this.activation.getClassName());if(null!=r&&2===this.rank)e=dA(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=function(t,e,n,r=1,i="valid",a,s=1){return e_(()=>{if(null==a&&(a="channelsLast"),oI(a),3!==t.shape.length)throw new ID("The input of a conv1dWithBias operation should be 3, but is "+`${t.shape.length} instead.`);if(3!==e.shape.length)throw new ID("The kernel for a conv1dWithBias operation should be 3, but is "+`${e.shape.length} instead`);if(null!=n&&1!==n.shape.length)throw new ID("The bias for a conv1dWithBias operation should be 1, but is "+`${e.shape.length} instead`);if("channelsFirst"===a&&(t=hb(t,[0,2,1])),"causal"===i)throw new kD("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=iw(t,e,r,"same"===i?"same":"valid","NWC",s);return null!=n&&(o=OI(o,n)),o})}(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=dA(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new kD("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r=[1,1,1],i="valid",a,s){return e_(()=>{if(null==a&&(a="channelsLast"),oI(a),4!==t.rank&&5!==t.rank)throw new ID("conv3dWithBias expects input to be of rank 4 or 5, but received "+`${t.rank}.`);if(4!==e.rank&&5!==e.rank)throw new ID("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+`${t.rank}.`);let o=hA(t,a);if("causal"===i)throw new kD("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=sw(o,e,r,"same"===i?"same":"valid","NDHWC",s),null!=n&&(o=OI(o,n)),"channelsFirst"===a&&(o=hb(o,[0,4,1,2,3])),o})}(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e})}computeOutputShape(t){t=dk(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let i=0;i<n.length;++i){const t=lA(n[i],this.kernelSize[i],this.padding,this.strides[i],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[i]);e.push(t)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:rk(this.kernelInitializer),kernelRegularizer:YE(this.kernelRegularizer),kernelConstraint:QD(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new ID("Convolution layer expected config.filters to be a 'number' > 0 "+`but got ${JSON.stringify(t.filters)}`)}}class mA extends fA{constructor(t){super(2,t),mA.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!VD(t.kernelSize,"number",1,2))throw new ID("Conv2D expects config.kernelSize to be number or number[] with "+`length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}mA.className="Conv2D",u.registerClass(mA);class gA extends fA{constructor(t){super(3,t),gA.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new ID("Conv3D expects config.kernelSize to be number or"+` [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}gA.className="Conv3D",u.registerClass(gA);class yA extends mA{constructor(t){if(super(t),this.inputSpec=[new yk({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new ID("Conv2DTranspose currently supports only padding modes 'same' "+`and 'valid', but received padding mode ${this.padding}`)}build(t){if(4!==(t=dk(t)).length)throw new ID("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new ID("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new yk({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return e_(()=>{let e=hk(t);if(4!==e.shape.length)throw new ID("Conv2DTranspose.call() expects input tensor to be rank-4, but "+`received a tensor of rank-${e.shape.length}`);const n=e.shape;let r,i;"channelsFirst"===this.dataFormat?(r=2,i=3):(r=1,i=2);const a=n[i],s=this.kernelSize[1],o=this.strides[1],l=[n[0],uA(n[r],this.strides[0],this.kernelSize[0],this.padding),uA(a,o,s,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=hb(e,[0,2,3,1]));let u=aw(e,this.kernel.read(),l,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(u=hb(u,[0,3,1,2])),null!=this.bias&&(u=OI(u,this.bias.read(),this.dataFormat)),null!=this.activation&&(u=this.activation.apply(u)),u})}computeOutputShape(t){const e=(t=dk(t)).slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const a=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return e[n]=this.filters,e[r]=uA(e[r],o,a,this.padding),e[i]=uA(e[i],l,s,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}yA.className="Conv2DTranspose",u.registerClass(yA);class vA extends fA{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new ID("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new ID("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new ID(`SeparableConv${this.rank}D supports only padding modes: `+`'same' and 'valid', but received ${JSON.stringify(e.padding)}`);this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=ik(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=tA(e.depthwiseRegularizer),this.depthwiseConstraint=eI(e.depthwiseConstraint),this.pointwiseInitializer=ik(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=tA(e.pointwiseRegularizer),this.pointwiseConstraint=eI(e.pointwiseConstraint)}build(t){if((t=dk(t)).length<this.rank+2)throw new ID(`Inputs to SeparableConv${this.rank}D should have rank `+`${this.rank+2}, but received input shape: `+`${JSON.stringify(t)}`);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new ID("The channel dimension of the inputs should be defined, "+`but found ${JSON.stringify(t[e])}`);const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(n*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new yk({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return e_(()=>{let e;if(t=hk(t),1===this.rank)throw new kD("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=hb(t,[0,2,3,1])),e=Vw(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=OI(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=hb(e,[0,3,1,2])),e})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=rk(this.depthwiseInitializer),t.pointwiseInitializer=rk(this.pointwiseInitializer),t.depthwiseRegularizer=YE(this.depthwiseRegularizer),t.pointwiseRegularizer=YE(this.pointwiseRegularizer),t.depthwiseConstraint=QD(this.depthwiseConstraint),t.pointwiseConstraint=QD(this.pointwiseConstraint),t}}vA.className="SeparableConv";class _A extends vA{constructor(t){super(2,t)}}_A.className="SeparableConv2D",u.registerClass(_A);class bA extends fA{constructor(t){super(1,t),bA.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!VD(t.kernelSize,"number",1,1))throw new ID("Conv1D expects config.kernelSize to be number or number[] with "+`length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}bA.className="Conv1D",u.registerClass(bA);class xA extends wk{constructor(t){super(t),this.cropping="number"==typeof t.cropping?[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return e_(()=>{if(t=hk(t),"channelsLast"===this.dataFormat){const e=DI(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return DI(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=DI(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return DI(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}xA.className="Cropping2D",u.registerClass(xA);class wA extends wk{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],null==t[2]?null:this.size[0]*t[2],null==t[3]?null:this.size[1]*t[3]]:[t[0],null==t[1]?null:this.size[0]*t[1],null==t[2]?null:this.size[1]*t[2],t[3]]}call(t,e){return e_(()=>{let e=hk(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=hb(e,[0,2,3,1]);const t=e.resizeNearestNeighbor([this.size[0]*n[2],this.size[1]*n[3]]);return hb(t,[0,3,1,2])}return e.resizeNearestNeighbor([this.size[0]*n[1],this.size[1]*n[2]])})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}wA.className="UpSampling2D",u.registerClass(wA);class SA extends pA{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=ik(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=eI(t.depthwiseConstraint),this.depthwiseRegularizer=tA(t.depthwiseRegularizer)}build(t){if((t=dk(t)).length<4)throw new ID("Inputs to DepthwiseConv2D should have rank 4. "+`Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new ID("The channel dimension of the inputs to DepthwiseConv2D should "+`be defined, but is not (${t[e]}).`);const n=t[e];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return e_(()=>{let e=function(t,e,n=[1,1],r="valid",i,a){return e_(()=>{null==i&&(i="channelsLast"),oI(i);let s=cA(t,i);if(4!==t.rank)throw new ID("Input for depthwiseConv2d is required to be 4-D, but is instead "+`${t.rank}-D`);if(4!==e.rank)throw new ID("depthwiseKernel is required to be 4-D, but is instead "+`${e.rank}-D`);return s=uw(s,e,n,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===i&&(s=hb(s,[0,3,1,2])),s})}(t=hk(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=OI(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e})}computeOutputShape(t){t=dk(t);const e="channelsFirst"===this.dataFormat?t[3]:t[2],n="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,r=lA("channelsFirst"===this.dataFormat?t[2]:t[1],this.kernelSize[0],this.padding,this.strides[0]),i=lA(e,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],n,r,i]:[t[0],r,i,n]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=rk(this.depthwiseInitializer),t.depthwiseRegularizer=YE(this.depthwiseRegularizer),t.depthwiseConstraint=QD(this.depthwiseRegularizer),t}}SA.className="DepthwiseConv2D",u.registerClass(SA);class CA extends wk{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}call(t,e){return e_(()=>{this.invokeCallHook(t,e);const n=hk(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,r=this.getNoiseShape(n);return FI(()=>PI(n,this.rate,r,this.seed),()=>n,t)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}CA.className="Dropout",u.registerClass(CA);class DA extends CA{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}DA.className="SpatialDropout1D",u.registerClass(DA);class IA extends wk{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,UD(this.units,"units"),this.activation=JE(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=ik(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=ik(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=eI(t.kernelConstraint),this.biasConstraint=eI(t.biasConstraint),this.kernelRegularizer=tA(t.kernelRegularizer),this.biasRegularizer=tA(t.biasRegularizer),this.activityRegularizer=tA(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=dk(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=dk(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return e_(()=>{this.invokeCallHook(t,e);const n=hk(t),r=jD(this.activation.getClassName());let i;return null!=r?i=TI(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=TI(n,this.kernel.read()),null!=this.bias&&(i=OI(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i})}getConfig(){const t={units:this.units,activation:HE(this.activation),useBias:this.useBias,kernelInitializer:rk(this.kernelInitializer),biasInitializer:rk(this.biasInitializer),kernelRegularizer:YE(this.kernelRegularizer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),kernelConstraint:QD(this.kernelConstraint),biasConstraint:QD(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}IA.className="Dense",u.registerClass(IA);class kA extends wk{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=dk(t);for(const e of t.slice(1))if(null==e)throw new ID('The shape of the input to "Flatten" is not fully defined '+`(got ${t.slice(1)}). Make sure to pass a complete `+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],gI(t,1)]}call(t,e){return e_(()=>{this.invokeCallHook(t,e);let n=hk(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=n.transpose(t)}return function(t){if(t.rank<=1)throw new ID(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],gI(t.shape,1)];return t.reshape(e)}(n)})}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}kA.className="Flatten",u.registerClass(kA);class EA extends wk{constructor(t){super(t),this.supportsMasking=!0,this.activation=JE(t.activation)}call(t,e){return e_(()=>{this.invokeCallHook(t,e);const n=hk(t);return this.activation.apply(n)})}getConfig(){const t={activation:HE(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}EA.className="Activation",u.registerClass(EA);class AA extends wk{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return e_(()=>{return t=hk(t),e=t,n=this.n,e_(()=>{if(2!==e.shape.length)throw new ID("repeat() expects a rank-2 tensor, but received a "+`rank-${e.shape.length} tensor.`);return EI(wI(e,1),[1,n,1])});var e,n})}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}AA.className="RepeatVector",u.registerClass(AA);class TA extends wk{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let i=1,a=null;for(let o=0;o<r.length;++o){const t=r[o];if(this.isUnknown(t)){if(null!==a)throw new ID("Can only specifiy one unknown dimension.");a=o}else i*=t}const s=gI(t);if(null!==a){if(0===i||s%i!=0)throw new ID(n);r[a]=s/i}else if(s!==i)throw new ID(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return e_(()=>{this.invokeCallHook(t,e);const n=hk(t),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return n.reshape(i)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}TA.className="Reshape",u.registerClass(TA);class RA extends wk{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+`${t.dims} instead.`);const e=bI(1,t.dims.length+1);if(!r.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new yk({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=dk(t)).slice();return this.dims.forEach((n,r)=>{e[r+1]=t[n]}),e}call(t,e){return hb(hk(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}RA.className="Permute",u.registerClass(RA);class MA extends wk{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=hk(t);return yv(Aw(n,this.maskValue),-1)}call(t,e){return e_(()=>{this.invokeCallHook(t,e);const n=hk(t),r=yv(Aw(n,this.maskValue),-1,!0);return n.mul(r.asType(n.dtype))})}}MA.className="Masking",u.registerClass(MA);class NA extends wk{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=null==t.inputLength?[e,null]:[e].concat(ND(t.inputLength))}this.inputDim=t.inputDim,UD(this.inputDim,"inputDim"),this.outputDim=t.outputDim,UD(this.outputDim,"outputDim"),this.embeddingsInitializer=ik(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=tA(t.embeddingsRegularizer),this.activityRegularizer=tA(t.activityRegularizer),this.embeddingsConstraint=eI(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return e_(()=>this.maskZero?(t=hk(t),Aw(t,Yy(t))):null)}computeOutputShape(t){if(t=dk(t),null==this.inputLength)return[...t,this.outputDim];const e=ND(this.inputLength);if(e.length!==t.length-1)throw new ID(`"inputLength" is ${this.inputLength}, but received `+`input shape has shape ${t}`);{let n=0;for(let r=0;r<e.length;++r){const i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new ID(`"inputLength" is ${this.inputLength}, but received `+`input shape has shape ${t}`);null==i&&(e[n]=a),n++}}return[t[0],...e,this.outputDim]}call(t,e){return e_(()=>{this.invokeCallHook(t,e);let n=hk(t);return"int32"!==n.dtype&&(n=xI(n,"int32")),RI(this.embeddings.read(),n.as1D()).reshape(dk(this.computeOutputShape(n.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:rk(this.embeddingsInitializer),embeddingsRegularizer:YE(this.embeddingsRegularizer),activityRegularizer:YE(this.activityRegularizer),embeddingsConstraint:QD(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}NA.className="Embedding",u.registerClass(NA);class OA extends wk{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new kD}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new ID("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[dk(t)]),(t=t).length<2)throw new ID("A merge layer should be called on an Array of at least 2 inputs."+` Got ${t.length} input(s).`);let e=[];for(const i of t)null!=i&&null!==i[0]&&e.push(i[0]);if(e=BD(e),e.length>1)throw new ID("Can not merge tensors with different batch sizes. "+`Got tensors with shapes: ${JSON.stringify(t)}.`);let n=null==t[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const e=null==t[i]?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const r=t.map(t=>t.length);this.reshapeRequired=-1!==t.indexOf(null)||1!==BD(r).length}call(t,e){return e_(()=>{if(t=t,this.reshapeRequired){const e=[],n=t.map(t=>t.rank);if(-1===n.indexOf(null)){const r=_I(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=wI(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const a of t){const t=a.rank;if(null==t){const t=a.shape,r=t[0],i=t.slice(1).concat([r]);let s=a.reshape([r].concat(gI(t.slice(1))));s=hb(s,[1,0]),s=s.reshape(i),e.push(s),n=!0}else if(t>1){const r=bI(1,t).concat([0]);e.push(hb(a,r)),n=!0}else e.push(a)}let r=this.mergeFunction(e);const i=r.rank;if(n)if(null==i){const t=r.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));r=hb(r.reshape([-1,e]),[1,0]).reshape(n)}else if(i>1){const t=[i-1].concat(bI(0,i-1));r=hb(r,t)}return r}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==(t=t)[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const n=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const r of t)null!=r&&null!==r[0]&&n.push(r[0]);return n=BD(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return e_(()=>{if(null==e)return null;if(!Array.isArray(e))throw new ID("`mask` should be an Array");if(!Array.isArray(t))throw new ID("`inputs` should be an Array");if(e.length!==t.length)throw new ID("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+`(${t.length} vs ${e.length})`);if(e.every(t=>null==t))return null;let n=(e=e.map(t=>null==t?t:iv(t,0)))[0];for(let t=1;t<e.length-1;++t)n=dw(n,e[t]);return n})}}class PA extends OA{constructor(t){super(t)}mergeFunction(t){return e_(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=a_(e,t[n]);return e})}}PA.className="Add",u.registerClass(PA);class FA extends OA{constructor(t){super(t)}mergeFunction(t){return e_(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=K_(e,t[n]);return e})}}FA.className="Multiply",u.registerClass(FA);class LA extends OA{constructor(t){super(t)}mergeFunction(t){return e_(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=a_(e,t[n]);return K_(1/t.length,e)})}}LA.className="Average",u.registerClass(LA);class zA extends OA{constructor(t){super(t)}mergeFunction(t){return e_(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=U_(e,t[n]);return e})}}zA.className="Maximum",u.registerClass(zA);class $A extends OA{constructor(t){super(t)}mergeFunction(t){return e_(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=H_(e,t[n]);return e})}}$A.className="Minimum",u.registerClass($A);class BA extends OA{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new ID("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const n=[];for(let i=0;i<t.length;++i){const e=t[i].slice();e.splice(this.axis,1);let a=!1;for(const t of n)if(r.arraysEqual(t,e)){a=!0;break}a||n.push(e)}if(n.length>1)throw new ID("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return e_(()=>II(t,this.axis))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new ID("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const i of e.slice(1)){if(null==n[r]||null==i[r]){n[r]=null;break}n[r]+=i[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new ID("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new ID("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new ID(`Mismatch in the length of mask (${e.length}) `+`and the legnth of inputs (${t.length})`);return e_(()=>{let n=!0;if(e.forEach(t=>{null==t||(n=!1)}),n)return null;const r=[];for(let a=0;a<t.length;++a)r.push(null==e[a]?Zy(t[a]).asType("bool"):e[a].rank<t[a].rank?iv(e[a],-1):e[a]);const i=Qy(r,this.axis);return gv(i,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function WA(t,e){for(;t<0;)t+=e;return t}BA.className="Concatenate",u.registerClass(BA);class qA extends OA{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){r.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new kD("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);if(e[i[0]]!==n[i[1]])throw new ID("Dimension incompatibility: "+`${e[i[0]]} !== ${n[i[1]]}`)}mergeFunction(t){if(2!==t.length)throw new ID("A `Dot` layer must be called on exactly 2 inputs, "+`but received ${t.length} input(s).`);let e,n=t[0],i=t[1];return e=Array.isArray(this.axes)?this.axes.map((e,n)=>WA(e,t[n].shape.length)):[WA(this.axes,n.shape.length),WA(this.axes,i.shape.length)],this.normalize&&(n=Fk(n,e[0]),i=Fk(i,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new kD("batchDot is not implemented for tensors of 4D or higher rank yet");if(r.assert(t.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+`but got ${t.shape.length}`),r.assert(t.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+`but got ${e.shape.length}`),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new kD("batchDot is not implemented for complex64-type Tensors yet.");const i=t.shape.length,a=e.shape.length;null==n&&(n=[i-1,a-2]);const s=n;return e_(()=>{let n,r;if(i>a){n=i-a;const t=[];for(let e=0;e<n;++e)t.push(1);e=e.reshape(e.shape.concat(t))}else if(a>i){n=a-i;const e=[];for(let t=0;t<n;++t)e.push(1);t=t.reshape(t.shape.concat(e))}else n=0;if(r=2===t.shape.length&&2===e.shape.length?s[0]===s[1]?t.mul(e).sum(s[0]):t.transpose([1,0]).mul(e).sum(s[1]):t.matMul(e,s[0]!==t.shape.length-1,s[1]===e.shape.length-1),n>0){let t;t=i>a?i+a-3:i-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);r=r.squeeze(e)}return 1===r.shape.length&&(r=r.expandDims(1)),r})}(n,i,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[WA(this.axes,t.length),WA(this.axes,e.length)],n}computeOutputShape(t){r.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new kD("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);e.splice(i[0],1),n.splice(i[1],1),n.splice(0,1);const a=e.concat(n);return 1===a.length&&a.push(1),a}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}qA.className="Dot",u.registerClass(qA);class VA extends wk{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return e_(()=>{this.invokeCallHook(t,e);const n=hk(t);return FI(()=>AI(n.shape,0,this.stddev).add(n),()=>n,e.training||!1)})}}VA.className="GaussianNoise",u.registerClass(VA);class UA extends wk{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return e_(()=>{this.invokeCallHook(t,e);const n=hk(t);return this.rate>0&&this.rate<1?FI(()=>{const t=Math.sqrt(this.rate/(1-this.rate));return n.mul(AI(n.shape,1,t))},()=>n,e.training||!1):n})}}UA.className="GaussianDropout",u.registerClass(UA);class jA extends wk{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||hk(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return e_(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t);return FI(()=>{const e=hk(t),r=-1.7580993408473766;let i=Sw(qw(n),this.rate);i=xI(i,"float32");const a=((1-this.rate)*(1+this.rate*r**2))**-.5,s=-a*r*this.rate;return e.mul(i).add(i.add(-1).mul(r)).mul(a).add(s)},()=>hk(t),e.training||!1)}return t})}}function HA(t,e,n,r,i,a=.001){let s;if(2===t.rank)s=Xx(t,e,n,r,i,a);else if(3===t.rank)s=Kx(t,e,n,r,i,a);else{if(4!==t.rank)throw new kD(`batchNormalization is not implemented for array of rank ${t.rank} `+"yet");s=Zx(t,e,n,r,i,a)}return s}jA.className="AlphaDropout",u.registerClass(jA);class GA extends wk{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=ik(t.betaInitializer||"zeros"),this.gammaInitializer=ik(t.gammaInitializer||"ones"),this.movingMeanInitializer=ik(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=ik(t.movingVarianceInitializer||"ones"),this.betaConstraint=eI(t.betaConstraint),this.gammaConstraint=eI(t.gammaConstraint),this.betaRegularizer=tA(t.betaRegularizer),this.gammaRegularizer=tA(t.gammaRegularizer)}build(t){t=dk(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new ID(`Axis ${e} of input tensor should have a defined dimension but `+"the layer received an input with shape "+`${JSON.stringify(t)}.`);this.inputSpec=[new yk({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return e_(()=>{const n=null!=e.training&&e.training,i=hk(t),a=i.shape,s=a.length,o=bI(0,s),l=this.axis>=0?this.axis:this.axis+s;o.splice(l,1);const u=AD(1,s);u[l]=a[l];const c=o.slice();c.sort();const h=!r.arraysEqual(c,bI(0,s).slice(0,s-1));if(!n)return(()=>{if(h){const t=this.movingMean.read().reshape(u),e=this.movingVariance.read().reshape(u),n=this.center?this.beta.read().reshape(u):null,r=this.scale?this.gamma.read().reshape(u):null;return HA(i,t,e,n,r,this.epsilon)}return HA(i,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,p,f]=function(t,e,n,i,a=.001){return r.arraysEqual(i.slice().sort(),bI(0,t.rank-1))?function(t,e,n,r,i=.001){return e_(()=>{const a=Sv(t,r),s=a.mean,o=a.variance;return[HA(t,s,o,n,e,i),s,o]})}(t,e,n,i,a):function(t,e,n,r,i=.001){return e_(()=>{const a=Sv(t,r),s=a.mean,o=a.variance,l=[];for(const e of bI(0,t.rank))-1!==r.indexOf(e)?l.push(1):l.push(t.shape[e]);const u=s.reshape(l),c=o.reshape(l),h=null==e?null:e.reshape(l),d=null==n?null:n.reshape(l);return[HA(t,u,c,d,h,i),s,o]})}(t,e,n,i,a)}(i,this.gamma.read(),this.beta.read(),o,this.epsilon),m=(t,e,n)=>{e_(()=>{const r=1-n,i=t.read(),a=i.sub(e).mul(r);t.write(i.sub(a))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,f,this.momentum)})(),d})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:rk(this.betaInitializer),gammaInitializer:rk(this.gammaInitializer),movingMeanInitializer:rk(this.movingMeanInitializer),movingVarianceInitializer:rk(this.movingVarianceInitializer),betaRegularizer:YE(this.betaRegularizer),gammaRegularizer:YE(this.gammaRegularizer),betaConstraint:QD(this.betaConstraint),gammaConstraint:QD(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}GA.className="BatchNormalization",u.registerClass(GA);class JA extends wk{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+`but received ${JSON.stringify(this.axis)}`);for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+`but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=ik(t.betaInitializer||"zeros"),this.gammaInitializer=ik(t.gammaInitializer||"ones"),this.betaRegularizer=tA(t.betaRegularizer),this.gammaRegularizer=tA(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=dk(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=e);for(const r of this.axis)if(r<0||r>=e)throw new Error(`Invalid axis: ${r}`);if(this.axis.length!==BD(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const n=this.axis.map(e=>t[e]);this.gamma=this.scale?this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}call(t,e){const n=hk(t),r=n.shape,i=r.length;return e_(()=>{let{mean:t,variance:e}=Sv(n,this.axis,!0);const a=AD(1,i);for(const n of this.axis)a[n]=r[n];const s=t=>null!=t&&t.shape.length!==i&&this.axis!==[i-1]?t.reshape(a):t;let o=s(this.gamma.read()),l=s(this.beta.read());const u=[],c=[];for(let n=0;n<i;++n)-1!==this.axis.indexOf(n)?(u.push(r[n]),c.push(1)):(u.push(1),c.push(r[n]));return t=t.tile(u),e=e.tile(u),o=o.tile(c),l=l.tile(c),HA(n,t,e,l,o,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:rk(this.betaInitializer),gammaInitializer:rk(this.gammaInitializer),betaRegularizer:YE(this.betaRegularizer),gammaRegularizer:YE(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}JA.className="LayerNormalization",u.registerClass(JA);class XA extends wk{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new ID("ZeroPadding2D expects padding to be a length-2 array, but "+`received a length-${t.padding.length} array.`);let e,n;if("number"==typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new ID("ZeroPadding2D expects height padding to be a length-2 array, "+`but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new ID("ZeroPadding2D expects width padding to be a length-2 array, "+`but received a length-${t.padding[1].length} array.`);n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new yk({ndim:4})]}computeOutputShape(t){let e,n;return t=dk(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return e_(()=>{return e=hk(t),n=this.padding,r=this.dataFormat,e_(()=>{if(4!==e.rank)throw new ID("temporalPadding expects input tensor to be 4-D, but received a "+`${e.rank}-D tensor.`);if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new ID("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new ID(`Unknown data format: ${r}. `+"Supported data formats are 'channelsLast' and 'channelsFirst.");let t;return t="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],bb(e,t)});var e,n,r})}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}function KA(t,e,n,r,i,a){return e_(()=>{let s;oI(i),uI(a),lI(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=cA(t,i);const o="same"===r?"same":"valid";return s="max"===a?uS(t,e,n,o):cS(t,e,n,o),"channelsFirst"===i&&(s=hb(s,[0,3,1,2])),s})}function ZA(t,e,n,r,i,a){return e_(()=>{let s;oI(i),uI(a),lI(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=hA(t,i);const o="same"===r?"same":"valid";return s="max"===a?dS(t,e,n,o):pS(t,e,n,o),"channelsFirst"===i&&(s=hb(s,[0,4,1,2,3])),s})}XA.className="ZeroPadding2D",u.registerClass(XA);class YA extends wk{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new ID("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+`${JSON.stringify(t.poolSize)}`);this.poolSize=t.poolSize}if(UD(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new ID("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+`${JSON.stringify(t.strides)}`);this.strides=t.strides}UD(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,lI(this.padding),this.inputSpec=[new yk({ndim:3})]}computeOutputShape(t){const e=lA((t=dk(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return e_(()=>{this.invokeCallHook(t,e),t=wI(hk(t),2);const n=this.poolingFunction(hk(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return sv(n,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class QA extends YA{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return oI(i),lI(r),KA(t,e,n,r,i,"max")}}QA.className="MaxPooling1D",u.registerClass(QA);class tT extends YA{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return oI(i),lI(r),KA(t,e,n,r,i,"avg")}}tT.className="AveragePooling1D",u.registerClass(tT);class eT extends wk{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new ID("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+`${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];UD(this.poolSize,"poolSize"),UD(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,oI(this.dataFormat),lI(this.padding),this.inputSpec=[new yk({ndim:4})]}computeOutputShape(t){t=dk(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=lA(e,this.poolSize[0],this.padding,this.strides[0]),n=lA(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return e_(()=>(this.invokeCallHook(t,e),this.poolingFunction(hk(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class nT extends eT{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return oI(i),lI(r),KA(t,e,n,r,i,"max")}}nT.className="MaxPooling2D",u.registerClass(nT);class rT extends eT{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return oI(i),lI(r),KA(t,e,n,r,i,"avg")}}rT.className="AveragePooling2D",u.registerClass(rT);class iT extends wk{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new ID("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+`${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];UD(this.poolSize,"poolSize"),UD(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,oI(this.dataFormat),lI(this.padding),this.inputSpec=[new yk({ndim:5})]}computeOutputShape(t){t=dk(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=lA(e,this.poolSize[0],this.padding,this.strides[0]),n=lA(n,this.poolSize[1],this.padding,this.strides[1]),r=lA(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return e_(()=>(this.invokeCallHook(t,e),this.poolingFunction(hk(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class aT extends iT{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return oI(i),lI(r),ZA(t,e,n,r,i,"max")}}aT.className="MaxPooling3D",u.registerClass(aT);class sT extends iT{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return oI(i),lI(r),ZA(t,e,n,r,i,"avg")}}sT.className="AveragePooling3D",u.registerClass(sT);class oT extends wk{constructor(t){super(t),this.inputSpec=[new yk({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new kD}}class lT extends oT{constructor(t){super(t||{})}call(t,e){return e_(()=>{const e=hk(t);return xv(e,1)})}}lT.className="GlobalAveragePooling1D",u.registerClass(lT);class uT extends oT{constructor(t){super(t||{})}call(t,e){return e_(()=>{const e=hk(t);return kw(e,1)})}}uT.className="GlobalMaxPooling1D",u.registerClass(uT);class cT extends wk{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,oI(this.dataFormat),this.inputSpec=[new yk({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new kD}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class hT extends cT{call(t,e){return e_(()=>{const e=hk(t);return xv(e,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}hT.className="GlobalAveragePooling2D",u.registerClass(hT);class dT extends cT{call(t,e){return e_(()=>{const e=hk(t);return kw(e,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}function pT(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new ID("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function fT(t,e,n,r=!1,i,a,s=!1,o=!1){return e_(()=>{const l=e.shape.length;if(l<3)throw new ID(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(bI(2,l));if(e=hb(e,u),null!=a)throw new kD("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=i.asType("bool").asType("float32")).rank===l-1&&(i=iv(i,-1)),i=hb(i,u)),r&&(e=nS(e,0),null!=i&&(i=nS(i,0)));const c=[];let h,d=n;const p=e.shape[0],f=lv(e);let m,g;null!=i&&(m=lv(i));for(let e=0;e<p;++e){const n=f[e],r=e_(()=>t(n,d));if(null==i)h=r[0],d=r[1];else{const t=e_(()=>{const t=m[e],n=Zy(t).sub(t);return{output:r[0].mul(t).add(d[0].mul(n)),newStates:d.map((e,i)=>r[1][i].mul(t).add(e.mul(n)))}});h=t.output,d=t.newStates}o&&c.push(h)}return o&&(g=ov(c,1)),[h,g,d]})}dT.className="GlobalMaxPooling2D",u.registerClass(dT);class mT extends wk{constructor(t){let e;if(super(t),null==t.cell)throw new ID("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new ST({cells:t.cell}):t.cell,null==e.stateSize)throw new ID("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new yk({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?bI(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(t=>null):this.states_}setStates(t){this.states_=t}computeOutputShape(t){uk(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return e_(()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map(t=>null);return[t].concat(e)}return t})}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new kD("Constants support is not implemented in RNN yet.");uk(t)&&(t=t[0]),t=t,this.inputSpec[0]=new yk({shape:[this.stateful?t[0]:null,null,t[t.length-1]]});const e=[t[0]].concat(t.slice(2));let n;if(this.cell.build(e),n=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!r.arraysEqual(this.stateSpec.map(t=>t.shape[t.shape.length-1]),n))throw new ID("An initialState was passed that is not compatible with "+`cell.stateSize. Received stateSpec=${this.stateSpec}; `+`However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=n.map(t=>new yk({shape:[null,t]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){e_(()=>{if(!this.stateful)throw new CD("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new ID("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>Gy([n,t])):[Gy([n,this.cell.stateSize])];else if(null==t)n_(this.states_),null!=this.keptStates&&(n_(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>Gy([n,t])):this.states_[0]=Gy([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new ID(`Layer ${this.name} expects ${this.states_.length} state(s), `+`but it received ${t.length} state value(s). Input `+`received: ${t}`);!0===e?this.keptStates.push(this.states_.slice()):n_(this.states_);for(let e=0;e<this.states_.length;++e){const i=t[e],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,s=[n,a];if(!r.arraysEqual(i.shape,s))throw new ID(`State ${e} is incompatible with layer ${this.name}: `+`expected shape=${s}, received shape=${i.shape}`);this.states_[e]=i}}this.states_=this.states_.map(t=>r_(t.clone()))})}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=pT(t,n,r,this.numConstants);t=i.inputs,n=i.initialState,r=i.constants;let a=[],s=[];if(null!=n){e.initialState=n,a=a.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new yk({shape:t.shape}));s=s.concat(this.stateSpec)}if(null!=r&&(e.constants=r,a=a.concat(r),this.numConstants=r.length),a[0]instanceof vk){const n=[t].concat(a),r=this.inputSpec.concat(s),i=this.inputSpec;this.inputSpec=r;const o=super.apply(n,e);return this.inputSpec=i,o}return super.apply(t,e)}call(t,e){return e_(()=>{const n=null==e?null:e.mask,r=null==e?null:e.training;let i=null==e?null:e.initialState;t=hk(t),null==i&&(i=this.stateful?this.states_:this.getInitialState(t));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new ID(`RNN Layer has ${a} state(s) but was passed `+`${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const s={training:r},o=fT((t,e)=>{const n=this.cell.call([t].concat(e),s);return[n[0],n.slice(1)]},t,i,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],u=o[1],c=o[2];this.stateful&&this.resetStates(c,r);const h=this.returnSequences?u:l;return this.returnState?[h].concat(c):h})}getInitialState(t){return e_(()=>{let e=Gy(t.shape);return e=Cv(e,[1,2]),e=wI(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>t>1?EI(e,[1,t]):e):this.cell.stateSize>1?[EI(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const e=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:e};const n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,e,n={}){const r=Pk(e.cell,n);return new t(Object.assign(e,{cell:r}))}}mT.className="RNN",u.registerClass(mT);class gT extends wk{}class yT extends gT{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,UD(this.units,"units"),this.activation=JE(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=ik(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ik(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ik(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=tA(t.kernelRegularizer),this.recurrentRegularizer=tA(t.recurrentRegularizer),this.biasRegularizer=tA(t.biasRegularizer),this.kernelConstraint=eI(t.kernelConstraint),this.recurrentConstraint=eI(t.recurrentConstraint),this.biasConstraint=eI(t.biasConstraint),this.dropout=vI([1,_I([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=vI([1,_I([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=dk(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return e_(()=>{if(2!==(t=t).length)throw new ID(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let n=t[1];t=t[0];const r=null!=e.training&&e.training;let i;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=CT(()=>Zy(t),this.dropout,r)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=CT(()=>Zy(n),this.recurrentDropout,r));const a=this.dropoutMask,s=this.recurrentDropoutMask;i=TI(null!=a?K_(t,a):t,this.kernel.read()),null!=this.bias&&(i=OI(i,this.bias.read())),null!=s&&(n=K_(n,s));let o=a_(i,TI(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]})}getConfig(){const t={units:this.units,activation:HE(this.activation),useBias:this.useBias,kernelInitializer:rk(this.kernelInitializer),recurrentInitializer:rk(this.recurrentInitializer),biasInitializer:rk(this.biasInitializer),kernelRegularizer:YE(this.kernelRegularizer),recurrentRegularizer:YE(this.recurrentRegularizer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),kernelConstraint:QD(this.kernelConstraint),recurrentConstraint:QD(this.recurrentConstraint),biasConstraint:QD(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=super.getConfig();return Object.assign(t,e),t}}yT.className="SimpleRNNCell",u.registerClass(yT);class vT extends mT{constructor(t){t.cell=new yT(t),super(t)}call(t,e){return e_(()=>(null!=this.cell.dropoutMask&&(n_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(n_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}get units(){return this.cell.units}get activation(){return this.cell.activation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}getConfig(){const t={units:this.units,activation:HE(this.activation),useBias:this.useBias,kernelInitializer:rk(this.kernelInitializer),recurrentInitializer:rk(this.recurrentInitializer),biasInitializer:rk(this.biasInitializer),kernelRegularizer:YE(this.kernelRegularizer),recurrentRegularizer:YE(this.recurrentRegularizer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),kernelConstraint:QD(this.kernelConstraint),recurrentConstraint:QD(this.recurrentConstraint),biasConstraint:QD(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return new t(e)}}vT.className="SimpleRNN",u.registerClass(vT);class _T extends gT{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,UD(this.units,"units"),this.activation=JE(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=JE(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=ik(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ik(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ik(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=tA(t.kernelRegularizer),this.recurrentRegularizer=tA(t.recurrentRegularizer),this.biasRegularizer=tA(t.biasRegularizer),this.kernelConstraint=eI(t.kernelConstraint),this.recurrentConstraint=eI(t.recurrentConstraint),this.biasConstraint=eI(t.biasConstraint),this.dropout=vI([1,_I([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=vI([1,_I([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=dk(t),this.kernel=this.addWeight("kernel",[t[t.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return e_(()=>{if(2!==(t=t).length)throw new ID("GRUCell expects 2 input Tensors (inputs, h, c), got "+`${t.length}.`);const n=null!=e.training&&e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=CT(()=>Zy(t),this.dropout,n,3)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=CT(()=>Zy(r),this.recurrentDropout,n,3));const i=this.recurrentDropoutMask;let a,s,o;0<this.dropout&&this.dropout<1&&(t=K_(t,this.dropoutMask[0]));let l=TI(t,this.kernel.read());this.useBias&&(l=OI(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=K_(r,i[0]));const u=this.recurrentKernel.read(),[c,h]=kv(u,[2*this.units,this.units],u.rank-1),d=TI(r,c),[p,f,m]=kv(l,3,l.rank-1),[g,y]=kv(d,2,d.rank-1);a=this.recurrentActivation.apply(a_(p,g)),s=this.recurrentActivation.apply(a_(f,y));const v=TI(K_(s,r),h);o=this.activation.apply(a_(m,v));const _=a_(K_(a,r),K_(a_(1,C_(a)),o));return[_,_]})}getConfig(){const t={units:this.units,activation:HE(this.activation),recurrentActivation:HE(this.recurrentActivation),useBias:this.useBias,kernelInitializer:rk(this.kernelInitializer),recurrentInitializer:rk(this.recurrentInitializer),biasInitializer:rk(this.biasInitializer),kernelRegularizer:YE(this.kernelRegularizer),recurrentRegularizer:YE(this.recurrentRegularizer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),kernelConstraint:QD(this.kernelConstraint),recurrentConstraint:QD(this.recurrentConstraint),biasConstraint:QD(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return Object.assign(t,e),t}}_T.className="GRUCell",u.registerClass(_T);class bT extends mT{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new _T(t),super(t)}call(t,e){return e_(()=>(null!=this.cell.dropoutMask&&(n_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(n_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}get units(){return this.cell.units}get activation(){return this.cell.activation}get recurrentActivation(){return this.cell.recurrentActivation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}get implementation(){return this.cell.implementation}getConfig(){const t={units:this.units,activation:HE(this.activation),recurrentActivation:HE(this.recurrentActivation),useBias:this.useBias,kernelInitializer:rk(this.kernelInitializer),recurrentInitializer:rk(this.recurrentInitializer),biasInitializer:rk(this.biasInitializer),kernelRegularizer:YE(this.kernelRegularizer),recurrentRegularizer:YE(this.recurrentRegularizer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),kernelConstraint:QD(this.kernelConstraint),recurrentConstraint:QD(this.recurrentConstraint),biasConstraint:QD(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}bT.className="GRU",u.registerClass(bT);class xT extends gT{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,UD(this.units,"units"),this.activation=JE(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=JE(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=ik(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ik(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ik(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=tA(t.kernelRegularizer),this.recurrentRegularizer=tA(t.recurrentRegularizer),this.biasRegularizer=tA(t.biasRegularizer),this.kernelConstraint=eI(t.kernelConstraint),this.recurrentConstraint=eI(t.recurrentConstraint),this.biasConstraint=eI(t.biasConstraint),this.dropout=vI([1,_I([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=vI([1,_I([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;let n;if(t=dk(t),this.kernel=this.addWeight("kernel",[t[t.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,r=this.units;n=new((e=class extends $I{apply(e,n){const i=t.apply([r]),a=(new WI).apply([r]),s=t.apply([2*r]);return kI(kI(i,a),s)}}).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return e_(()=>{const n=null!=e.training&&e.training;if(3!==(t=t).length)throw new ID("LSTMCell expects 3 input Tensors (inputs, h, c), got "+`${t.length}.`);let r=t[1];const i=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=CT(()=>Zy(t),this.dropout,n,4)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=CT(()=>Zy(r),this.recurrentDropout,n,4));const a=this.recurrentDropoutMask;let s,o,l,u;0<this.dropout&&this.dropout<1&&(t=K_(t,this.dropoutMask[0]));let c=TI(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=K_(r,a[0])),c=a_(c,TI(r,this.recurrentKernel.read())),this.useBias&&(c=OI(c,this.bias.read()));const[h,d,p,f]=kv(c,4,c.rank-1);s=this.recurrentActivation.apply(h),o=this.recurrentActivation.apply(d),l=a_(K_(o,i),K_(s,this.activation.apply(p))),u=this.recurrentActivation.apply(f);const m=K_(u,this.activation.apply(l));return[m,m,l]})}getConfig(){const t={units:this.units,activation:HE(this.activation),recurrentActivation:HE(this.recurrentActivation),useBias:this.useBias,kernelInitializer:rk(this.kernelInitializer),recurrentInitializer:rk(this.recurrentInitializer),biasInitializer:rk(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:YE(this.kernelRegularizer),recurrentRegularizer:YE(this.recurrentRegularizer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),kernelConstraint:QD(this.kernelConstraint),recurrentConstraint:QD(this.recurrentConstraint),biasConstraint:QD(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return Object.assign(t,e),t}}xT.className="LSTMCell",u.registerClass(xT);class wT extends mT{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new xT(t),super(t)}call(t,e){return e_(()=>(null!=this.cell.dropoutMask&&(n_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(n_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}get units(){return this.cell.units}get activation(){return this.cell.activation}get recurrentActivation(){return this.cell.recurrentActivation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get unitForgetBias(){return this.cell.unitForgetBias}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}get implementation(){return this.cell.implementation}getConfig(){const t={units:this.units,activation:HE(this.activation),recurrentActivation:HE(this.recurrentActivation),useBias:this.useBias,kernelInitializer:rk(this.kernelInitializer),recurrentInitializer:rk(this.recurrentInitializer),biasInitializer:rk(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:YE(this.kernelRegularizer),recurrentRegularizer:YE(this.recurrentRegularizer),biasRegularizer:YE(this.biasRegularizer),activityRegularizer:YE(this.activityRegularizer),kernelConstraint:QD(this.kernelConstraint),recurrentConstraint:QD(this.recurrentConstraint),biasConstraint:QD(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}wT.className="LSTM",u.registerClass(wT);class ST extends gT{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return e_(()=>{let n=(t=t).slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let a;for(let s=0;s<this.cells.length;++s){const o=this.cells[s];n=r[s],a=0===s?[t[0]].concat(n):[a[0]].concat(n),a=o.call(a,e),i.push(a.slice(1))}n=[];for(const t of i.slice().reverse())n.push(...t);return[a[0]].concat(n)})}build(t){let e;uk(t)&&(t=t[0]),t=t,this.cells.forEach((n,r)=>{hI(`RNNCell_${r}`,()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=[];for(const r of this.cells)t.push({className:r.getClassName(),config:r.getConfig()});const e={cells:t},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(t,e,n={}){const r=[];for(const i of e.cells)r.push(Pk(i,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return mk(t)}setWeights(t){const e=[];for(const n of this.cells){const r=t.splice(n.weights.length);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],r[t]])}gk(e)}}function CT(t,e,n=null,r=1){function i(){return PI(t(),e)}if(r>1){const e=[];for(let a=0;a<r;a++)e.push(FI(i,t,n));return e.map(t=>r_(t.clone()))}return r_(FI(i,t,n).clone())}ST.className="StackedRNNCells",u.registerClass(ST);class DT extends wk{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,n={}){const r=Pk(e.layer,n);delete e.layer;const i={layer:r};return Object.assign(i,e),new t(i)}}class IT extends DT{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=dk(t)).length<3)throw new ID("TimeDistributed layer expects an input shape >= 3D, but received "+`input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=dk(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e);return[n[0],t[1]].concat(n.slice(1))}call(t,e){return e_(()=>fT((t,n)=>[hk(this.layer.call(t,e)),[]],t=hk(t),[],!1,null,null,!1,!0)[1])}}IT.className="TimeDistributed",u.registerClass(IT);class kT extends DT{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=Pk(n),e.goBackwards=!0!==e.goBackwards;const r={};if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=Pk(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,qD(aI,"BidirectionalMergeMode",this.mergeMode),t.weights)throw new kD("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=Math.floor(t.length/2);this.forwardLayer.setWeights(t.slice(0,e)),this.backwardLayer.setWeights(t.slice(e))}computeOutputShape(t){let e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(r=i.slice(1),e=i[0]):e=i[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):MD(n)}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=pT(t,n,r,this.numConstants);if(t=i.inputs,n=i.initialState,r=i.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const a=[],s=[];if(null!=n){const t=n.length;if(t%2>0)throw new ID("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,a.push(...n);const r=n.map(t=>new yk({shape:t.shape}));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),s.push(...r)}if(null!=r)throw new kD("Support for constants in Bidirectional layers is not implemented yet.");const o=a[0]instanceof vk;for(const l of a)if(l instanceof vk!==o)throw new ID("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){const n=[t].concat(a),r=this.inputSpec.concat(s),i=this.inputSpec;this.inputSpec=r;const o=super.apply(n,e);return this.inputSpec=i,o}return super.apply(t,e)}call(t,e){return e_(()=>{const n=e.initialState;let r,i,a,s;if(null==n)r=this.forwardLayer.call(t,e),i=this.backwardLayer.call(t,e);else{const a=n.slice(0,n.length/2),s=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:a})),i=this.backwardLayer.call(t,Object.assign(e,{initialState:s}))}return this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=nS(i,1)),"concat"===this.mergeMode?s=II([r,i]):"sum"===this.mergeMode?s=a_(r,i):"ave"===this.mergeMode?s=K_(.5,a_(r,i)):"mul"===this.mergeMode?s=K_(r,i):null==this.mergeMode&&(s=[r,i]),this.returnState?null==this.mergeMode?s.concat(a):[s].concat(a):s})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){hI(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),hI(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map(t=>null);return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=Pk(e.layer);if(delete e.layer,null!=e.numConstants)throw new kD("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=n,new t(r)}}var ET,AT;kT.className="Bidirectional",u.registerClass(kT),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(ET||(ET={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(AT||(AT={}));const TT=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],RT=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],MT=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],NT=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],OT=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],PT=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],FT=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],LT=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],zT=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],$T=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],BT=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],WT=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],qT=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],VT=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],UT=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],jT=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}];class HT{constructor(t,e,n,r,i,a,s){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=HT.nextId++}get closed(){return this.closed_}clearAndClose(){this.tensors.forEach(t=>t.tensor.dispose()),this.tensors=[],this.closed_=!0}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read `+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(t=>this.read(t))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),n&&n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(n&&n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);n.tensor=e,n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,`+`because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((t,n)=>this.write(t,e[n]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return Fy([],[0].concat(this.elementShape));const n=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),ov(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return Fy([],[0].concat(this.elementShape));const e=[];for(let r=0;r<this.size();r++)e.push(r);const n=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Qy(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(t,lv(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let n=0;const r=t.map(t=>(n+=t,n));if(n!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), `+"and the TensorArray is not marked as dynamically resizeable");const i=0===n?0:e.size/n,a=[];e_(()=>{e=e.reshape([1,n,i]);for(let n=0;n<t.length;++n)a[n]=Eb(e,[0,0===n?0:r[n-1],0],[1,t[n],i]).reshape(this.elementShape);return a});const s=[];for(let o=0;o<t.length;o++)s[o]=o;this.writeMany(s,a)}assertShapesMatchAllowUndefinedSize(t,e,n=""){r.assert(this.shapesEqualAllowUndefinedSize(t,e),()=>n+` Shapes ${t} and ${e} must match`)}shapesEqualAllowUndefinedSize(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0}}function GT(t){return null===t?null:JT(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function JT(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof Jg))}function XT(t){return t instanceof Jg?{value:t.clone(),recurse:!1}:JT(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}HT.nextId=0;class KT{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}class ZT extends KT{constructor(){super(ZT.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}ZT.INITIAL_CAPACITY=32;class YT{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new oR(this,t)}filter(t){return new aR(this,t)}map(t){return new sR(this,t)}mapAsync(t){return new lR(this,t)}serialMapAsync(t){return new lR(this,t).serial()}flatmap(t){return new cR(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(t=>!0===t)}rowMajorBatch(t,e=!0){return new iR(this,t,e)}columnMajorBatch(t,e=!0,n=GT){return this.rowMajorBatch(t,e).map(t=>function(t,e=GT){return function t(e,n,r=new Set){const i=e[0];if(r.has(i))throw new Error("Circular references are not supported.");const a=n(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(JT(i)){const a=Array.isArray(i)?[]:{};r.add(i);for(const s in i){const i=t(e.map(t=>t[s]),n,r);a[s]=i}return r.delete(i),a}throw new Error(`Can't recurse into non-iterable type: ${i}`)}return a.value}(t,e)}(t,n))}concatenate(t,e){return new hR(new QT([this,t]),e)}take(t){return t<0||null==t?this:new rR(this,t)}skip(t){return t<0||null==t?this:new nR(this,t)}prefetch(t){return new pR(this,t)}shuffle(t,e){return new fR(this,t,e)}serial(){return new eR(this)}}class QT extends YT{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:(e=t,function t(e,n,r=new Map,i=new Set){if(null==e)return null;if(i.has(e))throw new Error("Circular references are not supported.");if(r.has(e))return r.get(e);const a=n(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(JT(e)){const a=Array.isArray(e)?[]:{};i.add(e);for(const s in e){const o=t(e[s],n,r,i);a[s]=o}return i.delete(e),a}throw new Error(`Can't recurse into non-iterable type: ${e}`)}return r.set(e,a.value),a.value}(e,XT)),done:!1};var e}}class tR extends YT{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}}}class eR extends YT{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class nR extends YT{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;n_(t.value)}return this.upstream.next()}}class rR extends YT{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class iR extends YT{constructor(t,e,n=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class aR extends YT{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;n_(t.value)}}}class sR extends YT{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Map`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=i.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.getTensorsInContainer(n);for(const a of e)i.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}}class oR extends YT{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class lR extends YT{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=i.getTensorsInContainer(t.value),n=await this.transform(t.value),r=i.getTensorsInContainer(n);for(const a of e)i.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}}class uR extends YT{constructor(){super(),this.outputQueue=new ZT,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!(await this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class cR extends uR{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=i.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const a of e)i.isTensorInList(a,r)||a.dispose();return!0}}class hR extends YT{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}var dR;!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(dR||(dR={}));class pR extends YT{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new KT(e)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class fR extends pR{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=Fw.alea(n||r.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}class mR{constructor(){this.size=null}batch(t,e=!0){const n=this;let i;return r.assert(t>0,()=>`batchSize needs to be positive, but it is\n      ${t}`),i=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),gR(async()=>(await n.iterator()).columnMajorBatch(t,e,yR),i)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,gR(async()=>(await e.iterator()).concatenate(await t.iterator()),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,gR(async()=>(await e.iterator()).filter(e=>e_(()=>t(e))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return gR(async()=>(await e.iterator()).map(e=>e_(()=>t(e))),this.size)}mapAsync(t){const e=this;return gR(async()=>(await e.iterator()).mapAsync(t),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return gR(async()=>(await e.iterator()).prefetch(t),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,gR(async()=>{return n=(r=async()=>({value:await e.iterator(),done:!1}),new tR(r)).take(t),new hR(n,void 0);var n,r},n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,gR(async()=>(await e.iterator()).skip(t),n)}shuffle(t,e,n=!0){if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+`bufferSize to the dataset size (${this.size} elements)`);const i=this,a=Fw.alea(e||r.now().toString());return gR(async()=>{let e=a.int32();return n&&(e+=a.int32()),(await i.iterator()).shuffle(t,e.toString())},this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,gR(async()=>(await e.iterator()).take(t),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function gR(t,e=null){return new class extends mR{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function yR(t){return null===t?null:null==(e=t[0])||null===(n=e)||"object"!=typeof n&&"function"!=typeof n||Array.isArray(e)||"object"==typeof e&&e instanceof Jg||r.isTypedArray(e)?{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof Jg?ov(t):Fy(t)}(t),recurse:!1}:{value:null,recurse:!0};var e,n}function vR(t,e,n,i){const a=r.getTypedArrayFromDType(i,r.sizeFromShape(n));for(let r=0;r<a.length;++r){const n=r*e;let i=t[n];for(let r=0;r<e;++r){const e=t[n+r];e>i&&(i=e)}a[r]=i}return a}function _R(t,e,n,i,a){const s=e.length,o=r.sizeFromShape(e),l=r.computeStrides(e),u=r.computeStrides(a),c=r.getTypedArrayFromDType(n,r.sizeFromShape(a));for(let h=0;h<o;++h){const e=r.indexToLoc(h,s,l),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[i[t]];c[r.locToIndex(n,s,u)]=t[h]}return c}function bR(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&r.assert("complex64"!==t.dtype,()=>`${e} does not support complex64 tensors in the CPU backend.`)})}function xR(t,e,n,r,i,a){const s=i.strideHeight,o=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,h=i.effectiveFilterWidth,d=i.padInfo.top,p=i.padInfo.left,f="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=tv(i.outShape,n),g=m.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],v=i.outShape[2]*i.outShape[3],_=i.outShape[3];for(let b=0;b<i.batchSize;++b){const e=b*y,n=b*r[0];for(let m=0;m<i.inChannels;++m)for(let y=0;y<i.outHeight;++y){const b=y*s-d,x=Math.max(0,b),w=Math.min(i.inHeight,c+b),S=e+y*v;for(let e=0;e<i.outWidth;++e){const s=e*o-p,c=Math.max(0,s),d=Math.min(i.inWidth,h+s);let y=f,v=0,b=0;for(let e=x;e<w;e+=l){const i=n+e*r[1];for(let e=c;e<d;e+=u){const n=t[i+e*r[2]+m];"max"===a&&n>y?y=n:"avg"===a&&(v+=n,b++)}if(isNaN(y))break}g[S+e*_+m]="avg"===a?v/b:y}}}return m}function wR(t,e,n,r,i=!1,a=!1){const s=tv(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,m=tv(e,n,t);for(let g=0;g<r.batchSize;++g)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.outHeight;++e){const n=e*o-p;let y=n;for(;y<0;)y+=u;const v=Math.min(r.inHeight,h+n);for(let o=0;o<r.outWidth;++o){const h=o*l-f;let p=h;for(;p<0;)p+=c;const _=Math.min(r.inWidth,d+h);let b=Number.NEGATIVE_INFINITY,x=-1;for(let e=y;e<v;e+=u){const s=e-n;for(let n=p;n<_;n+=c){const o=n-h,l=m.get(g,e,n,t);l>b&&(b=l,x=i?a?((g*r.inHeight+e)*r.inWidth+n)*r.inChannels+t:(e*r.inWidth+n)*r.inChannels+t:s*d+o)}}s.set(x,g,e,o,t)}}return s}mR.MAX_BUFFER_SIZE=1e4,Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");const SR=_.nonMaxSuppressionV3,CR=_.split,DR=_.tile,IR=_.topkImpl,kR=_.whereImpl;function ER(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}class AR extends bD{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new _D(this,Qv())}write(t,e,n){this.firstUse&&(this.firstUse=!1,Mm().get("IS_NODE")&&v.warn("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));const r={};return this.data.set(r,{values:t,dtype:n}),r}move(t,e,n,r){this.data.set(t,{values:e,dtype:r})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensors:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return v.mergeRealAndImagArrays(t,e)}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map(t=>r.decodeString(t))}catch(i){throw new Error("Failed to decode encoded string bytes into utf-8")}return tv(t.shape,t.dtype,n)}makeOutput(t,e,n){const r=this.write(t,e,n);return Qv().makeTensorFromDataId(r,e,n,this)}disposeData(t){if(this.data.has(t)){const{complexTensors:e}=this.data.get(t);null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}}async time(t){const e=r.now();return t(),{kernelMs:r.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}complex(t,e){const n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Qv().keep(t.clone()),imag:Qv().keep(e.clone())},n}real(t){return this.data.get(t.dataId).complexTensors.real.clone()}imag(t){return this.data.get(t.dataId).complexTensors.imag.clone()}slice(t,e,n){if(bR(t,"slice"),s.isSliceContinous(t.shape,e,n)){const i=s.computeFlatOffset(e,t.strides),a=r.sizeFromShape(n);return Fy(this.readSync(t.dataId).subarray(i,i+a),n,t.dtype)}const i=tv(n,t.dtype),a=this.bufferSync(t);for(let r=0;r<i.size;++r){const t=i.indexToLoc(r).map((t,n)=>t+e[n]);i.values[r]=a.get(...t)}return i.toTensor()}stridedSlice(t,e,n,r){bR(t,"stridedSlice");const i=s.computeOutShape(e,n,r);if(i.some(t=>0===t))return Fy([],i);const a=tv(i,t.dtype),o=this.bufferSync(t);for(let s=0;s<a.size;s++){const t=a.indexToLoc(s),n=new Array(t.length);for(let i=0;i<n.length;i++)n[i]=t[i]*r[i]+e[i];a.set(o.get(...n),...t)}return a.toTensor()}diag(t){const e=this.readSync(t.dataId),n=tv([t.size,t.size],t.dtype),r=n.values;for(let i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()}unstack(t,e){const n=t.shape[e],r=new Array(t.rank-1);let i=0;for(let l=0;l<t.rank;l++)l!==e&&(r[i++]=t.shape[l]);const a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;const o=new Array(n);for(let l=0;l<o.length;l++)a[e]=l,o[l]=this.slice(t,a,s).reshape(r);return o}reverse(t,e){bR(t,"reverse");const n=tv(t.shape,t.dtype),r=this.bufferSync(t);for(let i=0;i<n.size;i++){const a=n.indexToLoc(i),s=a.slice();e.forEach(e=>s[e]=t.shape[e]-1-s[e]),n.set(r.get(...s),...a)}return n.toTensor()}concat(t,e){if("complex64"===t[0].dtype){const n=t.map(t=>Oy(t)),r=t.map(t=>Py(t));return Ny(this.concat(n,e),this.concat(r,e))}const n=t.map(t=>{const n=r.sizeFromShape(t.shape.slice(e));return t.as2D(-1,n)}),i=v.computeOutShape(n.map(t=>t.shape),1),a=tv(i,t[0].dtype).values;if(1===n[0].shape[0]){let t=0;n.forEach(e=>{a.set(this.readSync(e.dataId),t),t+=e.size})}else{let t=0;n.forEach(e=>{const n=this.readSync(e.dataId);let r=0;for(let s=0;s<e.shape[0];++s){const o=s*i[1]+t;for(let t=0;t<e.shape[1];++t)a[o+t]=n[r++]}t+=e.shape[1]})}const s=v.computeOutShape(t.map(t=>t.shape),e);return Fy(a,s,t[0].dtype)}neg(t){return bR(t,"neg"),this.multiply(zy(-1),t)}add(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,n,r)=>({real:t+n,imag:e+r})):this.broadcastedBinaryOp(t,e,ny(t.dtype,e.dtype),(t,e)=>t+e)}addN(t){bR(t,"addN");const e=t.map(t=>this.readSync(t.dataId)),n=tv(t[0].shape,t[0].dtype),r=n.values;for(let i=0;i<t.length;i++){const t=e[i];for(let e=0;e<r.length;e++)r[e]+=t[e]}return n.toTensor()}softmax(t,e){const n=r.parseAxisParam([e],t.shape),i=kw(t,n),a=v.expandShapeToKeepDim(i.shape,n),s=this.subtract(t,i.reshape(a)),o=this.exp(s),l=this.sum(o,n).reshape(a);return nb(o,l)}subtract(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,n,r)=>({real:t-n,imag:e-r})):this.broadcastedBinaryOp(t,e,ny(t.dtype,e.dtype),(t,e)=>t-e)}pow(t,e){return bR([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.pow(t,e))}batchMatMul(t,e,n,r){bR([t,e],"matMul");const i=n?t.shape[1]:t.shape[2],a=n?t.shape[2]:t.shape[1],s=r?e.shape[1]:e.shape[2],o=t.shape[0],l=this.readSync(t.dataId),u=this.readSync(e.dataId),[c,h,d]=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],[p,f,m]=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],g=a*s,y=tv([o,a,s],t.dtype),v=y.values,_=this.blockSize;for(let b=0;b<o;b++)for(let t=0;t<a;t+=_)for(let e=0;e<s;e+=_)for(let n=0;n<i;n+=_){const r=Math.min(t+_,a),o=Math.min(e+_,s),y=Math.min(n+_,i);for(let i=t;i<r;i++)for(let t=e;t<o;t++){let e=0;for(let r=n;r<y;r++)e+=l[b*c+i*h+r*d]*u[r*p+t*f+b*m];v[b*g+(i*s+t)]+=e}}return y.toTensor()}fusedBatchMatMul({a:t,b:e,transposeA:n,transposeB:r,bias:i,activation:a,preluActivationWeights:s}){let o=this.batchMatMul(t,e,n,r);return i&&(o=this.add(o,i)),a&&(o=ER(this,o,a,s)),o}multiply(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})):this.broadcastedBinaryOp(t,e,ny(t.dtype,e.dtype),(t,e)=>t*e)}floorDiv(t,e){return bR([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(t,e)=>Math.floor(t/e))}sum(t,e){bR(t,"sum"),v.assertAxesAreInnerMostDims("sum",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=Gy(n,ny(t.dtype,"int32")),s=r.sizeFromShape(i),o=this.readSync(a.dataId),l=this.readSync(t.dataId);for(let r=0;r<o.length;++r){const t=r*s;let e=0;for(let n=0;n<s;++n)e+=l[t+n];o[r]=e}return a}prod(t,e){bR(t,"sum");const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=Gy(n,ny(t.dtype,"int32")),s=r.sizeFromShape(i),o=this.readSync(a.dataId),l=this.readSync(t.dataId);for(let r=0;r<o.length;++r){const t=r*s;let e=1;for(let n=0;n<s;++n)e*=l[t+n];o[r]=e}return a}unsortedSegmentSum(t,e,n){bR(t,"unsortedSegmentSum");const r=[],i=t.rank-e.rank;for(let a=0;a<i;++a)e=e.expandDims(a+1);for(let a=0;a<n;++a){const n=zy(a,"int32"),i=bw(n,e).asType("float32").mul(t).sum(0);r.push(i)}return ov(r)}argMin(t,e){bR(t,"argMin");const n=[e];v.assertAxesAreInnerMostDims("argMin",n,t.rank);const[i,a]=v.computeOutAndReduceShapes(t.shape,n),s=Gy(i,"int32"),o=r.sizeFromShape(a),l=this.readSync(s.dataId),u=this.readSync(t.dataId);for(let r=0;r<l.length;++r){const t=r*o;let e=u[t],n=0;for(let r=0;r<o;++r){const i=u[t+r];i<e&&(e=i,n=r)}l[r]=n}return s}argMax(t,e){bR(t,"argMax");const n=[e];v.assertAxesAreInnerMostDims("argMax",n,t.rank);const[i,a]=v.computeOutAndReduceShapes(t.shape,n),s=Gy(i,"int32"),o=r.sizeFromShape(a),l=this.readSync(s.dataId),u=this.readSync(t.dataId);for(let r=0;r<l.length;++r){const t=r*o;let e=u[t],n=0;for(let r=0;r<o;++r){const i=u[t+r];i>e&&(e=i,n=r)}l[r]=n}return s}cumsum(t,e,n,r){if(bR(t,"cumsum"),e!==t.rank-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${t.rank-1} `+`but got axis=${e}`);const i=ny(t.dtype,"int32"),a=Gy(t.shape,i),s=this.readSync(a.dataId),o=this.readSync(t.dataId),l=t.shape[t.rank-1],u=r?(t,e)=>t+l-e-1:(t,e)=>t+e;for(let c=0;c<o.length;c+=l)for(let t=0;t<l;t++){const e=u(c,t);if(0===t)s[e]=n?0:o[e];else{const r=u(c,t-1);s[e]=n?o[r]+s[r]:o[e]+s[r]}}return a}equal(t,e){return bR([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t===e?1:0)}notEqual(t,e){return bR([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t!==e?1:0)}less(t,e){return bR([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t<e?1:0)}lessEqual(t,e){return bR([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t<=e?1:0)}greater(t,e){return bR([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t>e?1:0)}greaterEqual(t,e){return bR([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t>=e?1:0)}logicalNot(t){bR(t,"logicalNot");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,"bool")}logicalAnd(t,e){return bR([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t&&e)}logicalOr(t,e){return bR([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t||e)}select(t,e,n){bR([t,e,n],"select");const i=this.readSync(t.dataId),a=this.readSync(e.dataId),s=this.readSync(n.dataId),o=Gy(e.shape,ny(e.dtype,n.dtype)),l=this.readSync(o.dataId);let u=0;const c=0===t.rank||t.rank>1||1===e.rank?1:r.sizeFromShape(e.shape.slice(1));for(let r=0;r<i.length;r++)for(let t=0;t<c;t++)l[u++]=1===i[r]?a[r]:s[r];return o}where(t){bR([t],"where");const e=this.readSync(t.dataId);return kR(t.shape,e)}topk(t,e,n){bR(t,"topk");const r=this.readSync(t.dataId);return IR(r,t.shape,t.dtype,e,n)}min(t,e){bR(t,"min"),v.assertAxesAreInnerMostDims("min",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=Gy(n,t.dtype),s=r.sizeFromShape(i),o=this.readSync(a.dataId),l=this.readSync(t.dataId);for(let r=0;r<o.length;++r){const t=r*s;let e=l[t];for(let n=0;n<s;++n){const r=l[t+n];r<e&&(e=r)}o[r]=e}return a}minimum(t,e){return bR([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.min(t,e))}mod(t,e){return bR([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})}maximum(t,e){return bR([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.max(t,e))}all(t,e){bR(t,"all"),v.assertAxesAreInnerMostDims("all",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=Gy(n,t.dtype),s=r.sizeFromShape(i),o=this.readSync(a.dataId),l=this.readSync(t.dataId);for(let r=0;r<o.length;++r){const t=r*s;let e=l[t];for(let n=0;n<s;++n){const r=l[t+n];e=e&&r}o[r]=e}return a}any(t,e){bR(t,"any"),v.assertAxesAreInnerMostDims("any",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=Gy(n,t.dtype),s=r.sizeFromShape(i),o=this.readSync(a.dataId),l=this.readSync(t.dataId);for(let r=0;r<o.length;++r){const t=r*s;let e=l[t];for(let n=0;n<s;++n){const r=l[t+n];e=e||r}o[r]=e}return a}squaredDifference(t,e){return bR([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>{const n=t-e;return n*n})}ceil(t){bR(t,"ceil");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,"float32")}floor(t){bR(t,"floor");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,"float32")}sign(t){bR(t,"x");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return this.makeOutput(n,t.shape,"float32")}isNaN(t){bR(t,"x");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")}isInf(t){bR(t,"x");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")}isFinite(t){bR(t,"x");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")}round(t){bR(t,"round");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r){const t=Math.floor(e[r]);n[r]=e[r]-t<.5?Math.floor(e[r]):e[r]-t>.5?Math.ceil(e[r]):t%2==0?t:t+1}return this.makeOutput(n,t.shape,"float32")}exp(t){bR(t,"exp");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,"float32")}expm1(t){bR(t,"expm1");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,"float32")}log(t){bR(t,"log");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=Math.log(e[r]);return this.makeOutput(n,t.shape,"float32")}log1p(t){bR(t,"log1p");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return this.makeOutput(n,t.shape,"float32")}sqrt(t){bR(t,"sqrt");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return this.makeOutput(n,t.shape,"float32")}rsqrt(t){bR(t,"rsqrt");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return this.makeOutput(n,t.shape,"float32")}reciprocal(t){bR(t,"reciprocal");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,"float32")}linear(t){return t}relu(t){bR(t,"relu");const e=Gy(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId);for(let i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e}relu6(t){bR(t,"relu");const e=Gy(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId);for(let i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return e}prelu(t,e){return bR([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>t<0?e*t:t)}elu(t){bR(t,"elu");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r){const t=n[r];e[r]=t>=0?t:Math.exp(t)-1}return this.makeOutput(e,t.shape,"float32")}eluDer(t,e){bR([t,e],"eluDer");const n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId);for(let a=0;a<r.length;++a){const t=r[a];n[a]=t>=1?i[a]:i[a]*(t+1)}return this.makeOutput(n,e.shape,"float32")}selu(t){bR(t,"selu");const e=v.SELU_SCALEALPHA,n=v.SELU_SCALE,r=new Float32Array(t.size),i=this.readSync(t.dataId);for(let a=0;a<i.length;++a){const t=i[a];r[a]=t>=0?n*t:e*(Math.exp(t)-1)}return this.makeOutput(r,t.shape,"float32")}clip(t,e,n){bR(t,"clip");const r=new Float32Array(t.size),i=this.readSync(t.dataId);for(let a=0;a<i.length;++a){const t=i[a];r[a]=t>n?n:t<e?e:t}return this.makeOutput(r,t.shape,"float32")}abs(t){const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,"float32")}complexAbs(t){const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return this.makeOutput(e,t.shape,"float32")}int(t){bR(t,"int");const e=new Int32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,"int32")}sigmoid(t){bR(t,"sigmoid");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,"float32")}softplus(t){bR(t,"softplus");const e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId);for(let i=0;i<r.length;++i){const t=r[i]>-e,a=r[i]<e,s=Math.exp(r[i]);let o;o=a?s:t?r[i]:Math.log(1+s),n[i]=o}return this.makeOutput(n,t.shape,"float32")}sin(t){bR(t,"sin");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,"float32")}cos(t){bR(t,"cos");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,"float32")}tan(t){bR(t,"tan");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,"float32")}asin(t){bR(t,"asin");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,"float32")}acos(t){bR(t,"acos");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,"float32")}atan(t){bR(t,"atan");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,"float32")}atan2(t,e){return bR([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.atan2(t,e))}sinh(t){bR(t,"sinh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,"float32")}cosh(t){bR(t,"cosh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,"float32")}tanh(t){bR(t,"tanh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=r.tanh(n[i]);return this.makeOutput(e,t.shape,"float32")}asinh(t){bR(t,"asinh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,"float32")}acosh(t){bR(t,"acosh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,"float32")}atanh(t){bR(t,"atanh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,"float32")}erf(t){bR(t,"erf");const e=new Float32Array(t.size),n=this.readSync(t.dataId),r=v.ERF_P,i=v.ERF_A1,a=v.ERF_A2,s=v.ERF_A3,o=v.ERF_A4,l=v.ERF_A5;for(let u=0;u<n.length;++u){const t=Math.sign(n[u]),c=Math.abs(n[u]),h=1/(1+r*c);e[u]=t*(1-((((l*h+o)*h+s)*h+a)*h+i)*h*Math.exp(-c*c))}return this.makeOutput(e,t.shape,"float32")}step(t,e=0){bR(t,"step");const n=new Float32Array(t.size),r=this.readSync(t.dataId);for(let i=0;i<r.length;++i){const t=r[i];n[i]=isNaN(t)?NaN:t>0?1:e}return this.makeOutput(n,t.shape,"float32")}fusedConv2d({input:t,filter:e,convInfo:n,bias:r,activation:i,preluActivationWeights:a}){let s=this.conv2d(t,e,n);return r&&(s=this.add(s,r)),i&&(s=ER(this,s,i,a)),s}conv2d(t,e,n){bR([t,e],"conv2d");const r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,s=n.dilationWidth,o=n.padInfo.left,l=n.padInfo.top,u="channelsLast"===n.dataFormat,c=tv(n.outShape,t.dtype),h=t.strides[0],d=u?t.strides[1]:t.strides[2],p=u?t.strides[2]:1,f=u?1:t.strides[1],m=c.strides[0],g=u?c.strides[1]:c.strides[2],y=u?c.strides[2]:1,v=u?1:c.strides[1],_=this.readSync(t.dataId),b=this.readSync(e.dataId),x=c.values;for(let w=0;w<n.batchSize;++w){const t=w*h,u=w*m;for(let c=0;c<n.outHeight;++c){const h=u+c*g,m=c*n.strideHeight-l;for(let l=0;l<r;l++){const r=m+l*a;if(r<0||r>=n.inHeight)continue;const u=l*e.strides[0],c=t+r*d;for(let t=0;t<n.outWidth;++t){const r=h+t*y,a=t*n.strideWidth-o;for(let t=0;t<i;t++){const i=a+t*s;if(i<0||i>=n.inWidth)continue;const o=c+i*p;let l=u+t*e.strides[1];for(let t=0;t<n.inChannels;++t){const e=_[o+t*f];for(let t=0;t<n.outChannels;++t)x[r+t*v]+=e*b[l+t];l+=n.outChannels}}}}}}return c.toTensor()}conv3d(t,e,n){const r=n.filterDepth,i=n.filterHeight,a=n.filterWidth,s=n.dilationDepth,o=n.dilationHeight,l=n.dilationWidth,u=n.padInfo.front,c=n.padInfo.left,h=n.padInfo.top,d=tv(n.outShape,t.dtype),p=this.readSync(t.dataId),f=this.readSync(e.dataId),m=d.values;for(let g=0;g<n.batchSize;++g){const y=g*t.strides[0],v=g*d.strides[0];for(let g=0;g<n.outDepth;++g){const _=v+g*d.strides[1],b=g*n.strideDepth-u;for(let u=0;u<r;u++){const r=b+u*s;if(r<0||r>=n.inDepth)continue;const g=u*e.strides[0],v=y+r*t.strides[1];for(let s=0;s<n.outHeight;++s){const r=_+s*d.strides[2],u=s*n.strideHeight-h;for(let s=0;s<i;s++){const i=u+s*o;if(i<0||i>=n.inHeight)continue;const h=g+s*e.strides[1],d=v+i*t.strides[2];for(let t=0;t<n.outWidth;++t){const i=r+t*n.outChannels,s=t*n.strideWidth-c;for(let t=0;t<a;t++){const r=s+t*l;if(r<0||r>=n.inWidth)continue;const a=d+r*n.inChannels;let o=h+t*e.strides[2];for(let t=0;t<n.inChannels;++t){const e=p[a+t];for(let t=0;t<n.outChannels;++t)m[i+t]+=e*f[o+t];o+=n.outChannels}}}}}}}}return d.toTensor()}conv2dDerInput(t,e,n){bR([t,e],"conv2dDerInput");const r=tv(n.inShape,"float32"),i=r.values,a=this.readSync(t.dataId),s=this.readSync(e.dataId),[o,l,u]=e.strides,{batchSize:c,filterHeight:h,filterWidth:d,inChannels:p,inHeight:f,inWidth:m,outChannels:g,outHeight:y,outWidth:v,strideHeight:_,strideWidth:b,dataFormat:x}=n,w=h-1-n.padInfo.top,S=d-1-n.padInfo.left,C="channelsLast"===x,D=r.strides[0],I=C?r.strides[1]:r.strides[2],k=C?r.strides[2]:1,E=C?1:r.strides[1],A=t.strides[0],T=C?t.strides[1]:t.strides[2],R=C?t.strides[2]:1,M=C?1:t.strides[1];for(let N=0;N<c;++N)for(let t=0;t<p;++t)for(let e=0;e<f;++e){const n=e-w,r=Math.max(0,Math.ceil(n/_)),c=Math.min(y,(h+n)/_);for(let p=0;p<m;++p){const f=p-S,m=Math.max(0,Math.ceil(f/b)),y=Math.min(v,(d+f)/b);let x=0;for(let e=r;e<c;++e){const r=e*_-n;for(let n=m;n<y;++n){const i=A*N+T*e+R*n,c=o*(h-1-r)+l*(d-1-(n*b-f))+u*t;for(let t=0;t<g;++t)x+=a[i+M*t]*s[c+t]}}i[D*N+I*e+k*p+E*t]=x}}return r.toTensor()}conv3dDerInput(t,e,n){const r=tv(n.inShape,"float32"),i=r.values,[a,s,o,l]=r.strides,u=this.readSync(t.dataId),[c,h,d,p]=t.strides,f=this.readSync(e.dataId),[m,g,y,v]=e.strides,{batchSize:_,filterDepth:b,filterHeight:x,filterWidth:w,inChannels:S,inDepth:C,inHeight:D,inWidth:I,outChannels:k,outDepth:E,outHeight:A,outWidth:T,strideDepth:R,strideHeight:M,strideWidth:N}=n,O=b-1-n.padInfo.front,P=x-1-n.padInfo.top,F=w-1-n.padInfo.left;for(let L=0;L<_;++L)for(let t=0;t<S;++t)for(let e=0;e<C;++e){const n=e-O,r=Math.max(0,Math.ceil(n/R)),_=Math.min(E,(b+n)/R);for(let S=0;S<D;++S){const C=S-P,D=Math.max(0,Math.ceil(C/M)),E=Math.min(A,(x+C)/M);for(let A=0;A<I;++A){const I=A-F,O=Math.max(0,Math.ceil(I/N)),P=Math.min(T,(w+I)/N);let z=0;for(let e=r;e<_;++e){const r=e*R-n;for(let n=D;n<E;++n){const i=n*M-C;for(let a=O;a<P;++a){const s=c*L+h*e+d*n+p*a,o=m*(b-1-r)+g*(x-1-i)+y*(w-1-(a*N-I))+v*t;for(let t=0;t<k;++t)z+=u[s+t]*f[o+t]}}}i[a*L+s*e+o*S+l*A+t]=z}}}return r.toTensor()}conv2dDerFilter(t,e,n){bR([t,e],"conv2dDerFilter");const r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,s=n.filterWidth,o="channelsLast"===n.dataFormat,l=tv(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,h=this.bufferSync(t),d=this.bufferSync(e);for(let p=0;p<a;++p){const t=Math.max(0,Math.ceil((c-p)/r)),e=Math.min(n.outHeight,(n.inHeight+c-p)/r);for(let a=0;a<s;++a){const s=Math.max(0,Math.ceil((u-a)/i)),f=Math.min(n.outWidth,(n.inWidth+u-a)/i);for(let m=0;m<n.inChannels;++m)for(let g=0;g<n.outChannels;++g){let y=0;for(let l=0;l<n.batchSize;++l)for(let n=t;n<e;++n){const t=p+n*r-c;for(let e=s;e<f;++e){const r=a+e*i-u;y+=o?h.get(l,t,r,m)*d.get(l,n,e,g):h.get(l,m,t,r)*d.get(l,g,n,e)}}l.set(y,p,a,m,g)}}}return l.toTensor()}conv3dDerFilter(t,e,n){const r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,s=n.filterDepth,o=n.filterHeight,l=n.filterWidth,u=tv(n.filterShape,"float32"),c=u.values,[h,d,p,f]=u.strides,m=this.readSync(e.dataId),[g,y,v,_]=e.strides,b=this.readSync(t.dataId),[x,w,S,C]=t.strides,D=n.padInfo.front,I=n.padInfo.left,k=n.padInfo.top;for(let E=0;E<s;++E){const t=Math.max(0,Math.ceil((D-E)/r)),e=Math.min(n.outDepth,(n.inDepth+D-E)/r),s=E*h;for(let u=0;u<o;++u){const o=Math.max(0,Math.ceil((k-u)/i)),h=Math.min(n.outHeight,(n.inHeight+k-u)/i),A=u*d+s;for(let s=0;s<l;++s){const l=Math.max(0,Math.ceil((I-s)/a)),d=Math.min(n.outWidth,(n.inWidth+I-s)/a),T=s*p+A;for(let p=0;p<n.inChannels;++p){const A=p*f+T;for(let f=0;f<n.outChannels;++f){let T=0;for(let c=0;c<n.batchSize;++c){const n=c*x,A=c*g;for(let c=t;c<e;++c){const t=(E+c*r-D)*w+n,e=c*y+A;for(let n=o;n<h;++n){const r=(u+n*i-k)*S+t,o=n*v+e;for(let t=l;t<d;++t)T+=b[(s+t*a-I)*C+r+p]*m[t*_+o+f]}}}c[A+f]=T}}}}}return u.toTensor()}fusedDepthwiseConv2D({input:t,filter:e,convInfo:n,bias:r,activation:i,preluActivationWeights:a}){let s=this.depthwiseConv2D(t,e,n);return r&&(s=this.add(s,r)),i&&(s=ER(this,s,i,a)),s}depthwiseConv2D(t,e,n){bR([t,e],"depthwiseConv2D");const r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,s=n.dilationWidth,o=n.padInfo.left,l=n.padInfo.top,u=n.outChannels/n.inChannels,c=tv(n.outShape,t.dtype),h=this.readSync(t.dataId),d=this.readSync(e.dataId),p=c.values;for(let f=0;f<n.batchSize;++f){const m=f*t.strides[0],g=f*c.strides[0];for(let f=0;f<n.outHeight;++f){const y=g+f*c.strides[1],v=f*n.strideHeight-o;for(let o=0;o<r;++o){const r=v+o*a;if(r<0||r>=n.inHeight)continue;const f=o*e.strides[0],g=m+r*t.strides[1];for(let t=0;t<n.outWidth;++t){const r=y+t*c.strides[2],a=t*n.strideWidth-l;for(let t=0;t<i;++t){const i=a+t*s;if(i<0||i>=n.inWidth)continue;const o=g+i*n.inChannels;let l=r,c=f+t*e.strides[1];for(let t=0;t<n.inChannels;++t){const e=h[o+t];for(let t=0;t<u;++t)p[l+t]+=e*d[c+t];l+=u,c+=u}}}}}}return c.toTensor()}depthwiseConv2DDerInput(t,e,n){bR([t,e],"depthwiseConv2DDerInput");const r=tv(n.inShape,"float32"),i=r.values,[a,s,o]=r.strides,l=this.readSync(t.dataId),[u,c,h]=t.strides,d=this.readSync(e.dataId),[p,f,m]=e.strides,{batchSize:g,filterHeight:y,filterWidth:v,inChannels:_,inHeight:b,inWidth:x,outChannels:w,outHeight:S,outWidth:C,strideHeight:D,strideWidth:I}=n,k=y-1-n.padInfo.top,E=v-1-n.padInfo.left,A=w/_;for(let T=0;T<g;++T)for(let t=0;t<_;++t)for(let e=0;e<b;++e){const n=e-k,r=Math.max(0,Math.ceil(n/D)),g=Math.min(S,(y+n)/D);for(let _=0;_<x;++_){const b=_-E,x=Math.max(0,Math.ceil(b/I)),w=Math.min(C,(v+b)/I);let S=0;for(let e=r;e<g;++e){const r=e*D-n;for(let n=x;n<w;++n){const i=u*T+c*e+h*n,a=p*(y-1-r)+f*(v-1-(n*I-b))+m*t;for(let e=0;e<A;++e)S+=l[i+(t*A+e)]*d[a+e]}}i[a*T+s*e+o*_+t]=S}}return r.toTensor()}depthwiseConv2DDerFilter(t,e,n){bR([t,e],"depthwiseConv2DDerFilter");const r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,s=n.filterWidth,o=tv(n.filterShape,"float32"),l=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,h=this.bufferSync(t),d=this.bufferSync(e);for(let p=0;p<a;++p){const t=Math.max(0,Math.ceil((u-p)/r)),e=Math.min(n.outHeight,(n.inHeight+u-p)/r);for(let a=0;a<s;++a){const s=Math.max(0,Math.ceil((l-a)/i)),f=Math.min(n.outWidth,(n.inWidth+l-a)/i);for(let m=0;m<n.outChannels;++m){const g=Math.trunc(m/c),y=m%c;let v=0;for(let o=0;o<n.batchSize;++o)for(let n=t;n<e;++n){const t=p+n*r-u;for(let e=s;e<f;++e)v+=h.get(o,t,a+e*i-l,g)*d.get(o,n,e,m)}o.set(v,p,a,g,y)}}}return o.toTensor()}tile(t,e){return bR(t,"tile"),DR(this.bufferSync(t),e)}pad(t,e,n){bR(t,"pad");const r=e.map((e,n)=>e[0]+t.shape[n]+e[1]),i=e.map(t=>t[0]),a=this.bufferSync(t),s=tv(r,t.dtype);0!==n&&s.values.fill(n);for(let o=0;o<t.size;o++){const t=a.indexToLoc(o),e=t.map((t,e)=>t+i[e]);s.set(a.get(...t),...e)}return s.toTensor()}gather(t,e,n){bR([t,e],"gather");const r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;const a=tv(r,t.dtype),s=this.bufferSync(t);for(let o=0;o<a.size;++o){const t=a.indexToLoc(o),e=t.slice();e[n]=i[t[n]];const r=s.locToIndex(e);a.values[o]=s.values[r]}return a.toTensor()}batchToSpaceND(t,e,n){bR([t],"batchToSpaceND");const r=e.reduce((t,e)=>t*e),i=v.getReshaped(t.shape,e,r),a=v.getPermuted(i.length,e.length),s=v.getReshapedPermuted(t.shape,e,r),o=v.getSliceBeginCoords(n,e.length),l=v.getSliceSize(s,n,e.length);return hb(t.reshape(i),a).reshape(s).slice(o,l)}spaceToBatchND(t,e,n){bR([t],"spaceToBatchND");const r=e.reduce((t,e)=>t*e),i=[[0,0]];i.push(...n);for(let u=1+e.length;u<t.shape.length;++u)i.push([0,0]);const a=t.pad(i),s=v.getReshaped(a.shape,e,r,!1),o=v.getPermuted(s.length,e.length,!1),l=v.getReshapedPermuted(a.shape,e,r,!1);return hb(a.reshape(s),o).reshape(l)}maxPool(t,e){return bR(t,"maxPool"),xR(this.readSync(t.dataId),0,t.dtype,t.strides,e,"max").toTensor()}maxPoolBackprop(t,e,n,r){bR([e,n],"maxPoolBackprop");const i=this.readSync(e.dataId),a=tv(r.outShape,e.dtype,wR(i,e.shape,e.dtype,r).values),s=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=h-1-r.padInfo.left,p=c-1-r.padInfo.top,f=tv(e.shape,"float32"),m=this.bufferSync(t);for(let g=0;g<r.batchSize;++g)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.inHeight;++e)for(let n=0;n<r.inWidth;++n){const i=e-p,y=n-d;let v=0;for(let e=0;e<c;e+=l){const n=(i+e)/s;if(!(n<0||n>=r.outHeight||Math.floor(n)!==n))for(let i=0;i<h;i+=u){const s=(y+i)/o;if(s<0||s>=r.outWidth||Math.floor(s)!==s)continue;const l=c*h-1-a.get(g,n,s,t)===e*h+i?1:0;0!==l&&(v+=m.get(g,n,s,t)*l)}}f.set(v,g,e,n,t)}return f.toTensor()}avgPoolBackprop(t,e,n){bR([t,e],"avgPoolBackprop");const r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,s=n.filterWidth,o=n.dilationHeight,l=n.dilationWidth,u=n.effectiveFilterHeight,c=n.effectiveFilterWidth,h=c-1-n.padInfo.left,d=u-1-n.padInfo.top,p=tv(e.shape,"float32"),f=1/(a*s),m=this.bufferSync(t);for(let g=0;g<n.batchSize;++g)for(let t=0;t<n.inChannels;++t)for(let e=0;e<n.inHeight;++e)for(let a=0;a<n.inWidth;++a){const s=e-d,y=a-h;let v=0;for(let e=0;e<u;e+=o){const a=(s+e)/r;if(!(a<0||a>=n.outHeight||Math.floor(a)!==a))for(let e=0;e<c;e+=l){const r=(y+e)/i;r<0||r>=n.outWidth||Math.floor(r)!==r||(v+=m.get(g,a,r,t))}}p.set(v*f,g,e,a,t)}return p.toTensor()}pool3d(t,e,n){bR(t,"pool3d");const r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(t.dataId),y=tv(e.outShape,t.dtype),v=y.values,_=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],b=e.outShape[2]*e.outShape[3]*e.outShape[4],x=e.outShape[3]*e.outShape[4],w=e.outShape[4];for(let S=0;S<e.batchSize;++S){const y=S*_,C=S*t.strides[0];for(let _=0;_<e.inChannels;++_)for(let S=0;S<e.outDepth;++S){const D=S*r-d;let I=D;for(;I<0;)I+=s;const k=Math.min(e.inDepth,u+D),E=y+S*b;for(let r=0;r<e.outHeight;++r){const u=r*i-p;let d=u;for(;d<0;)d+=o;const y=Math.min(e.inHeight,c+u),b=E+r*x;for(let r=0;r<e.outWidth;++r){const i=r*a-f;let u=i;for(;u<0;)u+=l;const c=Math.min(e.inWidth,h+i),p=b+r*w;let x=m,S=0,D=0;for(let e=I;e<k;e+=s){const r=C+e*t.strides[1];for(let e=d;e<y;e+=o){const i=r+e*t.strides[2];for(let e=u;e<c;e+=l){const r=g[i+e*t.strides[3]+_];if("max"===n&&r>x?x=r:"avg"===n&&(S+=r,D++),isNaN(x))break}if(isNaN(x))break}if(isNaN(x))break}v[p+_]="avg"===n?S/D:x}}}}return y.toTensor()}avgPool3d(t,e){return bR(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()}avgPool3dBackprop(t,e,n){bR([t,e],"avgPool3dBackprop");const r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,s=n.filterDepth,o=n.filterHeight,l=n.filterWidth,u=n.dilationDepth,c=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterDepth,p=n.effectiveFilterHeight,f=n.effectiveFilterWidth,m=d-1-n.padInfo.front,g=f-1-n.padInfo.left,y=p-1-n.padInfo.top,v=tv(e.shape,"float32"),_=1/(s*o*l),b=this.bufferSync(t);for(let x=0;x<n.batchSize;++x)for(let t=0;t<n.inChannels;++t)for(let e=0;e<n.inDepth;++e)for(let s=0;s<n.inHeight;++s)for(let o=0;o<n.inWidth;++o){const l=e-m,w=s-y,S=o-g;let C=0;for(let e=0;e<d;e+=u){const s=(l+e)/r;if(!(s<0||s>=n.outDepth||Math.floor(s)!==s))for(let e=0;e<p;e+=c){const r=(w+e)/i;if(!(r<0||r>=n.outHeight||Math.floor(r)!==r))for(let e=0;e<f;e+=h){const i=(S+e)/a;i<0||i>=n.outWidth||Math.floor(i)!==i||(C+=b.get(x,s,r,i,t))}}}v.set(C*_,x,e,s,o,t)}return v.toTensor()}maxPool3d(t,e){return bR(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()}maxPool3dPositions(t,e){const n=tv(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left,m=this.bufferSync(t);for(let g=0;g<e.batchSize;++g)for(let t=0;t<e.inChannels;++t)for(let y=0;y<e.outDepth;++y){const v=y*r-d;let _=v;for(;_<0;)_+=s;const b=Math.min(e.inDepth,u+v);for(let r=0;r<e.outHeight;++r){const u=r*i-p;let d=u;for(;d<0;)d+=o;const x=Math.min(e.inHeight,c+u);for(let i=0;i<e.outWidth;++i){const p=i*a-f;let w=p;for(;w<0;)w+=l;const S=Math.min(e.inWidth,h+p);let C=Number.NEGATIVE_INFINITY,D=-1;for(let e=_;e<b;e+=s){const n=e-v;for(let r=d;r<x;r+=o){const i=r-u;for(let a=w;a<S;a+=l){const s=a-p,o=m.get(g,e,r,a,t);o>=C&&(C=o,D=n*c*h+i*c+s)}}}n.set(D,g,y,r,i,t)}}}return n.toTensor()}maxPool3dBackprop(t,e,n,r){bR([e,n],"maxPool3dBackprop");const i=this.maxPool3dPositions(e,r),a=r.strideDepth,s=r.strideHeight,o=r.strideWidth,l=r.dilationDepth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=h-1-r.padInfo.front,m=p-1-r.padInfo.left,g=d-1-r.padInfo.top,y=tv(e.shape,"float32"),v=this.bufferSync(i),_=this.bufferSync(t);for(let b=0;b<r.batchSize;++b)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.inDepth;++e)for(let n=0;n<r.inHeight;++n)for(let i=0;i<r.inWidth;++i){const x=e-f,w=n-g,S=i-m;let C=0;for(let e=0;e<h;e+=l){const n=(x+e)/a;if(!(n<0||n>=r.outDepth||Math.floor(n)!==n))for(let i=0;i<d;i+=u){const a=(w+i)/s;if(!(a<0||a>=r.outHeight||Math.floor(a)!==a))for(let s=0;s<p;s+=c){const l=(S+s)/o;if(l<0||l>=r.outWidth||Math.floor(l)!==l)continue;const u=h*d*p-1-v.get(b,n,a,l,t)===e*d*p+i*p+s?1:0;0!==u&&(C+=_.get(b,n,a,l,t)*u)}}}y.set(C,b,e,n,i,t)}return y.toTensor()}cast(t,e){return v.castTensor(t,e,this)}reshape(t,e){return v.reshapeTensor(t,e)}avgPool(t,e){return bR(t,"avgPool"),bR(t,"maxPool"),xR(this.readSync(t.dataId),0,t.dtype,t.strides,e,"avg").toTensor().toFloat()}resizeBilinear(t,e,n,i){bR(t,"resizeBilinear");const[a,s,o,l]=t.shape,u=this.readSync(t.dataId),c=new Float32Array(r.sizeFromShape([a,e,n,l])),h=[i&&e>1?s-1:s,i&&n>1?o-1:o],d=[i&&e>1?e-1:e,i&&n>1?n-1:n];let p=0;const f=h[0]/d[0],m=h[1]/d[1];for(let r=0;r<a;r++)for(let i=0;i<e;i++){const e=f*i,a=Math.floor(e),h=e-a,d=Math.min(s-1,Math.ceil(e)),g=r*t.strides[0]+a*t.strides[1],y=r*t.strides[0]+d*t.strides[1];for(let r=0;r<n;r++){const e=m*r,n=Math.floor(e),i=e-n,a=Math.min(o-1,Math.ceil(e)),s=g+n*t.strides[2],d=y+n*t.strides[2],f=g+a*t.strides[2],v=y+a*t.strides[2];for(let t=0;t<l;t++){const e=u[s+t],n=u[d+t],r=e+(u[f+t]-e)*i;c[p++]=r+(n+(u[v+t]-n)*i-r)*h}}}return Fy(c,[a,e,n,l])}resizeBilinearBackprop(t,e,n){bR([t,e],"resizeBilinearBackprop");const[r,i,a,s]=e.shape,[,o,l]=t.shape,u=new Float32Array(r*i*a*s),c=[n&&o>1?i-1:i,n&&l>1?a-1:a],h=[n&&o>1?o-1:o,n&&l>1?l-1:l],d=c[0]/h[0],p=c[1]/h[1],f=this.readSync(t.dataId);let m=0;for(let g=0;g<r;g++){const t=g*e.strides[0];for(let n=0;n<o;n++){const r=n*d,o=Math.floor(r),c=Math.min(Math.ceil(r),i-1),h=t+o*e.strides[1],g=t+c*e.strides[1],y=r-o,v=1-y;for(let t=0;t<l;t++){const n=t*p,r=Math.floor(n),i=Math.min(Math.ceil(n),a-1),o=n-r,l=1-o,c=h+r*e.strides[2],d=h+i*e.strides[2],_=g+r*e.strides[2],b=g+i*e.strides[2],x=v*l,w=v*o,S=y*l,C=y*o;for(let t=0;t<s;t++){const e=f[m++];u[c+t]+=e*x,u[d+t]+=e*w,u[_+t]+=e*S,u[b+t]+=e*C}}}}return qy(u,[r,a,i,s],e.dtype)}resizeNearestNeighbor(t,e,n,r){bR(t,"resizeNearestNeighbor");const[i,a,s,o]=t.shape,l=this.readSync(t.dataId),u=new Float32Array(i*e*n*o),c=[r&&e>1?a-1:a,r&&n>1?s-1:s],h=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=c[0]/h[0],p=c[1]/h[1];let f=0;for(let m=0;m<i;m++){const i=m*t.strides[0];for(let c=0;c<e;c++){const e=d*c,h=i+Math.min(a-1,r?Math.round(e):Math.floor(e))*t.strides[1];for(let i=0;i<n;i++){const e=p*i,n=h+Math.min(s-1,r?Math.round(e):Math.floor(e))*t.strides[2];for(let t=0;t<o;t++)u[f++]=l[n+t]}}}return Fy(u,[i,e,n,o],t.dtype)}resizeNearestNeighborBackprop(t,e,n){bR([t,e],"resizeNearestNeighborBackprop");const[r,i,a,s]=e.shape,[,o,l]=t.shape,u=new Float32Array(r*i*a*s),c=this.readSync(t.dataId),h=[n&&o>1?i-1:i,n&&l>1?a-1:a],d=[n&&o>1?o-1:o,n&&l>1?l-1:l],p=h[0]/d[0],f=h[1]/d[1],m=1/p,g=1/f,y=2*Math.ceil(m)+2,v=2*Math.ceil(g)+2;for(let _=0;_<r;_++){const r=_*e.strides[0];for(let h=0;h<i;h++){const d=r+h*e.strides[1],_=Math.floor(h*m),b=Math.floor(_-y/2);for(let m=0;m<a;m++){const _=d+m*e.strides[2],x=Math.floor(m*g),w=Math.floor(x-v/2);for(let e=0;e<s;e++){let s=0;for(let u=0;u<y;u++){const d=u+b;if(d<0||d>=o)continue;const g=r+d*t.strides[1],y=d*p;if(h===Math.min(i-1,n?Math.round(y):Math.floor(y)))for(let r=0;r<v;r++){const i=r+w;if(i<0||i>=l)continue;const o=g+i*t.strides[2],u=i*f;m===Math.min(a-1,n?Math.round(u):Math.floor(u))&&(s+=c[o+e])}}u[_+e]=s}}}}return qy(u,e.shape,e.dtype)}batchNorm(t,e,n,r,i,a){bR([t,e,n,i,r],"batchNorm");const s=this.readSync(t.dataId),o=this.readSync(e.dataId),l=this.readSync(n.dataId),u=i?this.readSync(i.dataId):new Float32Array([1]),c=r?this.readSync(r.dataId):new Float32Array([0]),h=new Float32Array(s.length),d=c.length,p=u.length,f=l.length,m=o.length;let g=0,y=0,v=0,_=0;for(let b=0;b<s.length;++b)h[b]=c[g++]+(s[b]-o[y++])*u[v++]/Math.sqrt(l[_++]+a),g>=d&&(g=0),y>=m&&(y=0),v>=p&&(v=0),_>=f&&(_=0);return qy(h,t.shape)}localResponseNormalization4D(t,e,n,r,i){bR(t,"localResponseNormalization4D");const a=t.shape[3],s=a-1,o=this.readSync(t.dataId),l=t.size,u=new Float32Array(l);function c(t){const n=t%a;let r=t-n+Math.max(0,n-e);const i=t-n+Math.min(n+e,s);let l=0;for(;r<=i;r++){const t=o[r];l+=t*t}return l}for(let h=0;h<l;h++){const t=c(h),e=o[h]*Math.pow(n+r*t,-i);u[h]=e}return qy(u,t.shape)}LRNGrad(t,e,n,r,i,a,s){bR(t,"LRNGrad");const o=t.shape[3],l=this.readSync(t.dataId),u=this.readSync(e.dataId),c=this.readSync(n.dataId),h=new Float32Array(t.size),d=t.size;for(let p=0;p<d;p++){const t=p%o,e=p-t+Math.max(0,t-r),n=p-t+Math.min(o,t+r+1);let d=0;for(let r=e;r<n;r++)d+=Math.pow(u[r],2);d=a*d+i;for(let r=e;r<n;r++){let t=-2*a*s*u[r]*c[p]/d;p===r&&(t+=Math.pow(d,-s)),t*=l[p],h[r]+=t}}return qy(h,t.shape)}multinomial(t,e,n,r){bR(t,"multinomial");const i=e?t:AS(t),a=i.shape[0],s=i.shape[1],o=Gy([a,n],"int32"),l=this.readSync(o.dataId),u=this.readSync(i.dataId);for(let c=0;c<a;++c){const t=c*s,e=new Float32Array(s-1);e[0]=u[t];for(let n=1;n<e.length;++n)e[n]=e[n-1]+u[t+n];const i=Fw.alea(r.toString()),a=c*n;for(let r=0;r<n;++r){const t=i();l[a+r]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){l[a+r]=n;break}}}return o}oneHot(t,e,n,r){bR(t,"oneHot");const i=new Float32Array(t.size*e);i.fill(r);const a=this.readSync(t.dataId);for(let s=0;s<t.size;++s)a[s]>=0&&a[s]<e&&(i[s*e+a[s]]=n);return By(i,[t.size,e],"int32")}nonMaxSuppression(t,e,n,r,i){bR(t,"nonMaxSuppression");const a=this.readSync(t.dataId),s=this.readSync(e.dataId);return SR(a,s,n,r,i)}fft(t){return this.fftBatch(t,!1)}ifft(t){return this.fftBatch(t,!0)}fftBatch(t,e){const n=t.shape[0],r=t.shape[1],i=tv(t.shape,"float32"),a=tv(t.shape,"float32"),s=Oy(t).as2D(n,r),o=Py(t).as2D(n,r);for(let l=0;l<n;l++){const t=s.slice([l,0],[1,r]),n=o.slice([l,0],[1,r]),u=Ny(t,n),c=this.readSync(this.fftImpl(u,e).dataId);for(let e=0;e<r;e++){const t=v.getComplexWithIndex(c,e);i.values[l*r+e]=t.real,a.values[l*r+e]=t.imag}}return Ny(i.toTensor(),a.toTensor()).as2D(n,r)}fftImpl(t,e){const n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){let i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=Ny(Oy(i).div(zy(r)),Py(i).div(zy(r)))),i}{const n=this.readSync(t.dataId),i=this.fourierTransformByMatmul(n,r,e),a=v.splitRealAndImagArrays(i);return Ny(a.real,a.imag).as2D(t.shape[0],t.shape[1])}}isExponentOf2(t){return 0==(t&t-1)}fftRadix2(t,e,n){if(1===e)return t;const r=this.readSync(t.dataId),i=e/2,a=v.complexWithEvenIndex(r);let s=Ny(a.real,a.imag).as1D();const o=v.complexWithOddIndex(r);let l=Ny(o.real,o.imag).as1D();s=this.fftRadix2(s,i,n),l=this.fftRadix2(l,i,n);const u=v.exponents(e,n),c=Ny(u.real,u.imag).mul(l),h=s.add(c),d=s.sub(c),p=Oy(h).concat(Oy(d)),f=Py(h).concat(Py(d));return Ny(p,f).as1D()}fourierTransformByMatmul(t,e,n){const r=new Float32Array(2*e);for(let i=0;i<e;i++){let a=0,s=0;for(let r=0;r<e;r++){const o=v.exponent(i*r,e,n),l=v.getComplexWithIndex(t,r);a+=l.real*o.real-l.imag*o.imag,s+=l.real*o.imag+l.imag*o.real}n&&(a/=e,s/=e),v.assignToTypedArray(r,a,s,i)}return r}depthToSpace(t,e,n){r.assert("NHWC"===n,()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${n}`),r.assert(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`);const i=t.shape[0],a=t.shape[1],s=t.shape[2],o=t.shape[3],l=a*e,u=s*e,c=o/(e*e),h=this.readSync(t.dataId),d=new Float32Array(i*l*u*c);let p=0;for(let r=0;r<i;++r)for(let t=0;t<l;++t){const n=Math.floor(t/e),i=t%e;for(let t=0;t<u;++t){const l=Math.floor(t/e),u=(i*e+t%e)*c;for(let t=0;t<c;++t)d[p++]=h[t+u+o*(l+s*(n+a*r))]}}return qy(d,[i,l,u,c])}broadcastedBinaryOp(t,e,n,r){const i=v.assertAndGetBroadcastShape(t.shape,e.shape),a=tv(i,n),s=this.readSync(t.dataId),o=this.readSync(e.dataId),l=v.getBroadcastDims(t.shape,i),u=v.getBroadcastDims(e.shape,i),c=a.values;if(l.length+u.length===0)for(let h=0;h<c.length;++h)c[h]=r(s[h%s.length],o[h%o.length]);else{const n=this.bufferSync(t),i=this.bufferSync(e);for(let h=0;h<c.length;++h){const d=a.indexToLoc(h),p=d.slice(-t.rank);l.forEach(t=>p[t]=0);const f=n.locToIndex(p),m=d.slice(-e.rank);u.forEach(t=>m[t]=0);const g=i.locToIndex(m);c[h]=r(s[f],o[g])}}return a.toTensor()}broadcastedBinaryComplexOp(t,e,n){const r=v.assertAndGetBroadcastShape(t.shape,e.shape),i=tv(r,"float32"),a=tv(r,"float32"),s=this.readSync(t.dataId),o=this.readSync(e.dataId),l=v.getBroadcastDims(t.shape,r),u=v.getBroadcastDims(e.shape,r),c=i.values,h=a.values;if(l.length+u.length===0)for(let d=0;d<c.length;d++){const t=d%s.length,e=d%o.length,r=n(s[2*t],s[2*t+1],o[2*e],o[2*e+1]);c[d]=r.real,h[d]=r.imag}else{const r=this.bufferSync(this.data.get(t.dataId).complexTensors.real),a=this.bufferSync(this.data.get(e.dataId).complexTensors.real);for(let d=0;d<c.length;d++){const p=i.indexToLoc(d),f=p.slice(-t.rank);l.forEach(t=>f[t]=0);const m=r.locToIndex(f),g=p.slice(-e.rank);u.forEach(t=>g[t]=0);const y=a.locToIndex(g),v=n(s[2*m],s[2*m+1],o[2*y],o[2*y+1]);c[d]=v.real,h[d]=v.imag}}return this.complex(i.toTensor(),a.toTensor())}split(t,e,n){return CR(t,e,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}cropAndResize(t,e,n,r,i,a){const[s,o,l,u]=t.shape,c=e.shape[0],[h,d]=r,p=tv([c,h,d,u],"float32"),f=this.readSync(e.dataId),m=this.readSync(n.dataId),g=this.readSync(t.dataId),y=t.strides,v=p.strides;for(let _=0;_<c;_++){const t=4*_,e=f[t],n=f[t+1],r=f[t+2],c=f[t+3],b=m[_];if(b>=s)continue;const x=h>1?(r-e)*(o-1)/(h-1):0,w=d>1?(c-n)*(l-1)/(d-1):0;for(let s=0;s<h;s++){const t=h>1?e*(o-1)+s*x:.5*(e+r)*(o-1);if(t<0||t>o-1)for(let e=0;e<d;e++)for(let t=0;t<u;t++)p.values[t+e*v[2]+s*v[1]+_*v[0]]=a;else if("bilinear"===i){const e=Math.floor(t),r=Math.ceil(t),i=t-e;for(let t=0;t<d;t++){const o=d>1?n*(l-1)+t*w:.5*(n+c)*(l-1);if(o<0||o>l-1){for(let e=0;e<u;e++)p.values[e+t*v[2]+s*v[1]+_*v[0]]=a;continue}const h=Math.floor(o),f=Math.ceil(o),m=o-h;for(let n=0;n<u;n++){let a=n+h*y[2]+e*y[1]+b*y[0];const o=g[a];a=n+f*y[2]+e*y[1]+b*y[0];const l=g[a];a=n+h*y[2]+r*y[1]+b*y[0];const u=g[a];a=n+f*y[2]+r*y[1]+b*y[0];const c=g[a],d=o+(l-o)*m;a=n+t*v[2]+s*v[1]+_*v[0],p.values[a]=d+(u+(c-u)*m-d)*i}}}else for(let e=0;e<d;++e){const r=d>1?n*(l-1)+e*w:.5*(n+c)*(l-1);if(r<0||r>l-1){for(let t=0;t<u;t++)p.values[t+e*v[2]+s*v[1]+_*v[0]]=a;continue}const i=Math.round(r),o=Math.round(t);for(let t=0;t<u;t++)p.values[t+e*v[2]+s*v[1]+_*v[0]]=g[t+i*y[2]+o*y[1]+b*y[0]]}}}return p.toTensor()}sparseToDense(t,e,n,r){const{sliceRank:i,numUpdates:a,sliceSize:s,strides:o,outputSize:l}=v.calculateShapes(e,t,n);return this.scatter(t,e,n,l,s,a,i,o,r,!1)}gatherND(t,e){const n=e.shape,r=n[n.length-1],[i,a,s,o]=v.prepareAndValidate(t,e);if(0===a)return Fy([],i,t.dtype);const l=new Ug([a,s],t.dtype),u=this.readSync(e.dataId),c=this.readSync(t.dataId);for(let h=0;h<a;h++){const e=[];let n=0;for(let t=0;t<r;t++){const i=u[h*r+t];n+=i*o[t],e.push(i)}if(n<0||n>=t.size/s)throw new Error(`Invalid indices: ${e} does not index into ${t.shape}`);for(let t=0;t<s;t++)l.values[h*s+t]=c[n*s+t]}return l.toTensor().reshape(i)}scatterND(t,e,n){const{sliceRank:r,numUpdates:i,sliceSize:a,strides:s,outputSize:o}=v.calculateShapes(e,t,n),l=zy(0);return this.scatter(t,e,n,o,a,i,r,s,l,!0)}fill(t,e,n){n=n||r.inferDtype(e);const i=r.getArrayFromDType(n,r.sizeFromShape(t));return i.fill(e),Qv().makeTensor(i,t,n,this)}onesLike(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)}zerosLike(t){const e=r.getArrayFromDType(t.dtype,r.sizeFromShape(t.shape));return this.makeOutput(e,t.shape,t.dtype)}linspace(t,e,n){return v.linspaceImpl(t,e,n)}scatter(t,e,n,r,i,a,s,o,l,u){const c=[r/i,i],h=this.readSync(t.dataId),d=this.readSync(e.dataId);if(0===r)return Fy([],n,e.dtype);const p=new Ug(c,e.dtype);p.values.fill(this.readSync(l.dataId)[0]);for(let f=0;f<a;f++){const t=[];let a=0;for(let e=0;e<s;e++){const n=h[f*s+e];t.push(n),a+=n*o[e]}if(a<0||a>=r/i)throw new Error(`Invalid indices: ${t} does not index into ${n}`);for(let n=0;n<i;n++)u?p.values[a*i+n]+=d[f*i+n]:p.values[a*i+n]=0===e.rank?d[0]:d[f*i+n]}return p.toTensor().reshape(n)}}function TR(t,e){return{kernelName:t,backendName:"cpu",kernelFunc:({inputs:n,backend:r})=>{const{a:i,b:a}=n,s=r;bR([i,a],t);const o=s.data.get(i.dataId).values,l=s.data.get(a.dataId).values,[u,c]=e(i.shape,a.shape,o,l,i.dtype);return{dataId:s.write(u,c,i.dtype),shape:c,dtype:i.dtype}}}}function RR(t){return(e,n,i,a,s)=>{const o=v.assertAndGetBroadcastShape(e,n),l=o.length,u=r.computeStrides(o),c=r.sizeFromShape(o),h=r.getTypedArrayFromDType(s,c),d=e.length,p=n.length,f=r.computeStrides(e),m=r.computeStrides(n),g=v.getBroadcastDims(e,o),y=v.getBroadcastDims(n,o);if(g.length+y.length===0)for(let r=0;r<h.length;++r)h[r]=t(i[r%i.length],a[r%a.length]);else for(let v=0;v<h.length;++v){const e=r.indexToLoc(v,l,u),n=e.slice(-d);g.forEach(t=>n[t]=0);const s=r.locToIndex(n,d,f),o=e.slice(-p);y.forEach(t=>o[t]=0);const c=r.locToIndex(o,p,m);h[v]=t(i[s],a[c])}return[h,o]}}const MR=TR("Div",RR((t,e)=>t/e)),NR={kernelName:"Max",backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{reductionIndices:a}=e,s=n;let o=i.shape;const l=o.length;let u=r.parseAxisParam(a,o);const c=v.getAxesPermutation(u,l);let h=s.data.get(i.dataId).values;if(null!=c){const t=new Array(l);for(let e=0;e<t.length;e++)t[e]=o[c[e]];h=_R(h,o,i.dtype,c,t),u=v.getInnerMostAxes(u.length,l),o=t}bR(i,"max"),v.assertAxesAreInnerMostDims("max",u,l);const[d,p]=v.computeOutAndReduceShapes(o,u),f=vR(h,r.sizeFromShape(p),d,i.dtype);return{dataId:s.write(f,d,i.dtype),shape:d,dtype:i.dtype}}},OR={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{filterSize:a,strides:s,pad:o,includeBatchInIndex:l}=e,u=n;bR(i,"MaxPoolWithArgmax");const c=u.data.get(i.dataId).values,h=v.computePool2DInfo(i.shape,a,s,[1,1],o),[d,p]=function(t,e,n,i,a){const s=xR(t,0,n,r.computeStrides(e),a,"max"),o=wR(t,e,n,a,!0,i);return[s.values,o.values]}(c,i.shape,i.dtype,l,h),f=u.write(d,h.outShape,i.dtype),m=u.write(p,h.outShape,i.dtype);return[{dataId:f,shape:h.outShape,dtype:i.dtype},{dataId:m,shape:h.outShape,dtype:"int32"}]}},PR=_.nonMaxSuppressionV5,FR=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{boxes:r,scores:i}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:o,softNmsSigma:l}=n,u=e;bR(r,"NonMaxSuppressionWithScore");const c=u.data.get(r.dataId).values,h=u.data.get(i.dataId).values,d=a,p=s,f=o,m=l,{selectedIndices:g,selectedScores:y}=PR(c,h,d,p,f,m);return[g,y]}},{kernelName:"Square",backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;bR(n,"square");const i=r.data.get(n.dataId).values,a=new Float32Array(i.length);for(let s=0;s<i.length;++s){const t=i[s];a[s]=t*t}return{dataId:r.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},TR("SquaredDifference",RR((t,e)=>{const n=t-e;return n*n})),MR,{kernelName:"Transpose",backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{perm:i}=e,a=n;bR(r,"transpose");const s=new Array(r.shape.length);for(let l=0;l<s.length;l++)s[l]=r.shape[i[l]];const o=_R(a.data.get(r.dataId).values,r.shape,r.dtype,i,s);return{dataId:a.write(o,s,r.dtype),shape:s,dtype:r.dtype}}},OR,NR];for(const l9 of FR)qm(l9);i_("cpu",()=>new AR,1);const LR={},zR={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $R(t){t in LR||(LR[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete LR[t]},!1),1===t?e.getContext("webgl",zR)||e.getContext("experimental-webgl",zR):e.getContext("webgl2",zR)}(t));const e=LR[t];return e.isContextLost()?(delete LR[t],$R(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),LR[t])}var BR,WR,qR;function VR(t,e){return[e,t]}function UR(t){const e=r.sizeFromShape(t),n=Math.ceil(e/4);return r.sizeToSquarishShape(n)}function jR(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function HR(t,e){const n=t;let r,i,a,s,o,l,u,c,h,d;return 2===Mm().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,a=n.RGBA16F,s=n.RGBA32F,o=n.RED,u=4,c=1,h=n.HALF_FLOAT,d=n.FLOAT):(r=t.RGBA,i=t.RGBA,a=t.RGBA,s=n.RGBA,o=t.RGBA,u=4,c=4,h=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT),l=t.RGBA,{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:s,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:h,textureTypeFloat:d}}function GR(t,e,n){const r=n();return e&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}(t,e))}(t),r}function JR(t){return!!(Mm().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function XR(t,e,n){return nM(t,e,()=>t.getExtension(n),'Extension "'+n+'" not supported on this browser.')}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(BR||(BR={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(WR||(WR={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(qR||(qR={}));const KR=/ERROR: [0-9]+:([0-9]+):/g;function ZR(t,e,n){if(GR(t,e,()=>t.validateProgram(n)),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function YR(t,e,n,r,i,a,s,o){const l=t.getAttribLocation(n,r);return-1!==l&&(GR(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,i)),GR(t,e,()=>t.vertexAttribPointer(l,a,t.FLOAT,!1,s,o)),GR(t,e,()=>t.enableVertexAttribArray(l)),!0)}function QR(t,e,n,r){GR(t,e,()=>t.bindFramebuffer(t.FRAMEBUFFER,r)),GR(t,e,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0))}function tM(t,e,n){GR(t,e,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),GR(t,e,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function eM(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}(t,e))}function nM(t,e,n,r){const i=GR(t,e,()=>n());if(null==i)throw new Error(r);return i}function rM(t,e=2){return r.sizeFromShape(t.slice(0,t.length-e))}function iM(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function aM(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[rM(t),...iM(t)]),e}function sM(t){return t%2==0}function oM(t,e){if(t=t.slice(-2),e=e.slice(-2),r.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(sM(n)&&sM(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&sM(t[0])&&sM(e[0])}let lM,uM;function cM(t,e){return null!=t.getExtension(e)}function hM(t){try{if(null!=$R(t))return!0}catch(e){return!1}return!1}function dM(t){const e=HR(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}const pM=Mm();pM.registerFlag("HAS_WEBGL",()=>pM.getNumber("WEBGL_VERSION")>0),pM.registerFlag("WEBGL_VERSION",()=>hM(2)?2:hM(1)?1:0),pM.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===pM.get("WEBGL_VERSION")),pM.registerFlag("WEBGL_CPU_FORWARD",()=>!0),pM.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),pM.registerFlag("WEBGL_PACK",()=>pM.getBool("HAS_WEBGL")),pM.registerFlag("WEBGL_PACK_NORMALIZATION",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_PACK_CLIP",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1),pM.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_PACK_REDUCE",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_LAZILY_UNPACK",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_CONV_IM2COL",()=>pM.getBool("WEBGL_PACK")),pM.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(t){if(null==lM){const e=$R(t);lM=e.getParameter(e.MAX_TEXTURE_SIZE)}return lM}(pM.getNumber("WEBGL_VERSION"))),pM.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(t){if(null==uM){const e=$R(t);uM=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,uM)}(pM.getNumber("WEBGL_VERSION"))),pM.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=pM.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=$R(t);return e=cM(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:cM(n,"EXT_disjoint_timer_query")?1:0,e}(t)}),pM.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>pM.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!a.isMobile()),pM.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(t){if(0===t)return!1;const e=$R(t);if(1===t){if(!cM(e,"OES_texture_float"))return!1}else if(!cM(e,"EXT_color_buffer_float"))return!1;return dM(e)}(pM.getNumber("WEBGL_VERSION"))),pM.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!pM.getBool("WEBGL_FORCE_F16_TEXTURES")&&pM.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),pM.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>function(t){if(0===t)return!1;const e=$R(t);if(1!==t){if(cM(e,"EXT_color_buffer_float"))return dM(e);const t="EXT_color_buffer_half_float";if(cM(e,t)){const n=e.getExtension(t);return function(t,e){const n=HR(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}(e,n)}return!1}return!!cM(e,"OES_texture_float")&&!!cM(e,"WEBGL_color_buffer_float")&&dM(e)}(pM.getNumber("WEBGL_VERSION"))),pM.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(t=pM.getNumber("WEBGL_VERSION"))&&null!=$R(t).fenceSync;var t}),pM.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>pM.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);class fM{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((t,e)=>`T${e}`);const n=[];this.variableNames.forEach(t=>{n.push(`float v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>`v${t}`).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}class mM{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((t,e)=>`T${e}`);const n=[];this.variableNames.forEach(t=>{n.push(`vec4 v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>`v${t}`).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}class gM{constructor(t,e,n){this.variableNames=["A"];const r=t.windowSize,i=t.batchSize,a=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${"max"===e?">":"<"} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}function yM(t,e){return["x","y","z","w","u","v"].slice(0,e).map(e=>`${t}.${e}`)}function vM(t,e){return 1===e?[t]:yM(t,e)}function _M(){let t,e,n,r,i,a,s,o,l,u;return 2===Mm().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",a="outputColor",s="out vec4 outputColor;",o="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",s="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}function bM(t,e,n="index"){const i=r.computeStrides(e);return i.map((e,r)=>`${`int ${t[r]} = ${n} / ${e}`}; ${r===i.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${e}`:`index -= ${t[r]} * ${e}`};`).join("")}function xM(t){const e=r.computeStrides(t).map(t=>t.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;\n  }\n`}const wM="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:SM}=v;const CM="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",DM="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",IM="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",kM="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function EM(t){return`offset${t}`}function AM(t){const e=t.name,n=r.sizeFromShape(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${e}[i];\n      }\n    }\n  `}function TM(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function RM(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function MM(t,e){return e.map(e=>t[e]).join(", ")}class NM{constructor(t,e,n,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,r.assert(t.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);const a=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),a>1&&this.outputShape.push(a),i||this.variableNames.push("bestIndicesA");const s=this.outputShape,o=s.length,l=TM(o),u=vM("coords",o);let c,h;if(1===a){h=o+1;const t=TM(h);c=`\n        ${t} sourceLocR = ${t}(${u.join()}, 0);\n        ++${u[o-1]};\n        ${t} sourceLocG = ${t}(${u.join()}, 0);\n        ++${u[o-2]};\n        ${t} sourceLocA = ${t}(${u.join()}, 0);\n        --${u[o-1]};\n        ${t} sourceLocB = ${t}(${u.join()}, 0);\n        --${u[o-2]};`}else h=o,c=`\n        ${l} sourceLocR = coords;\n        ++${u[o-1]};\n        ${l} sourceLocG = coords;\n        ++${u[o-2]};\n        ${l} sourceLocA = coords;\n        --${u[o-1]};\n        ${l} sourceLocB = coords;\n        --${u[o-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],f=d.map(t=>"int "+t),m=vM("sourceLocR",h-1).concat("inIdx.r"),g=vM("sourceLocG",h-1).concat("inIdx.g"),y=vM("sourceLocB",h-1).concat("inIdx.b"),v=vM("sourceLocA",h-1).concat("inIdx.a"),_="max"===n?"greaterThan":"lessThan",b=i?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,x=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${g.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,w=i?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${d.join()}),\n                                          vec2(${d.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${d.join()}),\n                               vec2(${d.slice(-2).join()}));\n      }\n      ${w}\n      void main() {\n        ${l} coords = getOutputCoords();\n        bool hasNextCol = ${u[o-1]} < ${s[o-1]-1};\n        bool hasNextRow = ${u[o-2]} < ${s[o-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${x};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${b}\n          vec4 candidate = ${x};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${_}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}class OM{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e};\n            wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${n};\n            wC+= ${t.dilationWidth}) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class PM{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterDepth*t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${e};\n            wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${n};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${r};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class FM{constructor(t,e,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],v.assertAndGetBroadcastShape(t,e),v.assertAndGetBroadcastShape(t,n);let s="0.0";null!=r&&(v.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";null!=i&&(v.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${s};\n        float scale = ${o};\n        float inv = scale * inversesqrt(variance + float(${a}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class LM{constructor(t,e,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],v.assertAndGetBroadcastShape(t,e),v.assertAndGetBroadcastShape(t,n);let s="vec4(0.0)";null!=r&&(v.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=i&&(v.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${s};\n        vec4 scale = ${o};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${a}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}class zM{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=v.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const $M="return a + b;",BM="return a - b;",WM="return a * b;",qM="return (a < 0.) ? b * a : a;";class VM{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=v.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const UM="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";class jM{constructor(t,e,n,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=v.assertAndGetBroadcastShape(e,n);const a=this.outputShape.length;let s="";if(i)if(0===a||1===r.sizeFromShape(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(s=`\n          ${TM(a)} coords = getOutputCoords();\n        `,1===a)s+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const t=vM("coords",a);s+=`\n            bool nextRowOutOfBounds =\n              (${t[a-2]} + 1) >= ${this.outputShape[a-2]};\n            bool nextColOutOfBounds =\n              (${t[a-1]} + 1) >= ${this.outputShape[a-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${s}\n\n        setOutput(result);\n      }\n    `}}class HM{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}getCustomSetupFunc(t,e){return(n,r)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class GM{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}getCustomSetupFunc(t,e){return(n,r)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class JM{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}class XM{constructor(t){this.outputShape=[],this.outputShape=v.computeOutShape(t,1),this.variableNames=t.map((t,e)=>`T${e}`);const e=new Array(t.length-1);e[0]=t[0][1];for(let r=1;r<e.length;r++)e[r]=e[r-1]+t[r][1];const n=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let r=1;r<e.length;r++)n.push(`else if (yC < ${e[r]}) `+`setOutput(getT${r}(yR, yC-${e[r-1]}));`);n.push(`else setOutput(getT${e.length}(yR, yC-${e[e.length-1]}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}class KM{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=v.computeOutShape(t,e);const n=this.outputShape,r=n.length,i=TM(r),a=vM("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((t,e)=>`T${e}`);const o=new Array(t.length-1);o[0]=t[0][e];for(let p=1;p<o.length;p++)o[p]=o[p-1]+t[p][e];const l=s[e],u=s.slice(-2),c=s.join();let h=`if (${l} < ${o[0]}) {\n        return getChannel(\n            getT0(${c}), vec2(${u.join()}));\n        }`;for(let p=1;p<o.length;p++){const t=o[p-1];h+=`\n        if (${l} < ${o[p]}  && ${l} >= ${o[p-1]}) {\n          return getChannel(\n            getT${p}(${ZM(s,l,t)}),\n            vec2(${ZM(u,l,t)}));\n        }`}const d=o[o.length-1];h+=`\n        return getChannel(\n          getT${o.length}(${ZM(s,l,d)}),\n          vec2(${ZM(u,l,d)}));`,this.userCode=`\n      float getValue(${s.map(t=>"int "+t)}) {\n        ${h}\n      }\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${a}), 0., 0., 0.);\n\n        ${a[r-1]} = ${a[r-1]} + 1;\n        if (${a[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${a});\n        }\n\n        ${a[r-2]} = ${a[r-2]} + 1;\n        if (${a[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${a});\n        }\n\n        ${a[r-1]} = ${a[r-1]} - 1;\n        if (${a[r-2]} < ${n[r-2]} &&\n            ${a[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${a});\n        }\n        setOutput(result);\n      }\n    `}}function ZM(t,e,n){const r=t.indexOf(e);return t.map((t,e)=>e===r?`${t} - ${n}`:t).join()}class YM{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              if (${"channelsLast"===t.dataFormat}) {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class QM{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r="channelsLast"===t.dataFormat;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${r?3:1}];\n\n        ivec2 dyCorner = ivec2(coords[${r?1:2}], coords[${r?2:3}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${r}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class tN{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${t.strideDepth} - ${t.padInfo.front};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class eN{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${t.strideDepth}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class nN{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${t.outChannels/t.inChannels} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class rN{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${r}; dm++) {\n              int d2 = d1 * ${r} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class iN{constructor(t,e=!1,n=null,r=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.padInfo.top,a=t.padInfo.left,s=t.strideHeight,o=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,c=t.filterHeight,h=t.filterWidth,d=4*Math.floor(t.inChannels/4),p=t.inChannels%4,f="channelsLast"===t.dataFormat,m=f?1:2,g=f?2:3,y=f?3:1;let v="",_="";n&&(v=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,_="result = activation(result);");const b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${s}, ${o});\n      const ivec2 pads = ivec2(${i}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${m}], coords[${g}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${c}; wR++) {\n          int xR = xRCorner + wR * ${l};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${h}; wC++) {\n            int xC = xCCorner + wC * ${u};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${d}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${f}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===p}) {\n\n              if (${f}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${d}) *\n                    getW(wR, wC, ${d}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${d}, xR, xC) *\n                    getW(wR, wC, ${d}, d2);\n              }\n\n            } else if (${2===p}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${d}, d2),\n                getW(wR, wC, ${d} + 1, d2)\n              );\n\n              if (${f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${d}),\n                  getX(batch, xR, xC, ${d} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${d}, xR, xC),\n                  getX(batch, ${d} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===p}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${d}, d2),\n                getW(wR, wC, ${d} + 1, d2),\n                getW(wR, wC, ${d} + 2, d2)\n              );\n\n              if (${f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${d}),\n                  getX(batch, xR, xC, ${d} + 1),\n                  getX(batch, xR, xC, ${d} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${d}, xR, xC),\n                  getX(batch, ${d} + 1, xR, xC),\n                  getX(batch, ${d} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${b}\n        ${_}\n        setOutput(result);\n      }\n    `}}class aN{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,a=t.strideHeight,s=t.strideWidth,o=t.dilationDepth,l=t.dilationHeight,u=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${i}, ${a}, ${s});\n      const ivec3 pads = ivec3(${e}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${o};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h}; wR++) {\n            int xR = xRCorner + wR * ${l};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class sN{constructor(t,e=!1,n=null,r=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.inHeight,a=t.inWidth,s=t.padInfo.top,o=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,f=t.outChannels/t.inChannels;let m="",g="";n&&(m=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,g="result = activation(result);");const y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${m}\n\n      const ivec2 strides = ivec2(${l}, ${u});\n      const ivec2 pads = ivec2(${s}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${f};\n        int q = d2 - d1 * ${f};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${c};\n\n          if (xR < 0 || xR >= ${i}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${p}; wC++) {\n            int xC = xCCorner + wC * ${h};\n\n            if (xC < 0 || xC >= ${a}) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${y}\n        ${g}\n        setOutput(result);\n      }\n    `}}class oN{constructor(t,e=!1,n=null,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const a=t.inHeight,s=t.inWidth,o=t.padInfo.top,l=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,m=f;let g="int xR; int xC; int xCOffset;";for(let r=0;r<p;r++)for(let t=0;t<f;t++)g+=`\n          vec4 xTexelR${r}C${2*t} = vec4(0.);\n          vec4 wR${r}C${t} = vec4(0.);\n          vec4 xR${r}C${t} = vec4(0.);`;for(let b=0;b<p;b++)for(let t=0;t<m;t++){const e=2*t;if(g+=`\n          xR = xRCorner + ${b*h};\n          xC = xCCorner + ${e*d};\n        `,1===c){if(e<f&&(g+=l%2==1?`\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ${a} && xCOffset >= 0 && xCOffset < ${s}) {\n                  xTexelR${b}C${e} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${s}) {\n                    xTexelR${b}C${e}.zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR${b}C${e} = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ${a} && xCOffset >= 0 && xCOffset < ${s}) {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${s}) {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR${b}C${e} = vec4(previous.zw, xTexelR${b}C${e}.xy);\n                } else {\n                  xR${b}C${e} = vec4(0, 0, xTexelR${b}C${e}.xy);\n                }\n              `:`\n                if(xR >= 0 && xR < ${a} && xC >= 0 && xC < ${s}) {\n                  xTexelR${b}C${e} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${b}C${e} = vec4(0.);\n                }\n\n                xR${b}C${e} = xTexelR${b}C${e};\n              `,e+1<f)){const t=l%2==0?r.nearestLargerEven(d):d;d%2==0&&l%2==1||d%2!=0&&l%2!=1?(g+=`\n                  xCOffset = xC + ${l%2} + ${t};\n\n                  if(xR >= 0 && xR < ${a} &&\n                    xCOffset >= 0 && xCOffset < ${s}) {\n                    xTexelR${b}C${e+2} = getX(batch, xR, xCOffset, d1);\n                  }\n                `,d>1&&(g+=`\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ${a} &&\n                      xCOffset >= 0 && xCOffset < ${s}) {\n                      xTexelR${b}C${e} = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR${b}C${e} = vec4(0.);\n                    }\n                  `),g+=`\n                  xR${b}C${e+1} = vec4(\n                    xTexelR${b}C${e}.zw, xTexelR${b}C${e+2}.xy);\n                `):g+=`\n                  xCOffset = xC + ${t};\n\n                  if(xR >= 0 && xR < ${a} &&\n                    xCOffset >= 0 && xCOffset < ${s}) {\n                    xTexelR${b}C${e+2} = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR${b}C${e+1} = xTexelR${b}C${e+2};\n                `}}else e<f&&(g+=`\n              if(xR >= 0 && xR < ${a}) {\n            `,l%2==1?(g+=`\n                xCOffset = xC + 1 - ${c};\n                if(xCOffset >= 0 && xCOffset < ${s}) {\n                  xTexelR${b}C${e} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${b}C${e} = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ${s}) {\n                  xTexelR${b}C${e+2} = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR${b}C${e+2} = vec4(0.);\n                }\n\n                xR${b}C${e} = vec4(\n                  xTexelR${b}C${e}.zw, xTexelR${b}C${e+2}.zw);\n              `,e+1<f&&(g+=`\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ${c};\n                  if(xCOffset >= 0 && xCOffset < ${s}) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR${b}C${e+1} = vec4(xTexelR${b}C${e+2}.xy, final.xy);\n                `)):(g+=`\n                if(xC >= 0 && xC < ${s}) {\n                  xTexelR${b}C${e} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${b}C${e} = vec4(0.);\n                }\n\n                xCOffset = xC + ${c};\n                if(xCOffset >= 0 && xCOffset < ${s}) {\n                  xTexelR${b}C${e+2} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${b}C${e+2} = vec4(0.);\n                }\n\n                xR${b}C${e} = vec4(\n                  xTexelR${b}C${e}.xy, xTexelR${b}C${e+2}.xy);\n              `,e+1<f&&(g+=`\n                  xR${b}C${e+1} = vec4(\n                    xTexelR${b}C${e}.zw, xTexelR${b}C${e+2}.zw);\n                `)),g+="}");e<f&&(g+=`\n            vec4 wTexelR${b}C${e} = getW(${b}, ${e}, d1, q);\n            wR${b}C${e} = vec4(wTexelR${b}C${e}.xz, wTexelR${b}C${e}.xz);\n          `,e+1<f&&(g+=`\n              vec4 wTexelR${b}C${e+1} = getW(${b}, ${e+1}, d1, q);\n              wR${b}C${e+1} =\n                vec4(wTexelR${b}C${e+1}.xz, wTexelR${b}C${e+1}.xz);`))}for(let r=0;r<p;r++)for(let t=0;t<f;t++)g+=`dotProd += xR${r}C${t} * wR${r}C${t};`;let y="",v="";n&&(y=i?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,v="result = activation(result);");const _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${y}\n\n      const ivec2 strides = ivec2(${u}, ${c});\n      const ivec2 pads = ivec2(${o}, ${l});\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ${g}\n\n        vec4 result = dotProd;\n        ${_}\n        ${v}\n        setOutput(result);\n      }\n    `}}class lN{constructor(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,s,o,l]=t,[u]=e,[c,h]=n;this.outputShape=[u,c,h,l];const d="bilinear"===r?1:0,[p,f]=[`${s-1}.0`,`${o-1}.0`],[m,g,y]=c>1?[`${(s-1)/(c-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,_,b]=h>1?[`${(o-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${v});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${a}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${_};\n\n        float in_y = ${y};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${i}));\n          return;\n        }\n        float in_x = ${b};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${i}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${d} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}class uN{constructor(t,e,n){this.variableNames=["x"],this.outputShape=t;const r=t.length,i=t[t.length-1],a=n?"<":">";this.userCode=`\n      int getIndex(int i) {\n        ${n?`return ${i} -i - 1;`:"return i;"}\n      }\n\n      void main() {\n        ${TM(r)} coords = getOutputCoords();\n        int end = ${cN(r,"coords")};\n        float val = 0.0;\n        for (int i = ${i} - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx ${a} end) {\n            continue;\n          }\n          if (idx == end && ${e}) {\n            continue;\n          }\n          ${cN(r,"coords")} = idx;\n          val += getX(${function(t,e){if(1===t)return`${e}`;if(2===t)return`${e}.x, ${e}.y`;if(3===t)return`${e}.x, ${e}.y, ${e}.z`;if(4===t)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative sum for rank ${t} is not yet supported`)}(r,"coords")});\n        }\n        setOutput(val);\n      }\n    `}}function cN(t,e){if(1===t)return`${e}`;if(2===t)return`${e}.y`;if(3===t)return`${e}.z`;if(4===t)return`${e}.w`;throw Error(`Cumulative sum for rank ${t} is not yet supported`)}class hN{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=BR.DENSE;const e=UR(t),n=_M();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${bM(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${n.output} = result;\n      }\n    `}}class dN{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=BR.DENSE;const e=UR(t),n=_M();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${bM(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${n.output} = result;\n      }\n    `}}class pN{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}class fN{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}class mN{constructor(t){this.variableNames=["A"],this.outTexUsage=WR.DOWNLOAD;const e=_M();this.outputShape=t,this.userCode=`\n      ${wM}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}class gN{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=WR.DOWNLOAD;const e=_M();this.outputShape=t,this.userCode=`\n      ${wM}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}class yN{constructor(t,e,n=!1){this.variableNames=["A"];const r=_M(),[i,a]=e;this.outputShape=t;let s="result";n&&(s="floor(result * 255. + 0.5)"),this.userCode=`\n      ${xM(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / ${a};\n        int c = imod(flatIndex, ${a});\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(${a}.0, ${i}.0);\n        vec4 values = ${r.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${r.output} = vec4(${s}, 0., 0., 0.);\n      }\n    `}}class vN{constructor(t,e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const r=_M(),[i,a]=e;this.outputShape=t;let s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let l=0;l<=1;l++)for(let e=0;e<=1;e++){const n=2*l+e;s+=`\n          localCoords = coords;\n          if(localCoords[2] + ${e} < ${t[2]}) {\n            localCoords[2] += ${e};\n            if(localCoords[1] + ${l} < ${t[1]}) {\n              localCoords[1] += ${l};\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ${a};\n              c = imod(flatIndex, ${a});\n              uv = (vec2(c, r) + halfCR) / vec2(${a}.0, ${i}.0);\n              values = ${r.texture2D}(A, uv);\n\n              if(offset == 0) {\n                result[${n}] = values[0];\n              } else if(offset == 1) {\n                result[${n}] = values[1];\n              } else if(offset == 2) {\n                result[${n}] = values[2];\n              } else {\n                result[${n}] = values[3];\n              }\n            }\n          }\n        `}this.userCode=`\n      ${xM(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ${s}\n\n        ${r.output} = ${o};\n      }\n    `}}class _N{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`;this.userCode=`\n      const float exponentMultiplier = ${i};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${t}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${n?`${r}.0`:"1.0"};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}class bN{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}getCustomSetupFunc(t){return(e,n)=>{null==this.valueLoc&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}}class xN{constructor(t,e,n){this.variableNames=["A","indices"];const r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;const i=TM(this.rank),a=function(t,e){const n=t.length;if(n>4)throw Error(`Gather for rank ${n} is not yet supported`);if(1===n)return"int(getIndices(resRC))";const r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[];for(let a=0;a<t.length;a++)i.push(a===e?`int(getIndices(${r[a]}))`:`${r[a]}`);return i.join()}(t,n);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        setOutput(getA(${a}));\n      }\n    `}}class wN{constructor(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;const r=TM(e.length),i=TM(n.length);this.userCode=`\n        ${r} strides = ${r}(${this.strides});\n         void main() {\n          ${i} coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ${this.sliceDim}; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ${this.sliceDim>1?"strides[j]":"strides"};\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      `}}function SN(t,e,n,r,i,a,s){!function(t,e){const n=Mm().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0)throw new Error("Requested texture size "+`[${t}x${e}]`+" is invalid.");if(t>n||e>n)throw new Error("Requested texture size "+`[${t}x${e}]`+" greater than WebGL maximum on this browser / GPU "+`[${n}x${n}]`+".")}(n,r);const o=function(t,e){return nM(t,e,()=>t.createTexture(),"Unable to create WebGLTexture.")}(t,e),l=t.TEXTURE_2D;return GR(t,e,()=>t.bindTexture(l,o)),GR(t,e,()=>t.texParameteri(l,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),GR(t,e,()=>t.texParameteri(l,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),GR(t,e,()=>t.texParameteri(l,t.TEXTURE_MIN_FILTER,t.NEAREST)),GR(t,e,()=>t.texParameteri(l,t.TEXTURE_MAG_FILTER,t.NEAREST)),GR(t,e,()=>t.texImage2D(l,0,i,n,r,0,a,s,null)),GR(t,e,()=>t.bindTexture(t.TEXTURE_2D,null)),o}class CN{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=Mm().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(t,e){LR[t]=e}(e,t)):this.gl=$R(e);let n="WEBGL_color_buffer_float";if(1===Mm().getNumber("WEBGL_VERSION")){const t="OES_texture_half_float";if(this.textureFloatExtension=XR(this.gl,this.debug,"OES_texture_float"),cM(this.gl,t))this.textureHalfFloatExtension=XR(this.gl,this.debug,t);else if(Mm().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),cM(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=XR(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Mm().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",cM(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!cM(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=function(t,e){return function(t,e,n){const r=nM(t,e,()=>t.createBuffer(),"Unable to create WebGLBuffer");return GR(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),GR(t,e,()=>t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)),r}(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl,this.debug),this.indexBuffer=function(t,e){return function(t,e,n){const r=nM(t,e,()=>t.createBuffer(),"Unable to create WebGLBuffer");return GR(t,e,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)),GR(t,e,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)),r}(t,e,new Uint16Array([0,1,2,2,1,3]))}(this.gl,this.debug),this.framebuffer=function(t,e){return nM(t,e,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl,this.debug),this.textureConfig=HR(this.gl,this.textureHalfFloatExtension)}get debug(){return Mm().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;GR(t,this.debug,()=>t.finish()),GR(t,this.debug,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),GR(t,this.debug,()=>t.deleteFramebuffer(this.framebuffer)),GR(t,this.debug,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),GR(t,this.debug,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),GR(t,this.debug,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){const[a,s]=VR(n,r);return SN(t,e,a,s,i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}(this.gl,this.debug,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){const[a,s]=VR(n,r);return SN(t,e,a,s,i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}(this.gl,this.debug,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){const[a,s]=VR(n,r);return SN(t,e,a,s,t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}(this.gl,this.debug,t,e)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n,r){GR(t,e,()=>t.bindTexture(t.TEXTURE_2D,n)),r.data instanceof Uint8Array?GR(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)):GR(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),GR(t,e,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,this.debug,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),function(t,e,n,r,i,a,s){let o,l,u;GR(t,e,()=>t.bindTexture(t.TEXTURE_2D,n)),a instanceof Uint8Array?(o=new Uint8Array(r*i*4),l=t.UNSIGNED_BYTE,u=t.RGBA):(o=new Float32Array(r*i*4),l=t.FLOAT,u=s.internalFormatPackedFloat),o.set(a),GR(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,u,r,i,0,t.RGBA,l,o)),GR(t,e,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,this.debug,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){const[a,s]=jR(n,r);return SN(t,e,a,s,i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}(this.gl,this.debug,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){const[a,s]=jR(n,r);return SN(t,e,a,s,i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}(this.gl,this.debug,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(tM(this.gl,this.debug,this.framebuffer),this.outputTexture=null),GR(this.gl,this.debug,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n,r,i){const[a,s]=VR(n,r),o=new Uint8Array(n*r*4);return GR(t,e,()=>t.readPixels(0,0,a,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}(this.gl,this.debug,e,n,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,n,r,i,a){return function(t,e,n,r,i,a,s,o){const l=t,u=new Float32Array(function(t,e){const[n,r]=jR(t,e);return n*r*4}(a,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}(this.gl,t,0,0,0,i,a)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=function(t,e,n,r,i){const a=t.createBuffer();GR(t,e,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,a));const s=16*n*r;return GR(t,e,()=>t.bufferData(t.PIXEL_PACK_BUFFER,s,t.STREAM_READ)),GR(t,e,()=>t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)),GR(t,e,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),a}(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(Mm().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(i,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=i}else Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n,r){const i=new Float32Array(n*r*4);return GR(t,e,()=>t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)),i}(this.gl,this.debug,e,n))}createProgram(t){this.throwIfDisposed();const e=this.gl,n=function(t,e,n){const i=nM(t,e,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(GR(t,e,()=>t.shaderSource(i,n)),GR(t,e,()=>t.compileShader(i)),!1===t.getShaderParameter(i,t.COMPILE_STATUS))throw function(t,e){const n=KR.exec(e);if(null==n)return console.log(`Couldn't parse line number in error: ${e}`),void console.log(t);const i=+n[1],a=t.split("\n"),s=a.length.toString().length+2,o=a.map((t,e)=>r.rightPad((e+1).toString(),s)+t);let l=0;for(let r=0;r<o.length;r++)l=Math.max(o[r].length,l);const u=o.slice(0,i-1),c=o.slice(i-1,i),h=o.slice(i);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log(`%c ${r.rightPad(c[0],l)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(i)),new Error("Failed to compile fragment shader.");return i}(e,this.debug,t),i=function(t,e){const n=_M();return function(t,e,n){const r=nM(t,e,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(GR(t,e,()=>t.shaderSource(r,n)),GR(t,e,()=>t.compileShader(r)),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}(t,e,`${n.version}\n    precision highp float;\n    ${n.attribute} vec3 clipSpacePos;\n    ${n.attribute} vec2 uv;\n    ${n.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}(e,this.debug),a=function(t,e){return nM(t,e,()=>t.createProgram(),"Unable to create WebGLProgram.")}(e,this.debug);return GR(e,this.debug,()=>e.attachShader(a,i)),GR(e,this.debug,()=>e.attachShader(a,n)),function(t,e,n){if(GR(t,e,()=>t.linkProgram(n)),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}(e,this.debug,a),this.debug&&ZR(e,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(t,e,n,r){return GR(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),YR(t,e,n,"clipSpacePos",r,3,20,0)&&YR(t,e,n,"uv",r,2,20,12)}(e,this.debug,this.program,this.vertexBuffer)),a}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&GR(this.gl,this.debug,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&ZR(this.gl,this.debug,this.program),GR(this.gl,this.debug,()=>this.gl.useProgram(t))}getUniformLocation(t,e,n=!0){return this.throwIfDisposed(),n?function(t,e,n,r){return nM(t,e,()=>t.getUniformLocation(n,r),'uniform "'+r+'" not present in program.')}(this.gl,this.debug,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),GR(this.gl,this.debug,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),function(t,e,n,r,i,a){GR(t,e,()=>function(t,e,n,r){(function(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error(`textureUnit must be in ${`[gl.TEXTURE0, gl.TEXTURE${n}]`}.`)})(t,r),GR(t,e,()=>t.activeTexture(t.TEXTURE0+r)),GR(t,e,()=>t.bindTexture(t.TEXTURE_2D,n))}(t,e,r,a)),GR(t,e,()=>t.uniform1i(i,a))}(this.gl,this.debug,0,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,i]=jR(e,n);this.setOutputMatrixTextureDriver(t,r,i)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&ZR(this.gl,this.debug,this.program),eM(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),GR(t,this.debug,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),GR(this.gl,this.debug,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=XR(this.gl,this.debug,2===Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await r.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map(t=>t.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||r.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),QR(this.gl,this.debug,t,this.framebuffer),this.debug&&eM(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(QR(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&eM(this.gl)):tM(this.gl,this.debug,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;QR(r,this.debug,t,this.framebuffer),this.debug&&eM(r),this.outputTexture=t,GR(r,this.debug,()=>r.viewport(0,0,e,n)),GR(r,this.debug,()=>r.scissor(0,0,e,n))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),GR(this.gl,this.debug,()=>this.gl.scissor(t,e,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function DN(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but `+`was executed with ${e.length} inputs`);t.forEach((t,n)=>{const i=t.logicalShape,a=e[n],s=a.shape;if(!r.arraysEqual(i,s))throw Error("Binary was compiled with different shapes than "+`the current args. Shapes ${i} and ${s} must match`);if(t.isUniform&&a.isUniform)return;const o=t.texShape,l=a.isUniform?null:a.texData.texShape;if(!r.arraysEqual(o,l))throw Error("Binary was compiled with different texture shapes than the"+` current args. Shape ${o} and ${l} must match`)})}class IN{constructor(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:r,inChannels:i,strideWidth:a,strideHeight:s,padInfo:o,outWidth:l,dilationWidth:u,dilationHeight:c,dataFormat:h}=n,{left:d,top:p}=o,f=i*r,m=_M(),g="channelsLast"===h,y=g?0:1,v=g?1:2;let _="";for(let b=0;b<=1;b++)for(let n=0;n<=1;n++)_+=`\n          blockIndex = rc.y + ${n};\n          pos = rc.x + ${b};\n\n          if(blockIndex < ${t[1]} && pos < ${t[0]}) {\n            offsetY = int(blockIndex / (${l})) * ${s} - ${p};\n            d0 = offsetY + ${c} * (pos / ${f});\n\n            if(d0 < ${e[y]} && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ${l}.) * ${a}. - ${d}.);\n              d1 = offsetX + ${u} * (int(mod(float(pos), ${f}.) / ${i}.));\n\n              if(d1 < ${e[v]} && d1 >= 0) {\n\n                ch = int(mod(float(pos), ${i}.));\n\n                if (${g}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*b+n}] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*b+n}] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${_}\n\n        ${m.output} = result;\n      }\n    `}}class kN{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];const a=e,s=t[3]-1;let o;this.outputShape=t;const l=`float(${n}) + float(${r}) * sum`;o=.5===i?`inversesqrt(${l})`:1===i?`1.0/(${l})`:`exp(log(${l}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${a}; j <= ${a}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${s}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${o};\n        setOutput(val);\n      }\n    `}}class EN{constructor(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${i})\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${i});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}class AN{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=e,s=t[3]-1;let o;this.outputShape=t;const l=`float(${n}) + float(${r}) * sum`;o=.5===i?`inversesqrt(${l})`:1===i?`1.0/(${l})`:`exp(log(${l}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${a};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${a}; j <= ${a}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${o};\n        setOutput(result);\n      }\n    `}}class TN{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e};\n          wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${e*n-1} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${n} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class RN{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${e};\n           wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${n};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${r};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${e*n*r-1} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${n} * ${r} +\n                  wR * ${r} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class MN{constructor(t,e,n=!1,r=!1,i=!1,a=null,s=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;const o=Math.ceil((n?t[1]:t[2])/2),l=n?"i * 2, rc.y":"rc.y, i * 2",u=r?"rc.z, i * 2":"i * 2, rc.z",c=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let d="",p="";a&&(d=s?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${a}\n        }`:`vec4 activation(vec4 x) {\n          ${a}\n        }`,p="result = activation(result);");const f=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${d}\n\n      const float sharedDimension = ${o}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${o}; i++) {\n          vec4 a = getMatrixA(rc.x, ${l});\n          vec4 b = getMatrixB(rc.x, ${u});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${c[0]} * ${h[0]});\n          result += (${c[1]} * ${h[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${f}\n\n        ${p}\n\n        setOutput(result);\n      }\n    `}}class NN{constructor(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}getCustomSetupFunc(t){return(e,n)=>{null==this.seedLoc&&(this.seedLoc=e.getUniformLocation(n,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}class ON{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}class PN{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const n=vM("rc",e),r=TM(e),i=function(t,e,n){if(1===t)return`rc > ${e[0]}`;let r="";for(let i=t-2;i<t;i++)r+=`${n[i]} >= ${e[i]}`,i<t-1&&(r+="||");return r}(e,t,n),a=function(t,e,n,r){if(1===t)return"";const i=r.slice(-2);return`\n    int r = ${i[0]};\n    int c = ${i[1]};\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ${e};\n    bool rEdge = rp1 >= ${n};\n  `}(e,t[t.length-1],t[t.length-2],n),s=function(t,e){const n=t.length,r=function(t,e){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let a=`${0===r?"r":"rp1"}, ${0===i?"c":"cp1"}`;for(let n=2;n<t;n++)a=`${e[e.length-1-n]},`+a;n.push(a)}return n}(n,e);return 1===n?`getA(rc),\n            rc + 1 >= ${t[0]} ? 0. : getA(rc + 1),\n            0, 0`:`getA(${r[0]}),\n          cEdge ? 0. : getA(${r[1]}),\n          rEdge ? 0. : getA(${r[2]}),\n          rEdge || cEdge ? 0. : getA(${r[3]})`}(t,n);this.userCode=`\n        void main() {\n          ${r} rc = getOutputCoords();\n\n          if(${i}) {\n            setOutput(vec4(0));\n          } else {\n            ${a}\n\n            setOutput(vec4(${s}));\n          }\n        }\n      `}}}class FN{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,i=TM(r),a=e.map(t=>t[0]).join(","),s=e.map((e,n)=>e[0]+t[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${i} start = ${i}(${a});\n      ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(${n}));\n        } else {\n          ${i} coords = outC - start;\n          setOutput(getX(${o}));\n        }\n      }\n    `:`\n        int start = ${a};\n        int end = ${s};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(${n}));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class LN{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,i=TM(r),a=e.map(t=>t[0]).join(","),s=e.map((e,n)=>e[0]+t[n]).join(","),o=vM("rc",r),l=vM("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${o[r-1]} += 1;\n       if(${u}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${o[r-2]} += 1;\n       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${o[r-1]} += 1;\n         if(${u}) {`],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+=`\n        ${h[f]}\n        if (${d}) {\n          result[${f}] = float(${n});\n        } else {\n          ${i} source = rc - start;\n          result[${f}] = getChannel(getX(${l.join()}), ${c});\n        }\n      `;p+=1===r?"} ":"}}",this.userCode=`\n      const ${i} start = ${i}(${a});\n      const ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}class zN{constructor(t,e,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,s=t.strideHeight,o=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e;let m="0.0";if(f||(m="-1.0 / 1e-20"),n)return void(this.userCode=`\n        const ivec2 strides = ivec2(${s}, ${o});\n        const ivec2 pads = ivec2(${d}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?i?`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`:`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`:`wR * ${h} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let g=`${e}(${e}(${e}(`+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(g="avgValue / count");const y=4*Math.floor(a/4),v=a%4,_=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${o});\n      const ivec2 pads = ivec2(${d}, ${p});\n      const float initializationValue = ${m};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${m});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${l}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${y}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${_}\n          }\n\n          int xC = xCCorner + ${y};\n          if (${1===v}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${_}\n          } else if (${2===v}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${_}\n          } else if (${3===v}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${_}\n          }\n        }\n        setOutput(${g});\n      }\n    `}}class $N{constructor(t,e,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,s=t.strideDepth,o=t.strideHeight,l=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const v="avg"===e;let _="0.0";if(v||(_="-1.0 / 1e-20"),n)return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${s}, ${o}, ${l});\n        const ivec3 pads = ivec3(${m}, ${g}, ${y});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${d};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${h}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?i?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let b=`${e}(${e}(${e}(`+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(b="avgValue / count");const x=4*Math.floor(a/4),w=a%4,S=`\n      if (${v}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${s}, ${o}, ${l});\n      const ivec3 pads = ivec3(${m}, ${g}, ${y});\n      const float initializationValue = ${_};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${_});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${x}; wC += 4) {\n              int xC = xCCorner + wC * ${h};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${h}, ch)\n              );\n\n              ${S}\n            }\n\n            int xC = xCCorner + ${x};\n            if (${1===w}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${2===w}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${3===w}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                initializationValue\n              );\n\n              ${S}\n            }\n          }\n          setOutput(${b});\n        }\n      }\n    `}}class BN{constructor(t,e){this.variableNames=["x"];const n=t.windowSize,r=t.batchSize,i=t.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];let s="0.0",o="";"prod"===e?s="1.0":"min"===e?(s="1.0 / 1e-20",o="min"):"max"===e&&(s="-1.0 / 1e-20",o="max");let l=`${e}(${e}(${e}(`+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?l="sumValue":"prod"===e?l="prodValue":"all"===e?l="allValue":"any"===e&&(l="anyValue");const u=4*Math.floor(n/4),c=n%4;let h=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${o}(values, minMaxValue);\n      }\n    `,d="vec4";"all"===e?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";i%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${s};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${s});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${2===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${3===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${h}\n        }\n        setOutput(${l});\n      }\n    `}}class WN{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let n="";for(let i=0;i<4;i++){let t="thisRC = rc;";i%2==1&&(t+="thisRC.z += 1;"),i>1&&(t+="thisRC.y += 1;"),n+=`\n        ${t}\n        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${i}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${i>0?"}":""}\n      `}var r;this.userCode=`\n      ${r=e,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${bM(["r","c","d"],r)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${xM(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${t[1]};\n        int cols = ${t[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class qN{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,r,i]=e.shape,[,a,s]=t.shape,o=[n&&a>1?r-1:r,n&&s>1?i-1:i],l=[n&&a>1?a-1:a,n&&s>1?s-1:s],u=o[0]/l[0],c=o[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${a}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${s}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}class VN{constructor(t,e,n,r){this.variableNames=["A"],this.outputShape=[];const[i,a,s,o]=t;this.outputShape=[i,e,n,o];const l=[r&&e>1?a-1:a,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${l[0]/u[0]},\n          ${l[1]/u[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class UN{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,s,o]=t;this.outputShape=[i,e,n,o];const l=[r&&e>1?a-1:a,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${l[0]/u[0]},\n          ${l[1]/u[1]},\n          ${l[1]/u[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${s}.0,\n                                     ${s}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${o-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}class jN{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,r,i]=e.shape,[,a,s]=t.shape,o=[n&&a>1?r-1:r,n&&s>1?i-1:i],l=[n&&a>1?a-1:a,n&&s>1?s-1:s],u=o[0]/l[0],c=o[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${a}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${s}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${o[0]}) *\n                (float(dyR) / float(${l[0]}));\n\n            float sourceFracCol =\n                float(${o[1]}) *\n                  (float(dyC) / float(${l[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${i}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}class HN{constructor(t,e,n,r){this.variableNames=["A"],this.outputShape=[];const[i,a,s,o]=t;this.outputShape=[i,e,n,o];const l=[r&&e>1?a-1:a,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${l[0]/u[0]},\n          ${l[1]/u[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${r?"0.5":"0.0"})));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class GN{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=t,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const r=t.map((n,r)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - coords[${n}] - 1`:`coords[${n}]`)(r)).join(","),i=TM(n);this.userCode=`\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}class JN{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=t;const r=vM("rc",n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,a=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,s=TM(n);function o(n){const r=t.map((r,i)=>function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - ${r[n]} - 1`:`${r[n]}`}(i,n));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${i}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${s} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(t){return o(t)}(r.slice())};\n          if(${i}){\n            result.g = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",o(t)}(r.slice())};\n          }\n          if(${a}) {\n            result.b = ${function(t){return t[n-2]="("+t[n-2]+" + 1)",o(t)}(r.slice())};\n            if(${i}) {\n              result.a = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",o(t)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}class XN{constructor(t,e,n,r,i,a,s=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const o=TM(i.length),l=TM(a.length);let u="";1===n?u="i":2===n&&(u="i, j");let c="";1===r?c="i":2===r&&(c="i, coords[1]"),this.userCode=`\n        ${o} strides = ${o}(${i});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(${`getIndices(${u})`});\n              flattenedIndex += index * ${e>1?"strides[j]":"strides"};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${`getUpdates(${c})`};\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      `}}class KN{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.numSegments,s=a*Math.ceil(i/n);this.outputShape=[r,s];const o=4*Math.floor(n/4),l=n%4,u="\n        sumValue += dot(values, segFilter);\n    ";let c="";i%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `);let h="";i%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${h}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${a})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${a})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${o}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${o};\n        if (${1===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${u}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${u}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}class ZN{constructor(t,e,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)i="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[];for(let r=0;r<e.length;r++)s.push(`${n[r]}`),r<t&&a.push(`${n[r]}`);r=a.join(),i=s.join()}const a=TM(n);this.userCode=`\n      void main() {\n        ${a} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${i}));\n        } else {\n          setOutput(getB(${i}));\n        }\n      }\n    `}}class YN{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=TM(this.rank),n=`uniform int start[${this.rank}];`,r=function(t){if(1===t)return"sourceLoc";if(t<=6)return QN.slice(0,t).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}(this.rank);let i;i=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((t,e)=>`sourceLoc.${QN[e]} = start[${e}] + coords.${QN[e]};`).join("\n")}\n      `,this.userCode=`\n      ${n}\n      void main() {\n        ${i}\n        setOutput(getSource(${r}));\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the `+`length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}const QN=["x","y","z","w","u","v"];class tO{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const e=TM(this.rank),n=vM("coords",this.rank),r=vM("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${i})`,s=`\n      result.x = ${a};\n      if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${a};\n        --${r[this.rank-1]};\n      }\n    `,o=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${a};\n        if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${a};\n        }\n      }\n    `,l=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((t,e)=>`start[${e}]`).join()});`:t.map((t,e)=>`${r[e]} = ${n[e]} + start[${e}];`).join("\n");this.userCode=`\n      uniform int start[${this.rank}];\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${l}\n        vec4 result = vec4(0.);\n        ${s}\n        ${o}\n        setOutput(result);\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the `+`length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}class eO{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=TM(n.length),a=TM(n.length);let s="";if(1===r)s="coords * strides + begin";else{let t=0;s=n.map((e,r)=>(t++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${t-1}] * strides[${r}] + begin[${r}]`)).join(",")}this.userCode=`\n      ${i} begin = ${i}(${t});\n      ${i} strides = ${i}(${e});\n\n      void main() {\n        ${a} coords = getOutputCoords();\n        setOutput(getX(${s}));\n      }\n    `}}class nO{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const r=rO(e,n),i=iO(t,r,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();const t=this.freeTextures[i].shift();return this.usedTextures[i].push(t),t}let a;return this.numUsedTextures++,this.log(),r===qR.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===qR.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===qR.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===qR.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===qR.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(a),a}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const i=iO(e,rO(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;const a=this.usedTextures[i],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}log(){this.logEnabled&&console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${this.numFreeTextures+this.numUsedTextures})`)}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});for(const t in this.usedTextures)this.usedTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}}}function rO(t,e){if(t===WR.UPLOAD)return qR.PACKED_2X2_FLOAT32;if(t===WR.RENDER||null==t)return function(t){return Mm().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?qR.PACKED_2X2_FLOAT32:qR.UNPACKED_FLOAT32:t?qR.PACKED_2X2_FLOAT16:qR.UNPACKED_FLOAT16}(e);if(t===WR.DOWNLOAD||t===WR.PIXELS)return qR.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function iO(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}class aO{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let a=0;a<n.length;a++)n[a]=t[a]*e[a];this.outputShape=n,this.rank=n.length;const r=TM(this.rank),i=function(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(1===e)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<t.length;i++)r.push(`imod(${n[i]}, ${t[i]})`);return r.join()}(t);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${i}));\n      }\n    `}}class sO{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const oO="return abs(x);",lO="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",uO="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",cO=`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${v.SELU_SCALEALPHA};\n  float scale = ${v.SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`,hO="return -x;",dO="return ceil(x);",pO="return floor(x);",fO="return exp(x);",mO="return exp(x) - 1.0;",gO=`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${v.ERF_P};\n  float a1 = ${v.ERF_A1};\n  float a2 = ${v.ERF_A2};\n  float a3 = ${v.ERF_A3};\n  float a4 = ${v.ERF_A4};\n  float a5 = ${v.ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`,yO="return x;",vO="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",_O="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",bO="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n";class xO{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class wO{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const e=t.length,n=vM("rc",e),r=TM(e),i=function(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),a=n.slice(-2),s=e<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${i});\n\n        setOutput(getChannel(packedInput, ${s}));\n      }\n    `}}const{segment_util:SO}=v,CO=_.split,DO=_.tile,IO=_.topkImpl,kO=_.whereImpl,EO={};function AO(t,e=!1){if("linear"===t)return"return x;";if("relu"===t)return e?vO:lO;if("elu"===t)return e?bO:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===t)return e?_O:uO;if("prelu"===t)return e?UM:qM;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}class TO extends bD{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Mm().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){const t=$R(Mm().getNumber("WEBGL_VERSION"));this.binaryCache=((e=Mm().getNumber("WEBGL_VERSION"))in EO||(EO[e]={}),EO[e]),this.gpgpu=new CN(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var e;this.textureManager=new nO(this.gpgpu),this.numMBBeforeWarning=null==Mm().global.screen?1024:Mm().global.screen.height*Mm().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new _D(this,Qv())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,n){if(Mm().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:WR.UPLOAD}),r}move(t,e,n,r){if(Mm().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:WR.UPLOAD})}readSync(t){const e=this.texData.get(t),{values:n,dtype:i,complexTensors:a,slice:s,shape:o,isPacked:l}=e;if(null!=s){let e;e=l?new xO(o,yO):new sO(o,yO);const n=this.runWebGLProgram(e,[{dataId:t,shape:o,dtype:i}],i),r=this.readSync(n.dataId);return this.disposeData(n.dataId),r}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===i)return n;const u=null!=this.activeTimers;let c,h;if(u&&(c=r.now()),"complex64"===i){const t=a.real.dataSync(),e=a.imag.dataSync();h=v.mergeRealAndImagArrays(t,e)}else h=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=r.now()-c),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise(t=>e.push(t))}const e=this.texData.get(t),{values:n,shape:i,slice:a,dtype:s,complexTensors:o,isPacked:l}=e;if(null!=a){let e;e=l?new xO(i,yO):new sO(i,yO);const n=this.runWebGLProgram(e,[{dataId:t,shape:i,dtype:s}],s),r=this.read(n.dataId);return this.disposeData(n.dataId),r}if(null!=n)return this.convertAndCacheOnCPU(t);if(!Mm().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Mm().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u,c,h=null;if("complex64"!==s&&Mm().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);const e=this.texData.get(u.dataId);h=this.gpgpu.createBufferFromTexture(e.texture,...UR(i))}if(this.pendingRead.set(t,[]),"complex64"!==s&&await this.gpgpu.createAndWaitForFence(),"complex64"===s){const t=await Promise.all([o.real.data(),o.imag.data()]);c=v.mergeRealAndImagArrays(t[0],t[1])}else if(null==h)c=this.getValuesFromTexture(t);else{const t=r.sizeFromShape(i);c=this.gpgpu.downloadFloat32MatrixFromBuffer(h,t)}null!=u&&this.disposeData(u.dataId);const d=this.convertAndCacheOnCPU(t,c),p=this.pendingRead.get(t);return this.pendingRead.delete(t),p.forEach(t=>t(d)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),d}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!JR(n)){if(Mm().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your `+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:i}=this.texData.get(t),a=r.sizeFromShape(e);if(Mm().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(r.texture,...UR(e)).subarray(0,a);return this.disposeData(n.dataId),i}const s=Mm().getBool("WEBGL_PACK")&&!0===i,o=s?aM(e):e,l=s?new gN(o):new mN(o),u=this.runWebGLProgram(l,[{shape:o,dtype:n,dataId:t}],"float32"),c=this.texData.get(u.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeData(u.dataId),h}async time(t){const e=this.activeTimers,n=[];let i=!1;null==this.programTimersStack?(this.programTimersStack=n,i=!0):this.activeTimers.push(n),this.activeTimers=n,t();const a=r.flatten(this.activeTimers.map(t=>t.query)).filter(t=>null!=t),s=r.flatten(this.activeTimers.map(t=>t.name)).filter(t=>null!=t);this.activeTimers=e,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(a);o.kernelMs=r.sum(t),o.getExtraProfileInfo=()=>t.map((t,e)=>({name:s[e],ms:t})).map(t=>`${t.name}: ${t.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}}startTimer(){return Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:r.now(),endMs:null}}endTimer(t){return Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=r.now(),t)}async getQueryTime(t){return Mm().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(t):t.endMs-t.startMs}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(!this.texData.has(t))return;this.releaseGPUData(t);const{complexTensors:e}=this.texData.get(t);null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:i,isPacked:a,slice:s}=this.texData.get(t),o=s&&s.origDataId||t,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,i,a)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Mm().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Qv().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,e=128){return null!=this.getCPUBackend()&&t.every(t=>null==this.texData.get(t.dataId).texture&&r.sizeFromShape(t.shape)<e)}getGPGPUContext(){return this.gpgpu}complex(t,e){const n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Qv().keep(t.clone()),imag:Qv().keep(e.clone())},n}real(t){return this.texData.get(t.dataId).complexTensors.real.clone()}imag(t){return this.texData.get(t.dataId).complexTensors.imag.clone()}slice(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===r.sizeFromShape(n))return Fy([],n,t.dtype);const{isPacked:i}=this.texData.get(t.dataId),a=s.isSliceContinous(t.shape,e,n);if(i||!a){const r=Mm().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tO(n):new YN(n),i=r.getCustomSetupFunc(e);return this.compileAndRun(r,[t],null,i)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)}shallowSlice(t,e,n){const r=this.texData.get(t.dataId),i=this.makeOutput(n,t.dtype),a=this.texData.get(i.dataId);Object.assign(a,r),a.shape=n,a.dtype=t.dtype;let o=s.computeFlatOffset(e,t.strides);r.slice&&(o+=r.slice.flatOffset),a.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,l+1),i}stridedSlice(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);const i=s.computeOutShape(e,n,r);if(i.some(t=>0===t))return Fy([],i);const a=new eO(e,r,i);return this.compileAndRun(a,[t])}reverse(t,e){const n=Mm().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JN(t.shape,e):new GN(t.shape,e);return this.compileAndRun(n,[t])}concat(t,e){if("complex64"===t[0].dtype){const n=t.map(t=>Oy(t)),r=t.map(t=>Py(t));return Ny(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>Mm().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const n=Math.floor(t.length/2),r=this.concat(t.slice(0,n),e),i=this.concat(t.slice(n),e);return this.concat([r,i],e)}if(Mm().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){const n=new KM(t.map(t=>t.shape),e);return this.compileAndRun(n,t)}const n=v.computeOutShape(t.map(t=>t.shape),e),i=t.map(t=>t.as2D(-1,r.sizeFromShape(t.shape.slice(e)))),a=new XM(i.map(t=>t.shape));return this.compileAndRun(a,i).reshape(n)}neg(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,hO,t.dtype);const e=new sO(t.shape,hO);return this.compileAndRun(e,[t])}batchMatMul(t,e,n,r){const i=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],s=n?t.shape[1]:t.shape[2],[o,,]=t.shape;if((1===i||1===a)&&s>1e3){n&&(t=hb(t,[0,2,1])),r&&(e=hb(e,[0,2,1]));const i=1===a?t:t.as3D(o,s,1),l=1===a?2:1,u=1===a?e.as3D(o,1,s):e;return this.multiply(i,u).sum(l,!0)}const l=ny(t.dtype,e.dtype),u=new MN(t.shape,[o,i,a],n,r);return this.compileAndRun(u,[t,e],l)}fusedBatchMatMul({a:t,b:e,transposeA:n,transposeB:r,bias:i,activation:a,preluActivationWeights:s}){const o=n?t.shape[2]:t.shape[1],l=r?e.shape[1]:e.shape[2],[u,,]=t.shape,c=ny(t.dtype,e.dtype),h=null!=i,d=null!=s,p=a?AO(a,!0):null,f=new MN(t.shape,[u,o,l],n,r,h,p,d),m=[t,e];return i&&m.push(i),s&&m.push(s),this.compileAndRun(f,m,c)}multiply(t,e){if("complex64"===t.dtype){const n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new zM("return areal * breal - aimag * bimag;",t.shape,e.shape),a=new zM("return areal * bimag + aimag * breal;",t.shape,e.shape),s=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],o=this.compileAndRun(i,s),l=this.compileAndRun(a,s),u=this.complex(o,l);return o.dispose(),l.dispose(),u}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,WM,t.dtype);const n=new VM(WM,t.shape,e.shape);return this.compileAndRun(n,[t,e],t.dtype)}batchNorm(t,e,n,r,i,a){const s=[t,e,n];let o=null;null!=r&&(o=r.shape,s.push(r));let l=null;if(null!=i&&(l=i.shape,s.push(i)),Mm().getBool("WEBGL_PACK_NORMALIZATION")){const r=new LM(t.shape,e.shape,n.shape,o,l,a);return this.compileAndRun(r,s)}const u=new FM(t.shape,e.shape,n.shape,o,l,a);return this.compileAndRun(u,s)}localResponseNormalization4D(t,e,n,r,i){const a=Mm().getBool("WEBGL_PACK_NORMALIZATION")?new AN(t.shape,e,n,r,i):new kN(t.shape,e,n,r,i);return this.compileAndRun(a,[t])}LRNGrad(t,e,n,r,i,a,s){const o=new EN(e.shape,r,i,a,s);return this.compileAndRun(o,[e,n,t])}tile(t,e){if("string"===t.dtype){const n=this.readSync(t.dataId).map(t=>r.decodeString(t)),i=tv(t.shape,t.dtype,n);return DO(i,e)}const n=new aO(t.shape,e);return this.compileAndRun(n,[t])}pad(t,e,n){const r=Mm().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new LN(t.shape,e,n):new FN(t.shape,e,n);return this.compileAndRun(r,[t])}gather(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);const r=new xN(t.shape,e.size,n);return this.compileAndRun(r,[t,e])}batchToSpaceND(t,e,n){r.assert(t.rank<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const i=e.reduce((t,e)=>t*e),a=v.getReshaped(t.shape,e,i),s=v.getPermuted(a.length,e.length),o=v.getReshapedPermuted(t.shape,e,i),l=v.getSliceBeginCoords(n,e.length),u=v.getSliceSize(o,n,e.length);return hb(t.reshape(a),s).reshape(o).slice(l,u)}spaceToBatchND(t,e,n){r.assert(t.rank<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const i=e.reduce((t,e)=>t*e),a=[[0,0]];a.push(...n);for(let r=1+e.length;r<t.shape.length;++r)a.push([0,0]);const s=t.pad(a),o=v.getReshaped(s.shape,e,i,!1),l=v.getPermuted(o.length,e.length,!1),u=v.getReshapedPermuted(s.shape,e,i,!1);return hb(s.reshape(o),l).reshape(u)}reduce(t,e,n){const r=t.shape[0],i=t.shape[1],a=v.computeOptimalWindowSize(i),s=new BN({windowSize:a,inSize:i,batchSize:r},e),o=this.compileAndRun(s,[t],n);return 1===o.shape[1]?o:this.reduce(o,e,n)}argReduce(t,e,n=null){let r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);const a=v.computeOptimalWindowSize(i),s=new gM({windowSize:a,inSize:i,batchSize:r},e,null==n),o=[t];null!=n&&o.push(n);const l=this.compileAndRun(s,o,"int32");return 1===l.shape[1]?l:this.argReduce(t,e,l)}argReducePacked(t,e,n=null){const r=null!=n?n.shape:t.shape,i=v.computeOptimalWindowSize(r[r.length-1]),a=new NM(r,i,e,null==n),s=this.compileAndRun(a,null==n?[t]:[t,n],"int32");return s.rank===t.rank?this.argReducePacked(t,e,s):s}sum(t,e){v.assertAxesAreInnerMostDims("sum",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=r.sizeFromShape(i),s=t.as2D(-1,a),o=ry(t.dtype);return this.reduce(s,"sum",o).reshape(n)}prod(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=r.sizeFromShape(i),s=t.as2D(-1,a),o=ry(t.dtype);return this.reduce(s,"prod",o).reshape(n)}unsortedSegmentSum(t,e,n){let i=0;const a=v.getAxesPermutation([i],t.rank);let s=t;null!=a&&(s=hb(t,a),i=v.getInnerMostAxes(1,t.rank)[0]);const o=SO.computeOutShape(s.shape,i,n),l=r.sizeFromShape([s.shape[i]]),u=s.as2D(-1,l),c=ry(t.dtype);let h=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(o);return null!=a&&(h=hb(h,v.getUndoAxesPermutation(a))),h}segOpCompute(t,e,n,r,i){const a=t.shape[0],s=t.shape[1],o=SO.segOpComputeOptimalWindowSize(s,i),l=new KN({windowSize:o,inSize:s,batchSize:a,numSegments:i},e),u=this.compileAndRun(l,[t,n],r);return u.shape[1]===i?u:(n=Ky(0,i).tile([s/o]),this.segOpCompute(u,e,n,r,i))}argMinMaxReduce(t,e,n){const i=[e];if(v.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),i,t.rank),!Mm().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){const[e,a]=v.computeOutAndReduceShapes(t.shape,i),s=r.sizeFromShape(a),o=t.as2D(-1,s);return this.argReduce(o,n).reshape(e)}return this.argReducePacked(t,n)}argMin(t,e){return this.argMinMaxReduce(t,e,"min")}argMax(t,e){return this.argMinMaxReduce(t,e,"max")}cumsum(t,e,n,r){if(e!==t.rank-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${t.rank-1} `+`but got axis=${e}`);const i=new uN(t.shape,n,r);return this.compileAndRun(i,[t])}equal(t,e){if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");const n=new VM("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}notEqual(t,e){if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");const n=new VM("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}less(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");const n=new VM("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}lessEqual(t,e){if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");const n=new VM("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}greater(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");const n=new VM("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}greaterEqual(t,e){if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");const n=new VM("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}logicalNot(t){const e=new sO(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])}logicalAnd(t,e){if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");const n=new VM("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}logicalOr(t,e){if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");const n=new VM("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}select(t,e,n){const r=new ZN(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],ny(e.dtype,n.dtype))}where(t){v.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return kO(t.shape,e)}topk(t,e,n){const r=t.dataSync();return IO(r,t.shape,t.dtype,e,n)}min(t,e){v.assertAxesAreInnerMostDims("min",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=r.sizeFromShape(i),s=t.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(n)}minimum(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);const n=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new VM("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}mod(t,e){const n=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new VM("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}maximum(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);const n=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new VM("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}all(t,e){v.assertAxesAreInnerMostDims("all",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=r.sizeFromShape(i),s=t.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(n)}any(t,e){v.assertAxesAreInnerMostDims("any",e,t.rank);const[n,i]=v.computeOutAndReduceShapes(t.shape,e),a=r.sizeFromShape(i),s=t.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(n)}floorDiv(t,e){if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");const n=new VM("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")}add(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,$M);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);const n=ny(t.dtype,e.dtype);if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,$M,n);const r=new VM($M,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)}packedUnaryOp(t,e,n){const r=new xO(t.shape,e);return this.compileAndRun(r,[t],n)}packedBinaryOp(t,e,n,r,i=!1){const a=new jM(n,t.shape,e.shape,i);return this.compileAndRun(a,[t,e],r)}complexSeparableBinaryOp(t,e,n){const r=this.texData.get(t.dataId),i=this.texData.get(e.dataId),[a,s]=[[r.complexTensors.real,i.complexTensors.real],[r.complexTensors.imag,i.complexTensors.imag]].map(r=>{const[i,a]=r,s=this.makeComplexComponentTensorInfo(t,i),o=this.makeComplexComponentTensorInfo(e,a),l=new VM(n,t.shape,e.shape);return this.compileAndRun(l,[s,o],ny(i.dtype,a.dtype))}),o=this.complex(a,s);return a.dispose(),s.dispose(),o}makeComplexComponentTensorInfo(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}addN(t){if(1===t.length)return t[0];if(t.length>Mm().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}const e=t.map(t=>t.dtype).reduce((t,e)=>ny(t,e)),n=t.map(t=>t.shape),r=Mm().getBool("WEBGL_PACK")?new mM(t[0].shape,n):new fM(t[0].shape,n);return this.compileAndRun(r,t,e)}subtract(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,BM);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);const n=ny(t.dtype,e.dtype);if(Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,BM,t.dtype);const r=new VM(BM,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)}pow(t,e){const n=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new VM("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),r=ny(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)}ceil(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,dO,t.dtype);const e=new sO(t.shape,dO);return this.compileAndRun(e,[t])}floor(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,pO,t.dtype);const e=new sO(t.shape,pO);return this.compileAndRun(e,[t])}sign(t){const e=new sO(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])}isNaN(t){const e=new sO(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")}isInf(t){const e=new sO(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")}isFinite(t){const e=new sO(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")}round(t){const e=new sO(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])}exp(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,fO,t.dtype);const e=new sO(t.shape,fO);return this.compileAndRun(e,[t])}expm1(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,mO,t.dtype);const e=new sO(t.shape,mO);return this.compileAndRun(e,[t])}softmax(t,e){const n=r.parseAxisParam([e],t.shape),i=kw(t,n),a=v.expandShapeToKeepDim(i.shape,n),s=this.subtract(t,i.reshape(a)),o=this.exp(s),l=this.sum(o,n).reshape(a);return nb(o,l)}log(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);const e=new sO(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])}log1p(t){const e=new sO(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])}sqrt(t){const e=new sO(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])}rsqrt(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);const e=new sO(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])}reciprocal(t){const e=new sO(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])}relu(t){let e;return e=Mm().getBool("WEBGL_PACK")?new xO(t.shape,vO):new sO(t.shape,lO),this.compileAndRun(e,[t])}relu6(t){let e;return e=Mm().getBool("WEBGL_PACK")?new xO(t.shape,_O):new sO(t.shape,uO),this.compileAndRun(e,[t])}prelu(t,e){const n=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM(UM,t.shape,e.shape):new VM(qM,t.shape,e.shape);return this.compileAndRun(n,[t,e])}elu(t){if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,bO,t.dtype);const e=new sO(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])}eluDer(t,e){const n=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new VM("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}selu(t){const e=new sO(t.shape,cO);return this.compileAndRun(e,[t])}int(t){const e=new sO(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")}clip(t,e,n){let r;r=Mm().getBool("WEBGL_PACK_CLIP")?new GM(t.shape):new HM(t.shape);const i=r.getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)}abs(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(Mm().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,oO,t.dtype);const e=new sO(t.shape,oO);return this.compileAndRun(e,[t])}complexAbs(t){const e=this.texData.get(t.dataId),n=new JM(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)}sigmoid(t){const e=new sO(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])}softplus(t){const e=new sO(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])}sin(t){const e=new sO(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])}cos(t){const e=new sO(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])}tan(t){const e=new sO(t.shape,"return tan(x);");return this.compileAndRun(e,[t])}asin(t){const e=new sO(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])}acos(t){const e=new sO(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])}atan(t){const e=new sO(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])}atan2(t,e){const n=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new VM("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}sinh(t){const e=new sO(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}cosh(t){const e=new sO(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}tanh(t){const e=new sO(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])}asinh(t){const e=new sO(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])}acosh(t){const e=new sO(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])}atanh(t){const e=new sO(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])}erf(t){const e=new sO(t.shape,gO);return this.compileAndRun(e,[t])}step(t,e){const n=new sO(t.shape,function(t=0){return"if (isnan(x)) return x;"+`\n    return x > 0.0 ? 1.0 : float(${t});\n  `}(e));return this.compileAndRun(n,[t])}conv2dByMatMul(t,e,n,i,a,s){const o=t.shape,l=this.texData.get(t.dataId),u="channelsLast"===n.dataFormat,c=o[2]%2!=0&&!!l.isPacked;if((1==o[0]*o[1]*o[2]||1===n.outChannels)&&n.inChannels>1e3||!Mm().getBool("WEBGL_LAZILY_UNPACK")||!Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!c){const r=this.reshape(t,[1,u?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],n.inChannels]),l=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:r,b:l,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),n.outShape)}const h={dataId:t.dataId,shape:[1,u?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),n.inChannels],dtype:t.dtype},d=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,r.assert(oM(l.shape,h.shape),()=>`packed reshape ${l.shape} to ${h.shape} isn't free`);const p=this.reshape(e,[1,n.inChannels,n.outChannels]),f=this.fusedBatchMatMul({a:h,b:p,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),m=this.texData.get(f.dataId);return r.assert(m.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=d,m.shape=n.outShape,Qv().makeTensorFromDataId(f.dataId,n.outShape,f.dtype)}conv2dWithIm2Row(t,e,n,r,i,a){const{filterWidth:s,filterHeight:o,inChannels:l,outWidth:u,outHeight:c,dataFormat:h}=n,d="channelsLast"===h,p=s*o*l,f=c*u,m=[p,f],g=t.squeeze([0]),y=e.reshape([1,p,-1]),v=new IN(m,g.shape,n),_=this.compileAndRun(v,[g]).reshape([1,m[0],m[1]]),b=null!=r,x=null!=a,w=i?AO(i,!0):null,S=new MN(_.shape,[1,f,n.outChannels],!0,!1,b,w,x),C=[_,y];return r&&C.push(r),x&&C.push(a),this.compileAndRun(S,C).reshape(d?[1,c,u,n.outChannels]:[1,n.outChannels,c,u])}fusedConv2d({input:t,filter:e,convInfo:n,bias:r,activation:i,preluActivationWeights:a}){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n,r,i,a);if(Mm().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n,r,i,a);const s=null!=r,o=null!=a,l=i?AO(i,!1):null,u=new iN(n,s,l,o),c=[t,e];return r&&c.push(r),a&&c.push(a),this.compileAndRun(u,c)}conv2d(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(Mm().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);const r=new iN(n);return this.compileAndRun(r,[t,e])}conv2dDerInput(t,e,n){const r=new QM(n);return this.compileAndRun(r,[t,e])}conv2dDerFilter(t,e,n){const r=new YM(n);return this.compileAndRun(r,[t,e])}fusedDepthwiseConv2D({input:t,filter:e,convInfo:n,bias:r,activation:i,preluActivationWeights:a}){const s=Mm().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1,o=i?AO(i,s):null,l=[t,e],u=null!=r,c=null!=a;let h;return u&&l.push(r),c&&l.push(a),s?(h=new oN(n,u,o,c),this.compileAndRun(h,l)):(h=new sN(n,u,o,c),this.compileAndRun(h,l))}depthwiseConv2D(t,e,n){let r;return Mm().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new oN(n),this.compileAndRun(r,[t,e])):(r=new sN(n),this.compileAndRun(r,[t,e]))}depthwiseConv2DDerInput(t,e,n){const r=new rN(n);return this.compileAndRun(r,[t,e])}depthwiseConv2DDerFilter(t,e,n){const r=new nN(n);return this.compileAndRun(r,[t,e])}conv3d(t,e,n){const r=new aN(n);return this.compileAndRun(r,[t,e])}conv3dDerInput(t,e,n){const r=new eN(n);return this.compileAndRun(r,[t,e])}conv3dDerFilter(t,e,n){const r=new tN(n);return this.compileAndRun(r,[t,e])}maxPool(t,e){const n=new zN(e,"max",!1);return this.compileAndRun(n,[t])}avgPool(t,e){const n=new zN(e,"avg",!1);return this.compileAndRun(n,[t],"float32")}maxPoolBackprop(t,e,n,r){const i=new zN(r,"max",!0),a=this.compileAndRun(i,[e]),s=new TN(r),o=this.compileAndRun(s,[t,a],e.dtype);return a.dispose(),o}avgPoolBackprop(t,e,n){const r=new OM(n);return this.compileAndRun(r,[t],e.dtype)}cast(t,e){return v.castTensor(t,e,this)}unstack(t,e){const n=t.shape[e],r=new Array(t.rank-1);let i=0;for(let l=0;l<t.rank;l++)l!==e&&(r[i++]=t.shape[l]);const a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;const o=new Array(n);for(let l=0;l<o.length;l++)a[e]=l,o[l]=this.slice(t,a,s).reshape(r);return o}avgPool3d(t,e){const n=new $N(e,"avg",!1);return this.compileAndRun(n,[t],"float32")}avgPool3dBackprop(t,e,n){const r=new PM(n);return this.compileAndRun(r,[t],e.dtype)}maxPool3d(t,e){const n=new $N(e,"max",!1);return this.compileAndRun(n,[t],"float32")}maxPool3dBackprop(t,e,n,r){const i=new $N(r,"max",!0),a=this.compileAndRun(i,[e]),s=new RN(r),o=this.compileAndRun(s,[t,a],e.dtype);return a.dispose(),o}reshape(t,e){const n=this.texData.get(t.dataId);if(n.isPacked&&!oM(t.shape,e)&&(null===n.texture||!oM(n.shape,e))){const n=this.packedReshape(t,e);return Qv().makeTensorFromDataId(n.dataId,n.shape,n.dtype)}return v.reshapeTensor(t,e)}resizeBilinear(t,e,n,r){const i=Mm().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new UN(t.shape,e,n,r):new VN(t.shape,e,n,r);return this.compileAndRun(i,[t],"float32")}resizeBilinearBackprop(t,e,n){const r=new qN(t,e,n);return this.compileAndRun(r,[t])}resizeNearestNeighbor(t,e,n,r){const i=new HN(t.shape,e,n,r);return this.compileAndRun(i,[t])}resizeNearestNeighborBackprop(t,e,n){const r=new jN(t,e,n);return this.compileAndRun(r,[t])}multinomial(t,e,n,r){const i=e?t:AS(t),a=new NN(i.shape[0],i.shape[1],n),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[i],"int32",s)}oneHot(t,e,n,r){const i=new ON(t.size,e,n,r);return this.compileAndRun(i,[t])}diag(t){const e=new fN(t.size);return this.compileAndRun(e,[t])}cropAndResize(t,e,n,r,i,a){const s=new lN(t.shape,e.shape,r,i,a);return this.compileAndRun(s,[t,e,n],"float32")}depthToSpace(t,e,n){r.assert(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`);const i=t.shape[0],a=("NHWC"===n?t.shape[1]:t.shape[2])*e,s=("NHWC"===n?t.shape[2]:t.shape[3])*e,o=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),l=new pN("NHWC"===n?[i,a,s,o]:[i,o,a,s],e,n);return this.compileAndRun(l,[t])}split(t,e,n){return CO(t,e,n)}scatterND(t,e,n){const{sliceRank:r,numUpdates:i,sliceSize:a,strides:s,outputSize:o}=v.calculateShapes(e,t,n),l=[o/a,a],u=t.reshape([i,r]),c=e.reshape([i,a]);if(0===o)return v.reshapeTensor(Fy([]),n);const h=zy(0),d=new XN(i,r,u.rank,c.rank,s,l);return this.compileAndRun(d,[c,u,h]).reshape(n)}sparseToDense(t,e,n,r){const{sliceRank:i,numUpdates:a,strides:s,outputSize:o}=v.calculateShapes(e,t,n),l=new XN(a,i,t.rank,e.rank,s,[o,1],!1);return this.compileAndRun(l,[e,t,r]).reshape(n)}fft(t){return this.fftImpl(t,!1)}ifft(t){return this.fftImpl(t,!0)}fftImpl(t,e){const n=this.texData.get(t.dataId),r=new _N("return real * expR - imag * expI;",t.shape,e),i=new _N("return real * expI + imag * expR;",t.shape,e),a=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],s=this.compileAndRun(r,a),o=this.compileAndRun(i,a),l=this.complex(s,o).as2D(t.shape[0],t.shape[1]);return s.dispose(),o.dispose(),l}gatherND(t,e){const n=e.shape,r=n[n.length-1],[i,a,s,o]=v.prepareAndValidate(t,e),l=e.reshape([a,r]),u=t.reshape([t.size/s,s]),c=new wN(r,o,[a,s]);return this.compileAndRun(c,[u,l]).reshape(i)}fill(t,e,n){if("string"===(n=n||r.inferDtype(e))){const i=r.getArrayFromDType(n,r.sizeFromShape(t));return i.fill(e),Qv().makeTensor(i,t,n,this)}{const r=new bN(t,e),i=r.getCustomSetupFunc(e);return this.compileAndRun(r,[],n,i)}}onesLike(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)}zerosLike(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)}linspace(t,e,n){return v.linspaceImpl(t,e,n)}makeTensorInfo(t,e){const n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}}makeOutput(t,e){const{dataId:n}=this.makeTensorInfo(t,e);return Qv().makeTensorFromDataId(n,t,e,this)}unpackTensor(t){const e=new wO(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new PN(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[rM(t.shape),...iM(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[rM(e),...iM(e)],a=new WN(i,n),s=this.runWebGLProgram(a,[r],t.dtype,null,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}}decode(t){const e=this.texData.get(t),{isPacked:n,shape:r,dtype:i}=e,a=aM(r);let s;return s=n?new dN(a):new hN(a),{dtype:i,shape:r,dataId:this.runWebGLProgram(s,[{shape:a,dtype:i,dataId:t}],i,null,!0).dataId}}runWebGLProgram(t,e,n,i,a=!1){const s=this.makeTensorInfo(t.outputShape,n),o=this.texData.get(s.dataId);if(t.packedOutput&&(o.isPacked=!0),t.outPackingScheme===BR.DENSE){const e=UR(t.outputShape);o.texShape=e.map(t=>2*t)}if(null!=t.outTexUsage&&(o.usage=t.outTexUsage),0===r.sizeFromShape(s.shape))return o.values=r.getTypedArrayFromDType(s.dtype,0),s;const l=[],u=e.map(e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&r.sizeFromShape(e.shape)<=Mm().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),l.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!oM(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),l.push(e),n=this.texData.get(e.dataId),t.shape=r}return this.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}});this.uploadToGPU(s.dataId);const c={shape:s.shape,texData:o,isUniform:!1},h=function(t,e,n){let r="";e.concat(n).forEach(t=>{r+=`${t.shape}_${t.isUniform?"uniform":t.texData.texShape}_${null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0}`});let i=t.constructor.name;return i+="_"+r+"_"+t.userCode,i}(t,u,c),d=this.getAndSaveBinary(h,()=>function(t,e,n,i){const a=e.userCode,s=n.map((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}}),o=s.map(t=>t.shapeInfo),l={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},u=function(t,e,n,i){const a=[];t.forEach(t=>{const e=r.sizeFromShape(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?a.push(`uniform float ${t.name}${e>1?`[${e}]`:""};`):(a.push(`uniform sampler2D ${t.name};`),a.push(`uniform int offset${t.name};`))});const s=a.join("\n"),o=t.map(t=>function(t,e,n=!1){let i="";return i+=n?function t(e){switch(e.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name;return`\n    vec4 ${"get"+e.charAt(0).toUpperCase()+e.slice(1)}() {\n      return ${_M().texture2D}(${e}, halfCR);\n    }\n  `}(e);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=_M();return`\n    vec4 ${n}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${i[0]}, ${i[1]}, index);\n      return ${a.texture2D}(${e}, uv);\n    }\n  `}(e);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,s=a[0],o=a[1],l=_M();if(null!=a&&r.arraysEqual(e,a))return`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${s}.0);\n\n        return ${l.texture2D}(${n}, uv);\n      }\n    `;const u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(e[1]/2)}, ${u[0]}, ${u[1]}, row, col);\n      return ${l.texture2D}(${n}, uv);\n    }\n  `}(e);case 3:return function(e){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){const r=[1,2],a=RM(e,n.slice(1)),s=["b","row","col"];return`\n        ${t(a)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${MM(s,r)});\n        }\n      `}const o=s[0],l=s[1],u=Math.ceil(n[2]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${o}, ${l}, ${u*Math.ceil(n[1]/2)}, ${u}, b, row, col);\n      return ${_M().texture2D}(${r}, uv);\n    }\n  `}(e);default:return function(t){const e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],o=s[0],l=s[1],u=Math.ceil(e[n-1]/2);let c=u*Math.ceil(e[n-2]/2),h="int b, int row, int col",d=`b * ${c} + (row / 2) * ${u} + (col / 2)`;for(let p=2;p<n-1;p++)h=`int b${p}, `+h,c*=e[n-p-1],d=`b${p} * ${c} + `+d;return`\n    vec4 ${i}(${h}) {\n      int index = ${d};\n      int texR = index / ${l};\n      int texC = index - texR * ${l};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${o});\n      return ${_M().texture2D}(${r}, uv);\n    }\n  `}(e)}}(t):function t(e){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`float ${n}() {return ${e};}`;const[r,i]=t.shapeInfo.texShape;if(1===r&&1===i)return`\n      float ${n}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const[a,s]=t.shapeInfo.texShape;return`\n    float ${n}() {\n      vec2 uv = uvFromFlat(${a}, ${s}, ${EM(e)});\n      return sampleTexture(${e}, uv);\n    }\n  `}(e);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`\n      float ${n}(int index) {\n        ${AM(t)}\n      }\n    `;const r=t.shapeInfo.texShape,i=r[0],a=r[1];if(1===a&&1===i)return`\n      float ${n}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const s=EM(e);return 1===a?`\n      float ${n}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${i}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `:1===i?`\n      float ${n}(int index) {\n        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${a}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n    float ${n}(int index) {\n      vec2 uv = uvFromFlat(${i}, ${a}, index + ${s});\n      return sampleTexture(${e}, uv);\n    }\n  `}(e);case 2:return function(e){const n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=e.shapeInfo.texShape;if(null!=s&&r.arraysEqual(n,s))return`\n    float ${a}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${s[1]}.0, ${s[0]}.0);\n      return sampleTexture(${i}, uv);\n    }\n  `;const{newShape:o,keptDims:l}=r.squeezeShape(n);if(o.length<n.length){const n=RM(e,o),r=["row","col"];return`\n      ${t(n)}\n      float ${a}(int row, int col) {\n        return ${a}(${MM(r,l)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${AM(e)}\n      }\n    `;const u=s[0],c=s[1],h=EM(i);return 1===c?`\n    float ${a}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${i}, uv);\n    }\n  `:1===u?`\n    float ${a}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);\n      return sampleTexture(${i}, uv);\n    }\n  `:`\n  float ${a}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${h};\n    vec2 uv = uvFromFlat(${u}, ${c}, index);\n    return sampleTexture(${i}, uv);\n  }\n`}(e);case 3:return function(e){const n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=n[1]*n[2],o=n[2],{newShape:l,keptDims:u}=r.squeezeShape(n);if(l.length<n.length){const n=RM(e,l),r=["row","col","depth"];return`\n        ${t(n)}\n        float ${a}(int row, int col, int depth) {\n          return ${a}(${MM(r,u)});\n        }\n      `}if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${s}, ${o}, 1)));\n        ${AM(e)}\n      }\n    `;const c=e.shapeInfo.texShape,h=c[0],d=c[1],p=e.shapeInfo.flatOffset;return d===s&&null==p?`\n        float ${a}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${o}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${d}.0, ${h}.0);\n          return sampleTexture(${i}, uv);\n        }\n      `:d===o&&null==p?`\n    float ${a}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);\n      return sampleTexture(${i}, uv);\n    }\n  `:`\n      float ${a}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${s} + col * ${o} + depth + ${EM(i)};\n        vec2 uv = uvFromFlat(${h}, ${d}, index);\n        return sampleTexture(${i}, uv);\n      }\n  `}(e);case 4:return function(e){const n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=n[3],o=n[2]*s,l=n[1]*o,{newShape:u,keptDims:c}=r.squeezeShape(n);if(u.length<n.length){const n=RM(e,u),r=["row","col","depth","depth2"];return`\n      ${t(n)}\n      float ${a}(int row, int col, int depth, int depth2) {\n        return ${a}(${MM(r,c)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${l}, ${o}, ${s}, 1)));\n        ${AM(e)}\n      }\n    `;const h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],f=d[1];return f===l&&null==h?`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${o}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `:f===s&&null==h?`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n    float ${a}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${l} + col * ${o} +\n          depth * ${s} + depth2;\n      vec2 uv = uvFromFlat(${p}, ${f}, index + ${EM(i)});\n      return sampleTexture(${i}, uv);\n    }\n  `}(e);case 5:return function(e){const n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=n[4],o=n[3]*s,l=n[2]*o,u=n[1]*l,{newShape:c,keptDims:h}=r.squeezeShape(n);if(c.length<n.length){const n=RM(e,c),r=["row","col","depth","depth2","depth3"];return`\n      ${t(n)}\n      float ${a}(int row, int col, int depth, int depth2, int depth3) {\n        return ${a}(${MM(r,h)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${u}, ${l}, ${o}, ${s})) +\n          depth3;\n        ${AM(e)}\n      }\n    `;const d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,f=p[0],m=p[1];return m===u&&null==d?`\n      float ${a}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${l}, ${o}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${m}.0, ${f}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `:m===s&&null==d?`\n      float ${a}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${n[1]*n[2]*n[3]},\n               ${n[2]*n[3]}, ${n[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${m}.0, ${f}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n    float ${a}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${u} + col * ${l} + depth * ${o} +\n          depth2 * ${s} + depth3 + ${EM(i)};\n      vec2 uv = uvFromFlat(${f}, ${m}, index);\n      return sampleTexture(${i}, uv);\n    }\n  `}(e);case 6:return function(e){const n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),{newShape:s,keptDims:o}=r.squeezeShape(n);if(s.length<n.length){const n=RM(e,s),r=["row","col","depth","depth2","depth3","depth4"];return`\n      ${t(n)}\n      float ${a}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${a}(${MM(r,o)});\n      }\n    `}const l=n[5],u=n[4]*l,c=n[3]*u,h=n[2]*c,d=n[1]*h;if(e.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${d}, ${h}, ${c}, ${u})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${l}, 1)));\n        ${AM(e)}\n      }\n    `;const p=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,m=f[0],g=f[1];return g===d&&null==p?`\n      float ${a}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${h}, ${c}, ${u}, ${l})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${g}.0, ${m}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `:g===l&&null==p?`\n      float ${a}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${n[1]*n[2]*n[3]*n[4]},\n               ${n[2]*n[3]*n[4]},\n               ${n[3]*n[4]},\n               ${n[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${g}.0, ${m}.0);\n        return sampleTexture(${i}, uv);\n      }\n    `:`\n    float ${a}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${d} + col * ${h} + depth * ${c} +\n          depth2 * ${u} + depth3 * ${l} + depth4 + ${EM(i)};\n      vec2 uv = uvFromFlat(${m}, ${g}, index);\n      return sampleTexture(${i}, uv);\n    }\n  `}(e);default:throw new Error(`${n.length}-D input sampling`+" is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(i+=n?function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),a="get"+i+"AtOutCoords",s=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,l=SM(t.shapeInfo.logicalShape,e.logicalShape),u=TM(o),c=o-s;let h;const d=["x","y","z","w","u","v"];h=0===s?"":o<2&&l.length>=1?"coords = 0;":l.map(t=>`coords.${d[t+c]} = 0;`).join("\n");let p="";p=o<2&&s>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>`coords.${d[e+c]}`).join(", ");let f="return outputValue;";const m=1===r.sizeFromShape(t.shapeInfo.logicalShape),g=1===r.sizeFromShape(e.logicalShape);if(1!==s||m||g){if(m&&!g)f=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){const t=s-2,e=s-1;l.indexOf(t)>-1&&l.indexOf(e)>-1?f="return vec4(outputValue.x);":l.indexOf(t)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(e)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${a}() {\n      ${u} coords = getOutputCoords();\n      ${h}\n      vec4 outputValue = get${i}(${p});\n      ${f}\n    }\n  `}(t,e):function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),a="get"+i+"AtOutCoords",s=t.shapeInfo.logicalShape.length,o=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===o&&null==t.shapeInfo.flatOffset&&r.arraysEqual(t.shapeInfo.texShape,e.texShape))return`\n      float ${a}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const l=TM(o),u=SM(t.shapeInfo.logicalShape,e.logicalShape),c=o-s;let h;const d=["x","y","z","w","u","v"];h=0===s?"":o<2&&u.length>=1?"coords = 0;":u.map(t=>`coords.${d[t+c]} = 0;`).join("\n");let p="";return p=o<2&&s>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>`coords.${d[e+c]}`).join(", "),`\n    float ${a}() {\n      ${l} coords = getOutputCoords();\n      ${h}\n      return get${i}(${p});\n    }\n  `}(t,e)),i}(t,e,i)).join("\n"),l=e.texShape,u=_M(),c=function(t){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${t.texture2D}(textureSampler, uv).r;\n    }\n  `}(u);let h,d,p=function(t){return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFs} vec2 resultUV;\n    ${t.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${t.defineSpecialNaN}\n    ${t.defineSpecialInf}\n    ${t.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${CM}\n    ${DM}\n    ${IM}\n  `}(u);return e.isPacked?(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${n[1]}.0);\n      }\n    `:1===n[1]?`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${n[0]}.0);\n      }\n    `:`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);\n    }\n  `}(0,e);case 2:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(r.arraysEqual(t,e))return`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));\n      }\n    `;const i=Math.ceil(t[1]/2);return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${r});\n      int c = imod(index, ${r}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(t,e);default:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let a=i,s="",o="b, r, c";for(let l=2;l<t.length-1;l++)a*=t[t.length-l-1],s=`\n      int b${l} = index / ${a};\n      index -= b${l} * ${a};\n    `+s,o=`b${l}, `+o;return`\n    ivec${t.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      ${s}\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${r});\n      int c = imod(index, ${r}) * 2;\n\n      return ivec${t.length}(${o});\n    }\n  `}(t,e)}}(e.logicalShape,l),d=function(t){return`\n    void setOutput(vec4 val) {\n      ${t.output} = val;\n    }\n  `}(u)):(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(n=e)[0]?`\n      int getOutputCoords() {\n        return int(resultUV.x * ${n[1]}.0);\n      }\n    `:1===n[1]?`\n      int getOutputCoords() {\n        return int(resultUV.y * ${n[0]}.0);\n      }\n    `:`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return resTexRC.x * ${n[1]} + resTexRC.y;\n    }\n  `;case 2:return function(t,e){return r.arraysEqual(t,e)?`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));\n      }\n    `:1===t[1]?`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===t[0]?`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      int r = index / ${t[1]};\n      int c = index - r * ${t[1]};\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=bM(["r","c","d"],t);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec3(r, c, d);\n    }\n  `}(t,e);case 4:return function(t,e){const n=bM(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec4(r, c, d, d2);\n    }\n  `}(t,e);case 5:return function(t,e){const n=bM(["r","c","d","d2","d3"],t);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},\n                             ${e[1]}));\n\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(t,e);case 6:return function(t,e){const n=bM(["r","c","d","d2","d3","d4"],t);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}var n}(e.logicalShape,l),d=function(t){return`\n    void setOutput(float val) {\n      ${t.output} = vec4(val, 0, 0, 0);\n    }\n  `}(u)),i&&(p+=kM),[p,c,d,s,h,o,n].join("\n")}(s,l,a,e.packedInputs),c=t.createProgram(u);let h=null;const d=t.getUniformLocation(c,"NAN",!1);1===Mm().getNumber("WEBGL_VERSION")&&(h=t.getUniformLocation(c,"INFINITY",!1));const p={};for(let r=0;r<e.variableNames.length;r++){const n=e.variableNames[r],i=!1;p[n]=t.getUniformLocation(c,n,i),p[`offset${n}`]=t.getUniformLocation(c,`offset${n}`,i)}return{program:e,source:u,webGLProgram:c,uniformLocations:p,inShapeInfos:o,outShapeInfo:l,infLoc:h,nanLoc:d}}(this.gpgpu,t,u,c)),p=null!=this.activeTimers;let f;if(p&&(f=this.startTimer()),function(t,e,n,i,a){DN(e.inShapeInfos,n),DN([e.outShapeInfo],[i]);const s=i.texData.texture,o=i.texData.texShape;i.texData.isPacked?t.setOutputPackedMatrixTexture(s,o[0],o[1]):t.setOutputMatrixTexture(s,o[0],o[1]),t.setProgram(e.webGLProgram),1===Mm().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((n,i)=>{const a=e.program.variableNames[i],s=e.uniformLocations[a],o=e.uniformLocations[`offset${a}`];if(null!=s)if(n.isUniform)if(r.sizeFromShape(n.shape)<2)t.gl.uniform1f(s,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(s,e)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,s,i)}),null!=a&&a(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,d,u,c,i),l.forEach(t=>this.disposeData(t.dataId)),p&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)})),!Mm().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===a){const t=this.unpackTensor(s);return this.disposeData(s.dataId),t}return s}compileAndRun(t,e,n,r,i=!1){const a=this.runWebGLProgram(t,e,n=n||e[0].dtype,r,i);return Qv().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Mm().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=e_(()=>{if(!Mm().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Mm().getBool("DEBUG");Mm().set("DEBUG",!1);const e=this.abs(zy(1e-8)).dataSync()[0];if(Mm().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:i,values:a,texture:s,usage:o,isPacked:l}=e;if(null!=s)return;const u=null!=this.activeTimers;let c;u&&(c=r.now());let h=e.texShape;if(null==h&&(h=function(t,e=!1){let n=Mm().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map((e,n)=>n>=t.length-2?r.nearestLargerEven(t[n]):t[n])).length&&(t=[2,t[0]])),2!==t.length){const e=r.squeezeShape(t);t=e.newShape}let i=r.sizeFromShape(t);if(t.length<=1&&i<=n)return[1,i];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){const e=rM(t);let n=2,a=2;return t.length&&([n,a]=iM(t)),i=e*(n/2)*(a/2),r.sizeToSquarishShape(i).map(t=>2*t)}return r.sizeToSquarishShape(i)}(n,l),e.texShape=h),null!=a){const t=aM(n);let s,o=h[1],d=h[0];const p=a instanceof Uint8Array;l?([o,d]=jR(h[0],h[1]),s=new vN(t,[d,o],p)):s=new yN(t,[d,o],p);const f=this.makeTensorInfo([d,o],i);this.texData.get(f.dataId).usage=p?WR.PIXELS:WR.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),o,d,a);const m=this.runWebGLProgram(s,[f],i,null,!0),g=this.texData.get(m.dataId);e.texture=g.texture,e.texShape=g.texShape,e.isPacked=g.isPacked,e.usage=g.usage,this.disposeData(f.dataId),this.texData.delete(m.dataId),e.values=null,u&&(this.uploadWaitMs+=r.now()-c)}else{const t=this.acquireTexture(h,o,i,l);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error(`Unknown dtype ${e}`)}(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${t} MB, `+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*r.bytesPerElement(e)}}const RO={kernelName:"Div",backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{a:n,b:r}=t;return function(t,e,n){let r=new VM("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new jM("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",t.shape,e.shape,!0)),n.runWebGLProgram(r,[t,e],"float32")}(n,r,e)}};class MO{constructor(t){this.variableNames=["A"];const e=_M(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class NO{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=_M(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}const OO={kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:i}=e;const{numChannels:a}=r,s="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,[l,u]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],h=[u,l,a];(o||s)&&(null==PO&&(PO=document.createElement("canvas").getContext("2d")),PO.canvas.width=l,PO.canvas.height=u,PO.drawImage(i,0,0,l,u),i=PO.canvas);const d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=WR.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);const p=Mm().getBool("WEBGL_PACK")?new NO(h):new MO(h),f=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),f}};let PO;const{maxImpl:FO,transposeImpl:LO}=F;function zO(t,e,n){const r=n.texData.get(t.dataId);return!r.isPacked||oM(t.shape,e)||null!==r.texture&&oM(r.shape,e)?{dataId:t.dataId,shape:e,dtype:t.dtype}:function(t,e,n){const r=[rM(t.shape),...iM(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},a=[rM(e),...iM(e)],s=new WN(a,r),o=n.runWebGLProgram(s,[i],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}(t,e,n)}class $O{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let a=0;a<n.length;a++)n[a]=t[e[a]];this.outputShape=n,this.rank=n.length;const r=TM(this.rank),i=function(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${i}));\n    }\n    `}}class BO{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let u=0;u<n.length;u++)n[u]=t[e[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=TM(this.rank),i=yM("rc",this.rank),a=new Array(this.rank);for(let u=0;u<e.length;u++)a[e[u]]=i[u];const s=`vec2(${a.slice(-2).join()})`,o=`++${i[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${a.join()}), ${s})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${l};\n      if(${o}) {\n        result[1] = ${l};\n      }\n      --${i[this.rank-1]};\n      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${l};\n        if(${o}) {\n          result[3] = ${l};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function WO(t,e,n){const r=Mm().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BO(t.shape,e):new $O(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}const qO={kernelName:"NonMaxSuppressionV3",backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{v.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:r,scores:i}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:o}=n,l=e,u=l.readSync(r.dataId),c=l.readSync(i.dataId);return _.nonMaxSuppressionV3(u,c,a,s,o)}},VO=_.nonMaxSuppressionV5,UO=[{kernelName:"Max",backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{reductionIndices:a}=e,s=n,o=i.shape.length;let l=r.parseAxisParam(a,i.shape);const u=v.getAxesPermutation(l,o),c=null!=u,h=s.shouldExecuteOnCPU([i]);let d=i;if(c){if(h){const t=s.texData.get(d.dataId).values,e=new Array(o);for(let r=0;r<e.length;r++)e[r]=i.shape[u[r]];const n=LO(t,i.shape,i.dtype,u,e);d=s.makeTensorInfo(e,i.dtype),s.texData.get(d.dataId).values=n}else d=WO(i,u,s);l=v.getInnerMostAxes(l.length,o)}v.assertAxesAreInnerMostDims("max",l,o);const[p,f]=v.computeOutAndReduceShapes(d.shape,l);let m;if(h){const t=s.texData.get(d.dataId),e=FO(t.values,r.sizeFromShape(f),p,i.dtype);m=s.makeTensorInfo(p,i.dtype),s.texData.get(m.dataId).values=e}else m=function(t,e,n,i){const a=r.sizeFromShape(e),s=zO(t,[r.sizeFromShape(t.shape)/a,a],i),o=function t(e,n,r,i){const[a,s]=e.shape,o=v.computeOptimalWindowSize(s),l=new BN({windowSize:o,inSize:s,batchSize:a},r),u=i.runWebGLProgram(l,[e],n);return 1===u.shape[1]?u:t(u,n,r,i)}(s,t.dtype,"max",i);return s.dataId!==t.dataId&&i.disposeData(s.dataId),zO(o,n,i)}(d,f,p,s);return c&&s.disposeData(d.dataId),m}},OO,RO,qO,{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{v.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:r,scores:i}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:o,softNmsSigma:l}=n,u=e,c=u.readSync(r.dataId),h=u.readSync(i.dataId),d=a,p=s,f=o,m=l,{selectedIndices:g,selectedScores:y}=VO(c,h,d,p,f,m);return[g,y]}},{kernelName:"Square",backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e,i=new sO(n.shape,"return x * x;");return r.runWebGLProgram(i,[n],n.dtype)}},{kernelName:"SquaredDifference",backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{a:n,b:r}=t,i=e,a=Mm().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jM("return (a - b) * (a - b);",n.shape,r.shape):new VM("return (a - b) * (a - b);",n.shape,r.shape);return i.compileAndRun(a,[n,r])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{perm:i}=e,a=n,s=new Array(r.shape.length);for(let l=0;l<s.length;l++)s[l]=r.shape[i[l]];let o;if(a.shouldExecuteOnCPU([r])){const t=a.texData.get(r.dataId),e=LO(t.values,r.shape,r.dtype,i,s);o=a.makeTensorInfo(s,r.dtype),a.texData.get(o.dataId).values=e}else o=WO(r,i,a);return o}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{filterSize:a,strides:s,pad:o,includeBatchInIndex:l}=e,u=n;r.assert(4===i.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${i.shape.length}.`);const c=[1,1];r.assert(v.eitherStridesOrDilationsAreOne(s,c),()=>"Error in maxPool: Either strides or dilations must be 1. "+`Got strides ${s} and dilations '${c}'`);const h=v.computePool2DInfo(i.shape,a,s,c,o),[d,p]=function(t,e,n,r){let i=new zN(n,"max",!1);const a=r.runWebGLProgram(i,[t],"float32");return i=new zN(n,"max",!0,!0,e),[a,r.runWebGLProgram(i,[t],"float32")]}(i,l,h,u);return[d,p]}}];for(const l9 of UO)qm(l9);a.isBrowser()&&i_("webgl",()=>new TO,2);class jO{}class HO{}class GO{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),r=n.toLowerCase(),i=t.slice(e+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof GO?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new GO;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof GO?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const i=t.value;if(i){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===i.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class JO{encodeKey(t){return XO(t)}encodeValue(t){return XO(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function XO(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class KO{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new JO,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.split("&").forEach(t=>{const r=t.indexOf("="),[i,a]=-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],s=n.get(i)||[];s.push(a),n.set(i,s)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new KO({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(t.value);-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function ZO(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function YO(t){return"undefined"!=typeof Blob&&t instanceof Blob}function QO(t){return"undefined"!=typeof FormData&&t instanceof FormData}class tP{constructor(t,e,n,r){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new GO),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new KO,this.urlWithParams=e}serializeBody(){return null===this.body?null:ZO(this.body)||YO(this.body)||QO(this.body)||"string"==typeof this.body?this.body:this.body instanceof KO?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||QO(this.body)?null:YO(this.body)?this.body.type||null:ZO(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof KO?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,r=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let o=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(o=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),o)),t.setParams&&(l=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),l)),new tP(e,n,i,{params:l,headers:o,reportProgress:s,responseType:r,withCredentials:a})}}const eP=function(){var t={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return t[t.Sent]="Sent",t[t.UploadProgress]="UploadProgress",t[t.ResponseHeader]="ResponseHeader",t[t.DownloadProgress]="DownloadProgress",t[t.Response]="Response",t[t.User]="User",t}();class nP{constructor(t,e=200,n="OK"){this.headers=t.headers||new GO,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class rP extends nP{constructor(t={}){super(t),this.type=eP.ResponseHeader}clone(t={}){return new rP({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class iP extends nP{constructor(t={}){super(t),this.type=eP.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new iP({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class aP extends nP{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function sP(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let oP=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let r;if(t instanceof tP)r=t;else{let i=void 0;i=n.headers instanceof GO?n.headers:new GO(n.headers);let a=void 0;n.params&&(a=n.params instanceof KO?n.params:new KO({fromObject:n.params})),r=new tP(t,e,void 0!==n.body?n.body:null,{headers:i,params:a,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=Gh(r).pipe(Pd(t=>this.handler.handle(t)));if(t instanceof tP||"events"===n.observe)return i;const a=i.pipe(rd(t=>t instanceof iP));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return a.pipe(yt(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return a.pipe(yt(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return a.pipe(yt(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return a.pipe(yt(t=>t.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new KO).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,sP(n,e))}post(t,e,n={}){return this.request("POST",t,sP(n,e))}put(t,e,n={}){return this.request("PUT",t,sP(n,e))}}return t.\u0275fac=function(e){return new(e||t)(Ae(jO))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();class lP{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const uP=new _e("HTTP_INTERCEPTORS");let cP=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const hP=/^\)\]\}',?\n/;class dP{}let pP=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),fP=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new tt(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const r=t.serializeBody();let i=null;const a=()=>{if(null!==i)return i;const e=1223===n.status?204:n.status,r=n.statusText||"OK",a=new GO(n.getAllResponseHeaders()),s=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return i=new rP({headers:a,status:e,statusText:r,url:s}),i},s=()=>{let{headers:r,status:i,statusText:s,url:o}=a(),l=null;204!==i&&(l=void 0===n.response?n.responseText:n.response),0===i&&(i=l?200:0);let u=i>=200&&i<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(hP,"");try{l=""!==l?JSON.parse(l):null}catch(c){l=t,u&&(u=!1,l={error:c,text:l})}}u?(e.next(new iP({body:l,headers:r,status:i,statusText:s,url:o||void 0})),e.complete()):e.error(new aP({error:l,headers:r,status:i,statusText:s,url:o||void 0}))},o=t=>{const{url:r}=a(),i=new aP({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});e.error(i)};let l=!1;const u=r=>{l||(e.next(a()),l=!0);let i={type:eP.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===t.responseType&&n.responseText&&(i.partialText=n.responseText),e.next(i)},c=t=>{let n={type:eP.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",s),n.addEventListener("error",o),t.reportProgress&&(n.addEventListener("progress",u),null!==r&&n.upload&&n.upload.addEventListener("progress",c)),n.send(r),e.next({type:eP.Sent}),()=>{n.removeEventListener("error",o),n.removeEventListener("load",s),t.reportProgress&&(n.removeEventListener("progress",u),null!==r&&n.upload&&n.upload.removeEventListener("progress",c)),n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(Ae(dP))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const mP=new _e("XSRF_COOKIE_NAME"),gP=new _e("XSRF_HEADER_NAME");class yP{}let vP,_P=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=th(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc),Ae($u),Ae(mP))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),bP=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const r=this.tokenService.getToken();return null===r||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,r)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Ae(yP),Ae(gP))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),xP=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(uP,[]);this.chain=t.reduceRight((t,e)=>new lP(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Ae(HO),Ae(Fs))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),wP=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:bP,useClass:cP}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:mP,useValue:e.cookieName}:[],e.headerName?{provide:gP,useValue:e.headerName}:[]]}}}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[bP,{provide:uP,useExisting:bP,multi:!0},{provide:yP,useClass:_P},{provide:mP,useValue:"XSRF-TOKEN"},{provide:gP,useValue:"X-XSRF-TOKEN"}]}),t})(),SP=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[oP,{provide:jO,useClass:xP},fP,{provide:HO,useExisting:fP},pP,{provide:dP,useExisting:pP}],imports:[[wP.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})(),CP=(()=>{class t{constructor(t){this.http=t,this._receivedData=new Jh(""),this.receivedData=this._receivedData.asObservable()}getData(t){return new Promise((e,n)=>{this.http.get("http:www.envisionai.tech/search",{params:t}).subscribe(t=>{this._receivedData.next(t),e(t)},t=>{n(t)})})}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(Ae(oP))},t.\u0275prov=jt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),DP=(()=>{class t{constructor(t){this.TrendsapiService=t,this.epochs=27,this.split=Math.floor(52),this.windowSize=4,this.batchSize=3,this.receivedData_sub=this.TrendsapiService.receivedData.subscribe(t=>{})}inputValues(t){return new Promise((e,n)=>{this.selectedData=[],t[0].series.forEach(t=>{this.selectedData.push(t.value)}),e(this.selectedData)})}loadModel(){var t;("http:www.envisionai.tech/Tfmodel/model.json",t={strict:!1},null==t&&(t={}),async function(t,e){if(null==e&&(e={}),"string"==typeof t){const n=o.getLoadHandlers(t,e);if(0===n.length)n.push(o.browserHTTPRequest(t,e));else if(n.length>1)throw new ID(`Found more than one (${n.length}) load handlers for `+`URL '${t}'`);t=n[0]}return async function(t,e,n){if(null==n&&(n={}),null==t.load)throw new ID("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await t.load();let i=r.modelTopology;null!=i.model_config&&(i=i.model_config);const a=null==n.strict||n.strict,s=null!=r.weightData&&null!=r.weightSpecs&&a,l=Pk(sE(i),void 0,s),u=r.trainingConfig;if(null!=u&&l.loadTrainingConfig(u),null!=r.userDefinedMetadata&&l.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new ID("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=function(t,e){const n=o.decodeWeights(t,e),r={},i=[];return e.forEach(t=>{"optimizer"===t.group?i.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]}),{modelWeights:r,optimizerWeights:i}}(r.weightData,r.weightSpecs);l.loadWeights(t,a),null!=l.optimizer&&e.length>0&&await l.optimizer.setWeights(e),n_(t),n_(e.map(t=>t.tensor))}return l}(t,0,e)}("http:www.envisionai.tech/Tfmodel/model.json",t)).then(t=>{console.log("model imported successfully"),this.Model=t}).catch(t=>{console.log(t)})}selectCountry(t){if(this.Model&&this.presentData){let e=[];this.presentData.data.forEach(n=>{n.country==t&&(this.presentData.data[this.presentData.data.indexOf(n)].data.forEach(t=>{e.push(t.value)}),this.selectedData=e)})}}sliceArr(t){return new Promise((e,n)=>{let r=[],i=[];for(let a=0;a<t.length;a++){if(a+this.windowSize>t.length){e({inputs:r,targets:i});break}{let e=t.slice(a,a+this.windowSize-1),n=[t[a+this.windowSize]];r.push(e),i.push(n)}}e({inputs:r,targets:i})})}createDataset(){return new Promise((t,e)=>{if(this.selectedData){let e=this.selectedData.slice(0,this.split);this.selectedData.slice(this.split),this.sliceArr(e).then(e=>{let n=[];e.inputs.forEach(t=>{n=n.concat(t)});let r=[];e.targets.forEach(t=>{r=r.concat(t)}),this.inputSet=By(n,[n.length/(this.windowSize-1),this.windowSize-1],"int32"),this.targetSet=By(r,[r.length,1],"int32"),t()})}else console.log("bruh"),e()})}train(){this.Model&&(this.Model.compile({optimizer:VC.adam(.001),loss:p.huberLoss,metrics:["mse"]}),console.log("model compiled"),Tm("body").find("*").attr("disabled","disabled"),Tm("body").find("a").click((function(t){t.preventDefault()})),this.Model.fit(this.inputSet,this.targetSet,{epochs:this.epochs,batchSize:this.batchSize,callbacks:[],validationSplit:.6}).then(t=>(Tm("body").find("*").removeAttr("disabled"),Tm("body").find("a").unbind("click"),console.log(t),console.log("training complete: mae:",t.history.mse.slice(-1)),this.predict())).catch(t=>{Tm("body").find("*").removeAttr("disabled"),Tm("body").find("a").unbind("click"),console.log(t)}))}predict(){let t=this.selectedData.slice(-1)[0],e=[];for(let n=0;n<6;n++){let n=this.Model.predict(Fy(t,[1,1])),r=n.toString().substring(14,n.toString().length-4);e.push(parseFloat(r)),t=parseFloat(r)}return console.log(e),e}ngOnDestroy(){this.receivedData_sub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Ae(CP))},t.\u0275prov=jt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();try{vP="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(o9){vP=!1}let IP,kP=(()=>{class t{constructor(t){this._platformId=t,this.isBrowser=this._platformId?"browser"===this._platformId:"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!vP)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(Ae($u,8))},t.\u0275prov=jt({factory:function(){return new t(Ae($u,8))},token:t,providedIn:"root"}),t})(),EP=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})();const AP=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function TP(){if(IP)return IP;if("object"!=typeof document||!document)return IP=new Set(AP),IP;let t=document.createElement("input");return IP=new Set(AP.filter(e=>(t.setAttribute("type",e),t.type===e))),IP}let RP,MP,NP;function OP(t){return function(){if(null==RP&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>RP=!0}))}finally{RP=RP||!1}return RP}()?t:!!t.capture}function PP(){if("object"!=typeof document||!document)return 0;if(null==MP){const t=document.createElement("div"),e=t.style;t.dir="rtl",e.height="1px",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const n=document.createElement("div"),r=n.style;r.width="2px",r.height="1px",t.appendChild(n),document.body.appendChild(t),MP=0,0===t.scrollLeft&&(t.scrollLeft=1,MP=0===t.scrollLeft?1:2),t.parentNode.removeChild(t)}return MP}function FP(t){if(function(){if(null==NP){const t="undefined"!=typeof document?document.head:null;NP=!(!t||!t.createShadowRoot&&!t.attachShadow)}return NP}()){const e=t.getRootNode?t.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function LP(t){return null!=t&&"false"!==`${t}`}function zP(t,e=0){return function(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):e}function $P(t){return Array.isArray(t)?t:[t]}function BP(t){return null==t?"":"string"==typeof t?t:`${t}px`}function WP(t){return t instanceof yl?t.nativeElement:t}function qP(t,e,n,r){return L(n)&&(r=n,n=void 0),r?qP(t,e,n).pipe(yt(t=>q(t)?r(...t):r(t))):new tt(r=>{!function t(e,n,r,i,a){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){const t=e;e.addEventListener(n,r,a),s=()=>t.removeEventListener(n,r,a)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){const t=e;e.on(n,r),s=()=>t.off(n,r)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){const t=e;e.addListener(n,r),s=()=>t.removeListener(n,r)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let s=0,o=e.length;s<o;s++)t(e[s],n,r,i,a)}i.add(s)}(t,e,(function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),r,n)})}class VP extends j{constructor(t,e){super()}schedule(t,e=0){return this}}class UP extends VP{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let jP=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class HP extends jP{constructor(t,e=jP.now){super(t,()=>HP.delegate&&HP.delegate!==this?HP.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return HP.delegate&&HP.delegate!==this?HP.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}function GP(t,e){return n=>n.lift(new JP(t,e))}class JP{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new XP(t,this.compare,this.keySelector))}}class XP extends J{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(s9){return this.destination.error(s9)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(s9){return this.destination.error(s9)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}const KP=new HP(UP);class ZP{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new YP(t,this.durationSelector))}}class YP extends gt{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let e;try{const{durationSelector:n}=this;e=n(t)}catch(s9){return this.destination.error(s9)}const n=mt(this,e);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}clearThrottle(){const{value:t,hasValue:e,throttled:n}=this;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))}notifyNext(t,e,n,r){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function QP(t){return!q(t)&&t-parseFloat(t)+1>=0}function tF(t=0,e,n){let r=-1;return QP(e)?r=Number(e)<1?1:Number(e):ot(e)&&(n=e),ot(n)||(n=KP),new tt(e=>{const i=QP(t)?t:+t-n.now();return n.schedule(eF,i,{index:0,period:r,subscriber:e})})}function eF(t){const{index:e,period:n,subscriber:r}=t;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}function nF(t,e=KP){return n=()=>tF(t,e),function(t){return t.lift(new ZP(n))};var n}function rF(t){return e=>e.lift(new iF(t))}class iF{constructor(t){this.notifier=t}call(t,e){const n=new aF(t),r=mt(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class aF extends gt{constructor(t){super(t),this.seenValue=!1}notifyNext(t,e,n,r,i){this.seenValue=!0,this.complete()}notifyComplete(){}}const sF=new _e("cdk-dir-doc",{providedIn:"root",factory:function(){return Te(Nc)}});let oF=(()=>{class t{constructor(t){if(this.value="ltr",this.change=new cu,t){const e=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||e;this.value="ltr"===n||"rtl"===n?n:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(Ae(sF,8))},t.\u0275prov=jt({factory:function(){return new t(Ae(sF,8))},token:t,providedIn:"root"}),t})(),lF=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})();class uF{constructor(t=!1,e,n=!0){this._multiple=t,this._emitChanges=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new at,e&&e.length&&(t?e.forEach(t=>this._markSelected(t)):this._markSelected(e[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...t){this._verifyValueAssignment(t),t.forEach(t=>this._markSelected(t)),this._emitChangeEvent()}deselect(...t){this._verifyValueAssignment(t),t.forEach(t=>this._unmarkSelected(t)),this._emitChangeEvent()}toggle(t){this.isSelected(t)?this.deselect(t):this.select(t)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(t){return this._selection.has(t)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){this.isSelected(t)||(this._multiple||this._unmarkAll(),this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){if(t.length>1&&!this._multiple)throw Error("Cannot pass multiple values into SelectionModel with single-value mode.")}}let cF=(()=>{class t{constructor(t,e,n){this._ngZone=t,this._platform=e,this._scrolled=new at,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new tt(e=>{this._globalSubscription||this._addGlobalListener();const n=t>0?this._scrolled.pipe(nF(t)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Gh()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(t,e){const n=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe(rd(t=>!t||n.indexOf(t)>-1))}getAncestorScrollContainers(t){const e=[];return this.scrollContainers.forEach((n,r)=>{this._scrollableContainsElement(r,t)&&e.push(r)}),e}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_scrollableContainsElement(t,e){let n=e.nativeElement,r=t.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>qP(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(Ae(ec),Ae(kP),Ae(Nc,8))},t.\u0275prov=jt({factory:function(){return new t(Ae(ec),Ae(kP),Ae(Nc,8))},token:t,providedIn:"root"}),t})(),hF=(()=>{class t{constructor(t,e,n,r){this.elementRef=t,this.scrollDispatcher=e,this.ngZone=n,this.dir=r,this._destroyed=new at,this._elementScrolled=new tt(t=>this.ngZone.runOutsideAngular(()=>qP(this.elementRef.nativeElement,"scroll").pipe(rF(this._destroyed)).subscribe(t)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const e=this.elementRef.nativeElement,n=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=n?t.end:t.start),null==t.right&&(t.right=n?t.start:t.end),null!=t.bottom&&(t.top=e.scrollHeight-e.clientHeight-t.bottom),n&&0!=PP()?(null!=t.left&&(t.right=e.scrollWidth-e.clientWidth-t.left),2==PP()?t.left=t.right:1==PP()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=e.scrollWidth-e.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const e=this.elementRef.nativeElement;"object"==typeof document&&"scrollBehavior"in document.documentElement.style?e.scrollTo(t):(null!=t.top&&(e.scrollTop=t.top),null!=t.left&&(e.scrollLeft=t.left))}measureScrollOffset(t){const e=this.elementRef.nativeElement;if("top"==t)return e.scrollTop;if("bottom"==t)return e.scrollHeight-e.clientHeight-e.scrollTop;const n=this.dir&&"rtl"==this.dir.value;return"start"==t?t=n?"right":"left":"end"==t&&(t=n?"left":"right"),n&&2==PP()?"left"==t?e.scrollWidth-e.clientWidth-e.scrollLeft:e.scrollLeft:n&&1==PP()?"left"==t?e.scrollLeft+e.scrollWidth-e.clientWidth:-e.scrollLeft:"left"==t?e.scrollLeft:e.scrollWidth-e.clientWidth-e.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(cF),to(ec),to(oF,8))},t.\u0275dir=tn({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),t})(),dF=(()=>{class t{constructor(t,e,n){this._platform=t,this._document=n,e.runOutsideAngular(()=>{const e=this._getWindow();this._change=t.isBrowser?kt(qP(e,"resize"),qP(e,"orientationchange")):Gh(),this._invalidateCache=this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){this._invalidateCache.unsubscribe()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:e,height:n}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+n,right:t.left+e,height:n,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._getDocument(),e=this._getWindow(),n=t.documentElement,r=n.getBoundingClientRect();return{top:-r.top||t.body.scrollTop||e.scrollY||n.scrollTop||0,left:-r.left||t.body.scrollLeft||e.scrollX||n.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(nF(t)):this._change}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(Ae(kP),Ae(ec),Ae(Nc,8))},t.\u0275prov=jt({factory:function(){return new t(Ae(kP),Ae(ec),Ae(Nc,8))},token:t,providedIn:"root"}),t})(),pF=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})(),fF=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[lF,EP,pF],lF,pF]}),t})();function mF(t,...e){return e.length?e.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}function gF(t,e=KP){return n=>n.lift(new yF(t,e))}class yF{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new vF(t,this.dueTime,this.scheduler))}}class vF extends J{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(_F,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function _F(t){t.debouncedNext()}let bF=(()=>{class t{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),xF=(()=>{class t{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,e)=>this._cleanupObserver(e))}observe(t){const e=WP(t);return new tt(t=>{const n=this._observeElement(e).subscribe(t);return()=>{n.unsubscribe(),this._unobserveElement(e)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const e=new at,n=this._mutationObserverFactory.create(t=>e.next(t));n&&n.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:n,stream:e,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:e,stream:n}=this._observedElements.get(t);e&&e.disconnect(),n.complete(),this._observedElements.delete(t)}}}return t.\u0275fac=function(e){return new(e||t)(Ae(bF))},t.\u0275prov=jt({factory:function(){return new t(Ae(bF))},token:t,providedIn:"root"}),t})(),wF=(()=>{class t{constructor(t,e,n){this._contentObserver=t,this._elementRef=e,this._ngZone=n,this.event=new cu,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=LP(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=zP(t),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(gF(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription&&this._currentSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(to(xF),to(yl),to(ec))},t.\u0275dir=tn({type:t,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),t})(),SF=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[bF]}),t})();class CF{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new at,this._typeaheadSubscription=j.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new at,this.change=new at,t instanceof du&&t.changes.subscribe(t=>{if(this._activeItem){const e=t.toArray().indexOf(this._activeItem);e>-1&&e!==this._activeItemIndex&&(this._activeItemIndex=e)}})}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){if(this._items.length&&this._items.some(t=>"function"!=typeof t.getLabel))throw Error("ListKeyManager items in typeahead mode must implement the `getLabel` method.");return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Ld(t=>this._pressedLetters.push(t)),gF(t),rd(()=>this._pressedLetters.length>0),yt(()=>this._pressedLetters.join(""))).subscribe(t=>{const e=this._getItemsArray();for(let n=1;n<e.length+1;n++){const r=(this._activeItemIndex+n)%e.length,i=e[r];if(!this._skipPredicateFn(i)&&0===i.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(r);break}}this._pressedLetters=[]}),this}setActiveItem(t){const e=this._activeItemIndex;this.updateActiveItem(t),this._activeItemIndex!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,n=["altKey","ctrlKey","metaKey","shiftKey"].every(e=>!t[e]||this._allowedModifierKeys.indexOf(e)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&n){this.setNextItemActive();break}return;case 38:if(this._vertical&&n){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&n){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&n){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;default:return void((n||mF(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t),r=e[n];this._activeItem=null==r?null:r,this._activeItemIndex=n}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let n=1;n<=e.length;n++){const r=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof du?this._items.toArray():this._items}}class DF extends CF{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class IF extends CF{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let kF=(()=>{class t{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const e=function(t){try{return t.frameElement}catch(o9){return null}}((n=t).ownerDocument&&n.ownerDocument.defaultView||window);var n;if(e){const t=e&&e.nodeName.toLowerCase();if(-1===AF(e))return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&"object"===t)return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&!this.isVisible(e))return!1}let r=t.nodeName.toLowerCase(),i=AF(t);if(t.hasAttribute("contenteditable"))return-1!==i;if("iframe"===r)return!1;if("audio"===r){if(!t.hasAttribute("controls"))return!1;if(this._platform.BLINK)return!0}if("video"===r){if(!t.hasAttribute("controls")&&this._platform.TRIDENT)return!1;if(this._platform.BLINK||this._platform.FIREFOX)return!0}return("object"!==r||!this._platform.BLINK&&!this._platform.WEBKIT)&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(t){let e=t.nodeName.toLowerCase(),n="input"===e&&t.type;return"text"===n||"password"===n||"select"===e||"textarea"===e}(t))&&t.tabIndex>=0}isFocusable(t){return function(t){return!function(t){return function(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function(t){let e=t.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(t)||function(t){return function(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||EF(t))}(t)&&!this.isDisabled(t)&&this.isVisible(t)}}return t.\u0275fac=function(e){return new(e||t)(Ae(kP))},t.\u0275prov=jt({factory:function(){return new t(Ae(kP))},token:t,providedIn:"root"}),t})();function EF(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let e=t.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function AF(t){if(!EF(t))return null;const e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class TF{constructor(t,e,n,r,i=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,i||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),e&&(e.removeEventListener("focus",this.endAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),this._startAnchor=this._endAnchor=null}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement()))})}focusFirstTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement()))})}focusLastTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement()))})}_getRegionBoundary(t){let e=this._element.querySelectorAll(`[cdk-focus-region-${t}], `+`[cdkFocusRegion${t}], `+`[cdk-focus-${t}]`);for(let n=0;n<e.length;n++)e[n].hasAttribute(`cdk-focus-${t}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${t}', `+`use 'cdkFocusRegion${t}' instead. The deprecated `+"attribute will be removed in 8.0.0.",e[n]):e[n].hasAttribute(`cdk-focus-region-${t}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${t}', `+`use 'cdkFocusRegion${t}' instead. The deprecated attribute `+"will be removed in 8.0.0.",e[n]);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");return t?(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),ti()&&!this._checker.isFocusable(t)&&console.warn("Element matching '[cdkFocusInitial]' is not focusable.",t),t.focus(),!0):this.focusFirstTabbableElement()}focusFirstTabbableElement(){const t=this._getRegionBoundary("start");return t&&t.focus(),!!t}focusLastTabbableElement(){const t=this._getRegionBoundary("end");return t&&t.focus(),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=0;n<e.length;n++){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(t)return t}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=e.length-1;n>=0;n--){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(t)return t}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.asObservable().pipe(xd(1)).subscribe(t)}}let RF=(()=>{class t{constructor(t,e,n){this._checker=t,this._ngZone=e,this._document=n}create(t,e=!1){return new TF(t,this._checker,this._ngZone,this._document,e)}}return t.\u0275fac=function(e){return new(e||t)(Ae(kF),Ae(ec),Ae(Nc))},t.\u0275prov=jt({factory:function(){return new t(Ae(kF),Ae(ec),Ae(Nc))},token:t,providedIn:"root"}),t})();"undefined"!=typeof Element&&Element;const MF=new _e("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),NF=new _e("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let OF=(()=>{class t{constructor(t,e,n,r){this._ngZone=e,this._defaultOptions=r,this._document=n,this._liveElement=t||this._createLiveElement()}announce(t,...e){const n=this._defaultOptions;let r,i;return 1===e.length&&"number"==typeof e[0]?i=e[0]:[r,i]=e,this.clear(),clearTimeout(this._previousTimeout),r||(r=n&&n.politeness?n.politeness:"polite"),null==i&&n&&(i=n.duration),this._liveElement.setAttribute("aria-live",r),this._ngZone.runOutsideAngular(()=>new Promise(e=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,e(),"number"==typeof i&&(this._previousTimeout=setTimeout(()=>this.clear(),i))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}_createLiveElement(){const t=this._document.getElementsByClassName("cdk-live-announcer-element"),e=this._document.createElement("div");for(let n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return e.classList.add("cdk-live-announcer-element"),e.classList.add("cdk-visually-hidden"),e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),this._document.body.appendChild(e),e}}return t.\u0275fac=function(e){return new(e||t)(Ae(MF,8),Ae(ec),Ae(Nc),Ae(NF,8))},t.\u0275prov=jt({factory:function(){return new t(Ae(MF,8),Ae(ec),Ae(Nc),Ae(NF,8))},token:t,providedIn:"root"}),t})();function PF(t){return 0===t.buttons}const FF=new _e("cdk-focus-monitor-default-options"),LF=OP({passive:!0,capture:!0});let zF=(()=>{class t{constructor(t,e,n,r){this._ngZone=t,this._platform=e,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._documentKeydownListener=()=>{this._lastTouchTarget=null,this._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=t=>{if(!this._lastTouchTarget){const e=PF(t)?"keyboard":"mouse";this._setOriginForCurrentEventQueue(e)}},this._documentTouchstartListener=t=>{null!=this._touchTimeoutId&&clearTimeout(this._touchTimeoutId),this._lastTouchTarget=$F(t),this._touchTimeoutId=setTimeout(()=>this._lastTouchTarget=null,650)},this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._rootNodeFocusAndBlurListener=t=>{const e=$F(t),n="focus"===t.type?this._onFocus:this._onBlur;for(let r=e;r;r=r.parentElement)n.call(this,t,r)},this._document=n,this._detectionMode=(null==r?void 0:r.detectionMode)||0}monitor(t,e=!1){if(!this._platform.isBrowser)return Gh(null);const n=WP(t),r=FP(n)||this._getDocument(),i=this._elementInfo.get(n);if(i)return e&&(i.checkChildren=!0),i.subject.asObservable();const a={checkChildren:e,subject:new at,rootNode:r};return this._elementInfo.set(n,a),this._registerGlobalListeners(a),a.subject.asObservable()}stopMonitoring(t){const e=WP(t),n=this._elementInfo.get(e);n&&(n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._removeGlobalListeners(n))}focusVia(t,e,n){const r=WP(t);this._setOriginForCurrentEventQueue(e),"function"==typeof r.focus&&r.focus(n)}ngOnDestroy(){this._elementInfo.forEach((t,e)=>this.stopMonitoring(e))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,e,n){n?t.classList.add(e):t.classList.remove(e)}_getFocusOrigin(t){return this._origin?this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(t)?"touch":"program"}_setClasses(t,e){this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e)}_setOriginForCurrentEventQueue(t){this._ngZone.runOutsideAngular(()=>{this._origin=t,0===this._detectionMode&&(this._originTimeoutId=setTimeout(()=>this._origin=null,1))})}_wasCausedByTouch(t){const e=$F(t);return this._lastTouchTarget instanceof Node&&e instanceof Node&&(e===this._lastTouchTarget||e.contains(this._lastTouchTarget))}_onFocus(t,e){const n=this._elementInfo.get(e);if(!n||!n.checkChildren&&e!==$F(t))return;const r=this._getFocusOrigin(t);this._setClasses(e,r),this._emitOrigin(n.subject,r),this._lastFocusOrigin=r}_onBlur(t,e){const n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}_emitOrigin(t,e){this._ngZone.run(()=>t.next(e))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const e=t.rootNode,n=this._rootNodeFocusListenerCount.get(e)||0;n||this._ngZone.runOutsideAngular(()=>{e.addEventListener("focus",this._rootNodeFocusAndBlurListener,LF),e.addEventListener("blur",this._rootNodeFocusAndBlurListener,LF)}),this._rootNodeFocusListenerCount.set(e,n+1),1==++this._monitoredElementCount&&this._ngZone.runOutsideAngular(()=>{const t=this._getDocument(),e=this._getWindow();t.addEventListener("keydown",this._documentKeydownListener,LF),t.addEventListener("mousedown",this._documentMousedownListener,LF),t.addEventListener("touchstart",this._documentTouchstartListener,LF),e.addEventListener("focus",this._windowFocusListener)})}_removeGlobalListeners(t){const e=t.rootNode;if(this._rootNodeFocusListenerCount.has(e)){const t=this._rootNodeFocusListenerCount.get(e);t>1?this._rootNodeFocusListenerCount.set(e,t-1):(e.removeEventListener("focus",this._rootNodeFocusAndBlurListener,LF),e.removeEventListener("blur",this._rootNodeFocusAndBlurListener,LF),this._rootNodeFocusListenerCount.delete(e))}if(!--this._monitoredElementCount){const t=this._getDocument(),e=this._getWindow();t.removeEventListener("keydown",this._documentKeydownListener,LF),t.removeEventListener("mousedown",this._documentMousedownListener,LF),t.removeEventListener("touchstart",this._documentTouchstartListener,LF),e.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId)}}}return t.\u0275fac=function(e){return new(e||t)(Ae(ec),Ae(kP),Ae(Nc,8),Ae(FF,8))},t.\u0275prov=jt({factory:function(){return new t(Ae(ec),Ae(kP),Ae(Nc,8),Ae(FF,8))},token:t,providedIn:"root"}),t})();function $F(t){return t.composedPath?t.composedPath()[0]:t.target}let BF=(()=>{class t{constructor(t,e){this._elementRef=t,this._focusMonitor=e,this.cdkFocusChange=new cu,this._monitorSubscription=this._focusMonitor.monitor(this._elementRef,this._elementRef.nativeElement.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(t=>this.cdkFocusChange.emit(t))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(zF))},t.\u0275dir=tn({type:t,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),t})(),WF=(()=>{class t{constructor(t,e){this._platform=t,this._document=e}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const e=this._document.defaultView||window,n=e&&e.getComputedStyle?e.getComputedStyle(t):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),r){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove("cdk-high-contrast-active"),t.remove("cdk-high-contrast-black-on-white"),t.remove("cdk-high-contrast-white-on-black");const e=this.getHighContrastMode();1===e?(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-black-on-white")):2===e&&(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-white-on-black"))}}}return t.\u0275fac=function(e){return new(e||t)(Ae(kP),Ae(Nc))},t.\u0275prov=jt({factory:function(){return new t(Ae(kP),Ae(Nc))},token:t,providedIn:"root"}),t})(),qF=(()=>{class t{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)(Ae(WF))},imports:[[EP,SF]]}),t})();const VF=new Cl("9.2.4");class UF{}function jF(t,e){return{type:7,name:t,definitions:e,options:{}}}function HF(t,e=null){return{type:4,styles:e,timings:t}}function GF(t,e=null){return{type:2,steps:t,options:e}}function JF(t){return{type:6,styles:t,offset:null}}function XF(t,e,n){return{type:0,name:t,styles:e,options:n}}function KF(t,e,n=null){return{type:1,expr:t,animation:e,options:n}}function ZF(t=null){return{type:9,options:t}}function YF(t,e,n=null){return{type:11,selector:t,animation:e,options:n}}function QF(t){Promise.resolve(null).then(t)}class tL{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){QF(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){}getPosition(){return 0}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class eL{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const i=this.players.length;0==i?QF(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==i&&this._onFinish()}),t.onDestroy(()=>{++n==i&&this._onDestroy()}),t.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){let t=0;return this.players.forEach(e=>{const n=e.getPosition();t=Math.min(n,t)}),t}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}function nL(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function rL(t){switch(t.length){case 0:return new tL;case 1:return t[0];default:return new eL(t)}}function iL(t,e,n,r,i={},a={}){const s=[],o=[];let l=-1,u=null;if(r.forEach(t=>{const n=t.offset,r=n==l,c=r&&u||{};Object.keys(t).forEach(n=>{let r=n,o=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,s),o){case"!":o=i[n];break;case"*":o=a[n];break;default:o=e.normalizeStyleValue(n,r,o,s)}c[r]=o}),r||o.push(c),u=c,l=n}),s.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${s.join(t)}`)}return o}function aL(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&sL(n,"start",t)));break;case"done":t.onDone(()=>r(n&&sL(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&sL(n,"destroy",t)))}}function sL(t,e,n){const r=n.totalTime,i=oL(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),a=t._data;return null!=a&&(i._data=a),i}function oL(t,e,n,r,i="",a=0,s){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!s}}function lL(t,e,n){let r;return t instanceof Map?(r=t.get(e),r||t.set(e,r=n)):(r=t[e],r||(r=t[e]=n)),r}function uL(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let cL=(t,e)=>!1,hL=(t,e)=>!1,dL=(t,e,n)=>[];const pL=nL();(pL||"undefined"!=typeof Element)&&(cL=(t,e)=>t.contains(e),hL=(()=>{if(pL||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):hL}})(),dL=(t,e,n)=>{let r=[];if(n)r.push(...t.querySelectorAll(e));else{const n=t.querySelector(e);n&&r.push(n)}return r});let fL=null,mL=!1;function gL(t){fL||(fL=("undefined"!=typeof document?document.body:null)||{},mL=!!fL.style&&"WebkitAppearance"in fL.style);let e=!0;return fL.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in fL.style,!e&&mL)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in fL.style),e}const yL=hL,vL=cL,_L=dL;function bL(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}let xL=(()=>{class t{validateStyleProperty(t){return gL(t)}matchesElement(t,e){return yL(t,e)}containsElement(t,e){return vL(t,e)}query(t,e,n){return _L(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,i,a=[],s){return new tL(n,r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),wL=(()=>{class t{}return t.NOOP=new xL,t})();function SL(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:CL(parseFloat(e[1]),e[2])}function CL(t,e){switch(e){case"s":return 1e3*t;default:return t}}function DL(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,i=0,a="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=CL(parseFloat(n[1]),n[2]);const s=n[3];null!=s&&(i=CL(parseFloat(s),n[4]));const o=n[5];o&&(a=o)}else r=t;if(!n){let n=!1,a=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(a,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:i,easing:a}}(t,e,n)}function IL(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function kL(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else IL(t,n);return n}function EL(t,e,n){return n?e+":"+n+";":""}function AL(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=EL(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=EL(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function TL(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=zL(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),nL()&&AL(t))}function RL(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=zL(e);t.style[n]=""}),nL()&&AL(t))}function ML(t){return Array.isArray(t)?1==t.length?t[0]:GF(t):t}const NL=new RegExp("{{\\s*(.+?)\\s*}}","g");function OL(t){let e=[];if("string"==typeof t){let n;for(;n=NL.exec(t);)e.push(n[1]);NL.lastIndex=0}return e}function PL(t,e,n){const r=t.toString(),i=r.replace(NL,(t,r)=>{let i=e[r];return e.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?t:i}function FL(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const LL=/-+([a-z0-9])/g;function zL(t){return t.replace(LL,(...t)=>t[1].toUpperCase())}function $L(t,e){return 0===t||0===e}function BL(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let a=e[0],s=[];if(r.forEach(t=>{a.hasOwnProperty(t)||s.push(t),a[t]=n[t]}),s.length)for(var i=1;i<e.length;i++){let n=e[i];s.forEach((function(e){n[e]=qL(t,e)}))}}return e}function WL(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function qL(t,e){return window.getComputedStyle(t)[e]}function VL(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const i=r[1],a=r[2],s=r[3];e.push(HL(i,s)),"<"!=a[0]||"*"==i&&"*"==s||e.push(HL(s,i))}(t,n,e)):n.push(t),n}const UL=new Set(["true","1"]),jL=new Set(["false","0"]);function HL(t,e){const n=UL.has(t)||jL.has(t),r=UL.has(e)||jL.has(e);return(i,a)=>{let s="*"==t||t==i,o="*"==e||e==a;return!s&&n&&"boolean"==typeof i&&(s=i?UL.has(t):jL.has(t)),!o&&r&&"boolean"==typeof a&&(o=a?UL.has(e):jL.has(e)),s&&o}}const GL=new RegExp("s*:selfs*,?","g");function JL(t,e,n){return new XL(t).build(e,n)}class XL{constructor(t){this._driver=t}build(t,e){const n=new KL(e);return this._resetContextStyleTimingState(n),WL(this,ML(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const i=[],a=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,i.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const i=this.visitTransition(t,e);n+=i.queryCount,r+=i.depCount,a.push(i)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:i,transitions:a,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const i=new Set,a=r||{};if(n.styles.forEach(t=>{if(ZL(t)){const e=t;Object.keys(e).forEach(t=>{OL(e[t]).forEach(t=>{a.hasOwnProperty(t)||i.add(t)})})}}),i.size){const n=FL(i.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=WL(this,ML(t.animation),e);return{type:1,matchers:VL(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:YL(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>WL(this,t,e)),options:YL(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const i=t.steps.map(t=>{e.currentTime=n;const i=WL(this,t,e);return r=Math.max(r,e.currentTime),i});return e.currentTime=r,{type:3,steps:i,options:YL(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return QL(DL(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=QL(0,0,"");return t.dynamic=!0,t.strValue=r,t}return n=n||DL(r,e),QL(n.duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let i=t.styles?t.styles:JF({});if(5==i.type)r=this.visitKeyframes(i,e);else{let i=t.styles,a=!1;if(!i){a=!0;const t={};n.easing&&(t.easing=n.easing),i=JF(t)}e.currentTime+=n.duration+n.delay;const s=this.visitStyle(i,e);s.isEmptyStep=a,r=s}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?"*"==t?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,i=null;return n.forEach(t=>{if(ZL(t)){const e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,i=e.currentTime;n&&i>0&&(i-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const a=e.collectedStyles[e.currentQuerySelector],s=a[n];let o=!0;s&&(i!=r&&i>=s.startTime&&r<=s.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${s.startTime}ms" and "${s.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),o=!1),i=s.startTime),o&&(a[n]={startTime:i,endTime:r}),e.options&&function(t,e,n){const r=e.params||{},i=OL(t);i.length&&i.forEach(t=>{r.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let a=!1,s=!1,o=0;const l=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let l=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(ZL(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(ZL(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),u=0;return null!=l&&(r++,u=n.offset=l),s=s||u<0||u>1,a=a||u<o,o=u,i.push(u),n});s&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),a&&e.errors.push("Please ensure that all keyframe offsets are in order");const u=t.steps.length;let c=0;r>0&&r<u?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(c=1/(u-1));const h=u-1,d=e.currentTime,p=e.currentAnimateTimings,f=p.duration;return l.forEach((t,r)=>{const a=c>0?r==h?1:c*r:i[r],s=a*f;e.currentTime=d+p.delay+s,p.duration=s,this._validateStyleAst(t,e),t.offset=a,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:WL(this,ML(t.animation),e),options:YL(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:YL(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:YL(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[i,a]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(GL,"")),[t=t.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,t=>".ng-trigger-"+t.substr(1)).replace(/:animating/g,".ng-animating"),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+i:i,lL(e.collectedStyles,e.currentQuerySelector,{});const s=WL(this,ML(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:s,originalSelector:t.selector,options:YL(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:DL(t.timings,e.errors,!0);return{type:12,animation:WL(this,ML(t.animation),e),timings:n,options:null}}}class KL{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function ZL(t){return!Array.isArray(t)&&"object"==typeof t}function YL(t){var e;return t?(t=IL(t)).params&&(t.params=(e=t.params)?IL(e):null):t={},t}function QL(t,e,n){return{duration:t,delay:e,easing:n}}function tz(t,e,n,r,i,a,s=null,o=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:s,subTimeline:o}}class ez{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const nz=new RegExp(":enter","g"),rz=new RegExp(":leave","g");function iz(t,e,n,r,i,a={},s={},o,l,u=[]){return(new az).buildKeyframes(t,e,n,r,i,a,s,o,l,u)}class az{buildKeyframes(t,e,n,r,i,a,s,o,l,u=[]){l=l||new ez;const c=new oz(t,e,l,r,i,u,[]);c.options=o,c.currentTimeline.setStyles([a],null,c.errors,o),WL(this,n,c);const h=c.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(s).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([s],null,c.errors,o)}return h.length?h.map(t=>t.buildKeyframes()):[tz(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&e.transformIntoNewTimeline(a)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const i=null!=n.duration?SL(n.duration):null,a=null!=n.delay?SL(n.delay):null;return 0!==i&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,i,a);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),WL(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const i=t.options;if(i&&(i.params||i.delay)&&(r=e.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=sz);const t=SL(i.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>WL(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?SL(t.options.delay):0;t.steps.forEach(a=>{const s=e.createSubContext(t.options);i&&s.delayNextStep(i),WL(this,a,s),r=Math.max(r,s.currentTimeline.currentTime),n.push(s.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return DL(e.params?PL(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,a=e.createSubContext().currentTimeline;a.easing=n.easing,t.styles.forEach(t=>{a.forwardTime((t.offset||0)*i),a.setStyles(t.styles,t.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+i),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},i=r.delay?SL(r.delay):0;i&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=sz);let a=n;const s=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=s.length;let o=null;s.forEach((n,r)=>{e.currentQueryIndex=r;const s=e.createSubContext(t.options,n);i&&s.delayNextStep(i),n===e.element&&(o=s.currentTimeline),WL(this,t.animation,s),s.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,s.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),o&&(e.currentTimeline.mergeTimelineCollectedStyles(o),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,i=t.timings,a=Math.abs(i.duration),s=a*(e.currentQueryTotal-1);let o=a*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":o=s-o;break;case"full":o=n.currentStaggerTime}const l=e.currentTimeline;o&&l.delayNextStep(o);const u=l.currentTime;WL(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-u+(r.startTime-n.currentTimeline.startTime)}}const sz={};class oz{constructor(t,e,n,r,i,a,s,o){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=a,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=sz,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=o||new lz(this._driver,e,0),s.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=SL(n.duration)),null!=n.delay&&(r.delay=SL(n.delay));const i=n.params;if(i){let t=r.params;t||(t=this.options.params={}),Object.keys(i).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=PL(i[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,i=new oz(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=sz,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new uz(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,i,a){let s=[];if(r&&s.push(this.element),t.length>0){t=(t=t.replace(nz,"."+this._enterClassName)).replace(rz,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),s.push(...e)}return i||0!=s.length||a.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),s}}class lz{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new lz(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||"*",this._currentKeyframe[t]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const i=r&&r.params||{},a=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e),r.forEach(t=>{n[t]="*"})):kL(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(a).forEach(t=>{const e=PL(a[t],i,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:"*"),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,a)=>{const s=kL(i,!0);Object.keys(s).forEach(n=>{const r=s[n];"!"==r?t.add(n):"*"==r&&e.add(n)}),n||(s.offset=a/this.duration),r.push(s)});const i=t.size?FL(t.values()):[],a=e.size?FL(e.values()):[];if(n){const t=r[0],e=IL(t);t.offset=0,e.offset=1,r=[t,e]}return tz(this.element,r,i,a,this.duration,this.startTime,this.easing,!1)}}class uz extends lz{constructor(t,e,n,r,i,a,s=!1){super(t,e,a.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=s,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],a=n+e,s=e/a,o=kL(t[0],!1);o.offset=0,i.push(o);const l=kL(t[0],!1);l.offset=cz(s),i.push(l);const u=t.length-1;for(let r=1;r<=u;r++){let s=kL(t[r],!1);s.offset=cz((e+s.offset*n)/a),i.push(s)}n=a,e=0,r="",t=i}return tz(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function cz(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class hz{}class dz extends hz{normalizePropertyName(t,e){return zL(t)}normalizeStyleValue(t,e,n,r){let i="";const a=n.toString().trim();if(pz[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return a+i}}const pz=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function fz(t,e,n,r,i,a,s,o,l,u,c,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:s,timelines:o,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:h,errors:d}}const mz={};class gz{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,i){return t.some(t=>t(e,n,r,i))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],i=this._stateStyles[t],a=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):a}build(t,e,n,r,i,a,s,o,l,u){const c=[],h=this.ast.options&&this.ast.options.params||mz,d=this.buildStyles(n,s&&s.params||mz,c),p=o&&o.params||mz,f=this.buildStyles(r,p,c),m=new Set,g=new Map,y=new Map,v="void"===r,_={params:Object.assign(Object.assign({},h),p)},b=u?[]:iz(t,e,this.ast.animation,i,a,d,f,_,l,c);let x=0;if(b.forEach(t=>{x=Math.max(t.duration+t.delay,x)}),c.length)return fz(e,this._triggerName,n,r,v,d,f,[],[],g,y,x,c);b.forEach(t=>{const n=t.element,r=lL(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const i=lL(y,n,{});t.postStyleProps.forEach(t=>i[t]=!0),n!==e&&m.add(n)});const w=FL(m.values());return fz(e,this._triggerName,n,r,v,d,f,b,w,g,y,x)}}class yz{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=IL(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const i=t;Object.keys(i).forEach(t=>{let a=i[t];a.length>1&&(a=PL(a,r,e)),n[t]=a})}}),n}}class vz{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new yz(t.style,t.options&&t.options.params||{})}),_z(this.states,"true","1"),_z(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new gz(t,e,this.states))}),this.fallbackTransition=new gz(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(i=>i.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function _z(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const bz=new ez;class xz{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=JL(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,i=iL(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],i=this._animations[t];let a;const s=new Map;if(i?(a=iz(this._driver,e,i,"ng-enter","ng-leave",{},{},n,bz,r),a.forEach(t=>{const e=lL(s,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),a=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);s.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,"*")})});const o=rL(a.map(t=>{const e=s.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=o,o.onDestroy(()=>this.destroy(t)),this.players.push(o),o}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,r){const i=oL(e,"","","");return aL(this._getPlayer(t),n,i,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const wz=[],Sz={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Cz={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class Dz{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=null!=(r=n?t.value:t)?r:null,n){const e=IL(t);delete e.value,this.options=e}else this.options={};var r;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const Iz=new Dz("void");class kz{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Oz(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var i;const a=lL(this._elementListeners,t,[]),s={name:e,phase:n,callback:r};a.push(s);const o=lL(this._engine.statesByElement,t,{});return o.hasOwnProperty(e)||(Oz(t,"ng-trigger"),Oz(t,"ng-trigger-"+e),o[e]=Iz),()=>{this._engine.afterFlush(()=>{const t=a.indexOf(s);t>=0&&a.splice(t,1),this._triggers[e]||delete o[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const i=this._getTrigger(e),a=new Az(this.id,e,t);let s=this._engine.statesByElement.get(t);s||(Oz(t,"ng-trigger"),Oz(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,s={}));let o=s[e];const l=new Dz(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&o&&l.absorbOptions(o.options),s[e]=l,o||(o=Iz),"void"!==l.value&&o.value===l.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(o.params,l.params)){const e=[],n=i.matchStyles(o.value,o.params,e),r=i.matchStyles(l.value,l.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{RL(t,n),TL(t,r)})}return}const u=lL(this._engine.playersByElement,t,[]);u.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let c=i.matchTransition(o.value,l.value,t,l.params),h=!1;if(!c){if(!r)return;c=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:c,fromState:o,toState:l,player:a,isFallbackTransition:h}),h||(Oz(t,"ng-animate-queued"),a.onStart(()=>{Pz(t,"ng-animate-queued")})),a.onDone(()=>{let e=this.players.indexOf(a);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(a);t>=0&&n.splice(t,1)}}),this.players.push(a),u.push(a),a}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,".ng-trigger",!0);n.forEach(t=>{if(t.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(t=>this.clearElementCache(t)))}triggerLeaveAnimation(t,e,n,r){const i=this._engine.statesByElement.get(t);if(i){const a=[];if(Object.keys(i).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,"void",r);n&&a.push(n)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&rL(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t);if(e){const n=new Set;e.forEach(e=>{const r=e.name;if(n.has(r))return;n.add(r);const i=this._triggers[r].fallbackTransition,a=this._engine.statesByElement.get(t)[r]||Iz,s=new Dz("void"),o=new Az(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:i,fromState:a,toState:s,player:o,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const r=t.__ng_removed;r&&r!==Sz||(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Oz(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,a=this._elementListeners.get(i);a&&a.forEach(e=>{if(e.name==n.triggerName){const r=oL(i,n.triggerName,n.fromState.value,n.toState.value);r._data=t,aL(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class Ez{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new kz(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=n[t[r]].namespaceId;if(i){const t=this._fetchNamespace(i);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(Tz(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!Tz(e))return;const i=e.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Oz(t,"ng-animate-disabled")):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Pz(t,"ng-animate-disabled"))}removeNode(t,e,n,r){if(Tz(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,i){return Tz(e)?this._fetchNamespace(t).listen(e,n,r,i):()=>{}}_buildInstruction(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,".ng-trigger",!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,".ng-animating",!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return rL(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t.__ng_removed;if(e&&e.setForRemoval){if(t.__ng_removed=Sz,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,".ng-animate-disabled")&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Oz(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?rL(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new ez,r=[],i=new Map,a=[],s=new Map,o=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(t=>{u.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)u.add(e[n])});const c=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=Nz(h,this.collectedEnterElements),p=new Map;let f=0;d.forEach((t,e)=>{const n="ng-enter"+f++;p.set(e,n),t.forEach(t=>Oz(t,n))});const m=[],g=new Set,y=new Set;for(let T=0;T<this.collectedLeaveElements.length;T++){const t=this.collectedLeaveElements[T],e=t.__ng_removed;e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):y.add(t))}const v=new Map,_=Nz(h,Array.from(g));_.forEach((t,e)=>{const n="ng-leave"+f++;v.set(e,n),t.forEach(t=>Oz(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=p.get(e);t.forEach(t=>Pz(t,n))}),_.forEach((t,e)=>{const n=v.get(e);t.forEach(t=>Pz(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const b=[],x=[];for(let T=this._namespaceList.length-1;T>=0;T--)this._namespaceList[T].drainQueuedTransitions(e).forEach(t=>{const e=t.player,i=t.element;if(b.push(e),this.collectedEnterElements.length){const t=i.__ng_removed;if(t&&t.setForMove)return void e.destroy()}const u=!c||!this.driver.containsElement(c,i),h=v.get(i),d=p.get(i),f=this._buildInstruction(t,n,d,h,u);if(!f.errors||!f.errors.length)return u||t.isFallbackTransition?(e.onStart(()=>RL(i,f.fromStyles)),e.onDestroy(()=>TL(i,f.toStyles)),void r.push(e)):(f.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(i,f.timelines),a.push({instruction:f,player:e,element:i}),f.queriedElements.forEach(t=>lL(s,t,[]).push(e)),f.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=o.get(e);t||o.set(e,t=new Set),n.forEach(e=>t.add(e))}}),void f.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=l.get(e);r||l.set(e,r=new Set),n.forEach(t=>r.add(t))}));x.push(f)});if(x.length){const t=[];x.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),b.forEach(t=>t.destroy()),this.reportError(t)}const w=new Map,S=new Map;a.forEach(t=>{const e=t.element;n.has(e)&&(S.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,w))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{lL(w,e,[]).push(t),t.destroy()})});const C=m.filter(t=>Lz(t,o,l)),D=new Map;Mz(D,this.driver,y,l,"*").forEach(t=>{Lz(t,o,l)&&C.push(t)});const I=new Map;d.forEach((t,e)=>{Mz(I,this.driver,new Set(t),o,"!")}),C.forEach(t=>{const e=D.get(t),n=I.get(t);D.set(t,Object.assign(Object.assign({},e),n))});const k=[],E=[],A={};a.forEach(t=>{const{element:e,player:a,instruction:s}=t;if(n.has(e)){if(u.has(e))return a.onDestroy(()=>TL(e,s.toStyles)),a.disabled=!0,a.overrideTotalTime(s.totalTime),void r.push(a);let t=A;if(S.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=S.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>S.set(e,t))}const n=this._buildAnimation(a.namespaceId,s,w,i,I,D);if(a.setRealPlayer(n),t===A)k.push(a);else{const e=this.playersByElement.get(t);e&&e.length&&(a.parentPlayer=rL(e)),r.push(a)}}else RL(e,s.fromStyles),a.onDestroy(()=>TL(e,s.toStyles)),E.push(a),u.has(e)&&r.push(a)}),E.forEach(t=>{const e=i.get(t.element);if(e&&e.length){const n=rL(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let T=0;T<m.length;T++){const t=m[T],e=t.__ng_removed;if(Pz(t,"ng-leave"),e&&e.hasAnimation)continue;let n=[];if(s.size){let e=s.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,".ng-animating",!0);for(let t=0;t<r.length;t++){let e=s.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?Fz(this,t,r):this.processLeaveNode(t)}return m.length=0,k.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),k}elementContainsData(t,e){let n=!1;const r=e.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,i){let a=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(a=e)}else{const e=this.playersByElement.get(t);if(e){const t=!i||"void"==i;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&a.push(e)})}}return(n||r)&&(a=a.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),a}_beforeAnimationBuild(t,e,n){const r=e.element,i=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const s of e.timelines){const t=s.element,o=t!==r,l=lL(n,t,[]);this._getPreviousPlayers(t,o,i,a,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),l.push(t)})}RL(r,e.fromStyles)}_buildAnimation(t,e,n,r,i,a){const s=e.triggerName,o=e.element,l=[],u=new Set,c=new Set,h=e.timelines.map(e=>{const h=e.element;u.add(h);const d=h.__ng_removed;if(d&&d.removedBeforeQueried)return new tL(e.duration,e.delay);const p=h!==o,f=function(t){const e=[];return function t(e,n){for(let r=0;r<e.length;r++){const i=e[r];i instanceof eL?t(i.players,n):n.push(i)}}(t,e),e}((n.get(h)||wz).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=i.get(h),g=a.get(h),y=iL(0,this._normalizer,0,e.keyframes,m,g),v=this._buildPlayer(e,y,f);if(e.subTimeline&&r&&c.add(h),p){const e=new Az(t,s,h);e.setRealPlayer(v),l.push(e)}return v});l.forEach(t=>{lL(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e),r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e],r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r}(this.playersByQueriedElement,t.element,t))}),u.forEach(t=>Oz(t,"ng-animating"));const d=rL(h);return d.onDestroy(()=>{u.forEach(t=>Pz(t,"ng-animating")),TL(o,e.toStyles)}),c.forEach(t=>{lL(r,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new tL(t.duration,t.delay)}}class Az{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new tL,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>aL(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){lL(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Tz(t){return t&&1===t.nodeType}function Rz(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function Mz(t,e,n,r,i){const a=[];n.forEach(t=>a.push(Rz(t)));const s=[];r.forEach((n,r)=>{const a={};n.forEach(t=>{const n=a[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r.__ng_removed=Cz,s.push(r))}),t.set(r,a)});let o=0;return n.forEach(t=>Rz(t,a[o++])),s}function Nz(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),i=new Map;return e.forEach(t=>{const e=function t(e){if(!e)return 1;let a=i.get(e);if(a)return a;const s=e.parentNode;return a=n.has(s)?s:r.has(s)?1:t(s),i.set(e,a),a}(t);1!==e&&n.get(e).push(t)}),n}function Oz(t,e){if(t.classList)t.classList.add(e);else{let n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function Pz(t,e){if(t.classList)t.classList.remove(e);else{let n=t.$$classes;n&&delete n[e]}}function Fz(t,e,n){rL(n).onDone(()=>t.processLeaveNode(e))}function Lz(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(t=>i.add(t)):e.set(t,r),n.delete(t),!0}class zz{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new Ez(t,e,n),this._timelineEngine=new xz(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,i){const a=t+"-"+r;let s=this._triggerCache[a];if(!s){const t=[],e=JL(this._driver,i,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);s=function(t,e){return new vz(t,e)}(r,e),this._triggerCache[a]=s}this._transitionEngine.registerTrigger(e,r,s)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,i]=uL(n);this._timelineEngine.command(t,e,i,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,i){if("@"==n.charAt(0)){const[t,r]=uL(n);return this._timelineEngine.listen(t,e,r,i)}return this._transitionEngine.listen(t,e,n,r,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function $z(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=Wz(e[0]),e.length>1&&(r=Wz(e[e.length-1]))):e&&(n=Wz(e)),n||r?new Bz(t,n,r):null}let Bz=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&TL(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(TL(this._element,this._initialStyles),this._endStyles&&(TL(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(RL(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(RL(this._element,this._endStyles),this._endStyles=null),TL(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function Wz(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r];qz(i)&&(e=e||{},e[i]=t[i])}return e}function qz(t){return"display"===t||"position"===t}class Vz{constructor(t,e,n,r,i,a,s){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=i,this._fillMode=a,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=Xz(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),Jz(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),Gz(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){Uz(this._element,this._name,"paused")}resume(){Uz(this._element,this._name,"running")}setPosition(t){const e=jz(this._element,this._name);this._position=t*this._duration,Jz(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),Gz(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=Xz(t,"").split(","),r=Hz(n,e);r>=0&&(n.splice(r,1),Jz(t,"",n.join(",")))}(this._element,this._name))}}function Uz(t,e,n){Jz(t,"PlayState",n,jz(t,e))}function jz(t,e){const n=Xz(t,"");return n.indexOf(",")>0?Hz(n.split(","),e):Hz([n],e)}function Hz(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function Gz(t,e,n){n?t.removeEventListener("animationend",e):t.addEventListener("animationend",e)}function Jz(t,e,n,r){const i="animation"+e;if(null!=r){const e=t.style[i];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[i]=n}function Xz(t,e){return t.style["animation"+e]}class Kz{constructor(t,e,n,r,i,a,s,o){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=s,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=a||"linear",this.totalTime=r+i,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new Vz(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:qL(this.element,n))})}this.currentSnapshot=t}}class Zz extends tL{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=bL(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class Yz{constructor(){this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}validateStyleProperty(t){return gL(t)}matchesElement(t,e){return yL(t,e)}containsElement(t,e){return vL(t,e)}query(t,e,n){return _L(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>bL(t));let r=`@keyframes ${e} {\n`,i="";n.forEach(t=>{i=" ";const e=parseFloat(t.offset);r+=`${i}${100*e}% {\n`,i+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${e}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const a=document.createElement("style");return a.innerHTML=r,a}animate(t,e,n,r,i,a=[],s){s&&this._notifyFaultyScrubber();const o=a.filter(t=>t instanceof Kz),l={};$L(n,r)&&o.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const u=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=BL(t,e,l));if(0==n)return new Zz(t,u);const c=`gen_css_kf_${this._count++}`,h=this.buildKeyframeElement(t,c,e);document.querySelector("head").appendChild(h);const d=$z(t,e),p=new Kz(t,e,c,n,r,i,u,d);return p.onDestroy(()=>{var t;(t=h).parentNode.removeChild(t)}),p}_notifyFaultyScrubber(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}class Qz{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:qL(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class t${constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(e$().toString()),this._cssKeyframesDriver=new Yz}validateStyleProperty(t){return gL(t)}matchesElement(t,e){return yL(t,e)}containsElement(t,e){return vL(t,e)}query(t,e,n){return _L(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,i,a=[],s){if(!s&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,a);const o={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(o.easing=i);const l={},u=a.filter(t=>t instanceof Qz);$L(n,r)&&u.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const c=$z(t,e=BL(t,e=e.map(t=>kL(t,!1)),l));return new Qz(t,e,o,c)}}function e$(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let n$=(()=>{class t extends UF{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:Ue.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?GF(t):t;return a$(this._renderer,null,e,"register",[n]),new r$(e,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(Ae(_l),Ae(Nc))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();class r$ extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new i$(this._id,t,e||{},this._renderer)}}class i${constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return a$(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){return 0}}function a$(t,e,n,r,i){return t.setProperty(e,`@@${n}:${r}`,i)}let s$=(()=>{class t{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new o$("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,i=e.id+"-"+this._currentId;this._currentId++,this.engine.register(i,t);const a=e=>{Array.isArray(e)?e.forEach(a):this.engine.registerTrigger(r,i,t,e.name,e)};return e.data.animation.forEach(a),new l$(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(Ae(_l),Ae(zz),Ae(ec))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();class o${constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,!0)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&"@.disabled"==e?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class l$ extends o${constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&"@.disabled"==e?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let i=e.substr(1),a="";return"@"!=i.charAt(0)&&([i,a]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(i)),this.engine.listen(this.namespaceId,r,i,a,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let u$=(()=>{class t extends zz{constructor(t,e,n){super(t.body,e,n)}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc),Ae(wL),Ae(hz))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const c$=new _e("AnimationModuleType"),h$=[{provide:wL,useFactory:function(){return"function"==typeof e$()?new t$:new Yz}},{provide:c$,useValue:"BrowserAnimations"},{provide:UF,useClass:n$},{provide:hz,useFactory:function(){return new dz}},{provide:zz,useClass:u$},{provide:_l,useFactory:function(t,e,n){return new s$(t,e,n)},deps:[Mh,zz,ec]}];let d$=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:h$,imports:[Hh]}),t})();const p$=["*",[["mat-option"],["ng-container"]]],f$=["*","mat-option, ng-container"];function m$(t,e){if(1&t&&oo(0,"mat-pseudo-checkbox",3),2&t){const t=_o();ro("state",t.selected?"checked":"unchecked")("disabled",t.disabled)}}const g$=["*"],y$=new Cl("9.2.4"),v$=new _e("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let _$=(()=>{class t{constructor(t,e,n){this._hasDoneGlobalChecks=!1,this._document=n,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=e,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getDocument(){const t=this._document||document;return"object"==typeof t&&t?t:null}_getWindow(){const t=this._getDocument(),e=(null==t?void 0:t.defaultView)||window;return"object"==typeof e&&e?e:null}_checksAreEnabled(){return ti()&&!this._isTestEnv()}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){const t=this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype),e=this._getDocument();t&&e&&!e.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){const t=!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme,e=this._getDocument();if(t||!e||!e.body||"function"!=typeof getComputedStyle)return;const n=e.createElement("div");n.classList.add("mat-theme-loaded-marker"),e.body.appendChild(n);const r=getComputedStyle(n);r&&"none"!==r.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),e.body.removeChild(n)}_checkCdkVersionMatch(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&y$.full!==VF.full&&console.warn("The Angular Material version ("+y$.full+") does not match the Angular CDK version ("+VF.full+").\nPlease ensure the versions of these two packages exactly match.")}}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)(Ae(WF),Ae(v$,8),Ae(Nc,8))},imports:[[lF],lF]}),t})();function b$(t){return class extends t{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=LP(t)}}}function x$(t,e){return class extends t{constructor(...t){super(...t),this.color=e}get color(){return this._color}set color(t){const n=t||e;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function w$(t){return class extends t{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=LP(t)}}}function S$(t,e=0){return class extends t{constructor(...t){super(...t),this._tabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?t:e}}}function C$(t){return class extends t{constructor(...t){super(...t),this.errorState=!1,this.stateChanges=new at}updateErrorState(){const t=this.errorState,e=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);e!==t&&(this.errorState=e,this.stateChanges.next())}}}const D$=new _e("MAT_DATE_LOCALE",{providedIn:"root",factory:function(){return Te(qu)}});class I${constructor(){this._localeChanges=new at}get localeChanges(){return this._localeChanges}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let n=this.isValid(t),r=this.isValid(e);return n&&r?!this.compareDate(t,e):n==r}return t==e}clampDate(t,e,n){return e&&this.compareDate(t,e)<0?e:n&&this.compareDate(t,n)>0?n:t}}const k$=new _e("mat-date-formats");let E$;try{E$="undefined"!=typeof Intl}catch(o9){E$=!1}const A$={long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"]},T$=N$(31,t=>String(t+1)),R$={long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"]},M$=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function N$(t,e){const n=Array(t);for(let r=0;r<t;r++)n[r]=e(r);return n}let O$=(()=>{class t extends I${constructor(t,e){super(),this.useUtcForDisplay=!0,super.setLocale(t),this.useUtcForDisplay=!e.TRIDENT,this._clampDate=e.TRIDENT||e.EDGE}getYear(t){return t.getFullYear()}getMonth(t){return t.getMonth()}getDate(t){return t.getDate()}getDayOfWeek(t){return t.getDay()}getMonthNames(t){if(E$){const e=new Intl.DateTimeFormat(this.locale,{month:t,timeZone:"utc"});return N$(12,t=>this._stripDirectionalityCharacters(this._format(e,new Date(2017,t,1))))}return A$[t]}getDateNames(){if(E$){const t=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return N$(31,e=>this._stripDirectionalityCharacters(this._format(t,new Date(2017,0,e+1))))}return T$}getDayOfWeekNames(t){if(E$){const e=new Intl.DateTimeFormat(this.locale,{weekday:t,timeZone:"utc"});return N$(7,t=>this._stripDirectionalityCharacters(this._format(e,new Date(2017,0,t+1))))}return R$[t]}getYearName(t){if(E$){const e=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._stripDirectionalityCharacters(this._format(e,t))}return String(this.getYear(t))}getFirstDayOfWeek(){return 0}getNumDaysInMonth(t){return this.getDate(this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+1,0))}clone(t){return new Date(t.getTime())}createDate(t,e,n){if(e<0||e>11)throw Error(`Invalid month index "${e}". Month index has to be between 0 and 11.`);if(n<1)throw Error(`Invalid date "${n}". Date has to be greater than 0.`);let r=this._createDateWithOverflow(t,e,n);if(r.getMonth()!=e)throw Error(`Invalid date "${n}" for month with index "${e}".`);return r}today(){return new Date}parse(t){return"number"==typeof t?new Date(t):t?new Date(Date.parse(t)):null}format(t,e){if(!this.isValid(t))throw Error("NativeDateAdapter: Cannot format invalid date.");if(E$){this._clampDate&&(t.getFullYear()<1||t.getFullYear()>9999)&&(t=this.clone(t)).setFullYear(Math.max(1,Math.min(9999,t.getFullYear()))),e=Object.assign(Object.assign({},e),{timeZone:"utc"});const n=new Intl.DateTimeFormat(this.locale,e);return this._stripDirectionalityCharacters(this._format(n,t))}return this._stripDirectionalityCharacters(t.toDateString())}addCalendarYears(t,e){return this.addCalendarMonths(t,12*e)}addCalendarMonths(t,e){let n=this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+e,this.getDate(t));return this.getMonth(n)!=((this.getMonth(t)+e)%12+12)%12&&(n=this._createDateWithOverflow(this.getYear(n),this.getMonth(n),0)),n}addCalendarDays(t,e){return this._createDateWithOverflow(this.getYear(t),this.getMonth(t),this.getDate(t)+e)}toIso8601(t){return[t.getUTCFullYear(),this._2digit(t.getUTCMonth()+1),this._2digit(t.getUTCDate())].join("-")}deserialize(t){if("string"==typeof t){if(!t)return null;if(M$.test(t)){let e=new Date(t);if(this.isValid(e))return e}}return super.deserialize(t)}isDateInstance(t){return t instanceof Date}isValid(t){return!isNaN(t.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(t,e,n){const r=new Date(t,e,n);return t>=0&&t<100&&r.setFullYear(this.getYear(r)-1900),r}_2digit(t){return("00"+t).slice(-2)}_stripDirectionalityCharacters(t){return t.replace(/[\u200e\u200f]/g,"")}_format(t,e){const n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.format(n)}}return t.\u0275fac=function(e){return new(e||t)(Ae(D$,8),Ae(kP))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),P$=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[{provide:I$,useClass:O$}],imports:[[EP]]}),t})();const F$={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let L$=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[{provide:k$,useValue:F$}],imports:[[P$]]}),t})(),z$=(()=>{class t{isErrorState(t,e){return!!(t&&t.invalid&&(t.touched||e&&e.submitted))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),$$=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$],_$]}),t})();class B${constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const W$={enterDuration:450,exitDuration:400},q$=OP({passive:!0}),V$=["mousedown","touchstart"],U$=["mouseup","mouseleave","touchend","touchcancel"];class j${constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=WP(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign(Object.assign({},W$),n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const a=n.radius||function(t,e,n){const r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),i=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+i*i)}(t,e,r),s=t-r.left,o=e-r.top,l=i.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${s-a}px`,u.style.top=`${o-a}px`,u.style.height=`${2*a}px`,u.style.width=`${2*a}px`,null!=n.color&&(u.style.backgroundColor=n.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)";const c=new B$(this,u,n);return c.state=0,this._activeRipples.add(c),n.persistent||(this._mostRecentTransientRipple=c),this._runTimeoutOutsideZone(()=>{const t=c===this._mostRecentTransientRipple;c.state=1,n.persistent||t&&this._isPointerDown||c.fadeOut()},l),c}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign(Object.assign({},W$),t.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}setupTriggerEvents(t){const e=WP(t);e&&e!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(V$))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(U$),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const e=PF(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let t=0;t<e.length;t++)this.fadeInRipple(e[t].clientX,e[t].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(t=>{this._triggerElement.addEventListener(t,this,q$)})})}_removeTriggerEvents(){this._triggerElement&&(V$.forEach(t=>{this._triggerElement.removeEventListener(t,this,q$)}),this._pointerUpEventsRegistered&&U$.forEach(t=>{this._triggerElement.removeEventListener(t,this,q$)}))}}const H$=new _e("mat-ripple-global-options");let G$=(()=>{class t{constructor(t,e,n,r,i){this._elementRef=t,this._animationMode=i,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new j$(this,e,t,n)}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,e=0,n){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(ec),to(kP),to(H$,8),to(c$,8))},t.\u0275dir=tn({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,e){2&t&&Ro("mat-ripple-unbounded",e.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),t})(),J$=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$,EP],_$]}),t})(),X$=(()=>{class t{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1}}return t.\u0275fac=function(e){return new(e||t)(to(c$,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(t,e){2&t&&Ro("mat-pseudo-checkbox-indeterminate","indeterminate"===e.state)("mat-pseudo-checkbox-checked","checked"===e.state)("mat-pseudo-checkbox-disabled",e.disabled)("_mat-animation-noopable","NoopAnimations"===e._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(t,e){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),t})(),K$=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})();class Z${}const Y$=b$(Z$);let Q$=0,tB=(()=>{class t extends Y${constructor(){super(...arguments),this._labelId=`mat-optgroup-label-${Q$++}`}}return t.\u0275fac=function(e){return eB(e||t)},t.\u0275cmp=Je({type:t,selectors:[["mat-optgroup"]],hostAttrs:["role","group",1,"mat-optgroup"],hostVars:4,hostBindings:function(t,e){2&t&&(Ks("aria-disabled",e.disabled.toString())("aria-labelledby",e._labelId),Ro("mat-optgroup-disabled",e.disabled))},inputs:{disabled:"disabled",label:"label"},exportAs:["matOptgroup"],features:[Zo],ngContentSelectors:f$,decls:4,vars:2,consts:[[1,"mat-optgroup-label",3,"id"]],template:function(t,e){1&t&&(xo(p$),ao(0,"label",0),Vo(1),wo(2),so(),wo(3,1)),2&t&&(ro("id",e._labelId),Hi(1),jo("",e.label," "))},styles:[".mat-optgroup-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup-label[disabled]{cursor:default}[dir=rtl] .mat-optgroup-label{text-align:right}.mat-optgroup-label .mat-icon{margin-right:16px;vertical-align:middle}.mat-optgroup-label .mat-icon svg{vertical-align:top}[dir=rtl] .mat-optgroup-label .mat-icon{margin-left:16px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),t})();const eB=zr(tB);let nB=0;class rB{constructor(t,e=!1){this.source=t,this.isUserInput=e}}const iB=new _e("MAT_OPTION_PARENT_COMPONENT");let aB=(()=>{class t{constructor(t,e,n,r){this._element=t,this._changeDetectorRef=e,this._parent=n,this.group=r,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id=`mat-option-${nB++}`,this.onSelectionChange=new cu,this._stateChanges=new at}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=LP(t)}get disableRipple(){return this._parent&&this._parent.disableRipple}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(t,e){const n=this._getHostElement();"function"==typeof n.focus&&n.focus(e)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){13!==t.keyCode&&32!==t.keyCode||mF(t)||(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue=t,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new rB(this,t))}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs),to(iB,8),to(tB,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(t,e){1&t&&fo("click",(function(){return e._selectViaInteraction()}))("keydown",(function(t){return e._handleKeydown(t)})),2&t&&(Jo("id",e.id),Ks("tabindex",e._getTabIndex())("aria-selected",e._getAriaSelected())("aria-disabled",e.disabled.toString()),Ro("mat-selected",e.selected)("mat-option-multiple",e.multiple)("mat-active",e.active)("mat-option-disabled",e.disabled))},inputs:{id:"id",disabled:"disabled",value:"value"},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],ngContentSelectors:g$,decls:4,vars:3,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"]],template:function(t,e){1&t&&(xo(),Ys(0,m$,1,2,"mat-pseudo-checkbox",0),ao(1,"span",1),wo(2),so(),oo(3,"div",2)),2&t&&(ro("ngIf",e.multiple),Hi(3),ro("matRippleTrigger",e._getHostElement())("matRippleDisabled",e.disabled||e.disableRipple))},directives:[ah,G$,X$],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.cdk-high-contrast-active .mat-option .mat-option-ripple{opacity:.5}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),t})();function sB(t,e,n){if(n.length){let r=e.toArray(),i=n.toArray(),a=0;for(let e=0;e<t+1;e++)r[e].group&&r[e].group===i[a]&&a++;return a}return 0}let oB=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[J$,fh,K$]]}),t})();const lB=new _e("mat-label-global-options"),uB=["*"];function cB(t,e){if(1&t){const t=co();ao(0,"div",2),fo("click",(function(){return Tn(t),_o()._onBackdropClicked()})),so()}2&t&&Ro("mat-drawer-shown",_o()._isShowingBackdrop())}function hB(t,e){1&t&&(ao(0,"mat-drawer-content"),wo(1,2),so())}const dB=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],pB=["mat-drawer","mat-drawer-content","*"],fB={transformDrawer:jF("transform",[XF("open, open-instant",JF({transform:"none",visibility:"visible"})),XF("void",JF({"box-shadow":"none",visibility:"hidden"})),KF("void => open-instant",HF("0ms")),KF("void <=> open, open-instant => void",HF("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};function mB(t){throw Error(`A drawer was already declared for 'position="${t}"'`)}const gB=new _e("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),yB=new _e("MAT_DRAWER_CONTAINER");let vB=(()=>{class t extends hF{constructor(t,e,n,r,i){super(n,r,i),this._changeDetectorRef=t,this._container=e}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return t.\u0275fac=function(e){return new(e||t)(to(bs),to(ie(()=>bB)),to(yl),to(cF),to(ec))},t.\u0275cmp=Je({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,e){2&t&&To("margin-left",e._container._contentMargins.left,"px")("margin-right",e._container._contentMargins.right,"px")},features:[Zo],ngContentSelectors:uB,decls:1,vars:0,template:function(t,e){1&t&&(xo(),wo(0))},encapsulation:2,changeDetection:0}),t})(),_B=(()=>{class t{constructor(t,e,n,r,i,a,s){this._elementRef=t,this._focusTrapFactory=e,this._focusMonitor=n,this._platform=r,this._ngZone=i,this._doc=a,this._container=s,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new at,this._animationEnd=new at,this._animationState="void",this.openedChange=new cu(!0),this._destroyed=new at,this.onPositionChanged=new cu,this._modeChanged=new at,this.openedChange.subscribe(t=>{t?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._restoreFocus()}),this._ngZone.runOutsideAngular(()=>{qP(this._elementRef.nativeElement,"keydown").pipe(rd(t=>27===t.keyCode&&!this.disableClose&&!mF(t)),rF(this._destroyed)).subscribe(t=>this._ngZone.run(()=>{this.close(),t.stopPropagation(),t.preventDefault()}))}),this._animationEnd.pipe(GP((t,e)=>t.fromState===e.fromState&&t.toState===e.toState)).subscribe(t=>{const{fromState:e,toState:n}=t;(0===n.indexOf("open")&&"void"===e||"void"===n&&0===e.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!=this._position&&(this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=LP(t)}get autoFocus(){const t=this._autoFocus;return null==t?"side"!==this.mode:t}set autoFocus(t){this._autoFocus=LP(t)}get opened(){return this._opened}set opened(t){this.toggle(LP(t))}get _openedStream(){return this.openedChange.pipe(rd(t=>t),yt(()=>{}))}get openedStart(){return this._animationStarted.pipe(rd(t=>t.fromState!==t.toState&&0===t.toState.indexOf("open")),yt(()=>{}))}get _closedStream(){return this.openedChange.pipe(rd(t=>!t),yt(()=>{}))}get closedStart(){return this._animationStarted.pipe(rd(t=>t.fromState!==t.toState&&"void"===t.toState),yt(()=>{}))}_takeFocus(){this.autoFocus&&this._focusTrap&&this._focusTrap.focusInitialElementWhenReady().then(t=>{t||"function"!=typeof this._elementRef.nativeElement.focus||this._elementRef.nativeElement.focus()})}_restoreFocus(){if(!this.autoFocus)return;const t=this._doc&&this._doc.activeElement;t&&this._elementRef.nativeElement.contains(t)&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur()),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}toggle(t=!this.opened,e="program"){return this._opened=t,t?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=e):(this._animationState="void",this._restoreFocus()),this._updateFocusTrapState(),new Promise(t=>{this.openedChange.pipe(xd(1)).subscribe(e=>t(e?"open":"close"))})}get _width(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_animationStartListener(t){this._animationStarted.next(t)}_animationDoneListener(t){this._animationEnd.next(t)}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(RF),to(zF),to(kP),to(ec),to(Nc,8),to(yB,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,e){1&t&&mo("@transform.start",(function(t){return e._animationStartListener(t)}))("@transform.done",(function(t){return e._animationDoneListener(t)})),2&t&&(Ks("align",null),Xo("@transform",e._animationState),Ro("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",onPositionChanged:"positionChanged",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart"},exportAs:["matDrawer"],ngContentSelectors:uB,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(xo(),ao(0,"div",0),wo(1),so())},encapsulation:2,data:{animation:[fB.transformDrawer]},changeDetection:0}),t})(),bB=(()=>{class t{constructor(t,e,n,r,i,a=!1,s){this._dir=t,this._element=e,this._ngZone=n,this._changeDetectorRef=r,this._animationMode=s,this._drawers=new du,this.backdropClick=new cu,this._destroyed=new at,this._doCheckSubject=new at,this._contentMargins={left:null,right:null},this._contentMarginChanges=new at,t&&t.change.pipe(rF(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),i.change().pipe(rF(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=LP(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:LP(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(Rd(this._allDrawers),rF(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(t=>!t._container||t._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Rd(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._doCheckSubject.pipe(gF(10),rF(this._destroyed)).subscribe(()=>this.updateContentMargins())}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,e=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._width;else if("push"==this._left.mode){const n=this._left._width;t+=n,e-=n}if(this._right&&this._right.opened)if("side"==this._right.mode)e+=this._right._width;else if("push"==this._right.mode){const n=this._right._width;e+=n,t-=n}t=t||null,e=e||null,t===this._contentMargins.left&&e===this._contentMargins.right||(this._contentMargins={left:t,right:e},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(rd(t=>t.fromState!==t.toState),rF(this._drawers.changes)).subscribe(t=>{"open-instant"!==t.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(rF(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(rF(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.asObservable().pipe(xd(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(rF(kt(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const e=this._element.nativeElement.classList,n="mat-drawer-container-has-open";t?e.add(n):e.remove(n)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?(null!=this._end&&mB("end"),this._end=t):(null!=this._start&&mB("start"),this._start=t)}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawer()}_closeModalDrawer(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t.close())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return t.\u0275fac=function(e){return new(e||t)(to(oF,8),to(yl),to(ec),to(bs),to(dF),to(gB),to(c$,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(t,e,n){var r;1&t&&(Du(n,vB,!0),Du(n,_B,!0)),2&t&&(xu(r=Eu())&&(e._content=r.first),xu(r=Eu())&&(e._allDrawers=r))},viewQuery:function(t,e){var n;1&t&&Su(vB,!0),2&t&&xu(n=Eu())&&(e._userContent=n.first)},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,e){2&t&&Ro("mat-drawer-container-explicit-backdrop",e._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[pl([{provide:yB,useExisting:t}])],ngContentSelectors:pB,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,e){1&t&&(xo(dB),Ys(0,cB,1,2,"div",0),wo(1),wo(2,1),Ys(3,hB,2,0,"mat-drawer-content",1)),2&t&&(ro("ngIf",e.hasBackdrop),Hi(3),ro("ngIf",!e._content))},directives:[ah,vB],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),t})(),xB=(()=>{class t extends _B{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=LP(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=zP(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=zP(t)}}return t.\u0275fac=function(e){return wB(e||t)},t.\u0275cmp=Je({type:t,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,e){2&t&&(Ks("align",null),To("top",e.fixedInViewport?e.fixedTopGap:null,"px")("bottom",e.fixedInViewport?e.fixedBottomGap:null,"px"),Ro("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened)("mat-sidenav-fixed",e.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Zo],ngContentSelectors:uB,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(xo(),ao(0,"div",0),wo(1),so())},encapsulation:2,data:{animation:[fB.transformDrawer]},changeDetection:0}),t})();const wB=zr(xB);let SB=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,_$,EP,pF],pF,_$]}),t})();const CB=["mat-button",""],DB=["*"],IB=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class kB{constructor(t){this._elementRef=t}}const EB=x$(b$(w$(kB)));let AB=(()=>{class t extends EB{constructor(t,e,n){super(t),this._focusMonitor=e,this._animationMode=n,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const r of IB)this._hasHostAttributes(r)&&this._getHostElement().classList.add(r);t.nativeElement.classList.add("mat-button-base"),this._focusMonitor.monitor(this._elementRef,!0),this.isRoundButton&&(this.color="accent")}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",e){this._focusMonitor.focusVia(this._getHostElement(),t,e)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(t=>this._getHostElement().hasAttribute(t))}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(zF),to(c$,8))},t.\u0275cmp=Je({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,e){var n;1&t&&Su(G$,!0),2&t&&xu(n=Eu())&&(e.ripple=n.first)},hostAttrs:[1,"mat-focus-indicator"],hostVars:3,hostBindings:function(t,e){2&t&&(Ks("disabled",e.disabled||null),Ro("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Zo],attrs:CB,ngContentSelectors:DB,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(xo(),ao(0,"span",0),wo(1),so(),oo(2,"div",1),oo(3,"div",2)),2&t&&(Hi(2),Ro("mat-button-ripple-round",e.isRoundButton||e.isIconButton),ro("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[G$],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n"],encapsulation:2,changeDetection:0}),t})(),TB=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[J$,_$],_$]}),t})();function RB(...t){if(1===t.length){const e=t[0];if(q(e))return MB(e,null);if(V(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return MB(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return MB(t=1===t.length&&q(t[0])?t[0]:t,null).pipe(yt(t=>e(...t)))}return MB(t,null)}function MB(t,e){return new tt(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let a=0,s=0;for(let o=0;o<r;o++){const l=xt(t[o]);let u=!1;n.add(l.subscribe({next:t=>{u||(u=!0,s++),i[o]=t},error:t=>n.error(t),complete:()=>{a++,a!==r&&u||(s===r&&n.next(e?e.reduce((t,e,n)=>(t[e]=i[n],t),{}):i),n.complete())}}))}})}const NB=new _e("NgValueAccessor"),OB={provide:NB,useExisting:ie(()=>PB),multi:!0};let PB=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(to(xl),to(yl))},t.\u0275dir=tn({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&fo("change",(function(t){return e.onChange(t.target.checked)}))("blur",(function(){return e.onTouched()}))},features:[pl([OB])]}),t})();const FB={provide:NB,useExisting:ie(()=>zB),multi:!0},LB=new _e("CompositionEventMode");let zB=(()=>{class t{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=Mc()?Mc().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(to(xl),to(yl),to(LB,8))},t.\u0275dir=tn({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&fo("input",(function(t){return e._handleInput(t.target.value)}))("blur",(function(){return e.onTouched()}))("compositionstart",(function(){return e._compositionStart()}))("compositionend",(function(t){return e._compositionEnd(t.target.value)}))},features:[pl([FB])]}),t})(),$B=(()=>{class t{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t}),t})(),BB=(()=>{class t extends $B{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return WB(e||t)},t.\u0275dir=tn({type:t,features:[Zo]}),t})();const WB=zr(BB);function qB(){throw new Error("unimplemented")}class VB extends $B{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return qB()}get asyncValidator(){return qB()}}class UB{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}let jB=(()=>{class t extends UB{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(to(VB,2))},t.\u0275dir=tn({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&Ro("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[Zo]}),t})(),HB=(()=>{class t extends UB{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(to(BB,2))},t.\u0275dir=tn({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&Ro("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[Zo]}),t})();function GB(t){return null==t||0===t.length}const JB=new _e("NgValidators"),XB=new _e("NgAsyncValidators"),KB=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ZB{static min(t){return e=>{if(GB(e.value)||GB(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(GB(e.value)||GB(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return GB(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return GB(t.value)||KB.test(t.value)?null:{email:!0}}static minLength(t){return e=>{if(GB(e.value))return null;const n=e.value?e.value.length:0;return n<t?{minlength:{requiredLength:t,actualLength:n}}:null}}static maxLength(t){return e=>{const n=e.value?e.value.length:0;return n>t?{maxlength:{requiredLength:t,actualLength:n}}:null}}static pattern(t){if(!t)return ZB.nullValidator;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(GB(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(YB);return 0==e.length?null:function(t){return tW(function(t,e){return e.map(e=>e(t))}(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(YB);return 0==e.length?null:function(t){return RB(function(t,e){return e.map(e=>e(t))}(t,e).map(QB)).pipe(yt(tW))}}}function YB(t){return null!=t}function QB(t){const e=ho(t)?xt(t):t;if(!po(e))throw new Error("Expected validator to return Promise or Observable.");return e}function tW(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function eW(t){return t.validate?e=>t.validate(e):t}function nW(t){return t.validate?e=>t.validate(e):t}const rW={provide:NB,useExisting:ie(()=>iW),multi:!0};let iW=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(to(xl),to(yl))},t.\u0275dir=tn({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&fo("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[pl([rW])]}),t})();const aW={provide:NB,useExisting:ie(()=>oW),multi:!0};let sW=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),oW=(()=>{class t{constructor(t,e,n,r){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=r,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(VB),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}return t.\u0275fac=function(e){return new(e||t)(to(xl),to(yl),to(sW),to(Fs))},t.\u0275dir=tn({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&fo("change",(function(){return e.onChange()}))("blur",(function(){return e.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[pl([aW])]}),t})();const lW={provide:NB,useExisting:ie(()=>uW),multi:!0};let uW=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(to(xl),to(yl))},t.\u0275dir=tn({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&fo("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[pl([lW])]}),t})();const cW='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',hW='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });';class dW{static controlParentException(){throw new Error(`formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${cW}`)}static ngModelGroupException(){throw new Error(`formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        ${hW}\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        \n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>`)}static missingFormException(){throw new Error(`formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ${cW}`)}static groupParentException(){throw new Error(`formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${hW}`)}static arrayParentException(){throw new Error('formArrayName must be used with a parent formGroup directive.  You\'ll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        \n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });')}static disabledAttrWarning(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}static ngModelWarning(t){console.warn(`\n    It looks like you're using ngModel on the same form field as ${t}. \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/${"formControl"===t?"FormControlDirective":"FormControlName"}#use-with-ngmodel\n    `)}}const pW={provide:NB,useExisting:ie(()=>fW),multi:!0};let fW=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Us}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=function(t,e){return null==t?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(to(xl),to(yl))},t.\u0275dir=tn({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&fo("change",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[pl([pW])]}),t})();const mW={provide:NB,useExisting:ie(()=>gW),multi:!0};let gW=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Us}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(e.hasOwnProperty("selectedOptions")){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const r=t.item(e),i=this._getOptionValue(r.value);n.push(i)}}else{const t=e.options;for(let e=0;e<t.length;e++){const r=t.item(e);if(r.selected){const t=this._getOptionValue(r.value);n.push(t)}}}this.value=n,t(n)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(to(xl),to(yl))},t.\u0275dir=tn({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&fo("change",(function(t){return e.onChange(t.target)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[pl([mW])]}),t})();function yW(t,e){return[...e.path,t]}function vW(t,e){t||wW(e,"Cannot find control with"),e.valueAccessor||wW(e,"No value accessor for form control with"),t.validator=ZB.compose([t.validator,e.validator]),t.asyncValidator=ZB.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&_W(t,e)})}(t,e),function(t,e){t.registerOnChange((t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&_W(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function _W(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function bW(t,e){null==t&&wW(e,"Cannot find control with"),t.validator=ZB.compose([t.validator,e.validator]),t.asyncValidator=ZB.composeAsync([t.asyncValidator,e.asyncValidator])}function xW(t){return wW(t,"There is no FormControl instance attached to form control element with")}function wW(t,e){let n;throw n=t.path.length>1?`path: '${t.path.join(" -> ")}'`:t.path[0]?`name: '${t.path}'`:"unspecified name attribute",new Error(`${e} ${n}`)}function SW(t){return null!=t?ZB.compose(t.map(eW)):null}function CW(t){return null!=t?ZB.composeAsync(t.map(nW)):null}const DW=[PB,uW,iW,fW,gW,oW];function IW(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function kW(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function EW(t){const e=TW(t)?t.validators:t;return Array.isArray(e)?SW(e):e||null}function AW(t,e){const n=TW(e)?e.asyncValidators:t;return Array.isArray(n)?CW(n):n||null}function TW(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class RW{constructor(t,e){this.validator=t,this.asyncValidator=e,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this.validator=EW(t)}setAsyncValidators(t){this.asyncValidator=AW(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status="PENDING";const e=QB(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>this.setErrors(e,{emitEvent:t}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let r=t;return e.forEach(t=>{r=r instanceof NW?r.controls.hasOwnProperty(t)?r.controls[t]:null:r instanceof OW&&r.at(t)||null}),r}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new cu,this.statusChanges=new cu}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){TW(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class MW extends RW{constructor(t=null,e,n){super(EW(e),AW(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class NW extends RW{constructor(t,e,n){super(EW(e),AW(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof MW?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){let e=!1;return this._forEachChild((n,r)=>{e=e||this.contains(r)&&t(n)}),e}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class OW extends RW{constructor(t,e,n){super(EW(e),AW(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof MW?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const PW={provide:BB,useExisting:ie(()=>LW)},FW=(()=>Promise.resolve(null))();let LW=(()=>{class t extends BB{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new cu,this.form=new NW({},SW(t),CW(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){FW.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),vW(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){FW.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),kW(this._directives,t)})}addFormGroup(t){FW.then(()=>{const e=this._findContainer(t.path),n=new NW({});bW(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){FW.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){FW.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,IW(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(to(JB,10),to(XB,10))},t.\u0275dir=tn({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&fo("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pl([PW]),Zo]}),t})(),zW=(()=>{class t extends BB{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return yW(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return SW(this._validators)}get asyncValidator(){return CW(this._asyncValidators)}_checkParentType(){}}return t.\u0275fac=function(e){return $W(e||t)},t.\u0275dir=tn({type:t,features:[Zo]}),t})();const $W=zr(zW);let BW=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const WW=new _e("NgModelWithFormControlWarning"),qW={provide:BB,useExisting:ie(()=>VW)};let VW=(()=>{class t extends BB{constructor(t,e){super(),this._validators=t,this._asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new cu}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return vW(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){kW(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);bW(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);bW(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,IW(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){e.valueAccessor.registerOnChange(()=>xW(e)),e.valueAccessor.registerOnTouched(()=>xW(e)),e._rawValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),e._rawAsyncValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),t&&t._clearChangeFns()}(t.control,t),e&&vW(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{}),this._oldForm=this.form}_updateValidators(){const t=SW(this._validators);this.form.validator=ZB.compose([this.form.validator,t]);const e=CW(this._asyncValidators);this.form.asyncValidator=ZB.composeAsync([this.form.asyncValidator,e])}_checkFormPresent(){this.form||dW.missingFormException()}}return t.\u0275fac=function(e){return new(e||t)(to(JB,10),to(XB,10))},t.\u0275dir=tn({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&fo("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pl([qW]),Zo,rl]}),t})();const UW={provide:BB,useExisting:ie(()=>jW)};let jW=(()=>{class t extends zW{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){JW(this._parent)&&dW.groupParentException()}}return t.\u0275fac=function(e){return new(e||t)(to(BB,13),to(JB,10),to(XB,10))},t.\u0275dir=tn({type:t,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[pl([UW]),Zo]}),t})();const HW={provide:BB,useExisting:ie(()=>GW)};let GW=(()=>{class t extends BB{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return yW(null==this.name?this.name:this.name.toString(),this._parent)}get validator(){return SW(this._validators)}get asyncValidator(){return CW(this._asyncValidators)}_checkParentType(){JW(this._parent)&&dW.arrayParentException()}}return t.\u0275fac=function(e){return new(e||t)(to(BB,13),to(JB,10),to(XB,10))},t.\u0275dir=tn({type:t,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[pl([HW]),Zo]}),t})();function JW(t){return!(t instanceof jW||t instanceof VW||t instanceof GW)}const XW={provide:VB,useExisting:ie(()=>KW)};let KW=(()=>{class t extends VB{constructor(t,e,n,r,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.update=new cu,this._ngModelWarningSent=!1,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=function(t,e){if(!e)return null;Array.isArray(e)||wW(t,"Value accessor was not provided as an array for form control with");let n=void 0,r=void 0,i=void 0;return e.forEach(e=>{var a;e.constructor===zB?n=e:(a=e,DW.some(t=>a.constructor===t)?(r&&wW(t,"More than one built-in value accessor matches form control with"),r=e):(i&&wW(t,"More than one custom value accessor matches form control with"),i=e))}),i||r||n||(wW(t,"No valid value accessor for form control with"),null)}(this,r)}set isDisabled(t){dW.disabledAttrWarning()}ngOnChanges(e){var n,r;this._added||this._setUpControl(),function(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Us(e,n.currentValue)}(e,this.viewModel)&&("formControlName",n=t,this,r=this._ngModelWarningConfig,ti()&&"never"!==r&&((null!==r&&"once"!==r||n._ngModelWarningSentOnce)&&("always"!==r||this._ngModelWarningSent)||(dW.ngModelWarning("formControlName"),n._ngModelWarningSentOnce=!0,this._ngModelWarningSent=!0)),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return yW(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return SW(this._rawValidators)}get asyncValidator(){return CW(this._rawAsyncValidators)}_checkParentType(){!(this._parent instanceof jW)&&this._parent instanceof zW?dW.ngModelGroupException():this._parent instanceof jW||this._parent instanceof VW||this._parent instanceof GW||dW.controlParentException()}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t.\u0275fac=function(e){return new(e||t)(to(BB,13),to(JB,10),to(XB,10),to(NB,10),to(WW,8))},t.\u0275dir=tn({type:t,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[pl([XW]),Zo,rl]}),t._ngModelWarningSentOnce=!1,t})(),ZW=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})(),YW=(()=>{class t{group(t,e=null){const n=this._reduceControls(t);let r=null,i=null,a=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(r=null!=e.validators?e.validators:null,i=null!=e.asyncValidators?e.asyncValidators:null,a=null!=e.updateOn?e.updateOn:void 0):(r=null!=e.validator?e.validator:null,i=null!=e.asyncValidator?e.asyncValidator:null)),new NW(n,{asyncValidators:i,updateOn:a,validators:r})}control(t,e,n){return new MW(t,e,n)}array(t,e,n){const r=t.map(t=>this._createControl(t));return new OW(r,e,n)}_reduceControls(t){const e={};return Object.keys(t).forEach(n=>{e[n]=this._createControl(t[n])}),e}_createControl(t){return t instanceof MW||t instanceof NW||t instanceof OW?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),QW=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:WW,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[YW,sW],imports:[ZW]}),t})();const tq=["underline"],eq=["connectionContainer"],nq=["inputContainer"],rq=["label"];function iq(t,e){1&t&&(lo(0),ao(1,"div",14),oo(2,"div",15),oo(3,"div",16),oo(4,"div",17),so(),ao(5,"div",18),oo(6,"div",15),oo(7,"div",16),oo(8,"div",17),so(),uo())}function aq(t,e){1&t&&(ao(0,"div",19),wo(1,1),so())}function sq(t,e){if(1&t&&(lo(0),wo(1,2),ao(2,"span"),Vo(3),so(),uo()),2&t){const t=_o(2);Hi(3),Uo(t._control.placeholder)}}function oq(t,e){1&t&&wo(0,3,["*ngSwitchCase","true"])}function lq(t,e){1&t&&(ao(0,"span",23),Vo(1," *"),so())}function uq(t,e){if(1&t){const t=co();ao(0,"label",20,21),fo("cdkObserveContent",(function(){return Tn(t),_o().updateOutlineGap()})),Ys(2,sq,4,1,"ng-container",12),Ys(3,oq,1,0,void 0,12),Ys(4,lq,2,0,"span",22),so()}if(2&t){const t=_o();Ro("mat-empty",t._control.empty&&!t._shouldAlwaysFloat)("mat-form-field-empty",t._control.empty&&!t._shouldAlwaysFloat)("mat-accent","accent"==t.color)("mat-warn","warn"==t.color),ro("cdkObserveContentDisabled","outline"!=t.appearance)("id",t._labelId)("ngSwitch",t._hasLabel()),Ks("for",t._control.id)("aria-owns",t._control.id),Hi(2),ro("ngSwitchCase",!1),Hi(1),ro("ngSwitchCase",!0),Hi(1),ro("ngIf",!t.hideRequiredMarker&&t._control.required&&!t._control.disabled)}}function cq(t,e){1&t&&(ao(0,"div",24),wo(1,4),so())}function hq(t,e){if(1&t&&(ao(0,"div",25,26),oo(2,"span",27),so()),2&t){const t=_o();Hi(2),Ro("mat-accent","accent"==t.color)("mat-warn","warn"==t.color)}}function dq(t,e){1&t&&(ao(0,"div"),wo(1,5),so()),2&t&&ro("@transitionMessages",_o()._subscriptAnimationState)}function pq(t,e){if(1&t&&(ao(0,"div",31),Vo(1),so()),2&t){const t=_o(2);ro("id",t._hintLabelId),Hi(1),Uo(t.hintLabel)}}function fq(t,e){if(1&t&&(ao(0,"div",28),Ys(1,pq,2,2,"div",29),wo(2,6),oo(3,"div",30),wo(4,7),so()),2&t){const t=_o();ro("@transitionMessages",t._subscriptAnimationState),Hi(1),ro("ngIf",t.hintLabel)}}const mq=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],gq=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"];let yq=0,vq=(()=>{class t{constructor(){this.id=`mat-error-${yq++}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["mat-error"]],hostAttrs:["role","alert",1,"mat-error"],hostVars:1,hostBindings:function(t,e){2&t&&Ks("id",e.id)},inputs:{id:"id"}}),t})();const _q={transitionMessages:jF("transitionMessages",[XF("enter",JF({opacity:1,transform:"translateY(0%)"})),KF("void => enter",[JF({opacity:0,transform:"translateY(-100%)"}),HF("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let bq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t}),t})();function xq(t){return Error(`A hint was already declared for 'align="${t}"'.`)}let wq=0,Sq=(()=>{class t{constructor(){this.align="start",this.id=`mat-hint-${wq++}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["mat-hint"]],hostAttrs:[1,"mat-hint"],hostVars:4,hostBindings:function(t,e){2&t&&(Ks("id",e.id)("align",null),Ro("mat-right","end"==e.align))},inputs:{align:"align",id:"id"}}),t})(),Cq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["mat-label"]]}),t})(),Dq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["mat-placeholder"]]}),t})(),Iq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["","matPrefix",""]]}),t})(),kq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["","matSuffix",""]]}),t})(),Eq=0;class Aq{constructor(t){this._elementRef=t}}const Tq=x$(Aq,"primary"),Rq=new _e("MAT_FORM_FIELD_DEFAULT_OPTIONS"),Mq=new _e("MatFormField");let Nq=(()=>{class t extends Tq{constructor(t,e,n,r,i,a,s,o){super(t),this._elementRef=t,this._changeDetectorRef=e,this._dir=r,this._defaults=i,this._platform=a,this._ngZone=s,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new at,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId=`mat-hint-${Eq++}`,this._labelId=`mat-form-field-label-${Eq++}`,this._labelOptions=n||{},this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==o,this.appearance=i&&i.appearance?i.appearance:"legacy",this._hideRequiredMarker=!(!i||null==i.hideRequiredMarker)&&i.hideRequiredMarker}get appearance(){return this._appearance}set appearance(t){const e=this._appearance;this._appearance=t||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&e!==t&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=LP(t)}get _shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}get _canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(t){this._explicitFormFieldControl=t}get _labelChild(){return this._labelChildNonStatic||this._labelChildStatic}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${t.controlType}`),t.stateChanges.pipe(Rd(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(rF(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.asObservable().pipe(rF(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),kt(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(Rd(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(Rd(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(rF(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(t){const e=this._control?this._control.ngControl:null;return e&&e[t]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!!this._labelChild}_shouldLabelFloat(){return this._canLabelFloat&&(this._control.shouldLabelFloat||this._shouldAlwaysFloat)}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,qP(this._label.nativeElement,"transitionend").pipe(xd(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){if(this._control.placeholder&&this._placeholderChild)throw Error("Placeholder attribute and child element were both specified.")}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){if(this._hintChildren){let t,e;this._hintChildren.forEach(n=>{if("start"===n.align){if(t||this.hintLabel)throw xq("start");t=n}else if("end"===n.align){if(e)throw xq("end");e=n}})}}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||this._labelOptions.float||"auto"}_syncDescribedByIds(){if(this._control){let t=[];if("hint"===this._getDisplayedMessages()){const e=this._hintChildren?this._hintChildren.find(t=>"start"===t.align):null,n=this._hintChildren?this._hintChildren.find(t=>"end"===t.align):null;e?t.push(e.id):this._hintLabel&&t.push(this._hintLabelId),n&&t.push(n.id)}else this._errorChildren&&(t=this._errorChildren.map(t=>t.id));this._control.setDescribedByIds(t)}}_validateControlChild(){if(!this._control)throw Error("mat-form-field must contain a MatFormFieldControl.")}updateOutlineGap(){const t=this._label?this._label.nativeElement:null;if("outline"!==this.appearance||!t||!t.children.length||!t.textContent.trim())return;if(!this._platform.isBrowser)return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let e=0,n=0;const r=this._connectionContainerRef.nativeElement,i=r.querySelectorAll(".mat-form-field-outline-start"),a=r.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const i=r.getBoundingClientRect();if(0===i.width&&0===i.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const a=this._getStartEnd(i),s=this._getStartEnd(t.children[0].getBoundingClientRect());let o=0;for(const e of t.children)o+=e.offsetWidth;e=Math.abs(s-a)-5,n=o>0?.75*o+10:0}for(let s=0;s<i.length;s++)i[s].style.width=`${e}px`;for(let s=0;s<a.length;s++)a[s].style.width=`${n}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(t){return this._dir&&"rtl"===this._dir.value?t.right:t.left}_isAttachedToDOM(){const t=this._elementRef.nativeElement;if(t.getRootNode){const e=t.getRootNode();return e&&e!==t}return document.documentElement.contains(t)}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs),to(lB,8),to(oF,8),to(Rq,8),to(kP),to(ec),to(c$,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-form-field"]],contentQueries:function(t,e,n){var r;1&t&&(Du(n,bq,!0),Iu(n,bq,!0),Du(n,Cq,!0),Iu(n,Cq,!0),Du(n,Dq,!0),Du(n,vq,!0),Du(n,Sq,!0),Du(n,Iq,!0),Du(n,kq,!0)),2&t&&(xu(r=Eu())&&(e._controlNonStatic=r.first),xu(r=Eu())&&(e._controlStatic=r.first),xu(r=Eu())&&(e._labelChildNonStatic=r.first),xu(r=Eu())&&(e._labelChildStatic=r.first),xu(r=Eu())&&(e._placeholderChild=r.first),xu(r=Eu())&&(e._errorChildren=r),xu(r=Eu())&&(e._hintChildren=r),xu(r=Eu())&&(e._prefixChildren=r),xu(r=Eu())&&(e._suffixChildren=r))},viewQuery:function(t,e){var n;1&t&&(Su(tq,!0),wu(eq,!0),Su(nq,!0),Su(rq,!0)),2&t&&(xu(n=Eu())&&(e.underlineRef=n.first),xu(n=Eu())&&(e._connectionContainerRef=n.first),xu(n=Eu())&&(e._inputContainerRef=n.first),xu(n=Eu())&&(e._label=n.first))},hostAttrs:[1,"mat-form-field"],hostVars:44,hostBindings:function(t,e){2&t&&Ro("mat-form-field-appearance-standard","standard"==e.appearance)("mat-form-field-appearance-fill","fill"==e.appearance)("mat-form-field-appearance-outline","outline"==e.appearance)("mat-form-field-appearance-legacy","legacy"==e.appearance)("mat-form-field-invalid",e._control.errorState)("mat-form-field-can-float",e._canLabelFloat)("mat-form-field-should-float",e._shouldLabelFloat())("mat-form-field-has-label",e._hasFloatingLabel())("mat-form-field-hide-placeholder",e._hideControlPlaceholder())("mat-form-field-disabled",e._control.disabled)("mat-form-field-autofilled",e._control.autofilled)("mat-focused",e._control.focused)("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)("ng-untouched",e._shouldForward("untouched"))("ng-touched",e._shouldForward("touched"))("ng-pristine",e._shouldForward("pristine"))("ng-dirty",e._shouldForward("dirty"))("ng-valid",e._shouldForward("valid"))("ng-invalid",e._shouldForward("invalid"))("ng-pending",e._shouldForward("pending"))("_mat-animation-noopable",!e._animationsEnabled)},inputs:{color:"color",floatLabel:"floatLabel",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[pl([{provide:Mq,useExisting:t}]),Zo],ngContentSelectors:gq,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],["underline",""],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(t,e){1&t&&(xo(mq),ao(0,"div",0),ao(1,"div",1,2),fo("click",(function(t){return e._control.onContainerClick&&e._control.onContainerClick(t)})),Ys(3,iq,9,0,"ng-container",3),Ys(4,aq,2,0,"div",4),ao(5,"div",5,6),wo(7),ao(8,"span",7),Ys(9,uq,5,16,"label",8),so(),so(),Ys(10,cq,2,0,"div",9),so(),Ys(11,hq,3,4,"div",10),ao(12,"div",11),Ys(13,dq,2,1,"div",12),Ys(14,fq,5,2,"div",13),so(),so()),2&t&&(Hi(3),ro("ngIf","outline"==e.appearance),Hi(1),ro("ngIf",e._prefixChildren.length),Hi(5),ro("ngIf",e._hasFloatingLabel()),Hi(1),ro("ngIf",e._suffixChildren.length),Hi(1),ro("ngIf","outline"!=e.appearance),Hi(1),ro("ngSwitch",e._getDisplayedMessages()),Hi(1),ro("ngSwitchCase","error"),Hi(1),ro("ngSwitchCase","hint"))},directives:[ah,uh,ch,wF],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:none}.mat-focused .cdk-high-contrast-active select.mat-input-element::-ms-value{color:inherit}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[_q.transitionMessages]},changeDetection:0}),t})(),Oq=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,_$,SF],_$]}),t})();const Pq=OP({passive:!0});let Fq=(()=>{class t{constructor(t,e){this._platform=t,this._ngZone=e,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return Qh;const e=WP(t),n=this._monitoredElements.get(e);if(n)return n.subject.asObservable();const r=new at,i="cdk-text-field-autofilled",a=t=>{"cdk-text-field-autofill-start"!==t.animationName||e.classList.contains(i)?"cdk-text-field-autofill-end"===t.animationName&&e.classList.contains(i)&&(e.classList.remove(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!1}))):(e.classList.add(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{e.addEventListener("animationstart",a,Pq),e.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(e,{subject:r,unlisten:()=>{e.removeEventListener("animationstart",a,Pq)}}),r.asObservable()}stopMonitoring(t){const e=WP(t),n=this._monitoredElements.get(e);n&&(n.unlisten(),n.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}ngOnDestroy(){this._monitoredElements.forEach((t,e)=>this.stopMonitoring(e))}}return t.\u0275fac=function(e){return new(e||t)(Ae(kP),Ae(ec))},t.\u0275prov=jt({factory:function(){return new t(Ae(kP),Ae(ec))},token:t,providedIn:"root"}),t})(),Lq=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[EP]]}),t})();const zq=new _e("MAT_INPUT_VALUE_ACCESSOR"),$q=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let Bq=0;class Wq{constructor(t,e,n,r){this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=n,this.ngControl=r}}const qq=C$(Wq);let Vq=(()=>{class t extends qq{constructor(t,e,n,r,i,a,s,o,l){super(a,r,i,n),this._elementRef=t,this._platform=e,this.ngControl=n,this._autofillMonitor=o,this._uid=`mat-input-${Bq++}`,this.focused=!1,this.stateChanges=new at,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>TP().has(t));const u=this._elementRef.nativeElement,c=u.nodeName.toLowerCase();this._inputValueAccessor=s||u,this._previousNativeValue=this.value,this.id=this.id,e.IOS&&l.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",t=>{let e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===c,this._isTextarea="textarea"===c,this._isNativeSelect&&(this.controlType=u.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=LP(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required}set required(t){this._required=LP(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&TP().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=LP(t)}ngOnInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){if($q.indexOf(this._type)>-1)throw Error(`Input type "${this._type}" isn't supported by matInput.`)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focused||this.focus()}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(kP),to(VB,10),to(LW,8),to(VW,8),to(z$),to(zq,10),to(Fq),to(ec))},t.\u0275dir=tn({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:10,hostBindings:function(t,e){1&t&&fo("focus",(function(){return e._focusChanged(!0)}))("blur",(function(){return e._focusChanged(!1)}))("input",(function(){return e._onInput()})),2&t&&(Jo("disabled",e.disabled)("required",e.required),Ks("id",e.id)("placeholder",e.placeholder)("readonly",e.readonly&&!e._isNativeSelect||null)("aria-describedby",e._ariaDescribedby||null)("aria-invalid",e.errorState)("aria-required",e.required.toString()),Ro("mat-input-server",e._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher"},exportAs:["matInput"],features:[pl([{provide:bq,useExisting:t}]),Zo,rl]}),t})(),Uq=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[z$],imports:[[Lq,Oq],Lq,Oq]}),t})();function jq(){throw Error("Host already has a portal attached")}class Hq{attach(t){return null==t&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),t.hasAttached()&&jq(),this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null==t?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class Gq extends Hq{constructor(t,e,n,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r}}class Jq extends Hq{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Xq extends Hq{constructor(t){super(),this.element=t instanceof yl?t.nativeElement:t}}class Kq{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&jq(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),t instanceof Gq?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof Jq?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Xq?(this._attachedPortal=t,this.attachDomPortal(t)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Zq extends Kq{constructor(t,e,n,r,i){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=t=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");const n=this._document.createComment("dom-portal");e.parentNode.insertBefore(n,e),this.outletElement.appendChild(e),super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})},this._document=i}attachComponentPortal(t){const e=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(e,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>n.destroy())):(n=e.create(t.injector||this._defaultInjector),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),n}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.detectChanges(),n.rootNodes.forEach(t=>this.outletElement.appendChild(t)),this.setDisposeFn(()=>{let t=e.indexOf(n);-1!==t&&e.remove(t)}),n}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}class Yq extends Zq{}let Qq=(()=>{class t extends Jq{constructor(t,e){super(t,e)}}return t.\u0275fac=function(e){return new(e||t)(to(Wl),to(Vl))},t.\u0275dir=tn({type:t,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[Zo]}),t})(),tV=(()=>{class t extends Kq{constructor(t,e,n){super(),this._componentFactoryResolver=t,this._viewContainerRef=e,this._isInitialized=!1,this.attached=new cu,this.attachDomPortal=t=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");const n=this._document.createComment("dom-portal");t.setAttachedHost(this),e.parentNode.insertBefore(n,e),this._getRootNode().appendChild(e),super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})},this._document=n}get portal(){return this._attachedPortal}set portal(t){(!this.hasAttached()||t||this._isInitialized)&&(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const e=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),r=e.createComponent(n,e.length,t.injector||e.injector);return e!==this._viewContainerRef&&this._getRootNode().appendChild(r.hostView.rootNodes[0]),super.setDisposeFn(()=>r.destroy()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachTemplatePortal(t){t.setAttachedHost(this);const e=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=e,this.attached.emit(e),e}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return t.\u0275fac=function(e){return new(e||t)(to(gl),to(Vl),to(Nc))},t.\u0275dir=tn({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Zo]}),t})(),eV=(()=>{class t extends tV{}return t.\u0275fac=function(e){return nV(e||t)},t.\u0275dir=tn({type:t,selectors:[["","cdkPortalHost",""],["","portalHost",""]],inputs:{portal:["cdkPortalHost","portal"]},exportAs:["cdkPortalHost"],features:[pl([{provide:tV,useExisting:t}]),Zo]}),t})();const nV=zr(eV);let rV=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})();class iV{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=BP(-this._previousScrollPosition.left),t.style.top=BP(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,e=t.style,n=this._document.body.style,r=e.scrollBehavior||"",i=n.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e.scrollBehavior=r,n.scrollBehavior=i}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,e=this._viewportRuler.getViewportSize();return t.scrollHeight>e.height||t.scrollWidth>e.width}}function aV(){return Error("Scroll strategy has already been attached.")}class sV{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){if(this._overlayRef)throw aV();this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class oV{enable(){}disable(){}attach(){}}function lV(t,e){return e.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function uV(t,e){return e.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class cV{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){if(this._overlayRef)throw aV();this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:e,height:n}=this._viewportRuler.getViewportSize();lV(t,[{width:e,height:n,bottom:n,right:e,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let hV=(()=>{class t{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this.noop=()=>new oV,this.close=t=>new sV(this._scrollDispatcher,this._ngZone,this._viewportRuler,t),this.block=()=>new iV(this._viewportRuler,this._document),this.reposition=t=>new cV(this._scrollDispatcher,this._viewportRuler,this._ngZone,t),this._document=r}}return t.\u0275fac=function(e){return new(e||t)(Ae(cF),Ae(dF),Ae(ec),Ae(Nc))},t.\u0275prov=jt({factory:function(){return new t(Ae(cF),Ae(dF),Ae(ec),Ae(Nc))},token:t,providedIn:"root"}),t})();class dV{constructor(t){if(this.scrollStrategy=new oV,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class pV{constructor(t,e,n,r,i){this.offsetX=n,this.offsetY=r,this.panelClass=i,this.originX=t.originX,this.originY=t.originY,this.overlayX=e.overlayX,this.overlayY=e.overlayY}}class fV{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}function mV(t,e){if("top"!==e&&"bottom"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "top", "bottom" or "center".')}function gV(t,e){if("start"!==e&&"end"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "start", "end" or "center".')}let yV=(()=>{class t{constructor(t){this._attachedOverlays=[],this._keydownListener=t=>{const e=this._attachedOverlays;for(let n=e.length-1;n>-1;n--)if(e[n]._keydownEvents.observers.length>0){e[n]._keydownEvents.next(t);break}},this._document=t}ngOnDestroy(){this._detach()}add(t){this.remove(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(t)}remove(t){const e=this._attachedOverlays.indexOf(t);e>-1&&this._attachedOverlays.splice(e,1),0===this._attachedOverlays.length&&this._detach()}_detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc))},t.\u0275prov=jt({factory:function(){return new t(Ae(Nc))},token:t,providedIn:"root"}),t})();const vV=!("undefined"==typeof window||!window||!window.__karma__&&!window.jasmine);let _V=(()=>{class t{constructor(t,e){this._platform=e,this._document=t}ngOnDestroy(){const t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._platform?this._platform.isBrowser:"undefined"!=typeof window;if(t||vV){const t=this._document.querySelectorAll('.cdk-overlay-container[platform="server"], .cdk-overlay-container[platform="test"]');for(let e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e])}const e=this._document.createElement("div");e.classList.add("cdk-overlay-container"),vV?e.setAttribute("platform","test"):t||e.setAttribute("platform","server"),this._document.body.appendChild(e),this._containerElement=e}}return t.\u0275fac=function(e){return new(e||t)(Ae(Nc),Ae(kP))},t.\u0275prov=jt({factory:function(){return new t(Ae(Nc),Ae(kP))},token:t,providedIn:"root"}),t})();class bV{constructor(t,e,n,r,i,a,s,o){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=i,this._keyboardDispatcher=a,this._document=s,this._location=o,this._backdropElement=null,this._backdropClick=new at,this._attachments=new at,this._detachments=new at,this._locationChanges=j.EMPTY,this._backdropClickHandler=t=>this._backdropClick.next(t),this._keydownEvents=new at,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(xd(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick.asObservable()}attachments(){return this._attachments.asObservable()}detachments(){return this._detachments.asObservable()}keydownEvents(){return this._keydownEvents.asObservable()}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=BP(this._config.width),t.height=BP(this._config.height),t.minWidth=BP(this._config.minWidth),t.minHeight=BP(this._config.minHeight),t.maxWidth=BP(this._config.maxWidth),t.maxHeight=BP(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"auto":"none"}_attachBackdrop(){this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add("cdk-overlay-backdrop-showing")})}):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t,e=this._backdropElement;if(!e)return;let n=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",n),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",n)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(n,500))}_toggleClasses(t,e,n){const r=t.classList;$P(e).forEach(t=>{t&&(n?r.add(t):r.remove(t))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.asObservable().pipe(rF(kt(this._attachments,this._detachments))).subscribe(()=>{this._pane&&this._host&&0!==this._pane.children.length||(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}}const xV=/([A-Za-z%]+)$/;class wV{constructor(t,e,n,r,i){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=i,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new at,this._resizeSubscription=j.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){if(this._overlayRef&&t!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),t.hostElement.classList.add("cdk-overlay-connected-position-bounding-box"),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=[];let i;for(let a of this._preferredPositions){let s=this._getOriginPoint(t,a),o=this._getOverlayPoint(s,e,a),l=this._getOverlayFit(o,e,n,a);if(l.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,s);this._canFitWithFlexibleDimensions(l,o,n)?r.push({position:a,origin:s,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(s,a)}):(!i||i.overlayFit.visibleArea<l.visibleArea)&&(i={overlayFit:l,overlayPoint:o,originPoint:s,position:a,overlayRect:e})}if(r.length){let t=null,e=-1;for(const n of r){const r=n.boundingBoxRect.width*n.boundingBoxRect.height*(n.position.weight||1);r>e&&(e=r,t=n)}return this._isPushed=!1,void this._applyPosition(t.position,t.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(i.position,i.originPoint);this._applyPosition(i.position,i.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&SV(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove("cdk-overlay-connected-position-bounding-box"),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const t=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,t);this._applyPosition(t,e)}}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e){let n,r;if("center"==e.originX)n=t.left+t.width/2;else{const r=this._isRtl()?t.right:t.left,i=this._isRtl()?t.left:t.right;n="start"==e.originX?r:i}return r="center"==e.originY?t.top+t.height/2:"top"==e.originY?t.top:t.bottom,{x:n,y:r}}_getOverlayPoint(t,e,n){let r,i;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,i="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+i}}_getOverlayFit(t,e,n,r){let{x:i,y:a}=t,s=this._getOffset(r,"x"),o=this._getOffset(r,"y");s&&(i+=s),o&&(a+=o);let l=0-a,u=a+e.height-n.height,c=this._subtractOverflows(e.width,0-i,i+e.width-n.width),h=this._subtractOverflows(e.height,l,u),d=c*h;return{visibleArea:d,isCompletelyWithinViewport:e.width*e.height===d,fitsInViewportVertically:h===e.height,fitsInViewportHorizontally:c==e.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,i=n.right-e.x,a=CV(this._overlayRef.getConfig().minHeight),s=CV(this._overlayRef.getConfig().minWidth),o=t.fitsInViewportHorizontally||null!=s&&s<=i;return(t.fitsInViewportVertically||null!=a&&a<=r)&&o}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=this._viewportRect,i=Math.max(t.x+e.width-r.right,0),a=Math.max(t.y+e.height-r.bottom,0),s=Math.max(r.top-n.top-t.y,0),o=Math.max(r.left-n.left-t.x,0);let l=0,u=0;return l=e.width<=r.width?o||-i:t.x<this._viewportMargin?r.left-n.left-t.x:0,u=e.height<=r.height?s||-a:t.y<this._viewportMargin?r.top-n.top-t.y:0,this._previousPushAmount={x:l,y:u},{x:t.x+l,y:t.y+u}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const e=this._getScrollVisibility(),n=new fV(t,e);this._positionChanges.next(n)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let i=0;i<e.length;i++)e[i].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let i,a,s,o,l,u;if("top"===e.overlayY)a=t.y,i=n.height-a+this._viewportMargin;else if("bottom"===e.overlayY)s=n.height-t.y+2*this._viewportMargin,i=n.height-s+this._viewportMargin;else{const e=Math.min(n.bottom-t.y+n.top,t.y),r=this._lastBoundingBoxSize.height;i=2*e,a=t.y-e,i>r&&!this._isInitialRender&&!this._growAfterOpen&&(a=t.y-r/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)u=n.width-t.x+this._viewportMargin,o=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)l=t.x,o=n.right-t.x;else{const e=Math.min(n.right-t.x+n.left,t.x),r=this._lastBoundingBoxSize.width;o=2*e,l=t.x-e,o>r&&!this._isInitialRender&&!this._growAfterOpen&&(l=t.x-r/2)}return{top:a,left:l,bottom:s,right:u,width:o,height:i}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const t=this._overlayRef.getConfig().maxHeight,i=this._overlayRef.getConfig().maxWidth;r.height=BP(n.height),r.top=BP(n.top),r.bottom=BP(n.bottom),r.width=BP(n.width),r.left=BP(n.left),r.right=BP(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",t&&(r.maxHeight=BP(t)),i&&(r.maxWidth=BP(i))}this._lastBoundingBoxSize=n,SV(this._boundingBox.style,r)}_resetBoundingBoxStyles(){SV(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){SV(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},r=this._hasExactPosition(),i=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(r){const r=this._viewportRuler.getViewportScrollPosition();SV(n,this._getExactOverlayY(e,t,r)),SV(n,this._getExactOverlayX(e,t,r))}else n.position="static";let s="",o=this._getOffset(e,"x"),l=this._getOffset(e,"y");o&&(s+=`translateX(${o}px) `),l&&(s+=`translateY(${l}px)`),n.transform=s.trim(),a.maxHeight&&(r?n.maxHeight=BP(a.maxHeight):i&&(n.maxHeight="")),a.maxWidth&&(r?n.maxWidth=BP(a.maxWidth):i&&(n.maxWidth="")),SV(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:"",bottom:""},i=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n));let a=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return i.y-=a,"bottom"===t.overlayY?r.bottom=`${this._document.documentElement.clientHeight-(i.y+this._overlayRect.height)}px`:r.top=BP(i.y),r}_getExactOverlayX(t,e,n){let r,i={left:"",right:""},a=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,n)),r=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===r?i.right=`${this._document.documentElement.clientWidth-(a.x+this._overlayRect.width)}px`:i.left=BP(a.x),i}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(t=>t.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:uV(t,n),isOriginOutsideView:lV(t,n),isOverlayClipped:uV(e,n),isOverlayOutsideView:lV(e,n)}}_subtractOverflows(t,...e){return e.reduce((t,e)=>t-Math.max(e,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach(t=>{gV("originX",t.originX),mV("originY",t.originY),gV("overlayX",t.overlayX),mV("overlayY",t.overlayY)})}_addPanelClasses(t){this._pane&&$P(t).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof yl)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function SV(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function CV(t){if("number"!=typeof t&&null!=t){const[e,n]=t.split(xV);return n&&"px"!==n?null:parseFloat(e)}return t||null}class DV{constructor(t,e,n,r,i,a,s){this._preferredPositions=[],this._positionStrategy=new wV(n,r,i,a,s).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,e)}get _isRtl(){return"rtl"===this._overlayRef.getDirection()}get onPositionChange(){return this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(t){this._overlayRef=t,this._positionStrategy.attach(t),this._direction&&(t.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(t){this._positionStrategy.withScrollableContainers(t)}withFallbackPosition(t,e,n,r){const i=new pV(t,e,n,r);return this._preferredPositions.push(i),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(t){return this._overlayRef?this._overlayRef.setDirection(t):this._direction=t,this}withOffsetX(t){return this._positionStrategy.withDefaultOffsetX(t),this}withOffsetY(t){return this._positionStrategy.withDefaultOffsetY(t),this}withLockedPosition(t){return this._positionStrategy.withLockedPosition(t),this}withPositions(t){return this._preferredPositions=t.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(t){return this._positionStrategy.setOrigin(t),this}}class IV{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add("cdk-global-overlay-wrapper"),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:i,maxWidth:a,maxHeight:s}=n,o=!("100%"!==r&&"100vw"!==r||a&&"100%"!==a&&"100vw"!==a),l=!("100%"!==i&&"100vh"!==i||s&&"100%"!==s&&"100vh"!==s);t.position=this._cssPosition,t.marginLeft=o?"0":this._leftOffset,t.marginTop=l?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,o?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove("cdk-global-overlay-wrapper"),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let kV=(()=>{class t{constructor(t,e,n,r){this._viewportRuler=t,this._document=e,this._platform=n,this._overlayContainer=r}global(){return new IV}connectedTo(t,e,n){return new DV(e,n,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new wV(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return t.\u0275fac=function(e){return new(e||t)(Ae(dF),Ae(Nc),Ae(kP),Ae(_V))},t.\u0275prov=jt({factory:function(){return new t(Ae(dF),Ae(Nc),Ae(kP),Ae(_V))},token:t,providedIn:"root"}),t})(),EV=0,AV=(()=>{class t{constructor(t,e,n,r,i,a,s,o,l,u){this.scrollStrategies=t,this._overlayContainer=e,this._componentFactoryResolver=n,this._positionBuilder=r,this._keyboardDispatcher=i,this._injector=a,this._ngZone=s,this._document=o,this._directionality=l,this._location=u}create(t){const e=this._createHostElement(),n=this._createPaneElement(e),r=this._createPortalOutlet(n),i=new dV(t);return i.direction=i.direction||this._directionality.value,new bV(r,e,n,i,this._ngZone,this._keyboardDispatcher,this._document,this._location)}position(){return this._positionBuilder}_createPaneElement(t){const e=this._document.createElement("div");return e.id=`cdk-overlay-${EV++}`,e.classList.add("cdk-overlay-pane"),t.appendChild(e),e}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(xc)),new Zq(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return t.\u0275fac=function(e){return new(e||t)(Ae(hV),Ae(_V),Ae(gl),Ae(kV),Ae(yV),Ae(Fs),Ae(ec),Ae(Nc),Ae(oF),Ae(Jc,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const TV=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],RV=new _e("cdk-connected-overlay-scroll-strategy");let MV=(()=>{class t{constructor(t){this.elementRef=t}}return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275dir=tn({type:t,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),t})(),NV=(()=>{class t{constructor(t,e,n,r,i){this._overlay=t,this._dir=i,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=j.EMPTY,this.viewportMargin=0,this.open=!1,this.backdropClick=new cu,this.positionChange=new cu,this.attach=new cu,this.detach=new cu,this.overlayKeydown=new cu,this._templatePortal=new Jq(e,n),this._scrollStrategyFactory=r,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=LP(t)}get lockPosition(){return this._lockPosition}set lockPosition(t){this._lockPosition=LP(t)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(t){this._flexibleDimensions=LP(t)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(t){this._growAfterOpen=LP(t)}get push(){return this._push}set push(t){this._push=LP(t)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._overlayRef&&this._overlayRef.dispose(),this._backdropSubscription.unsubscribe()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){this.positions&&this.positions.length||(this.positions=TV),this._overlayRef=this._overlay.create(this._buildConfig()),this._overlayRef.keydownEvents().subscribe(t=>{this.overlayKeydown.next(t),27!==t.keyCode||mF(t)||(t.preventDefault(),this._detachOverlay())})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),e=new dV({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(e.width=this.width),(this.height||0===this.height)&&(e.height=this.height),(this.minWidth||0===this.minWidth)&&(e.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(e.minHeight=this.minHeight),this.backdropClass&&(e.backdropClass=this.backdropClass),this.panelClass&&(e.panelClass=this.panelClass),e}_updatePositionStrategy(t){const e=this.positions.map(t=>({originX:t.originX,originY:t.originY,overlayX:t.overlayX,overlayY:t.overlayY,offsetX:t.offsetX||this.offsetX,offsetY:t.offsetY||this.offsetY,panelClass:t.panelClass||void 0}));return t.setOrigin(this.origin.elementRef).withPositions(e).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this.origin.elementRef);return this._updatePositionStrategy(t),t.positionChanges.subscribe(t=>this.positionChange.emit(t)),t}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||(this._overlayRef.attach(this._templatePortal),this.attach.emit()),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe()}_detachOverlay(){this._overlayRef&&(this._overlayRef.detach(),this.detach.emit()),this._backdropSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(to(AV),to(Wl),to(Vl),to(RV),to(oF,8))},t.\u0275dir=tn({type:t,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],open:["cdkConnectedOverlayOpen","open"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"],positions:["cdkConnectedOverlayPositions","positions"],origin:["cdkConnectedOverlayOrigin","origin"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown"},exportAs:["cdkConnectedOverlay"],features:[rl]}),t})();const OV={provide:RV,deps:[AV],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let PV=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[AV,OV],imports:[[lF,rV,fF],fF]}),t})();const FV=["trigger"],LV=["panel"];function zV(t,e){if(1&t&&(ao(0,"span",8),Vo(1),so()),2&t){const t=_o();Hi(1),Uo(t.placeholder||"\xa0")}}function $V(t,e){if(1&t&&(ao(0,"span"),Vo(1),so()),2&t){const t=_o(2);Hi(1),Uo(t.triggerValue||"\xa0")}}function BV(t,e){1&t&&wo(0,0,["*ngSwitchCase","true"])}function WV(t,e){1&t&&(ao(0,"span",9),Ys(1,$V,2,1,"span",10),Ys(2,BV,1,0,void 0,11),so()),2&t&&(ro("ngSwitch",!!_o().customTrigger),Hi(2),ro("ngSwitchCase",!0))}function qV(t,e){if(1&t){const t=co();ao(0,"div",12),ao(1,"div",13,14),fo("@transformPanel.done",(function(e){return Tn(t),_o()._panelDoneAnimatingStream.next(e.toState)}))("keydown",(function(e){return Tn(t),_o()._handleKeydown(e)})),wo(3,1),so(),so()}if(2&t){const t=_o();ro("@transformPanelWrap",void 0),Hi(1),Go("mat-select-panel ",t._getPanelTheme(),""),To("transform-origin",t._transformOrigin)("font-size",t._triggerFontSize,"px"),ro("ngClass",t.panelClass)("@transformPanel",t.multiple?"showing-multiple":"showing"),Ks("id",t.id+"-panel")}}const VV=[[["mat-select-trigger"]],"*"],UV=["mat-select-trigger","*"],jV={transformPanelWrap:jF("transformPanelWrap",[KF("* => void",YF("@transformPanel",[ZF()],{optional:!0}))]),transformPanel:jF("transformPanel",[XF("void",JF({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),XF("showing",JF({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),XF("showing-multiple",JF({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),KF("void => *",HF("120ms cubic-bezier(0, 0, 0.2, 1)")),KF("* => void",HF("100ms 25ms linear",JF({opacity:0})))])};let HV=0;const GV=new _e("mat-select-scroll-strategy"),JV=new _e("MAT_SELECT_CONFIG"),XV={provide:GV,deps:[AV],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};class KV{constructor(t,e){this.source=t,this.value=e}}class ZV{constructor(t,e,n,r,i){this._elementRef=t,this._defaultErrorStateMatcher=e,this._parentForm=n,this._parentFormGroup=r,this.ngControl=i}}const YV=w$(S$(b$(C$(ZV))));let QV=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=tn({type:t,selectors:[["mat-select-trigger"]]}),t})(),tU=(()=>{class t extends YV{constructor(t,e,n,r,i,a,s,o,l,u,c,h,d,p){super(i,r,s,o,u),this._viewportRuler=t,this._changeDetectorRef=e,this._ngZone=n,this._dir=a,this._parentFormField=l,this.ngControl=u,this._liveAnnouncer=d,this._panelOpen=!1,this._required=!1,this._scrollTop=0,this._multiple=!1,this._compareWith=(t,e)=>t===e,this._uid=`mat-select-${HV++}`,this._destroy=new at,this._triggerFontSize=0,this._onChange=()=>{},this._onTouched=()=>{},this._optionIds="",this._transformOrigin="top",this._panelDoneAnimatingStream=new at,this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],this._disableOptionCentering=!1,this._focused=!1,this.controlType="mat-select",this.ariaLabel="",this.optionSelectionChanges=ed(()=>{const t=this.options;return t?t.changes.pipe(Rd(t),kd(()=>kt(...t.map(t=>t.onSelectionChange)))):this._ngZone.onStable.asObservable().pipe(xd(1),kd(()=>this.optionSelectionChanges))}),this.openedChange=new cu,this._openedStream=this.openedChange.pipe(rd(t=>t),yt(()=>{})),this._closedStream=this.openedChange.pipe(rd(t=>!t),yt(()=>{})),this.selectionChange=new cu,this.valueChange=new cu,this.ngControl&&(this.ngControl.valueAccessor=this),this._scrollStrategyFactory=h,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(c)||0,this.id=this.id,p&&(null!=p.disableOptionCentering&&(this.disableOptionCentering=p.disableOptionCentering),null!=p.typeaheadDebounceInterval&&(this.typeaheadDebounceInterval=p.typeaheadDebounceInterval))}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required}set required(t){this._required=LP(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){if(this._selectionModel)throw Error("Cannot change `multiple` mode of select after initialization.");this._multiple=LP(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=LP(t)}get compareWith(){return this._compareWith}set compareWith(t){if("function"!=typeof t)throw Error("`compareWith` must be a function.");this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){t!==this._value&&(this.writeValue(t),this._value=t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=zP(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new uF(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(GP(),rF(this._destroy)).subscribe(()=>{this.panelOpen?(this._scrollTop=0,this.openedChange.emit(!0)):(this.openedChange.emit(!1),this.overlayDir.offsetX=0,this._changeDetectorRef.markForCheck())}),this._viewportRuler.change().pipe(rF(this._destroy)).subscribe(()=>{this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(rF(this._destroy)).subscribe(t=>{t.added.forEach(t=>t.select()),t.removed.forEach(t=>t.deselect())}),this.options.changes.pipe(Rd(null),rF(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){this.ngControl&&this.updateErrorState()}ngOnChanges(t){t.disabled&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._calculateOverlayPosition(),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this._ngZone.onStable.asObservable().pipe(xd(1)).subscribe(()=>{this._triggerFontSize&&this.overlayDir.overlayRef&&this.overlayDir.overlayRef.overlayElement&&(this.overlayDir.overlayRef.overlayElement.style.fontSize=`${this._triggerFontSize}px`)}))}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this.options&&this._setSelectionByValue(t)}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(t=>t.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const e=t.keyCode,n=40===e||38===e||37===e||39===e,r=13===e||32===e,i=this._keyManager;if(!i.isTyping()&&r&&!mF(t)||(this.multiple||t.altKey)&&n)t.preventDefault(),this.open();else if(!this.multiple){const n=this.selected;36===e||35===e?(36===e?i.setFirstItemActive():i.setLastItemActive(),t.preventDefault()):i.onKeydown(t);const r=this.selected;r&&n!==r&&this._liveAnnouncer.announce(r.viewValue,1e4)}}_handleOpenKeydown(t){const e=this._keyManager,n=t.keyCode,r=40===n||38===n,i=e.isTyping();if(36===n||35===n)t.preventDefault(),36===n?e.setFirstItemActive():e.setLastItemActive();else if(r&&t.altKey)t.preventDefault(),this.close();else if(i||13!==n&&32!==n||!e.activeItem||mF(t))if(!i&&this._multiple&&65===n&&t.ctrlKey){t.preventDefault();const e=this.options.some(t=>!t.disabled&&!t.selected);this.options.forEach(t=>{t.disabled||(e?t.select():t.deselect())})}else{const n=e.activeItemIndex;e.onKeydown(t),this._multiple&&r&&t.shiftKey&&e.activeItem&&e.activeItemIndex!==n&&e.activeItem._selectViaInteraction()}else t.preventDefault(),e.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this.overlayDir.positionChange.pipe(xd(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this._setSelectionByValue(this.ngControl?this.ngControl.value:this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.multiple&&t){if(!Array.isArray(t))throw Error("Value must be an array in multiple-selection mode.");this._selectionModel.clear(),t.forEach(t=>this._selectValue(t)),this._sortValues()}else{this._selectionModel.clear();const e=this._selectValue(t);e?this._keyManager.setActiveItem(e):this.panelOpen||this._keyManager.setActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectValue(t){const e=this.options.find(e=>{try{return null!=e.value&&this._compareWith(e.value,t)}catch(n){return ti()&&console.warn(n),!1}});return e&&this._selectionModel.select(e),e}_initKeyManager(){this._keyManager=new DF(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(rF(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe(rF(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollActiveOptionIntoView():this._panelOpen||this.multiple||!this._keyManager.activeItem||this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=kt(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(rF(t)).subscribe(t=>{this._onSelect(t.source,t.isUserInput),t.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),kt(...this.options.map(t=>t._stateChanges)).pipe(rF(t)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()}),this._setOptionIds()}_onSelect(t,e){const n=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(n!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),e&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),e&&this.focus())):(t.deselect(),this._selectionModel.clear(),this._propagateChanges(t.value)),n!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((e,n)=>this.sortComparator?this.sortComparator(e,n,t):t.indexOf(e)-t.indexOf(n)),this.stateChanges.next()}}_propagateChanges(t){let e=null;e=this.multiple?this.selected.map(t=>t.value):this.selected?this.selected.value:t,this._value=e,this.valueChange.emit(e),this._onChange(e),this.selectionChange.emit(new KV(this,e)),this._changeDetectorRef.markForCheck()}_setOptionIds(){this._optionIds=this.options.map(t=>t.id).join(" ")}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_scrollActiveOptionIntoView(){const t=this._keyManager.activeItemIndex||0,e=sB(t,this.options,this.optionGroups);this.panel.nativeElement.scrollTop=function(t,e,n,r){const i=t*e;return i<n?i:i+e>n+256?Math.max(0,i-256+e):n}(t+e,this._getItemHeight(),this.panel.nativeElement.scrollTop)}focus(t){this._elementRef.nativeElement.focus(t)}_getOptionIndex(t){return this.options.reduce((e,n,r)=>void 0!==e?e:t===n?r:void 0,void 0)}_calculateOverlayPosition(){const t=this._getItemHeight(),e=this._getItemCount(),n=Math.min(e*t,256),r=e*t-n;let i=this.empty?0:this._getOptionIndex(this._selectionModel.selected[0]);i+=sB(i,this.options,this.optionGroups);const a=n/2;this._scrollTop=this._calculateOverlayScroll(i,a,r),this._offsetY=this._calculateOverlayOffsetY(i,a,r),this._checkOverlayWithinViewport(r)}_calculateOverlayScroll(t,e,n){const r=this._getItemHeight();return Math.min(Math.max(0,r*t-e+r/2),n)}_getAriaLabel(){return this.ariaLabelledby?null:this.ariaLabel||this.placeholder}_getAriaLabelledby(){return this.ariaLabelledby?this.ariaLabelledby:this._parentFormField&&this._parentFormField._hasFloatingLabel()&&!this._getAriaLabel()&&this._parentFormField._labelId||null}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_calculateOverlayOffsetX(){const t=this.overlayDir.overlayRef.overlayElement.getBoundingClientRect(),e=this._viewportRuler.getViewportSize(),n=this._isRtl(),r=this.multiple?56:32;let i;if(this.multiple)i=40;else{let t=this._selectionModel.selected[0]||this.options.first;i=t&&t.group?32:16}n||(i*=-1);const a=0-(t.left+i-(n?r:0)),s=t.right+i-e.width+(n?0:r);a>0?i+=a+8:s>0&&(i-=s+8),this.overlayDir.offsetX=Math.round(i),this.overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(t,e,n){const r=this._getItemHeight(),i=(r-this._triggerRect.height)/2,a=Math.floor(256/r);let s;return this._disableOptionCentering?0:(s=0===this._scrollTop?t*r:this._scrollTop===n?(t-(this._getItemCount()-a))*r+(r-(this._getItemCount()*r-256)%r):e-r/2,Math.round(-1*s-i))}_checkOverlayWithinViewport(t){const e=this._getItemHeight(),n=this._viewportRuler.getViewportSize(),r=this._triggerRect.top-8,i=n.height-this._triggerRect.bottom-8,a=Math.abs(this._offsetY),s=Math.min(this._getItemCount()*e,256)-a-this._triggerRect.height;s>i?this._adjustPanelUp(s,i):a>r?this._adjustPanelDown(a,r,t):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(t,e){const n=Math.round(t-e);this._scrollTop-=n,this._offsetY-=n,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(t,e,n){const r=Math.round(t-e);if(this._scrollTop+=r,this._offsetY+=r,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=n)return this._scrollTop=n,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_getOriginBasedOnOption(){const t=this._getItemHeight(),e=(t-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-e+t/2}px 0px`}_getItemCount(){return this.options.length+this.optionGroups.length}_getItemHeight(){return 3*this._triggerFontSize}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty}}return t.\u0275fac=function(e){return new(e||t)(to(dF),to(bs),to(ec),to(z$),to(yl),to(oF,8),to(LW,8),to(VW,8),to(Mq,8),to(VB,10),eo("tabindex"),to(GV),to(OF),to(JV,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-select"]],contentQueries:function(t,e,n){var r;1&t&&(Du(n,QV,!0),Du(n,aB,!0),Du(n,tB,!0)),2&t&&(xu(r=Eu())&&(e.customTrigger=r.first),xu(r=Eu())&&(e.options=r),xu(r=Eu())&&(e.optionGroups=r))},viewQuery:function(t,e){var n;1&t&&(Su(FV,!0),Su(LV,!0),Su(NV,!0)),2&t&&(xu(n=Eu())&&(e.trigger=n.first),xu(n=Eu())&&(e.panel=n.first),xu(n=Eu())&&(e.overlayDir=n.first))},hostAttrs:["role","listbox",1,"mat-select"],hostVars:19,hostBindings:function(t,e){1&t&&fo("keydown",(function(t){return e._handleKeydown(t)}))("focus",(function(){return e._onFocus()}))("blur",(function(){return e._onBlur()})),2&t&&(Ks("id",e.id)("tabindex",e.tabIndex)("aria-label",e._getAriaLabel())("aria-labelledby",e._getAriaLabelledby())("aria-required",e.required.toString())("aria-disabled",e.disabled.toString())("aria-invalid",e.errorState)("aria-owns",e.panelOpen?e._optionIds:null)("aria-multiselectable",e.multiple)("aria-describedby",e._ariaDescribedby||null)("aria-activedescendant",e._getAriaActiveDescendant()),Ro("mat-select-disabled",e.disabled)("mat-select-invalid",e.errorState)("mat-select-required",e.required)("mat-select-empty",e.empty))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],id:"id",disableOptionCentering:"disableOptionCentering",typeaheadDebounceInterval:"typeaheadDebounceInterval",placeholder:"placeholder",required:"required",multiple:"multiple",compareWith:"compareWith",value:"value",panelClass:"panelClass",ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",sortComparator:"sortComparator"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[pl([{provide:bq,useExisting:t},{provide:iB,useExisting:t}]),Zo,rl],ngContentSelectors:UV,decls:9,vars:9,consts:[["cdk-overlay-origin","","aria-hidden","true",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder"],[1,"mat-select-value-text",3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-panel-wrap"],[3,"ngClass","keydown"],["panel",""]],template:function(t,e){if(1&t&&(xo(VV),ao(0,"div",0,1),fo("click",(function(){return e.toggle()})),ao(3,"div",2),Ys(4,zV,2,1,"span",3),Ys(5,WV,3,2,"span",4),so(),ao(6,"div",5),oo(7,"div",6),so(),so(),Ys(8,qV,4,11,"ng-template",7),fo("backdropClick",(function(){return e.close()}))("attach",(function(){return e._onAttached()}))("detach",(function(){return e.close()}))),2&t){const t=Qs(1);Hi(3),ro("ngSwitch",e.empty),Hi(1),ro("ngSwitchCase",!0),Hi(1),ro("ngSwitchCase",!1),Hi(3),ro("cdkConnectedOverlayScrollStrategy",e._scrollStrategy)("cdkConnectedOverlayOrigin",t)("cdkConnectedOverlayOpen",e.panelOpen)("cdkConnectedOverlayPositions",e._positions)("cdkConnectedOverlayMinWidth",null==e._triggerRect?null:e._triggerRect.width)("cdkConnectedOverlayOffsetY",e._offsetY)}},directives:[MV,uh,ch,NV,hh,eh],styles:[".mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-table;cursor:pointer;position:relative;box-sizing:border-box}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-select-value{display:table-cell;max-width:0;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{display:table-cell;vertical-align:middle}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}\n"],encapsulation:2,data:{animation:[jV.transformPanelWrap,jV.transformPanel]},changeDetection:0}),t})(),eU=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[XV],imports:[[fh,PV,oB,_$],pF,Oq,oB,_$]}),t})();const nU=["*"];function rU(t){return Error(`Unable to find icon with the name "${t}"`)}function iU(t){return Error("The URL provided to MatIconRegistry was not trusted as a resource URL "+`via Angular's DomSanitizer. Attempted URL was "${t}".`)}function aU(t){return Error("The literal provided to MatIconRegistry was not trusted as safe HTML by "+`Angular's DomSanitizer. Attempted literal was "${t}".`)}class sU{constructor(t,e){this.options=e,t.nodeName?this.svgElement=t:this.url=t}}let oU=(()=>{class t{constructor(t,e,n,r){this._httpClient=t,this._sanitizer=e,this._errorHandler=r,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=n}addSvgIcon(t,e,n){return this.addSvgIconInNamespace("",t,e,n)}addSvgIconLiteral(t,e,n){return this.addSvgIconLiteralInNamespace("",t,e,n)}addSvgIconInNamespace(t,e,n,r){return this._addSvgIconConfig(t,e,new sU(n,r))}addSvgIconLiteralInNamespace(t,e,n,r){const i=this._sanitizer.sanitize(Si.HTML,n);if(!i)throw aU(n);const a=this._createSvgElementForSingleIcon(i,r);return this._addSvgIconConfig(t,e,new sU(a,r))}addSvgIconSet(t,e){return this.addSvgIconSetInNamespace("",t,e)}addSvgIconSetLiteral(t,e){return this.addSvgIconSetLiteralInNamespace("",t,e)}addSvgIconSetInNamespace(t,e,n){return this._addSvgIconSetConfig(t,new sU(e,n))}addSvgIconSetLiteralInNamespace(t,e,n){const r=this._sanitizer.sanitize(Si.HTML,e);if(!r)throw aU(e);const i=this._svgElementFromString(r);return this._addSvgIconSetConfig(t,new sU(i,n))}registerFontClassAlias(t,e=t){return this._fontCssClassesByAlias.set(t,e),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const e=this._sanitizer.sanitize(Si.RESOURCE_URL,t);if(!e)throw iU(t);const n=this._cachedIconsByUrl.get(e);return n?Gh(lU(n)):this._loadSvgIconFromConfig(new sU(t)).pipe(Ld(t=>this._cachedIconsByUrl.set(e,t)),yt(t=>lU(t)))}getNamedSvgIcon(t,e=""){const n=uU(e,t),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);const i=this._iconSetConfigs.get(e);return i?this._getSvgFromIconSetConfigs(t,i):(a=rU(n),new tt(t=>t.error(a)));var a}ngOnDestroy(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgElement?Gh(lU(t.svgElement)):this._loadSvgIconFromConfig(t).pipe(Ld(e=>t.svgElement=e),yt(t=>lU(t)))}_getSvgFromIconSetConfigs(t,e){const n=this._extractIconWithNameFromAnySet(t,e);return n?Gh(n):RB(e.filter(t=>!t.svgElement).map(t=>this._loadSvgIconSetFromConfig(t).pipe(vd(e=>{const n=`Loading icon set URL: ${this._sanitizer.sanitize(Si.RESOURCE_URL,t.url)} failed: ${e.message}`;return this._errorHandler?this._errorHandler.handleError(new Error(n)):console.error(n),Gh(null)})))).pipe(yt(()=>{const n=this._extractIconWithNameFromAnySet(t,e);if(!n)throw rU(t);return n}))}_extractIconWithNameFromAnySet(t,e){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.svgElement){const e=this._extractSvgIconFromSet(r.svgElement,t,r.options);if(e)return e}}return null}_loadSvgIconFromConfig(t){return this._fetchUrl(t.url).pipe(yt(e=>this._createSvgElementForSingleIcon(e,t.options)))}_loadSvgIconSetFromConfig(t){return t.svgElement?Gh(t.svgElement):this._fetchUrl(t.url).pipe(yt(e=>(t.svgElement||(t.svgElement=this._svgElementFromString(e)),t.svgElement)))}_createSvgElementForSingleIcon(t,e){const n=this._svgElementFromString(t);return this._setSvgAttributes(n,e),n}_extractSvgIconFromSet(t,e,n){const r=t.querySelector(`[id="${e}"]`);if(!r)return null;const i=r.cloneNode(!0);if(i.removeAttribute("id"),"svg"===i.nodeName.toLowerCase())return this._setSvgAttributes(i,n);if("symbol"===i.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(i),n);const a=this._svgElementFromString("<svg></svg>");return a.appendChild(i),this._setSvgAttributes(a,n)}_svgElementFromString(t){const e=this._document.createElement("DIV");e.innerHTML=t;const n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(t){const e=this._svgElementFromString("<svg></svg>"),n=t.attributes;for(let r=0;r<n.length;r++){const{name:t,value:i}=n[r];"id"!==t&&e.setAttribute(t,i)}for(let r=0;r<t.childNodes.length;r++)t.childNodes[r].nodeType===this._document.ELEMENT_NODE&&e.appendChild(t.childNodes[r].cloneNode(!0));return e}_setSvgAttributes(t,e){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),e&&e.viewBox&&t.setAttribute("viewBox",e.viewBox),t}_fetchUrl(t){if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==t)throw Error(`Cannot fetch icon from URL "${t}".`);const e=this._sanitizer.sanitize(Si.RESOURCE_URL,t);if(!e)throw iU(t);const n=this._inProgressUrlFetches.get(e);if(n)return n;const r=this._httpClient.get(e,{responseType:"text"}).pipe(Bd(()=>this._inProgressUrlFetches.delete(e)),Pt());return this._inProgressUrlFetches.set(e,r),r}_addSvgIconConfig(t,e,n){return this._svgIconConfigs.set(uU(t,e),n),this}_addSvgIconSetConfig(t,e){const n=this._iconSetConfigs.get(t);return n?n.push(e):this._iconSetConfigs.set(t,[e]),this}}return t.\u0275fac=function(e){return new(e||t)(Ae(oP,8),Ae(qh),Ae(Nc,8),Ae(qr,8))},t.\u0275prov=jt({factory:function(){return new t(Ae(oP,8),Ae(qh),Ae(Nc,8),Ae(qr,8))},token:t,providedIn:"root"}),t})();function lU(t){return t.cloneNode(!0)}function uU(t,e){return t+":"+e}class cU{constructor(t){this._elementRef=t}}const hU=x$(cU),dU=new _e("mat-icon-location",{providedIn:"root",factory:function(){const t=Te(Nc),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),pU=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],fU=pU.map(t=>`[${t}]`).join(", "),mU=/^url\(['"]?#(.*?)['"]?\)$/;let gU=(()=>{class t extends hU{constructor(t,e,n,r,i){super(t),this._iconRegistry=e,this._location=r,this._errorHandler=i,this._inline=!1,this._currentIconFetch=j.EMPTY,n||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=LP(t)}get fontSet(){return this._fontSet}set fontSet(t){this._fontSet=this._cleanupFontValue(t)}get fontIcon(){return this._fontIcon}set fontIcon(t){this._fontIcon=this._cleanupFontValue(t)}_splitIconName(t){if(!t)return["",""];const e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnChanges(t){const e=t.svgIcon;if(e)if(this._currentIconFetch.unsubscribe(),this.svgIcon){const[t,e]=this._splitIconName(this.svgIcon);this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(e,t).pipe(xd(1)).subscribe(t=>this._setSvgElement(t),n=>{const r=`Error retrieving icon ${t}:${e}! ${n.message}`;this._errorHandler?this._errorHandler.handleError(new Error(r)):console.error(r)})}else e.previousValue&&this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()}ngOnInit(){this._usingFontIcon()&&this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&this._location&&t.size){const t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const e=t.querySelectorAll("style");for(let n=0;n<e.length;n++)e[n].textContent+=" ";if(this._location){const e=this._location.getPathname();this._previousPath=e,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(e)}this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let e=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();e--;){const n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,e=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();e!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),e&&t.classList.add(e),this._previousFontSetClass=e),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const e=this._elementsWithExternalReferences;e&&e.forEach((e,n)=>{e.forEach(e=>{n.setAttribute(e.name,`url('${t}#${e.value}')`)})})}_cacheChildrenWithExternalReferences(t){const e=t.querySelectorAll(fU),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<e.length;r++)pU.forEach(t=>{const i=e[r],a=i.getAttribute(t),s=a?a.match(mU):null;if(s){let e=n.get(i);e||(e=[],n.set(i,e)),e.push({name:t,value:s[1]})}})}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(oU),eo("aria-hidden"),to(dU,8),to(qr,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:4,hostBindings:function(t,e){2&t&&Ro("mat-icon-inline",e.inline)("mat-icon-no-color","primary"!==e.color&&"accent"!==e.color&&"warn"!==e.color)},inputs:{color:"color",inline:"inline",fontSet:"fontSet",fontIcon:"fontIcon",svgIcon:"svgIcon"},exportAs:["matIcon"],features:[Zo,rl],ngContentSelectors:nU,decls:1,vars:0,template:function(t,e){1&t&&(xo(),wo(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),t})(),yU=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$],_$]}),t})();function vU(t,e){1&t&&(ao(0,"small",28),Vo(1,"Must Envision a trend!"),so())}function _U(t,e){1&t&&(ao(0,"small",29),Vo(1,"Must Envision a year!"),so())}let bU=(()=>{class t{constructor(t,e){this.trendsapiService=t,this.sidebarService=e,this.clicked=!1,this.loading=!1,this.byDate=[]}ngOnInit(){this.searchForm=new NW({keyword:new MW(null,ZB.required),year:new MW(null,ZB.required)})}ngOnDestroy(){this.arraybyDate.unsubscribe()}onSubmit(t){t.preventDefault(),this.clicked=!0,this.searchForm.valid?(this.sidebarService.setLoading(!0),this.loading=!0,this.trendsapiService.getData({keyword:this.searchForm.get("keyword").value,year:this.searchForm.get("year").value}).then(t=>{this.sidebarService.saveOriginal(t),this.arraybyDate=this.sidebarService.byDate.subscribe(t=>this.byDate=t),this.sidebarService.parseCountries(t),this.sidebarService.setLoading(!1),this.loading=!1}).catch(t=>{console.log(t)})):(this.searchForm.get("year"),this.searchForm.get("keyword"))}}return t.\u0275fac=function(e){return new(e||t)(to(CP),to(Am))},t.\u0275cmp=Je({type:t,selectors:[["app-searchbar"]],decls:50,vars:4,consts:[["id","form","autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-6"],[1,""],["matInput","","formControlName","keyword","id","seachInput","type","text","placeholder","ex: #BLM","aria-placeholder","ex: #BLM",1,""],["id","passwordHelpBlock","class","text-danger",4,"ngIf"],[1,"col-4"],["formControlName","year"],["value","2020"],["value","2019"],["value","2018"],["value","2017"],["value","2016"],["value","2015"],["value","2014"],["value","2013"],["value","2012"],["value","2011"],["value","2010"],["value","2009"],["value","2008"],["value","2007"],["value","2006"],["value","2005"],["value","2004"],["id","passwordHelpBlock","height","12","class","text-danger",4,"ngIf"],[1,"col-2"],["mat-button","","type","button","mat-icon-button","",3,"disabled","click"],["id","passwordHelpBlock",1,"text-danger"],["id","passwordHelpBlock","height","12",1,"text-danger"]],template:function(t,e){1&t&&(ao(0,"form",0),fo("ngSubmit",(function(t){return e.onSubmit(t)})),ao(1,"div",1),ao(2,"mat-form-field",2),ao(3,"mat-label",3),Vo(4,"Search for a trend"),so(),oo(5,"input",4),Ys(6,vU,2,0,"small",5),so(),ao(7,"mat-form-field",6),ao(8,"mat-label",3),Vo(9,"Select a year"),so(),ao(10,"mat-select",7),ao(11,"mat-option",8),Vo(12,"2020"),so(),ao(13,"mat-option",9),Vo(14,"2019"),so(),ao(15,"mat-option",10),Vo(16,"2018"),so(),ao(17,"mat-option",11),Vo(18,"2017"),so(),ao(19,"mat-option",12),Vo(20,"2016"),so(),ao(21,"mat-option",13),Vo(22,"2015"),so(),ao(23,"mat-option",14),Vo(24,"2014"),so(),ao(25,"mat-option",15),Vo(26,"2013"),so(),ao(27,"mat-option",16),Vo(28,"2012"),so(),ao(29,"mat-option",17),Vo(30,"2011"),so(),ao(31,"mat-option",18),Vo(32,"2010"),so(),ao(33,"mat-option",19),Vo(34,"2009"),so(),ao(35,"mat-option",20),Vo(36,"2008"),so(),ao(37,"mat-option",21),Vo(38,"2007"),so(),ao(39,"mat-option",22),Vo(40,"2006"),so(),ao(41,"mat-option",23),Vo(42,"2005"),so(),ao(43,"mat-option",24),Vo(44,"2004"),so(),so(),Ys(45,_U,2,0,"small",25),so(),ao(46,"div",26),ao(47,"button",27),fo("click",(function(t){return e.onSubmit(t)})),ao(48,"mat-icon"),Vo(49,"search"),so(),so(),so(),so(),so()),2&t&&(ro("formGroup",e.searchForm),Hi(6),ro("ngIf",!e.searchForm.get("keyword").valid&&e.clicked),Hi(39),ro("ngIf",!e.searchForm.get("year").valid&&e.clicked),Hi(2),ro("disabled",e.loading))},directives:[BW,HB,VW,Nq,Cq,Vq,zB,jB,KW,ah,tU,aB,AB,gU],styles:["mat-form-field[_ngcontent-%COMP%]{width:80%}#form[_ngcontent-%COMP%]{margin-top:5%}"]}),t})();function xU(t,e){1&t&&wo(0)}const wU=["*"];function SU(t,e){}const CU=function(t){return{animationDuration:t}},DU=function(t,e){return{value:t,params:e}},IU=["tabBodyWrapper"],kU=["tabHeader"];function EU(t,e){}function AU(t,e){1&t&&Ys(0,EU,0,0,"ng-template",9),2&t&&ro("cdkPortalOutlet",_o().$implicit.templateLabel)}function TU(t,e){1&t&&Vo(0),2&t&&Uo(_o().$implicit.textLabel)}function RU(t,e){if(1&t){const t=co();ao(0,"div",6),fo("click",(function(){Tn(t);const n=e.$implicit,r=e.index,i=_o(),a=Qs(1);return i._handleClick(n,a,r)})),ao(1,"div",7),Ys(2,AU,1,1,"ng-template",8),Ys(3,TU,1,1,"ng-template",8),so(),so()}if(2&t){const t=e.$implicit,n=e.index,r=_o();Ro("mat-tab-label-active",r.selectedIndex==n),ro("id",r._getTabLabelId(n))("disabled",t.disabled)("matRippleDisabled",t.disabled||r.disableRipple),Ks("tabIndex",r._getTabIndex(t,n))("aria-posinset",n+1)("aria-setsize",r._tabs.length)("aria-controls",r._getTabContentId(n))("aria-selected",r.selectedIndex==n)("aria-label",t.ariaLabel||null)("aria-labelledby",!t.ariaLabel&&t.ariaLabelledby?t.ariaLabelledby:null),Hi(2),ro("ngIf",t.templateLabel),Hi(1),ro("ngIf",!t.templateLabel)}}function MU(t,e){if(1&t){const t=co();ao(0,"mat-tab-body",10),fo("_onCentered",(function(){return Tn(t),_o()._removeTabBodyWrapperHeight()}))("_onCentering",(function(e){return Tn(t),_o()._setTabBodyWrapperHeight(e)})),so()}if(2&t){const t=e.$implicit,n=e.index,r=_o();Ro("mat-tab-body-active",r.selectedIndex==n),ro("id",r._getTabContentId(n))("content",t.content)("position",t.position)("origin",t.origin)("animationDuration",r.animationDuration),Ks("aria-labelledby",r._getTabLabelId(n))}}const NU=["tabListContainer"],OU=["tabList"],PU=["nextPaginator"],FU=["previousPaginator"],LU=new _e("MatInkBarPositioner",{providedIn:"root",factory:function(){return t=>({left:t?(t.offsetLeft||0)+"px":"0",width:t?(t.offsetWidth||0)+"px":"0"})}});let zU=(()=>{class t{constructor(t,e,n,r){this._elementRef=t,this._ngZone=e,this._inkBarPositioner=n,this._animationMode=r}alignToElement(t){this.show(),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._setStyles(t))}):this._setStyles(t)}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}_setStyles(t){const e=this._inkBarPositioner(t),n=this._elementRef.nativeElement;n.style.left=e.left,n.style.width=e.width}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(ec),to(LU),to(c$,8))},t.\u0275dir=tn({type:t,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(t,e){2&t&&Ro("_mat-animation-noopable","NoopAnimations"===e._animationMode)}}),t})(),$U=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(to(Wl))},t.\u0275dir=tn({type:t,selectors:[["","matTabContent",""]]}),t})(),BU=(()=>{class t extends Qq{}return t.\u0275fac=function(e){return WU(e||t)},t.\u0275dir=tn({type:t,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[Zo]}),t})();const WU=zr(BU);class qU{}const VU=b$(qU),UU=new _e("MAT_TAB_GROUP");let jU=(()=>{class t extends VU{constructor(t,e){super(),this._viewContainerRef=t,this._closestTabGroup=e,this.textLabel="",this._contentPortal=null,this._stateChanges=new at,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(t){t&&(this._templateLabel=t)}get content(){return this._contentPortal}ngOnChanges(t){(t.hasOwnProperty("textLabel")||t.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new Jq(this._explicitContent||this._implicitContent,this._viewContainerRef)}}return t.\u0275fac=function(e){return new(e||t)(to(Vl),to(UU,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-tab"]],contentQueries:function(t,e,n){var r;1&t&&(Du(n,BU,!0),Iu(n,$U,!0,Wl)),2&t&&(xu(r=Eu())&&(e.templateLabel=r.first),xu(r=Eu())&&(e._explicitContent=r.first))},viewQuery:function(t,e){var n;1&t&&wu(Wl,!0),2&t&&xu(n=Eu())&&(e._implicitContent=n.first)},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"]},exportAs:["matTab"],features:[Zo,rl],ngContentSelectors:wU,decls:1,vars:0,template:function(t,e){1&t&&(xo(),Ys(0,xU,1,0,"ng-template"))},encapsulation:2}),t})();const HU={translateTab:jF("translateTab",[XF("center, void, left-origin-center, right-origin-center",JF({transform:"none"})),XF("left",JF({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),XF("right",JF({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),KF("* => left, * => right, left => center, right => center",HF("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),KF("void => left-origin-center",[JF({transform:"translate3d(-100%, 0, 0)"}),HF("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),KF("void => right-origin-center",[JF({transform:"translate3d(100%, 0, 0)"}),HF("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let GU=(()=>{class t extends tV{constructor(t,e,n,r){super(t,e,r),this._host=n,this._centeringSub=j.EMPTY,this._leavingSub=j.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(Rd(this._host._isCenterPosition(this._host._position))).subscribe(t=>{t&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(to(gl),to(Vl),to(ie(()=>XU)),to(Nc))},t.\u0275dir=tn({type:t,selectors:[["","matTabBodyHost",""]],features:[Zo]}),t})(),JU=(()=>{class t{constructor(t,e,n){this._elementRef=t,this._dir=e,this._dirChangeSubscription=j.EMPTY,this._translateTabComplete=new at,this._onCentering=new cu,this._beforeCentering=new cu,this._afterLeavingCenter=new cu,this._onCentered=new cu(!0),this.animationDuration="500ms",e&&(this._dirChangeSubscription=e.change.subscribe(t=>{this._computePositionAnimationState(t),n.markForCheck()})),this._translateTabComplete.pipe(GP((t,e)=>t.fromState===e.fromState&&t.toState===e.toState)).subscribe(t=>{this._isCenterPosition(t.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(t.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(t){this._positionIndex=t,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(t){const e=this._isCenterPosition(t.toState);this._beforeCentering.emit(e),e&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(t){return"center"==t||"left-origin-center"==t||"right-origin-center"==t}_computePositionAnimationState(t=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==t?"left":"right":this._positionIndex>0?"ltr"==t?"right":"left":"center"}_computePositionFromOrigin(t){const e=this._getLayoutDirection();return"ltr"==e&&t<=0||"rtl"==e&&t>0?"left-origin-center":"right-origin-center"}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(oF,8),to(bs))},t.\u0275dir=tn({type:t,inputs:{animationDuration:"animationDuration",position:"position",_content:["content","_content"],origin:"origin"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),t})(),XU=(()=>{class t extends JU{constructor(t,e,n){super(t,e,n)}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(oF,8),to(bs))},t.\u0275cmp=Je({type:t,selectors:[["mat-tab-body"]],viewQuery:function(t,e){var n;1&t&&Su(eV,!0),2&t&&xu(n=Eu())&&(e._portalHost=n.first)},hostAttrs:[1,"mat-tab-body"],features:[Zo],decls:3,vars:6,consts:[[1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(t,e){1&t&&(ao(0,"div",0,1),fo("@translateTab.start",(function(t){return e._onTranslateTabStarted(t)}))("@translateTab.done",(function(t){return e._translateTabComplete.next(t)})),Ys(2,SU,0,0,"ng-template",2),so()),2&t&&ro("@translateTab",lu(3,DU,e._position,ou(1,CU,e.animationDuration)))},directives:[GU],styles:[".mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}\n"],encapsulation:2,data:{animation:[HU.translateTab]}}),t})();const KU=new _e("MAT_TABS_CONFIG");let ZU=0;class YU{}class QU{constructor(t){this._elementRef=t}}const tj=x$(w$(QU),"primary");let ej=(()=>{class t extends tj{constructor(t,e,n,r){super(t),this._changeDetectorRef=e,this._animationMode=r,this._tabs=new du,this._indexToSelect=0,this._tabBodyWrapperHeight=0,this._tabsSubscription=j.EMPTY,this._tabLabelSubscription=j.EMPTY,this._dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this.selectedIndexChange=new cu,this.focusChange=new cu,this.animationDone=new cu,this.selectedTabChange=new cu(!0),this._groupId=ZU++,this.animationDuration=n&&n.animationDuration?n.animationDuration:"500ms",this.disablePagination=!(!n||null==n.disablePagination)&&n.disablePagination}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(t){this._dynamicHeight=LP(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._indexToSelect=zP(t,null)}get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t)?t+"ms":t}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){const e=this._elementRef.nativeElement;e.classList.remove(`mat-background-${this.backgroundColor}`),t&&e.classList.add(`mat-background-${t}`),this._backgroundColor=t}ngAfterContentChecked(){const t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){const e=null==this._selectedIndex;e||this.selectedTabChange.emit(this._createChangeEvent(t)),Promise.resolve().then(()=>{this._tabs.forEach((e,n)=>e.isActive=n===t),e||this.selectedIndexChange.emit(t)})}this._tabs.forEach((e,n)=>{e.position=n-t,null==this._selectedIndex||0!=e.position||e.origin||(e.origin=t-this._selectedIndex)}),this._selectedIndex!==t&&(this._selectedIndex=t,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{if(this._clampTabIndex(this._indexToSelect)===this._selectedIndex){const t=this._tabs.toArray();for(let e=0;e<t.length;e++)if(t[e].isActive){this._indexToSelect=this._selectedIndex=e;break}}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(Rd(this._allTabs)).subscribe(t=>{this._tabs.reset(t.filter(t=>!t._closestTabGroup||t._closestTabGroup===this)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}_focusChanged(t){this.focusChange.emit(this._createChangeEvent(t))}_createChangeEvent(t){const e=new YU;return e.index=t,this._tabs&&this._tabs.length&&(e.tab=this._tabs.toArray()[t]),e}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=kt(...this._tabs.map(t=>t._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(t){return Math.min(this._tabs.length-1,Math.max(t||0,0))}_getTabLabelId(t){return`mat-tab-label-${this._groupId}-${t}`}_getTabContentId(t){return`mat-tab-content-${this._groupId}-${t}`}_setTabBodyWrapperHeight(t){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const e=this._tabBodyWrapper.nativeElement;e.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(e.style.height=t+"px")}_removeTabBodyWrapperHeight(){const t=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=t.clientHeight,t.style.height="",this.animationDone.emit()}_handleClick(t,e,n){t.disabled||(this.selectedIndex=e.focusIndex=n)}_getTabIndex(t,e){return t.disabled?null:this.selectedIndex===e?0:-1}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs),to(KU,8),to(c$,8))},t.\u0275dir=tn({type:t,inputs:{headerPosition:"headerPosition",animationDuration:"animationDuration",disablePagination:"disablePagination",dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[Zo]}),t})(),nj=(()=>{class t extends ej{constructor(t,e,n,r){super(t,e,n,r)}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs),to(KU,8),to(c$,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-tab-group"]],contentQueries:function(t,e,n){var r;1&t&&Du(n,jU,!0),2&t&&xu(r=Eu())&&(e._allTabs=r)},viewQuery:function(t,e){var n;1&t&&(Su(IU,!0),Su(kU,!0)),2&t&&(xu(n=Eu())&&(e._tabBodyWrapper=n.first),xu(n=Eu())&&(e._tabHeader=n.first))},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(t,e){2&t&&Ro("mat-tab-group-dynamic-height",e.dynamicHeight)("mat-tab-group-inverted-header","below"===e.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[pl([{provide:UU,useExisting:t}]),Zo],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","disabled","matRippleDisabled","click",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","disabled","matRippleDisabled","click"],[1,"mat-tab-label-content"],[3,"ngIf"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(t,e){1&t&&(ao(0,"mat-tab-header",0,1),fo("indexFocused",(function(t){return e._focusChanged(t)}))("selectFocusedIndex",(function(t){return e.selectedIndex=t})),Ys(2,RU,4,14,"div",2),so(),ao(3,"div",3,4),Ys(5,MU,1,8,"mat-tab-body",5),so()),2&t&&(ro("selectedIndex",e.selectedIndex||0)("disableRipple",e.disableRipple)("disablePagination",e.disablePagination),Hi(2),ro("ngForOf",e._tabs),Hi(1),Ro("_mat-animation-noopable","NoopAnimations"===e._animationMode),Hi(2),ro("ngForOf",e._tabs))},directives:function(){return[uj,rh,aj,G$,BF,ah,tV,XU]},styles:[".mat-tab-group{display:flex;flex-direction:column}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),t})();class rj{}const ij=b$(rj);let aj=(()=>{class t extends ij{constructor(t){super(),this.elementRef=t}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275dir=tn({type:t,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(t,e){2&t&&(Ks("aria-disabled",!!e.disabled),Ro("mat-tab-disabled",e.disabled))},inputs:{disabled:"disabled"},features:[Zo]}),t})();const sj=OP({passive:!0});let oj=(()=>{class t{constructor(t,e,n,r,i,a,s){this._elementRef=t,this._changeDetectorRef=e,this._viewportRuler=n,this._dir=r,this._ngZone=i,this._platform=a,this._animationMode=s,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new at,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new at,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new cu,this.indexFocused=new cu,i.runOutsideAngular(()=>{qP(t.nativeElement,"mouseleave").pipe(rF(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){t=zP(t),this._selectedIndex!=t&&(this._selectedIndexChanged=!0,this._selectedIndex=t,this._keyManager&&this._keyManager.updateActiveItem(t))}ngAfterViewInit(){qP(this._previousPaginator.nativeElement,"touchstart",sj).pipe(rF(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),qP(this._nextPaginator.nativeElement,"touchstart",sj).pipe(rF(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const t=this._dir?this._dir.change:Gh(null),e=this._viewportRuler.change(150),n=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new IF(this._items).withHorizontalOrientation(this._getLayoutDirection()).withWrap(),this._keyManager.updateActiveItem(0),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(n):n(),kt(t,e,this._items.changes).pipe(rF(this._destroyed)).subscribe(()=>{Promise.resolve().then(n),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe(rF(this._destroyed)).subscribe(t=>{this.indexFocused.emit(t),this._setTabFocus(t)})}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(t){if(!mF(t))switch(t.keyCode){case 36:this._keyManager.setFirstItemActive(),t.preventDefault();break;case 35:this._keyManager.setLastItemActive(),t.preventDefault();break;case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(t));break;default:this._keyManager.onKeydown(t)}}_onContentChanges(){const t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(t){this._isValidIndex(t)&&this.focusIndex!==t&&this._keyManager&&this._keyManager.setActiveItem(t)}_isValidIndex(t){if(!this._items)return!0;const e=this._items?this._items.toArray()[t]:null;return!!e&&!e.disabled}_setTabFocus(t){if(this._showPaginationControls&&this._scrollToLabel(t),this._items&&this._items.length){this._items.toArray()[t].focus();const e=this._tabListContainer.nativeElement,n=this._getLayoutDirection();e.scrollLeft="ltr"==n?0:e.scrollWidth-e.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const t=this.scrollDistance,e=this._platform,n="ltr"===this._getLayoutDirection()?-t:t;this._tabList.nativeElement.style.transform=`translateX(${Math.round(n)}px)`,e&&(e.TRIDENT||e.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(t){this._scrollTo(t)}_scrollHeader(t){return this._scrollTo(this._scrollDistance+("before"==t?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(t){this._stopInterval(),this._scrollHeader(t)}_scrollToLabel(t){if(this.disablePagination)return;const e=this._items?this._items.toArray()[t]:null;if(!e)return;const n=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:r,offsetWidth:i}=e.elementRef.nativeElement;let a,s;"ltr"==this._getLayoutDirection()?(a=r,s=a+i):(s=this._tabList.nativeElement.offsetWidth-r,a=s-i);const o=this.scrollDistance,l=this.scrollDistance+n;a<o?this.scrollDistance-=o-a+60:s>l&&(this.scrollDistance+=s-l+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const t=this._tabList.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;t||(this.scrollDistance=0),t!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=t}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabList.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const t=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,e=t?t.elementRef.nativeElement:null;e?this._inkBar.alignToElement(e):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(t,e){e&&null!=e.button&&0!==e.button||(this._stopInterval(),tF(650,100).pipe(rF(kt(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:e,distance:n}=this._scrollHeader(t);(0===n||n>=e)&&this._stopInterval()}))}_scrollTo(t){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const e=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(e,t)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:e,distance:this._scrollDistance}}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs),to(dF),to(oF,8),to(ec),to(kP),to(c$,8))},t.\u0275dir=tn({type:t,inputs:{disablePagination:"disablePagination"}}),t})(),lj=(()=>{class t extends oj{constructor(t,e,n,r,i,a,s){super(t,e,n,r,i,a,s),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=LP(t)}_itemSelected(t){t.preventDefault()}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs),to(dF),to(oF,8),to(ec),to(kP),to(c$,8))},t.\u0275dir=tn({type:t,inputs:{disableRipple:"disableRipple"},features:[Zo]}),t})(),uj=(()=>{class t extends lj{constructor(t,e,n,r,i,a,s){super(t,e,n,r,i,a,s)}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs),to(dF),to(oF,8),to(ec),to(kP),to(c$,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-tab-header"]],contentQueries:function(t,e,n){var r;1&t&&Du(n,aj,!1),2&t&&xu(r=Eu())&&(e._items=r)},viewQuery:function(t,e){var n;1&t&&(wu(zU,!0),wu(NU,!0),wu(OU,!0),Su(PU,!0),Su(FU,!0)),2&t&&(xu(n=Eu())&&(e._inkBar=n.first),xu(n=Eu())&&(e._tabListContainer=n.first),xu(n=Eu())&&(e._tabList=n.first),xu(n=Eu())&&(e._nextPaginator=n.first),xu(n=Eu())&&(e._previousPaginator=n.first))},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(t,e){2&t&&Ro("mat-tab-header-pagination-controls-enabled",e._showPaginationControls)("mat-tab-header-rtl","rtl"==e._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[Zo],ngContentSelectors:wU,decls:13,vars:8,consts:[["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(t,e){1&t&&(xo(),ao(0,"div",0,1),fo("click",(function(){return e._handlePaginatorClick("before")}))("mousedown",(function(t){return e._handlePaginatorPress("before",t)}))("touchend",(function(){return e._stopInterval()})),oo(2,"div",2),so(),ao(3,"div",3,4),fo("keydown",(function(t){return e._handleKeydown(t)})),ao(5,"div",5,6),fo("cdkObserveContent",(function(){return e._onContentChanges()})),ao(7,"div",7),wo(8),so(),oo(9,"mat-ink-bar"),so(),so(),ao(10,"div",8,9),fo("mousedown",(function(t){return e._handlePaginatorPress("after",t)}))("click",(function(){return e._handlePaginatorClick("after")}))("touchend",(function(){return e._stopInterval()})),oo(12,"div",2),so()),2&t&&(Ro("mat-tab-header-pagination-disabled",e._disableScrollBefore),ro("matRippleDisabled",e._disableScrollBefore||e.disableRipple),Hi(5),Ro("_mat-animation-noopable","NoopAnimations"===e._animationMode),Hi(5),Ro("mat-tab-header-pagination-disabled",e._disableScrollAfter),ro("matRippleDisabled",e._disableScrollAfter||e.disableRipple))},directives:[G$,wF,zU],styles:['.mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;content:"";height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n'],encapsulation:2}),t})(),cj=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,_$,rV,J$,SF,qF],_$]}),t})();const hj=["sliderWrapper"],dj=OP({passive:!1}),pj={provide:NB,useExisting:ie(()=>yj),multi:!0};class fj{}class mj{constructor(t){this._elementRef=t}}const gj=S$(x$(b$(mj),"accent"));let yj=(()=>{class t extends gj{constructor(t,e,n,r,i,a,s,o){super(t),this._focusMonitor=e,this._changeDetectorRef=n,this._dir=r,this._animationMode=a,this._ngZone=s,this._invert=!1,this._max=100,this._min=0,this._step=1,this._thumbLabel=!1,this._tickInterval=0,this._value=null,this._vertical=!1,this.change=new cu,this.input=new cu,this.valueChange=new cu,this.onTouched=()=>{},this._percent=0,this._isSliding=!1,this._isActive=!1,this._tickIntervalPercent=0,this._sliderDimensions=null,this._controlValueAccessorChangeFn=()=>{},this._dirChangeSubscription=j.EMPTY,this._pointerDown=t=>{this.disabled||this._isSliding||!vj(t)&&0!==t.button||this._runInsideZone(()=>{const e=this.value,n=_j(t);this._isSliding=!0,this._lastPointerEvent=t,t.preventDefault(),this._focusHostElement(),this._onMouseenter(),this._bindGlobalEvents(t),this._focusHostElement(),this._updateValueFromPosition(n),this._valueOnSlideStart=this.value,this._pointerPositionOnStart=n,e!=this.value&&(this._emitInputEvent(),this._emitChangeEvent())})},this._pointerMove=t=>{if(this._isSliding){t.preventDefault();const e=this.value;this._lastPointerEvent=t,this._updateValueFromPosition(_j(t)),e!=this.value&&this._emitInputEvent()}},this._pointerUp=t=>{if(this._isSliding){const e=this._pointerPositionOnStart,n=_j(t);t.preventDefault(),this._removeGlobalEvents(),this._valueOnSlideStart=this._pointerPositionOnStart=this._lastPointerEvent=null,this._isSliding=!1,this._valueOnSlideStart==this.value||this.disabled||!e||e.x===n.x&&e.y===n.y||this._emitChangeEvent()}},this._windowBlur=()=>{this._lastPointerEvent&&this._pointerUp(this._lastPointerEvent)},this._document=o,this.tabIndex=parseInt(i)||0,this._runOutsizeZone(()=>{const e=t.nativeElement;e.addEventListener("mousedown",this._pointerDown,dj),e.addEventListener("touchstart",this._pointerDown,dj)})}get invert(){return this._invert}set invert(t){this._invert=LP(t)}get max(){return this._max}set max(t){this._max=zP(t,this._max),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get min(){return this._min}set min(t){this._min=zP(t,this._min),null===this._value&&(this.value=this._min),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get step(){return this._step}set step(t){this._step=zP(t,this._step),this._step%1!=0&&(this._roundToDecimal=this._step.toString().split(".").pop().length),this._changeDetectorRef.markForCheck()}get thumbLabel(){return this._thumbLabel}set thumbLabel(t){this._thumbLabel=LP(t)}get tickInterval(){return this._tickInterval}set tickInterval(t){this._tickInterval="auto"===t?"auto":"number"==typeof t||"string"==typeof t?zP(t,this._tickInterval):0}get value(){return null===this._value&&(this.value=this._min),this._value}set value(t){if(t!==this._value){let e=zP(t);this._roundToDecimal&&(e=parseFloat(e.toFixed(this._roundToDecimal))),this._value=e,this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}}get vertical(){return this._vertical}set vertical(t){this._vertical=LP(t)}get displayValue(){return this.displayWith?this.displayWith(this.value):this._roundToDecimal&&this.value&&this.value%1!=0?this.value.toFixed(this._roundToDecimal):this.value||0}focus(t){this._focusHostElement(t)}blur(){this._blurHostElement()}get percent(){return this._clamp(this._percent)}get _invertAxis(){return this.vertical?!this.invert:this.invert}get _isMinValue(){return 0===this.percent}get _thumbGap(){return this.disabled?7:this._isMinValue&&!this.thumbLabel?this._isActive?10:7:0}get _trackBackgroundStyles(){const t=this.vertical?`1, ${1-this.percent}, 1`:`${1-this.percent}, 1, 1`;return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"-":""}${this._thumbGap}px) scale3d(${t})`}}get _trackFillStyles(){const t=this.percent,e=this.vertical?`1, ${t}, 1`:`${t}, 1, 1`;return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"":"-"}${this._thumbGap}px) scale3d(${e})`,display:0===t?"none":""}}get _ticksContainerStyles(){return{transform:`translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"-":""}${this._tickIntervalPercent/2*100}%)`}}get _ticksStyles(){let t=100*this._tickIntervalPercent,e={backgroundSize:this.vertical?`2px ${t}%`:`${t}% 2px`,transform:`translateZ(0) translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"":"-"}${t/2}%)${this.vertical||"rtl"!=this._getDirection()?"":" rotate(180deg)"}`};if(this._isMinValue&&this._thumbGap){let t;t=this.vertical?this._invertAxis?"Bottom":"Top":this._invertAxis?"Right":"Left",e[`padding${t}`]=`${this._thumbGap}px`}return e}get _thumbContainerStyles(){return{transform:`translate${this.vertical?"Y":"X"}(-${100*(("rtl"!=this._getDirection()||this.vertical?this._invertAxis:!this._invertAxis)?this.percent:1-this.percent)}%)`}}_shouldInvertMouseCoords(){return"rtl"!=this._getDirection()||this.vertical?this._invertAxis:!this._invertAxis}_getDirection(){return this._dir&&"rtl"==this._dir.value?"rtl":"ltr"}ngOnInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{this._isActive=!!t&&"keyboard"!==t,this._changeDetectorRef.detectChanges()}),this._dir&&(this._dirChangeSubscription=this._dir.change.subscribe(()=>{this._changeDetectorRef.markForCheck()}))}ngOnDestroy(){const t=this._elementRef.nativeElement;t.removeEventListener("mousedown",this._pointerDown,dj),t.removeEventListener("touchstart",this._pointerDown,dj),this._lastPointerEvent=null,this._removeGlobalEvents(),this._focusMonitor.stopMonitoring(this._elementRef),this._dirChangeSubscription.unsubscribe()}_onMouseenter(){this.disabled||(this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent())}_onFocus(){this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent()}_onBlur(){this.onTouched()}_onKeydown(t){if(this.disabled||mF(t))return;const e=this.value;switch(t.keyCode){case 33:this._increment(10);break;case 34:this._increment(-10);break;case 35:this.value=this.max;break;case 36:this.value=this.min;break;case 37:this._increment("rtl"==this._getDirection()?1:-1);break;case 38:this._increment(1);break;case 39:this._increment("rtl"==this._getDirection()?-1:1);break;case 40:this._increment(-1);break;default:return}e!=this.value&&(this._emitInputEvent(),this._emitChangeEvent()),this._isSliding=!0,t.preventDefault()}_onKeyup(){this._isSliding=!1}_getWindow(){var t;return(null===(t=this._document)||void 0===t?void 0:t.defaultView)||window}_bindGlobalEvents(t){const e=this._document;if(void 0!==e&&e){const n=vj(t),r=n?"touchend":"mouseup";e.addEventListener(n?"touchmove":"mousemove",this._pointerMove,dj),e.addEventListener(r,this._pointerUp,dj),n&&e.addEventListener("touchcancel",this._pointerUp,dj)}const n=this._getWindow();void 0!==n&&n&&n.addEventListener("blur",this._windowBlur)}_removeGlobalEvents(){const t=this._document;void 0!==t&&t&&(t.removeEventListener("mousemove",this._pointerMove,dj),t.removeEventListener("mouseup",this._pointerUp,dj),t.removeEventListener("touchmove",this._pointerMove,dj),t.removeEventListener("touchend",this._pointerUp,dj),t.removeEventListener("touchcancel",this._pointerUp,dj));const e=this._getWindow();void 0!==e&&e&&e.removeEventListener("blur",this._windowBlur)}_increment(t){this.value=this._clamp((this.value||0)+this.step*t,this.min,this.max)}_updateValueFromPosition(t){if(!this._sliderDimensions)return;let e=this._clamp(((this.vertical?t.y:t.x)-(this.vertical?this._sliderDimensions.top:this._sliderDimensions.left))/(this.vertical?this._sliderDimensions.height:this._sliderDimensions.width));if(this._shouldInvertMouseCoords()&&(e=1-e),0===e)this.value=this.min;else if(1===e)this.value=this.max;else{const t=this._calculateValue(e),n=Math.round((t-this.min)/this.step)*this.step+this.min;this.value=this._clamp(n,this.min,this.max)}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.value),this.valueChange.emit(this.value),this.change.emit(this._createChangeEvent())}_emitInputEvent(){this.input.emit(this._createChangeEvent())}_updateTickIntervalPercent(){if(this.tickInterval&&this._sliderDimensions)if("auto"==this.tickInterval){let t=this.vertical?this._sliderDimensions.height:this._sliderDimensions.width,e=Math.ceil(30/(t*this.step/(this.max-this.min)));this._tickIntervalPercent=e*this.step/t}else this._tickIntervalPercent=this.tickInterval*this.step/(this.max-this.min)}_createChangeEvent(t=this.value){let e=new fj;return e.source=this,e.value=t,e}_calculatePercentage(t){return((t||0)-this.min)/(this.max-this.min)}_calculateValue(t){return this.min+t*(this.max-this.min)}_clamp(t,e=0,n=1){return Math.max(e,Math.min(t,n))}_getSliderDimensions(){return this._sliderWrapper?this._sliderWrapper.nativeElement.getBoundingClientRect():null}_focusHostElement(t){this._elementRef.nativeElement.focus(t)}_blurHostElement(){this._elementRef.nativeElement.blur()}_runInsideZone(t){this._ngZone?this._ngZone.run(t):t()}_runOutsizeZone(t){this._ngZone?this._ngZone.runOutsideAngular(t):t()}writeValue(t){this.value=t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(zF),to(bs),to(oF,8),eo("tabindex"),to(c$,8),to(ec),to(Nc,8))},t.\u0275cmp=Je({type:t,selectors:[["mat-slider"]],viewQuery:function(t,e){var n;1&t&&Su(hj,!0),2&t&&xu(n=Eu())&&(e._sliderWrapper=n.first)},hostAttrs:["role","slider",1,"mat-slider","mat-focus-indicator"],hostVars:28,hostBindings:function(t,e){1&t&&fo("focus",(function(){return e._onFocus()}))("blur",(function(){return e._onBlur()}))("keydown",(function(t){return e._onKeydown(t)}))("keyup",(function(){return e._onKeyup()}))("mouseenter",(function(){return e._onMouseenter()}))("selectstart",(function(t){return t.preventDefault()})),2&t&&(Jo("tabIndex",e.tabIndex),Ks("aria-disabled",e.disabled)("aria-valuemax",e.max)("aria-valuemin",e.min)("aria-valuenow",e.value)("aria-orientation",e.vertical?"vertical":"horizontal"),Ro("mat-slider-disabled",e.disabled)("mat-slider-has-ticks",e.tickInterval)("mat-slider-horizontal",!e.vertical)("mat-slider-axis-inverted",e._invertAxis)("mat-slider-invert-mouse-coords",e._shouldInvertMouseCoords())("mat-slider-sliding",e._isSliding)("mat-slider-thumb-label-showing",e.thumbLabel)("mat-slider-vertical",e.vertical)("mat-slider-min-value",e._isMinValue)("mat-slider-hide-last-tick",e.disabled||e._isMinValue&&e._thumbGap&&e._invertAxis)("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{disabled:"disabled",color:"color",tabIndex:"tabIndex",invert:"invert",max:"max",min:"min",value:"value",step:"step",thumbLabel:"thumbLabel",tickInterval:"tickInterval",vertical:"vertical",displayWith:"displayWith"},outputs:{change:"change",input:"input",valueChange:"valueChange"},exportAs:["matSlider"],features:[pl([pj]),Zo],decls:13,vars:6,consts:[[1,"mat-slider-wrapper"],["sliderWrapper",""],[1,"mat-slider-track-wrapper"],[1,"mat-slider-track-background",3,"ngStyle"],[1,"mat-slider-track-fill",3,"ngStyle"],[1,"mat-slider-ticks-container",3,"ngStyle"],[1,"mat-slider-ticks",3,"ngStyle"],[1,"mat-slider-thumb-container",3,"ngStyle"],[1,"mat-slider-focus-ring"],[1,"mat-slider-thumb"],[1,"mat-slider-thumb-label"],[1,"mat-slider-thumb-label-text"]],template:function(t,e){1&t&&(ao(0,"div",0,1),ao(2,"div",2),oo(3,"div",3),oo(4,"div",4),so(),ao(5,"div",5),oo(6,"div",6),so(),ao(7,"div",7),oo(8,"div",8),oo(9,"div",9),ao(10,"div",10),ao(11,"span",11),Vo(12),so(),so(),so(),so()),2&t&&(Hi(3),ro("ngStyle",e._trackBackgroundStyles),Hi(1),ro("ngStyle",e._trackFillStyles),Hi(1),ro("ngStyle",e._ticksContainerStyles),Hi(1),ro("ngStyle",e._ticksStyles),Hi(1),ro("ngStyle",e._thumbContainerStyles),Hi(5),Uo(e.displayValue))},directives:[dh],styles:['.mat-slider{display:inline-block;position:relative;box-sizing:border-box;padding:8px;outline:none;vertical-align:middle}.mat-slider:not(.mat-slider-disabled):active,.mat-slider.mat-slider-sliding:not(.mat-slider-disabled){cursor:-webkit-grabbing;cursor:grabbing}.mat-slider-wrapper{position:absolute}.mat-slider-track-wrapper{position:absolute;top:0;left:0;overflow:hidden}.mat-slider-track-fill{position:absolute;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-track-background{position:absolute;transform-origin:100% 100%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-ticks-container{position:absolute;left:0;top:0;overflow:hidden}.mat-slider-ticks{background-repeat:repeat;background-clip:content-box;box-sizing:border-box;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-container{position:absolute;z-index:1;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-focus-ring{position:absolute;width:30px;height:30px;border-radius:50%;transform:scale(0);opacity:0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider.cdk-keyboard-focused .mat-slider-focus-ring,.mat-slider.cdk-program-focused .mat-slider-focus-ring{transform:scale(1);opacity:1}.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb-label,.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb{cursor:-webkit-grab;cursor:grab}.mat-slider-thumb{position:absolute;right:-10px;bottom:-10px;box-sizing:border-box;width:20px;height:20px;border:3px solid transparent;border-radius:50%;transform:scale(0.7);transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-label{display:none;align-items:center;justify-content:center;position:absolute;width:28px;height:28px;border-radius:50%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-radius 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.cdk-high-contrast-active .mat-slider-thumb-label{outline:solid 1px}.mat-slider-thumb-label-text{z-index:1;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-sliding .mat-slider-track-fill,.mat-slider-sliding .mat-slider-track-background,.mat-slider-sliding .mat-slider-thumb-container{transition-duration:0ms}.mat-slider-has-ticks .mat-slider-wrapper::after{content:"";position:absolute;border-width:0;border-style:solid;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after,.mat-slider-has-ticks:hover:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after{opacity:1}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-disabled) .mat-slider-ticks,.mat-slider-has-ticks:hover:not(.mat-slider-disabled) .mat-slider-ticks{opacity:1}.mat-slider-thumb-label-showing .mat-slider-focus-ring{display:none}.mat-slider-thumb-label-showing .mat-slider-thumb-label{display:flex}.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:100% 100%}.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:0 0}.mat-slider:not(.mat-slider-disabled).cdk-focused.mat-slider-thumb-label-showing .mat-slider-thumb{transform:scale(0)}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label{border-radius:50% 50% 0}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label-text{opacity:1}.mat-slider:not(.mat-slider-disabled).cdk-mouse-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-touch-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-program-focused .mat-slider-thumb{border-width:2px;transform:scale(1)}.mat-slider-disabled .mat-slider-focus-ring{transform:scale(0);opacity:0}.mat-slider-disabled .mat-slider-thumb{border-width:4px;transform:scale(0.5)}.mat-slider-disabled .mat-slider-thumb-label{display:none}.mat-slider-horizontal{height:48px;min-width:128px}.mat-slider-horizontal .mat-slider-wrapper{height:2px;top:23px;left:8px;right:8px}.mat-slider-horizontal .mat-slider-wrapper::after{height:2px;border-left-width:2px;right:0;top:0}.mat-slider-horizontal .mat-slider-track-wrapper{height:2px;width:100%}.mat-slider-horizontal .mat-slider-track-fill{height:2px;width:100%;transform:scaleX(0)}.mat-slider-horizontal .mat-slider-track-background{height:2px;width:100%;transform:scaleX(1)}.mat-slider-horizontal .mat-slider-ticks-container{height:2px;width:100%}.cdk-high-contrast-active .mat-slider-horizontal .mat-slider-ticks-container{height:0;outline:solid 2px;top:1px}.mat-slider-horizontal .mat-slider-ticks{height:2px;width:100%}.mat-slider-horizontal .mat-slider-thumb-container{width:100%;height:0;top:50%}.mat-slider-horizontal .mat-slider-focus-ring{top:-15px;right:-15px}.mat-slider-horizontal .mat-slider-thumb-label{right:-14px;top:-40px;transform:translateY(26px) scale(0.01) rotate(45deg)}.mat-slider-horizontal .mat-slider-thumb-label-text{transform:rotate(-45deg)}.mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(45deg)}.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label,.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label-text{transform:none}.mat-slider-vertical{width:48px;min-height:128px}.mat-slider-vertical .mat-slider-wrapper{width:2px;top:8px;bottom:8px;left:23px}.mat-slider-vertical .mat-slider-wrapper::after{width:2px;border-top-width:2px;bottom:0;left:0}.mat-slider-vertical .mat-slider-track-wrapper{height:100%;width:2px}.mat-slider-vertical .mat-slider-track-fill{height:100%;width:2px;transform:scaleY(0)}.mat-slider-vertical .mat-slider-track-background{height:100%;width:2px;transform:scaleY(1)}.mat-slider-vertical .mat-slider-ticks-container{width:2px;height:100%}.cdk-high-contrast-active .mat-slider-vertical .mat-slider-ticks-container{width:0;outline:solid 2px;left:1px}.mat-slider-vertical .mat-slider-focus-ring{bottom:-15px;left:-15px}.mat-slider-vertical .mat-slider-ticks{width:2px;height:100%}.mat-slider-vertical .mat-slider-thumb-container{height:100%;width:0;left:50%}.mat-slider-vertical .mat-slider-thumb{-webkit-backface-visibility:hidden;backface-visibility:hidden}.mat-slider-vertical .mat-slider-thumb-label{bottom:-14px;left:-40px;transform:translateX(26px) scale(0.01) rotate(-45deg)}.mat-slider-vertical .mat-slider-thumb-label-text{transform:rotate(45deg)}.mat-slider-vertical.cdk-focused .mat-slider-thumb-label{transform:rotate(-45deg)}[dir=rtl] .mat-slider-wrapper::after{left:0;right:auto}[dir=rtl] .mat-slider-horizontal .mat-slider-track-fill{transform-origin:100% 100%}[dir=rtl] .mat-slider-horizontal .mat-slider-track-background{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:100% 100%}.mat-slider._mat-animation-noopable .mat-slider-track-fill,.mat-slider._mat-animation-noopable .mat-slider-track-background,.mat-slider._mat-animation-noopable .mat-slider-ticks,.mat-slider._mat-animation-noopable .mat-slider-thumb-container,.mat-slider._mat-animation-noopable .mat-slider-focus-ring,.mat-slider._mat-animation-noopable .mat-slider-thumb,.mat-slider._mat-animation-noopable .mat-slider-thumb-label,.mat-slider._mat-animation-noopable .mat-slider-thumb-label-text,.mat-slider._mat-animation-noopable .mat-slider-has-ticks .mat-slider-wrapper::after{transition:none}\n'],encapsulation:2,changeDetection:0}),t})();function vj(t){return"t"===t.type[0]}function _j(t){const e=vj(t)?t.touches[0]||t.changedTouches[0]:t;return{x:e.clientX,y:e.clientY}}let bj=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,_$],_$]}),t})();function xj(){}var wj=function(t){return null==t?xj:function(){return this.querySelector(t)}};function Sj(){return[]}var Cj=function(t){return null==t?Sj:function(){return this.querySelectorAll(t)}},Dj=function(t){return function(){return this.matches(t)}},Ij=function(t){return new Array(t.length)};function kj(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ej(t,e,n,r,i,a){for(var s,o=0,l=e.length,u=a.length;o<u;++o)(s=e[o])?(s.__data__=a[o],r[o]=s):n[o]=new kj(t,a[o]);for(;o<l;++o)(s=e[o])&&(i[o]=s)}function Aj(t,e,n,r,i,a,s){var o,l,u,c={},h=e.length,d=a.length,p=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(p[o]=u="$"+s.call(l,l.__data__,o,e),u in c?i[o]=l:c[u]=l);for(o=0;o<d;++o)(l=c[u="$"+s.call(t,a[o],o,a)])?(r[o]=l,l.__data__=a[o],c[u]=null):n[o]=new kj(t,a[o]);for(o=0;o<h;++o)(l=e[o])&&c[p[o]]===l&&(i[o]=l)}function Tj(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}kj.prototype={constructor:kj,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Rj="http://www.w3.org/1999/xhtml",Mj={svg:"http://www.w3.org/2000/svg",xhtml:Rj,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Nj=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Mj.hasOwnProperty(e)?{space:Mj[e],local:t}:t};function Oj(t){return function(){this.removeAttribute(t)}}function Pj(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Fj(t,e){return function(){this.setAttribute(t,e)}}function Lj(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function zj(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function $j(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var Bj=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function Wj(t){return function(){this.style.removeProperty(t)}}function qj(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Vj(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Uj(t,e){return t.style.getPropertyValue(e)||Bj(t).getComputedStyle(t,null).getPropertyValue(e)}function jj(t){return function(){delete this[t]}}function Hj(t,e){return function(){this[t]=e}}function Gj(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Jj(t){return t.trim().split(/^|\s+/)}function Xj(t){return t.classList||new Kj(t)}function Kj(t){this._node=t,this._names=Jj(t.getAttribute("class")||"")}function Zj(t,e){for(var n=Xj(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Yj(t,e){for(var n=Xj(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Qj(t){return function(){Zj(this,t)}}function tH(t){return function(){Yj(this,t)}}function eH(t,e){return function(){(e.apply(this,arguments)?Zj:Yj)(this,t)}}function nH(){this.textContent=""}function rH(t){return function(){this.textContent=t}}function iH(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function aH(){this.innerHTML=""}function sH(t){return function(){this.innerHTML=t}}function oH(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function lH(){this.nextSibling&&this.parentNode.appendChild(this)}function uH(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cH(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Rj&&e.documentElement.namespaceURI===Rj?e.createElement(t):e.createElementNS(n,t)}}function hH(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}Kj.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var dH=function(t){var e=Nj(t);return(e.local?hH:cH)(e)};function pH(){return null}function fH(){var t=this.parentNode;t&&t.removeChild(this)}function mH(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function gH(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var yH={},vH=null;function _H(t,e,n){return t=bH(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function bH(t,e,n){return function(r){var i=vH;vH=r;try{t.call(this,this.__data__,e,n)}finally{vH=i}}}function xH(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function wH(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function SH(t,e,n){var r=yH.hasOwnProperty(t.type)?_H:bH;return function(i,a,s){var o,l=this.__on,u=r(e,a,s);if(l)for(var c=0,h=l.length;c<h;++c)if((o=l[c]).type===t.type&&o.name===t.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=u,o.capture=n),void(o.value=e);this.addEventListener(t.type,u,n),o={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(o):this.__on=[o]}}function CH(t,e,n){var r=Bj(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function DH(t,e){return function(){return CH(this,t,e)}}function IH(t,e){return function(){return CH(this,t,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(yH={mouseenter:"mouseover",mouseleave:"mouseout"}));var kH=[null];function EH(t,e){this._groups=t,this._parents=e}function AH(){return new EH([[document.documentElement]],kH)}EH.prototype=AH.prototype={constructor:EH,select:function(t){"function"!=typeof t&&(t=wj(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,s,o=e[i],l=o.length,u=r[i]=new Array(l),c=0;c<l;++c)(a=o[c])&&(s=t.call(a,a.__data__,c,o))&&("__data__"in a&&(s.__data__=a.__data__),u[c]=s);return new EH(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=Cj(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s,o=e[a],l=o.length,u=0;u<l;++u)(s=o[u])&&(r.push(t.call(s,s.__data__,u,o)),i.push(s));return new EH(r,i)},filter:function(t){"function"!=typeof t&&(t=Dj(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,s=e[i],o=s.length,l=r[i]=[],u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new EH(r,this._parents)},data:function(t,e){if(!t)return f=new Array(this.size()),c=-1,this.each((function(t){f[++c]=t})),f;var n,r=e?Aj:Ej,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=a.length,o=new Array(s),l=new Array(s),u=new Array(s),c=0;c<s;++c){var h=i[c],d=a[c],p=d.length,f=t.call(h,h&&h.__data__,c,i),m=f.length,g=l[c]=new Array(m),y=o[c]=new Array(m);r(h,d,g,y,u[c]=new Array(p),f,e);for(var v,_,b=0,x=0;b<m;++b)if(v=g[b]){for(b>=x&&(x=b+1);!(_=y[x])&&++x<m;);v._next=_||null}}return(o=new EH(o,i))._enter=l,o._exit=u,o},enter:function(){return new EH(this._enter||this._groups.map(Ij),this._parents)},exit:function(){return new EH(this._exit||this._groups.map(Ij),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),a=new Array(r),s=0;s<i;++s)for(var o,l=e[s],u=n[s],c=l.length,h=a[s]=new Array(c),d=0;d<c;++d)(o=l[d]||u[d])&&(h[d]=o);for(;s<r;++s)a[s]=e[s];return new EH(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,s=i[a];--a>=0;)(r=i[a])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Tj);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s,o=n[a],l=o.length,u=i[a]=new Array(l),c=0;c<l;++c)(s=o[c])&&(u[c]=s);u.sort(e)}return new EH(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],s=0,o=a.length;s<o;++s)(i=a[s])&&t.call(i,i.__data__,s,a);return this},attr:function(t,e){var n=Nj(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Pj:Oj:"function"==typeof e?n.local?$j:zj:n.local?Lj:Fj)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Wj:"function"==typeof e?Vj:qj)(t,e,null==n?"":n)):Uj(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?jj:"function"==typeof e?Gj:Hj)(t,e)):this.node()[t]},classed:function(t,e){var n=Jj(t+"");if(arguments.length<2){for(var r=Xj(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?eH:e?Qj:tH)(n,e))},text:function(t){return arguments.length?this.each(null==t?nH:("function"==typeof t?iH:rH)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?aH:("function"==typeof t?oH:sH)(t)):this.node().innerHTML},raise:function(){return this.each(lH)},lower:function(){return this.each(uH)},append:function(t){var e="function"==typeof t?t:dH(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:dH(t),r=null==e?pH:"function"==typeof e?e:wj(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(fH)},clone:function(t){return this.select(t?gH:mH)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=xH(t+""),s=a.length;if(!(arguments.length<2)){for(o=e?SH:wH,null==n&&(n=!1),r=0;r<s;++r)this.each(o(a[r],e,n));return this}var o=this.node().__on;if(o)for(var l,u=0,c=o.length;u<c;++u)for(r=0,l=o[u];r<s;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?IH:DH)(t,e))}};var TH=AH,RH=function(t){return"string"==typeof t?new EH([[document.querySelector(t)]],[document.documentElement]):new EH([[t]],kH)},MH={value:function(){}};function NH(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new OH(r)}function OH(t){this._=t}function PH(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function FH(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function LH(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=MH,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}OH.prototype=NH.prototype={constructor:OH,on:function(t,e){var n,r=this._,i=PH(t+"",r),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(n=(t=i[a]).type)r[n]=LH(r[n],t.name,e);else if(null==e)for(n in r)r[n]=LH(r[n],t.name,null);return this}for(;++a<s;)if((n=(t=i[a]).type)&&(n=FH(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new OH(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var zH=NH,$H=function(){vH.preventDefault(),vH.stopImmediatePropagation()},BH=function(t){var e=t.document.documentElement,n=RH(t).on("dragstart.drag",$H,!0);"onselectstart"in e?n.on("selectstart.drag",$H,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function WH(t,e){var n=t.document.documentElement,r=RH(t).on("dragstart.drag",null);e&&(r.on("click.drag",$H,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var qH=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function VH(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function UH(){}var jH="\\s*([+-]?\\d+)\\s*",HH="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",GH="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",JH=/^#([0-9a-f]{3,8})$/,XH=new RegExp("^rgb\\("+[jH,jH,jH]+"\\)$"),KH=new RegExp("^rgb\\("+[GH,GH,GH]+"\\)$"),ZH=new RegExp("^rgba\\("+[jH,jH,jH,HH]+"\\)$"),YH=new RegExp("^rgba\\("+[GH,GH,GH,HH]+"\\)$"),QH=new RegExp("^hsl\\("+[HH,GH,GH]+"\\)$"),tG=new RegExp("^hsla\\("+[HH,GH,GH,HH]+"\\)$"),eG={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function nG(){return this.rgb().formatHex()}function rG(){return this.rgb().formatRgb()}function iG(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=JH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?aG(e):3===n?new uG(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?sG(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?sG(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=XH.exec(t))?new uG(e[1],e[2],e[3],1):(e=KH.exec(t))?new uG(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ZH.exec(t))?sG(e[1],e[2],e[3],e[4]):(e=YH.exec(t))?sG(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=QH.exec(t))?pG(e[1],e[2]/100,e[3]/100,1):(e=tG.exec(t))?pG(e[1],e[2]/100,e[3]/100,e[4]):eG.hasOwnProperty(t)?aG(eG[t]):"transparent"===t?new uG(NaN,NaN,NaN,0):null}function aG(t){return new uG(t>>16&255,t>>8&255,255&t,1)}function sG(t,e,n,r){return r<=0&&(t=e=n=NaN),new uG(t,e,n,r)}function oG(t){return t instanceof UH||(t=iG(t)),t?new uG((t=t.rgb()).r,t.g,t.b,t.opacity):new uG}function lG(t,e,n,r){return 1===arguments.length?oG(t):new uG(t,e,n,null==r?1:r)}function uG(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function cG(){return"#"+dG(this.r)+dG(this.g)+dG(this.b)}function hG(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function dG(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function pG(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new mG(t,e,n,r)}function fG(t){if(t instanceof mG)return new mG(t.h,t.s,t.l,t.opacity);if(t instanceof UH||(t=iG(t)),!t)return new mG;if(t instanceof mG)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,o=a-i,l=(a+i)/2;return o?(s=e===a?(n-r)/o+6*(n<r):n===a?(r-e)/o+2:(e-n)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new mG(s,o,l,t.opacity)}function mG(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function gG(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function yG(t,e,n,r,i){var a=t*t,s=a*t;return((1-3*t+3*a-s)*e+(4-6*a+3*s)*n+(1+3*t+3*a-3*s)*r+s*i)/6}qH(UH,iG,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:nG,formatHex:nG,formatHsl:function(){return fG(this).formatHsl()},formatRgb:rG,toString:rG}),qH(uG,lG,VH(UH,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new uG(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new uG(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cG,formatHex:cG,formatRgb:hG,toString:hG})),qH(mG,(function(t,e,n,r){return 1===arguments.length?fG(t):new mG(t,e,n,null==r?1:r)}),VH(UH,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new mG(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new mG(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new uG(gG(t>=240?t-240:t+120,i,r),gG(t,i,r),gG(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var vG=function(t){return function(){return t}};function _G(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):vG(isNaN(t)?e:t)}var bG=function t(e){var n=function(t){return 1==(t=+t)?_G:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):vG(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=lG(t)).r,(e=lG(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),s=_G(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function xG(t){return function(e){var n,r,i=e.length,a=new Array(i),s=new Array(i),o=new Array(i);for(n=0;n<i;++n)r=lG(e[n]),a[n]=r.r||0,s[n]=r.g||0,o[n]=r.b||0;return a=t(a),s=t(s),o=t(o),r.opacity=1,function(t){return r.r=a(t),r.g=s(t),r.b=o(t),r+""}}}xG((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1];return yG((n-r/e)*e,r>0?t[r-1]:2*i-a,i,a,r<e-1?t[r+2]:2*a-i)}})),xG((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e);return yG((n-r/e)*e,t[(r+e-1)%e],t[r%e],t[(r+1)%e],t[(r+2)%e])}}));var wG=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}};function SG(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),s=new Array(r);for(n=0;n<i;++n)a[n]=MG(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=a[n](t);return s}}var CG,DG,IG=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},kG=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},EG=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=MG(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},AG=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,TG=new RegExp(AG.source,"g"),RG=function(t,e){var n,r,i,a=AG.lastIndex=TG.lastIndex=0,s=-1,o=[],l=[];for(t+="",e+="";(n=AG.exec(t))&&(r=TG.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(r=r[0])?o[s]?o[s]+=r:o[++s]=r:(o[++s]=null,l.push({i:s,x:kG(n,r)})),a=TG.lastIndex;return a<e.length&&(i=e.slice(a),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)o[(n=l[r]).i]=n.x(t);return o.join("")})},MG=function(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?vG(e):("number"===i?kG:"string"===i?(n=iG(e))?(e=n,bG):RG:e instanceof iG?bG:e instanceof Date?IG:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?SG:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?EG:kG:wG))(t,e)},NG=function(){for(var t,e=vH;t=e.sourceEvent;)e=t;return e},OG=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},PG=function(t){var e=NG();return e.changedTouches&&(e=e.changedTouches[0]),OG(t,e)},FG=0,LG=0,zG=0,$G=0,BG=0,WG=0,qG="object"==typeof performance&&performance.now?performance:Date,VG="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function UG(){return BG||(VG(jG),BG=qG.now()+WG)}function jG(){BG=0}function HG(){this._call=this._time=this._next=null}function GG(t,e,n){var r=new HG;return r.restart(t,e,n),r}function JG(){BG=($G=qG.now())+WG,FG=LG=0;try{!function(){UG(),++FG;for(var t,e=CG;e;)(t=BG-e._time)>=0&&e._call.call(null,t),e=e._next;--FG}()}finally{FG=0,function(){for(var t,e,n=CG,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:CG=e);DG=t,KG(r)}(),BG=0}}function XG(){var t=qG.now(),e=t-$G;e>1e3&&(WG-=e,$G=t)}function KG(t){FG||(LG&&(LG=clearTimeout(LG)),t-BG>24?(t<1/0&&(LG=setTimeout(JG,t-qG.now()-WG)),zG&&(zG=clearInterval(zG))):(zG||($G=qG.now(),zG=setInterval(XG,1e3)),FG=1,VG(JG)))}HG.prototype=GG.prototype={constructor:HG,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?UG():+n)+(null==e?0:+e),this._next||DG===this||(DG?DG._next=this:CG=this,DG=this),this._call=t,this._time=n,KG()},stop:function(){this._call&&(this._call=null,this._time=1/0,KG())}};var ZG=function(t,e,n){var r=new HG;return r.restart((function(n){r.stop(),t(n+e)}),e=null==e?0:+e,n),r},YG=zH("start","end","cancel","interrupt"),QG=[],tJ=function(t,e,n,r,i,a){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(l){var u,c,h,d;if(1!==n.state)return o();for(u in i)if((d=i[u]).name===n.name){if(3===d.state)return ZG(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(ZG((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(o),n.state=5,1),a=-1,s=r.length;++a<s;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),o())}function o(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=GG((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:YG,tween:QG,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})};function eJ(t,e){var n=rJ(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function nJ(t,e){var n=rJ(t,e);if(n.state>3)throw new Error("too late; already running");return n}function rJ(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var iJ,aJ,sJ,oJ,lJ=function(t,e){var n,r,i,a=t.__transition,s=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):s=!1;s&&delete t.__transition}},uJ=180/Math.PI,cJ={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},hJ=function(t,e,n,r,i,a){var s,o,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*uJ,skewX:Math.atan(l)*uJ,scaleX:s,scaleY:o}};function dJ(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,s){var o=[],l=[];return a=t(a),s=t(s),function(t,r,i,a,s,o){if(t!==i||r!==a){var l=s.push("translate(",null,e,null,n);o.push({i:l-4,x:kG(t,i)},{i:l-2,x:kG(r,a)})}else(i||a)&&s.push("translate("+i+e+a+n)}(a.translateX,a.translateY,s.translateX,s.translateY,o,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:kG(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,s.rotate,o,l),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:kG(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,s.skewX,o,l),function(t,e,n,r,a,s){if(t!==n||e!==r){var o=a.push(i(a)+"scale(",null,",",null,")");s.push({i:o-4,x:kG(t,n)},{i:o-2,x:kG(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,s.scaleX,s.scaleY,o,l),a=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)o[(e=l[n]).i]=e.x(t);return o.join("")}}}var pJ=dJ((function(t){return"none"===t?cJ:(iJ||(iJ=document.createElement("DIV"),aJ=document.documentElement,sJ=document.defaultView),iJ.style.transform=t,t=sJ.getComputedStyle(aJ.appendChild(iJ),null).getPropertyValue("transform"),aJ.removeChild(iJ),t=t.slice(7,-1).split(","),hJ(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),fJ=dJ((function(t){return null==t?cJ:(oJ||(oJ=document.createElementNS("http://www.w3.org/2000/svg","g")),oJ.setAttribute("transform",t),(t=oJ.transform.baseVal.consolidate())?hJ((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):cJ)}),", ",")",")");function mJ(t,e){var n,r;return function(){var i=nJ(this,t),a=i.tween;if(a!==n)for(var s=0,o=(r=n=a).length;s<o;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function gJ(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=nJ(this,t),s=a.tween;if(s!==r){i=(r=s).slice();for(var o={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=o;break}l===u&&i.push(o)}a.tween=i}}function yJ(t,e,n){var r=t._id;return t.each((function(){var t=nJ(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return rJ(t,r).value[e]}}var vJ=function(t,e){var n;return("number"==typeof e?kG:e instanceof iG?bG:(n=iG(e))?(e=n,bG):RG)(t,e)};function _J(t){return function(){this.removeAttribute(t)}}function bJ(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xJ(t,e,n){var r,i,a=n+"";return function(){var s=this.getAttribute(t);return s===a?null:s===r?i:i=e(r=s,n)}}function wJ(t,e,n){var r,i,a=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===a?null:s===r?i:i=e(r=s,n)}}function SJ(t,e,n){var r,i,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(o=l+"")?null:s===r&&o===i?a:(i=o,a=e(r=s,l));this.removeAttribute(t)}}function CJ(t,e,n){var r,i,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(o=l+"")?null:s===r&&o===i?a:(i=o,a=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function DJ(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function IJ(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function kJ(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&IJ(t,i)),n}return i._value=e,i}function EJ(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&DJ(t,i)),n}return i._value=e,i}function AJ(t,e){return function(){eJ(this,t).delay=+e.apply(this,arguments)}}function TJ(t,e){return e=+e,function(){eJ(this,t).delay=e}}function RJ(t,e){return function(){nJ(this,t).duration=+e.apply(this,arguments)}}function MJ(t,e){return e=+e,function(){nJ(this,t).duration=e}}function NJ(t,e){if("function"!=typeof e)throw new Error;return function(){nJ(this,t).ease=e}}function OJ(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?eJ:nJ;return function(){var s=a(this,t),o=s.on;o!==r&&(i=(r=o).copy()).on(e,n),s.on=i}}var PJ=TH.prototype.constructor;function FJ(t){return function(){this.style.removeProperty(t)}}function LJ(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function zJ(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&LJ(t,a,n)),r}return a._value=e,a}function $J(t){return function(e){this.textContent=t.call(this,e)}}function BJ(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&$J(r)),e}return r._value=t,r}var WJ=0;function qJ(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function VJ(){return++WJ}var UJ=TH.prototype;qJ.prototype=(function(t){return TH().transition(t)}).prototype={constructor:qJ,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=wj(t));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var o,l,u=r[s],c=u.length,h=a[s]=new Array(c),d=0;d<c;++d)(o=u[d])&&(l=t.call(o,o.__data__,d,u))&&("__data__"in o&&(l.__data__=o.__data__),h[d]=l,tJ(h[d],e,n,d,h,rJ(o,n)));return new qJ(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Cj(t));for(var r=this._groups,i=r.length,a=[],s=[],o=0;o<i;++o)for(var l,u=r[o],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var d,p=t.call(l,l.__data__,h,u),f=rJ(l,n),m=0,g=p.length;m<g;++m)(d=p[m])&&tJ(d,e,n,m,p,f);a.push(p),s.push(l)}return new qJ(a,s,e,n)},filter:function(t){"function"!=typeof t&&(t=Dj(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,s=e[i],o=s.length,l=r[i]=[],u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new qJ(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),a=new Array(r),s=0;s<i;++s)for(var o,l=e[s],u=n[s],c=l.length,h=a[s]=new Array(c),d=0;d<c;++d)(o=l[d]||u[d])&&(h[d]=o);for(;s<r;++s)a[s]=e[s];return new qJ(a,this._parents,this._name,this._id)},selection:function(){return new PJ(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=VJ(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s,o=r[a],l=o.length,u=0;u<l;++u)if(s=o[u]){var c=rJ(s,e);tJ(s,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new qJ(r,this._parents,t,n)},call:UJ.call,nodes:UJ.nodes,node:UJ.node,size:UJ.size,empty:UJ.empty,each:UJ.each,on:function(t,e){var n=this._id;return arguments.length<2?rJ(this.node(),n).on.on(t):this.each(OJ(n,t,e))},attr:function(t,e){var n=Nj(t),r="transform"===n?fJ:vJ;return this.attrTween(t,"function"==typeof e?(n.local?CJ:SJ)(n,r,yJ(this,"attr."+t,e)):null==e?(n.local?bJ:_J)(n):(n.local?wJ:xJ)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Nj(t);return this.tween(n,(r.local?kJ:EJ)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?pJ:vJ;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=Uj(this,t),s=(this.style.removeProperty(t),Uj(this,t));return a===s?null:a===n&&s===r?i:i=e(n=a,r=s)}}(t,r)).on("end.style."+t,FJ(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var s=Uj(this,t),o=n(this),l=o+"";return null==o&&(this.style.removeProperty(t),l=o=Uj(this,t)),s===l?null:s===r&&l===i?a:(i=l,a=e(r=s,o))}}(t,r,yJ(this,"style."+t,e))).each(function(t,e){var n,r,i,a,s="style."+e,o="end."+s;return function(){var l=nJ(this,t),u=l.on,c=null==l.value[s]?a||(a=FJ(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(o,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var s=Uj(this,t);return s===a?null:s===r?i:i=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,zJ(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(yJ(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,BJ(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=rJ(this.node(),n).tween,a=0,s=i.length;a<s;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?mJ:gJ)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?AJ:TJ)(e,t)):rJ(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?RJ:MJ)(e,t)):rJ(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(NJ(e,t)):rJ(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(a,s){var o={value:s},l={value:function(){0==--i&&a()}};n.each((function(){var n=nJ(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),n.on=e}))}))}};var jJ={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function HJ(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return jJ.time=UG(),jJ;return n}TH.prototype.interrupt=function(t){return this.each((function(){lJ(this,t)}))},TH.prototype.transition=function(t){var e,n;t instanceof qJ?(e=t._id,t=t._name):(e=VJ(),(n=jJ).time=UG(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s,o=r[a],l=o.length,u=0;u<l;++u)(s=o[u])&&tJ(s,t,e,u,o,n||HJ(s,e));return new qJ(r,this._parents,t,e)};var GJ=function(t){return function(){return t}},JJ=function(t,e,n){this.target=t,this.type=e,this.selection=n};function XJ(){vH.stopImmediatePropagation()}var KJ=function(){vH.preventDefault(),vH.stopImmediatePropagation()},ZJ={name:"drag"},YJ={name:"space"},QJ={name:"handle"},tX={name:"center"};function eX(t){return[+t[0],+t[1]]}function nX(t){return[eX(t[0]),eX(t[1])]}function rX(t){return function(e){return function(t,e,n){arguments.length<3&&(n=e,e=NG().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return OG(t,r);return null}(e,vH.touches,t)}}var iX={name:"x",handles:["w","e"].map(hX),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},aX={name:"y",handles:["n","s"].map(hX),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},sX=(["n","w","e","s","nw","ne","sw","se"].map(hX),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),oX={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},lX={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},uX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},cX={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function hX(t){return{type:t}}function dX(){return!vH.ctrlKey&&!vH.button}function pX(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function fX(){return navigator.maxTouchPoints||"ontouchstart"in this}function mX(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function gX(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}var yX=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},vX=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return yX(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}},_X=Math.sqrt(50),bX=Math.sqrt(10),xX=Math.sqrt(2);function wX(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=_X?10:a>=bX?5:a>=xX?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=_X?10:a>=bX?5:a>=xX?2:1)}function SX(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=_X?i*=10:a>=bX?i*=5:a>=xX&&(i*=2),e<t?-i:i}var CX=new Date,DX=new Date;function IX(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var s,o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return o;do{o.push(s=new Date(+n)),e(n,a),t(n)}while(s<n&&n<r);return o},i.filter=function(n){return IX((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return CX.setTime(+e),DX.setTime(+r),t(CX),t(DX),Math.floor(n(CX,DX))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var kX=IX((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));kX.every=function(t){return isFinite(t=Math.floor(t))&&t>0?IX((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var EX=kX,AX=IX((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}));function TX(t){return IX((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var RX=TX(0),MX=TX(1),NX=(TX(2),TX(3),TX(4)),OX=(TX(5),TX(6),IX((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),PX=IX((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()})),FX=IX((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()})),LX=IX((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()})),zX=IX((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));zX.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?IX((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):zX:null};var $X=zX;function BX(t){return IX((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var WX=BX(0),qX=BX(1),VX=(BX(2),BX(3),BX(4)),UX=(BX(5),BX(6),IX((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),jX=IX((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));jX.every=function(t){return isFinite(t=Math.floor(t))&&t>0?IX((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var HX=jX;function GX(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function JX(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function XX(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var KX,ZX,YX={"-":"",_:" ",0:"0"},QX=/^\s*\d+/,tK=/^%/,eK=/[\\^$*+?|[\]().{}]/g;function nK(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function rK(t){return t.replace(eK,"\\$&")}function iK(t){return new RegExp("^(?:"+t.map(rK).join("|")+")","i")}function aK(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function sK(t,e,n){var r=QX.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function oK(t,e,n){var r=QX.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function lK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function uK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function cK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function hK(t,e,n){var r=QX.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function dK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function pK(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function fK(t,e,n){var r=QX.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function mK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function gK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function yK(t,e,n){var r=QX.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function vK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function _K(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function bK(t,e,n){var r=QX.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function xK(t,e,n){var r=QX.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function wK(t,e,n){var r=QX.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function SK(t,e,n){var r=tK.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function CK(t,e,n){var r=QX.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function DK(t,e,n){var r=QX.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function IK(t,e){return nK(t.getDate(),e,2)}function kK(t,e){return nK(t.getHours(),e,2)}function EK(t,e){return nK(t.getHours()%12||12,e,2)}function AK(t,e){return nK(1+OX.count(EX(t),t),e,3)}function TK(t,e){return nK(t.getMilliseconds(),e,3)}function RK(t,e){return TK(t,e)+"000"}function MK(t,e){return nK(t.getMonth()+1,e,2)}function NK(t,e){return nK(t.getMinutes(),e,2)}function OK(t,e){return nK(t.getSeconds(),e,2)}function PK(t){var e=t.getDay();return 0===e?7:e}function FK(t,e){return nK(RX.count(EX(t)-1,t),e,2)}function LK(t,e){var n=t.getDay();return t=n>=4||0===n?NX(t):NX.ceil(t),nK(NX.count(EX(t),t)+(4===EX(t).getDay()),e,2)}function zK(t){return t.getDay()}function $K(t,e){return nK(MX.count(EX(t)-1,t),e,2)}function BK(t,e){return nK(t.getFullYear()%100,e,2)}function WK(t,e){return nK(t.getFullYear()%1e4,e,4)}function qK(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+nK(e/60|0,"0",2)+nK(e%60,"0",2)}function VK(t,e){return nK(t.getUTCDate(),e,2)}function UK(t,e){return nK(t.getUTCHours(),e,2)}function jK(t,e){return nK(t.getUTCHours()%12||12,e,2)}function HK(t,e){return nK(1+UX.count(HX(t),t),e,3)}function GK(t,e){return nK(t.getUTCMilliseconds(),e,3)}function JK(t,e){return GK(t,e)+"000"}function XK(t,e){return nK(t.getUTCMonth()+1,e,2)}function KK(t,e){return nK(t.getUTCMinutes(),e,2)}function ZK(t,e){return nK(t.getUTCSeconds(),e,2)}function YK(t){var e=t.getUTCDay();return 0===e?7:e}function QK(t,e){return nK(WX.count(HX(t)-1,t),e,2)}function tZ(t,e){var n=t.getUTCDay();return t=n>=4||0===n?VX(t):VX.ceil(t),nK(VX.count(HX(t),t)+(4===HX(t).getUTCDay()),e,2)}function eZ(t){return t.getUTCDay()}function nZ(t,e){return nK(qX.count(HX(t)-1,t),e,2)}function rZ(t,e){return nK(t.getUTCFullYear()%100,e,2)}function iZ(t,e){return nK(t.getUTCFullYear()%1e4,e,4)}function aZ(){return"+0000"}function sZ(){return"%"}function oZ(t){return+t}function lZ(t){return Math.floor(+t/1e3)}KX=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,s=t.shortDays,o=t.months,l=t.shortMonths,u=iK(i),c=aK(i),h=iK(a),d=aK(a),p=iK(s),f=aK(s),m=iK(o),g=aK(o),y=iK(l),v=aK(l),_={a:function(t){return s[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return o[t.getMonth()]},c:null,d:IK,e:IK,f:RK,H:kK,I:EK,j:AK,L:TK,m:MK,M:NK,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:oZ,s:lZ,S:OK,u:PK,U:FK,V:LK,w:zK,W:$K,x:null,X:null,y:BK,Y:WK,Z:qK,"%":sZ},b={a:function(t){return s[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return o[t.getUTCMonth()]},c:null,d:VK,e:VK,f:JK,H:UK,I:jK,j:HK,L:GK,m:XK,M:KK,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:oZ,s:lZ,S:ZK,u:YK,U:QK,V:tZ,w:eZ,W:nZ,x:null,X:null,y:rZ,Y:iZ,Z:aZ,"%":sZ},x={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return C(t,e,n,r)},d:gK,e:gK,f:wK,H:vK,I:vK,j:yK,L:xK,m:mK,M:_K,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:fK,Q:CK,s:DK,S:bK,u:oK,U:lK,V:uK,w:sK,W:cK,x:function(t,e,r){return C(t,n,e,r)},X:function(t,e,n){return C(t,r,e,n)},y:dK,Y:hK,Z:pK,"%":SK};function w(t,e){return function(n){var r,i,a,s=[],o=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++o<u;)37===t.charCodeAt(o)&&(s.push(t.slice(l,o)),null!=(i=YX[r=t.charAt(++o)])?r=t.charAt(++o):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),s.push(r),l=o+1);return s.push(t.slice(l,o)),s.join("")}}function S(t,e){return function(n){var r,i,a=XX(1900,void 0,1);if(C(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=JX(XX(a.y,0,1))).getUTCDay(),r=i>4||0===i?qX.ceil(r):qX(r),r=UX.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=GX(XX(a.y,0,1))).getDay(),r=i>4||0===i?MX.ceil(r):MX(r),r=OX.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?JX(XX(a.y,0,1)).getUTCDay():GX(XX(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,JX(a)):GX(a)}}function C(t,e,n,r){for(var i,a,s=0,o=e.length,l=n.length;s<o;){if(r>=l)return-1;if(37===(i=e.charCodeAt(s++))){if(i=e.charAt(s++),!(a=x[i in YX?e.charAt(s++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=w(n,_),_.X=w(r,_),_.c=w(e,_),b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),{format:function(t){var e=w(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=S(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t+="",!0);return e.toString=function(){return t},e}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ZX=KX.format;var uZ=vX(yX).right,cZ=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},hZ=function(t){return+t},dZ=[0,1];function pZ(t){return t}function fZ(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function mZ(t,e,n){var r=t[0],i=t[1],a=e[0],s=e[1];return i<r?(r=fZ(i,r),a=n(s,a)):(r=fZ(r,i),a=n(a,s)),function(t){return a(r(t))}}function gZ(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=fZ(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(e){var n=uZ(t,e,1,r)-1;return a[n](i[n](e))}}function yZ(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function vZ(){return function(){var t,e,n,r,i,a,s=dZ,o=dZ,l=MG,u=pZ;function c(){var t,e,n,l=Math.min(s.length,o.length);return u!==pZ&&((t=s[0])>(e=s[l-1])&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=l>2?gZ:mZ,i=a=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(s.map(t),o,l)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=r(o,s.map(t),kG)))(n)))},h.domain=function(t){return arguments.length?(s=Array.from(t,hZ),c()):s.slice()},h.range=function(t){return arguments.length?(o=Array.from(t),c()):o.slice()},h.rangeRound=function(t){return o=Array.from(t),l=cZ,c()},h.clamp=function(t){return arguments.length?(u=!!t||pZ,c()):u!==pZ},h.interpolate=function(t){return arguments.length?(l=t,c()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}()(pZ,pZ)}function _Z(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function bZ(t){return new Date(t)}function xZ(t){return t instanceof Date?+t:+new Date(+t)}function wZ(t,e,n,r,i,a,s,o,l){var u=vZ(),c=u.invert,h=u.domain,d=l(".%L"),p=l(":%S"),f=l("%I:%M"),m=l("%I %p"),g=l("%a %d"),y=l("%b %d"),v=l("%B"),_=l("%Y"),b=[[s,1,1e3],[s,5,5e3],[s,15,15e3],[s,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function x(o){return(s(o)<o?d:a(o)<o?p:i(o)<o?f:r(o)<o?m:e(o)<o?n(o)<o?g:y:t(o)<o?v:_)(o)}function w(e,n,r){if(null==e&&(e=10),"number"==typeof e){var i,a=Math.abs(r-n)/e,s=vX((function(t){return t[2]})).right(b,a);return s===b.length?(i=SX(n/31536e6,r/31536e6,e),e=t):s?(i=(s=b[a/b[s-1][2]<b[s][2]/a?s-1:s])[1],e=s[0]):(i=Math.max(SX(n,r,e),1),e=o),e.every(i)}return e}return u.invert=function(t){return new Date(c(t))},u.domain=function(t){return arguments.length?h(Array.from(t,xZ)):h().map(bZ)},u.ticks=function(t){var e,n=h(),r=n[0],i=n[n.length-1],a=i<r;return a&&(e=r,r=i,i=e),e=(e=w(t,r,i))?e.range(r,i+1):[],a?e.reverse():e},u.tickFormat=function(t,e){return null==e?x:l(e)},u.nice=function(t){var e=h();return(t=w(t,e[0],e[e.length-1]))?h(function(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],s=t[i];return s<a&&(n=r,r=i,i=n,n=a,a=s,s=n),t[r]=e.floor(a),t[i]=e.ceil(s),t}(e,t)):u},u.copy=function(){return yZ(u,wZ(t,e,n,r,i,a,s,o,l))},u}var SZ=function(){return _Z.apply(wZ(EX,AX,RX,OX,PX,FX,LX,$X,ZX).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},CZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function DZ(t){if(!(e=CZ.exec(t)))throw new Error("invalid format: "+t);var e;return new IZ({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function IZ(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}DZ.prototype=IZ.prototype,IZ.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var kZ,EZ,AZ,TZ,RZ=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},MZ=function(t){return(t=RZ(Math.abs(t)))?t[1]:NaN},NZ=function(t,e){var n=RZ(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},OZ={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return NZ(100*t,e)},r:NZ,s:function(t,e){var n=RZ(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(kZ=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return a===s?r:a>s?r+new Array(a-s+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+RZ(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},PZ=function(t){return t},FZ=Array.prototype.map,LZ=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function zZ(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,a,s,o=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=wX(t,e,n))||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),a=new Array(i=Math.ceil(e-t+1));++o<i;)a[o]=(t+o)*s;else for(t=Math.floor(t*s),e=Math.ceil(e*s),a=new Array(i=Math.ceil(t-e+1));++o<i;)a[o]=(t-o)/s;return r&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var i,a=SX(t,e,n);switch((r=DZ(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(MZ(e)/3)))-MZ(Math.abs(t)))}(a,s))||(r.precision=i),TZ(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,MZ(e)-MZ(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-MZ(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return AZ(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,s=i.length-1,o=i[a],l=i[s];return l<o&&(r=o,o=l,l=r,r=a,a=s,s=r),(r=wX(o,l,n))>0?r=wX(o=Math.floor(o/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=wX(o=Math.ceil(o*r)/r,l=Math.floor(l*r)/r,n)),r>0?(i[a]=Math.floor(o/r)*r,i[s]=Math.ceil(l/r)*r,e(i)):r<0&&(i[a]=Math.ceil(o*r)/r,i[s]=Math.floor(l*r)/r,e(i)),t},t}function $Z(){var t=vZ();return t.copy=function(){return yZ(t,$Z())},_Z.apply(t,arguments),zZ(t)}EZ=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?PZ:(e=FZ.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],s=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),a.push(t.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[s=(s+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?PZ:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(FZ.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=DZ(t)).fill,n=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):OZ[v]||(void 0===g&&(g=12),y=!0,v="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var _="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===d?a:/[%p]/.test(v)?l:"",x=OZ[v],w=/[defgprs%]/.test(v);function S(t){var i,a,l,d=_,S=b;if("c"===v)S=x(t)+S,t="";else{var C=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:x(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),C&&0==+t&&"+"!==h&&(C=!1),d=(C?"("===h?h:u:"-"===h||"("===h?"":h)+d,S=("s"===v?LZ[8+kZ/3]:"")+S+(C&&"("===h?")":""),w)for(i=-1,a=t.length;++i<a;)if(48>(l=t.charCodeAt(i))||l>57){S=(46===l?s+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}m&&!p&&(t=r(t,1/0));var D=d.length+t.length+S.length,I=D<f?new Array(f-D+1).join(e):"";switch(m&&p&&(t=r(I+t,I.length?f-S.length:1/0),I=""),n){case"<":t=d+t+S+I;break;case"=":t=d+I+t+S;break;case"^":t=I.slice(0,D=I.length>>1)+d+t+S+I.slice(D);break;default:t=I+d+t+S}return o(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return t+""},S}return{format:h,formatPrefix:function(t,e){var n=h(((t=DZ(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(MZ(e)/3))),i=Math.pow(10,-r),a=LZ[8+r/3];return function(t){return n(i*t)+a}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),AZ=EZ.format,TZ=EZ.formatPrefix;var BZ=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a};const WZ=Symbol("implicit");function qZ(){var t=new Map,e=[],n=[],r=WZ;function i(i){var a=i+"",s=t.get(a);if(!s){if(r!==WZ)return r;t.set(a,s=e.push(i))}return n[(s-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return qZ(e,n).unknown(r)},_Z.apply(i,arguments),i}function VZ(){var t,e,n=qZ().unknown(void 0),r=n.domain,i=n.range,a=0,s=1,o=!1,l=0,u=0,c=.5;function h(){var n=r().length,h=s<a,d=h?s:a,p=h?a:s;t=(p-d)/Math.max(1,n-l+2*u),o&&(t=Math.floor(t)),d+=(p-d-t*(n-l))*c,e=t*(1-l),o&&(d=Math.round(d),e=Math.round(e));var f=BZ(n).map((function(e){return d+t*e}));return i(h?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),h()):r()},n.range=function(t){return arguments.length?([a,s]=t,a=+a,s=+s,h()):[a,s]},n.rangeRound=function(t){return[a,s]=t,a=+a,s=+s,o=!0,h()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,h()):o},n.padding=function(t){return arguments.length?(l=Math.min(1,u=+t),h()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),h()):l},n.paddingOuter=function(t){return arguments.length?(u=+t,h()):u},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),h()):c},n.copy=function(){return VZ(r(),[a,s]).round(o).paddingInner(l).paddingOuter(u).align(c)},_Z.apply(h(),arguments)}function UZ(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return UZ(e())},t}function jZ(){return UZ(VZ.apply(null,arguments).paddingInner(1))}function HZ(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function GZ(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function JZ(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function XZ(t,e,n){if(r=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n))).length){if((e=+e)<=0||r<2)return GZ(t);if(e>=1)return HZ(t);var r,i=(r-1)*e,a=Math.floor(i),s=HZ(function t(e,n,r=0,i=e.length-1,a=yX){for(;i>r;){if(i-r>600){const s=i-r+1,o=n-r+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(o-s/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-o*u/s+c)),Math.min(i,Math.floor(n+(s-o)*u/s+c)),a)}const s=e[n];let o=r,l=i;for(JZ(e,r,n),a(e[i],s)>0&&JZ(e,r,i);o<l;){for(JZ(e,o,l),++o,--l;a(e[o],s)<0;)++o;for(;a(e[l],s)>0;)--l}0===a(e[r],s)?JZ(e,r,l):(++l,JZ(e,l,i)),l<=n&&(r=l+1),n<=l&&(i=l-1)}return e}(t,a).subarray(0,a+1));return s+(GZ(t.subarray(a+1))-s)*(i-a)}}function KZ(t){this._context=t}KZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var ZZ=function(t){return new KZ(t)},YZ=Math.PI,QZ=2*YZ,tY=QZ-1e-6;function eY(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function nY(){return new eY}eY.prototype=nY.prototype={constructor:eY,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){var a=this._x1,s=this._y1,o=(n=+n)-(t=+t),l=(r=+r)-(e=+e),u=a-t,c=s-e,h=u*u+c*c;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(c*o-l*u)>1e-6&&i){var d=n-a,p=r-s,f=o*o+l*l,m=d*d+p*p,g=Math.sqrt(f),y=Math.sqrt(h),v=i*Math.tan((YZ-Math.acos((f+h-m)/(2*g*y)))/2),_=v/y,b=v/g;Math.abs(_-1)>1e-6&&(this._+="L"+(t+_*u)+","+(e+_*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>u*p)+","+(this._x1=t+b*o)+","+(this._y1=e+b*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var s=(n=+n)*Math.cos(r),o=n*Math.sin(r),l=t+s,u=e+o,c=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+l+","+u),n&&(h<0&&(h=h%QZ+QZ),h>tY?this._+="A"+n+","+n+",0,1,"+c+","+(t-s)+","+(e-o)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=YZ)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var rY=nY,iY=function(t){return function(){return t}};function aY(t){return t[0]}function sY(t){return t[1]}var oY=function(){var t=aY,e=sY,n=iY(!0),r=null,i=ZZ,a=null;function s(s){var o,l,u,c=s.length,h=!1;for(null==r&&(a=i(u=rY())),o=0;o<=c;++o)!(o<c&&n(l=s[o],o,s))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(l,o,s),+e(l,o,s));if(u)return a=null,u+""||null}return s.x=function(e){return arguments.length?(t="function"==typeof e?e:iY(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:iY(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:iY(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),s):r},s},lY=function(){var t=aY,e=null,n=iY(0),r=sY,i=iY(!0),a=null,s=ZZ,o=null;function l(l){var u,c,h,d,p,f=l.length,m=!1,g=new Array(f),y=new Array(f);for(null==a&&(o=s(p=rY())),u=0;u<=f;++u){if(!(u<f&&i(d=l[u],u,l))===m)if(m=!m)c=u,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),h=u-1;h>=c;--h)o.point(g[h],y[h]);o.lineEnd(),o.areaEnd()}m&&(g[u]=+t(d,u,l),y[u]=+n(d,u,l),o.point(e?+e(d,u,l):g[u],r?+r(d,u,l):y[u]))}if(p)return o=null,p+""||null}function u(){return oY().defined(i).curve(s).context(a)}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:iY(+n),e=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:iY(+e),l):t},l.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:iY(+t),l):e},l.y=function(t){return arguments.length?(n="function"==typeof t?t:iY(+t),r=null,l):n},l.y0=function(t){return arguments.length?(n="function"==typeof t?t:iY(+t),l):n},l.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:iY(+t),l):r},l.lineX0=l.lineY0=function(){return u().x(t).y(n)},l.lineY1=function(){return u().x(t).y(r)},l.lineX1=function(){return u().x(e).y(n)},l.defined=function(t){return arguments.length?(i="function"==typeof t?t:iY(!!t),l):i},l.curve=function(t){return arguments.length?(s=t,null!=a&&(o=s(a)),l):s},l.context=function(t){return arguments.length?(null==t?a=o=null:o=s(a=t),l):a},l},uY=function(){};function cY(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function hY(t,e){this._context=t,this._k=(1-e)/6}function dY(t,e){this._context=t,this._k=(1-e)/6}function pY(t){this._curve=t}hY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:cY(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:cY(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return new hY(t,e)}return n.tension=function(e){return t(+e)},n}(0),dY.prototype={areaStart:uY,areaEnd:uY,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:cY(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return new dY(t,e)}return n.tension=function(e){return t(+e)},n}(0),pY.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var fY=Math.abs,mY=Math.atan2,gY=Math.cos,yY=Math.max,vY=Math.min,_Y=Math.sin,bY=Math.sqrt,xY=Math.PI,wY=xY/2,SY=2*xY;function CY(t){return t>1?0:t<-1?xY:Math.acos(t)}function DY(t){return t>=1?wY:t<=-1?-wY:Math.asin(t)}function IY(t){return t.innerRadius}function kY(t){return t.outerRadius}function EY(t){return t.startAngle}function AY(t){return t.endAngle}function TY(t){return t&&t.padAngle}function RY(t,e,n,r,i,a,s,o){var l=n-t,u=r-e,c=s-i,h=o-a,d=h*l-c*u;if(!(d*d<1e-12))return[t+(d=(c*(e-a)-h*(t-i))/d)*l,e+d*u]}function MY(t,e,n,r,i,a,s){var o=t-n,l=e-r,u=(s?a:-a)/bY(o*o+l*l),c=u*l,h=-u*o,d=t+c,p=e+h,f=n+c,m=r+h,g=(d+f)/2,y=(p+m)/2,v=f-d,_=m-p,b=v*v+_*_,x=i-a,w=d*m-f*p,S=(_<0?-1:1)*bY(yY(0,x*x*b-w*w)),C=(w*_-v*S)/b,D=(-w*v-_*S)/b,I=(w*_+v*S)/b,k=(-w*v+_*S)/b,E=C-g,A=D-y,T=I-g,R=k-y;return E*E+A*A>T*T+R*R&&(C=I,D=k),{cx:C,cy:D,x01:-c,y01:-h,x11:C*(i/x-1),y11:D*(i/x-1)}}var NY=function(){var t=IY,e=kY,n=iY(0),r=null,i=EY,a=AY,s=TY,o=null;function l(){var l,u,c=+t.apply(this,arguments),h=+e.apply(this,arguments),d=i.apply(this,arguments)-wY,p=a.apply(this,arguments)-wY,f=fY(p-d),m=p>d;if(o||(o=l=rY()),h<c&&(u=h,h=c,c=u),h>1e-12)if(f>SY-1e-12)o.moveTo(h*gY(d),h*_Y(d)),o.arc(0,0,h,d,p,!m),c>1e-12&&(o.moveTo(c*gY(p),c*_Y(p)),o.arc(0,0,c,p,d,m));else{var g,y,v=d,_=p,b=d,x=p,w=f,S=f,C=s.apply(this,arguments)/2,D=C>1e-12&&(r?+r.apply(this,arguments):bY(c*c+h*h)),I=vY(fY(h-c)/2,+n.apply(this,arguments)),k=I,E=I;if(D>1e-12){var A=DY(D/c*_Y(C)),T=DY(D/h*_Y(C));(w-=2*A)>1e-12?(b+=A*=m?1:-1,x-=A):(w=0,b=x=(d+p)/2),(S-=2*T)>1e-12?(v+=T*=m?1:-1,_-=T):(S=0,v=_=(d+p)/2)}var R=h*gY(v),M=h*_Y(v),N=c*gY(x),O=c*_Y(x);if(I>1e-12){var P,F=h*gY(_),L=h*_Y(_),z=c*gY(b),$=c*_Y(b);if(f<xY&&(P=RY(R,M,z,$,F,L,N,O))){var B=R-P[0],W=M-P[1],q=F-P[0],V=L-P[1],U=1/_Y(CY((B*q+W*V)/(bY(B*B+W*W)*bY(q*q+V*V)))/2),j=bY(P[0]*P[0]+P[1]*P[1]);k=vY(I,(c-j)/(U-1)),E=vY(I,(h-j)/(U+1))}}S>1e-12?E>1e-12?(g=MY(z,$,R,M,h,E,m),y=MY(F,L,N,O,h,E,m),o.moveTo(g.cx+g.x01,g.cy+g.y01),E<I?o.arc(g.cx,g.cy,E,mY(g.y01,g.x01),mY(y.y01,y.x01),!m):(o.arc(g.cx,g.cy,E,mY(g.y01,g.x01),mY(g.y11,g.x11),!m),o.arc(0,0,h,mY(g.cy+g.y11,g.cx+g.x11),mY(y.cy+y.y11,y.cx+y.x11),!m),o.arc(y.cx,y.cy,E,mY(y.y11,y.x11),mY(y.y01,y.x01),!m))):(o.moveTo(R,M),o.arc(0,0,h,v,_,!m)):o.moveTo(R,M),c>1e-12&&w>1e-12?k>1e-12?(g=MY(N,O,F,L,c,-k,m),y=MY(R,M,z,$,c,-k,m),o.lineTo(g.cx+g.x01,g.cy+g.y01),k<I?o.arc(g.cx,g.cy,k,mY(g.y01,g.x01),mY(y.y01,y.x01),!m):(o.arc(g.cx,g.cy,k,mY(g.y01,g.x01),mY(g.y11,g.x11),!m),o.arc(0,0,c,mY(g.cy+g.y11,g.cx+g.x11),mY(y.cy+y.y11,y.cx+y.x11),m),o.arc(y.cx,y.cy,k,mY(y.y11,y.x11),mY(y.y01,y.x01),!m))):o.arc(0,0,c,x,b,m):o.lineTo(N,O)}else o.moveTo(0,0);if(o.closePath(),l)return o=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-xY/2;return[gY(r)*n,_Y(r)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:iY(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:iY(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:iY(+t),l):n},l.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:iY(+t),l):r},l.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:iY(+t),l):i},l.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:iY(+t),l):a},l.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:iY(+t),l):s},l.context=function(t){return arguments.length?(o=null==t?null:t,l):o},l},OY=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},PY=function(t){return t},FY=function(t,e,n,r,i){for(var a,s=t.children,o=-1,l=s.length,u=t.value&&(r-e)/t.value;++o<l;)(a=s[o]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*u},LY=function(t,e,n,r,i){for(var a,s=t.children,o=-1,l=s.length,u=t.value&&(i-n)/t.value;++o<l;)(a=s[o]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*u};function zY(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function $Y(t,e){var n,r,i,a,s,o=new VY(t),l=+t.value&&(o.value=t.value),u=[o];for(null==e&&(e=BY);n=u.pop();)if(l&&(n.value=+n.data.value),(i=e(n.data))&&(s=i.length))for(n.children=new Array(s),a=s-1;a>=0;--a)u.push(r=n.children[a]=new VY(i[a])),r.parent=n,r.depth=n.depth+1;return o.eachBefore(qY)}function BY(t){return t.children}function WY(t){t.data=t.data.data}function qY(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function VY(t){this.data=t,this.depth=this.height=0,this.parent=null}!function t(e){function n(t,n,r,i,a){!function(t,e,n,r,i,a){for(var s,o,l,u,c,h,d,p,f,m,g,y=[],v=e.children,_=0,b=0,x=v.length,w=e.value;_<x;){l=i-n,u=a-r;do{c=v[b++].value}while(!c&&b<x);for(h=d=c,g=c*c*(m=Math.max(u/l,l/u)/(w*t)),f=Math.max(d/g,g/h);b<x;++b){if(c+=o=v[b].value,o<h&&(h=o),o>d&&(d=o),g=c*c*m,(p=Math.max(d/g,g/h))>f){c-=o;break}f=p}y.push(s={value:c,dice:l<u,children:v.slice(_,b)}),s.dice?FY(s,n,r,i,w?r+=u*c/w:a):LY(s,n,r,w?n+=l*c/w:i,a),w-=c,_=b}}(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}((1+Math.sqrt(5))/2),VY.prototype=$Y.prototype={constructor:VY,count:function(){return this.eachAfter(zY)},each:function(t){var e,n,r,i,a=this,s=[a];do{for(e=s.reverse(),s=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)s.push(n[r])}while(s.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],s=[];i=a.pop();)if(s.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=s.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)r.push(e=e.parent);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return $Y(this).eachBefore(WY)}};const UY=["caretElm"];function jY(t,e){}const HY=function(t){return{model:t}};function GY(t,e){if(1&t&&(ao(0,"span"),Ys(1,jY,0,0,"ng-template",5),so()),2&t){const t=_o();Hi(1),ro("ngTemplateOutlet",t.template)("ngTemplateOutletContext",ou(2,HY,t.context))}}function JY(t,e){1&t&&oo(0,"span",6),2&t&&ro("innerHTML",_o().title,ki)}function XY(t,e){if(1&t&&(Qn(),tr(),oo(0,"ngx-charts-scale-legend",4)),2&t){const t=_o();ro("horizontal",t.legendOptions&&"below"===t.legendOptions.position)("valueRange",t.legendOptions.domain)("colors",t.legendOptions.colors)("height",t.view[1])("width",t.legendWidth)}}function KY(t,e){if(1&t){const t=co();Qn(),tr(),ao(0,"ngx-charts-legend",5),fo("labelClick",(function(e){return Tn(t),_o().legendLabelClick.emit(e)}))("labelActivate",(function(e){return Tn(t),_o().legendLabelActivate.emit(e)}))("labelDeactivate",(function(e){return Tn(t),_o().legendLabelDeactivate.emit(e)})),so()}if(2&t){const t=_o();ro("horizontal",t.legendOptions&&"below"===t.legendOptions.position)("data",t.legendOptions.domain)("title",t.legendOptions.title)("colors",t.legendOptions.colors)("height",t.view[1])("width",t.legendWidth)("activeEntries",t.activeEntries)}}const ZY=["*"],YY=["ngx-charts-axis-label",""],QY=["ticksel"],tQ=["ngx-charts-x-axis-ticks",""];function eQ(t,e){if(1&t&&(Qn(),ao(0,"g",3),ao(1,"title"),Vo(2),so(),ao(3,"text",4),Vo(4),so(),so()),2&t){const t=e.$implicit,n=_o();Ks("transform",n.tickTransform(t)),Hi(2),Uo(n.tickFormat(t)),Hi(1),To("font-size","12px"),Ks("text-anchor",n.textAnchor)("transform",n.textTransform),Hi(1),jo(" ",n.tickTrim(n.tickFormat(t))," ")}}function nQ(t,e){if(1&t&&(Qn(),ao(0,"g"),oo(1,"line",6),so()),2&t){const t=_o(2);Ks("transform",t.gridLineTransform()),Hi(1),Ks("y1",0-t.gridLineHeight)}}function rQ(t,e){if(1&t&&(Qn(),ao(0,"g"),Ys(1,nQ,2,2,"g",5),so()),2&t){const t=e.$implicit,n=_o();Ks("transform",n.tickTransform(t)),Hi(1),ro("ngIf",n.showGridLines)}}const iQ=["ngx-charts-x-axis",""];function aQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",2),fo("dimensionsChanged",(function(e){return Tn(t),_o().emitTicksHeight(e)})),so()}if(2&t){const t=_o();ro("trimTicks",t.trimTicks)("rotateTicks",t.rotateTicks)("maxTickLength",t.maxTickLength)("tickFormatting",t.tickFormatting)("tickArguments",t.tickArguments)("tickStroke",t.tickStroke)("scale",t.xScale)("orient",t.xOrient)("showGridLines",t.showGridLines)("gridLineHeight",t.dims.height)("width",t.dims.width)("tickValues",t.ticks)}}function sQ(t,e){if(1&t&&(Qn(),oo(0,"g",3)),2&t){const t=_o();ro("label",t.labelText)("offset",t.labelOffset)("orient","bottom")("height",t.dims.height)("width",t.dims.width)}}const oQ=["ngx-charts-y-axis-ticks",""];function lQ(t,e){if(1&t&&(Qn(),ao(0,"g",4),ao(1,"title"),Vo(2),so(),ao(3,"text",5),Vo(4),so(),so()),2&t){const t=e.$implicit,n=_o();Ks("transform",n.transform(t)),Hi(2),Uo(n.tickFormat(t)),Hi(1),To("font-size","12px"),Ks("dy",n.dy)("x",n.x1)("y",n.y1)("text-anchor",n.textAnchor),Hi(1),jo(" ",n.tickTrim(n.tickFormat(t))," ")}}function uQ(t,e){if(1&t&&(Qn(),oo(0,"path",6)),2&t){const t=_o();Ks("d",t.referenceAreaPath)("transform",t.gridLineTransform())}}function cQ(t,e){1&t&&(Qn(),oo(0,"line",9)),2&t&&Ks("x2",_o(3).gridLineWidth)}function hQ(t,e){1&t&&(Qn(),oo(0,"line",9)),2&t&&Ks("x2",0-_o(3).gridLineWidth)}function dQ(t,e){if(1&t&&(Qn(),ao(0,"g"),Ys(1,cQ,1,1,"line",8),Ys(2,hQ,1,1,"line",8),so()),2&t){const t=_o(2);Ks("transform",t.gridLineTransform()),Hi(1),ro("ngIf","left"===t.orient),Hi(1),ro("ngIf","right"===t.orient)}}function pQ(t,e){if(1&t&&(Qn(),ao(0,"g"),Ys(1,dQ,3,3,"g",7),so()),2&t){const t=e.$implicit,n=_o();Ks("transform",n.transform(t)),Hi(1),ro("ngIf",n.showGridLines)}}function fQ(t,e){if(1&t&&(Qn(),ao(0,"g"),ao(1,"title"),Vo(2),so(),ao(3,"text",11),Vo(4),so(),so()),2&t){const t=_o(2).$implicit,e=_o();Hi(2),Uo(e.tickTrim(e.tickFormat(t.value))),Hi(1),Ks("dy",e.dy)("y",-6)("x",e.gridLineWidth)("text-anchor",e.textAnchor),Hi(1),jo(" ",t.name," ")}}function mQ(t,e){if(1&t&&(Qn(),ao(0,"g"),oo(1,"line",10),Ys(2,fQ,5,6,"g",7),so()),2&t){const t=_o().$implicit,e=_o();Ks("transform",e.transform(t.value)),Hi(1),Ks("x2",e.gridLineWidth)("transform",e.gridLineTransform()),Hi(1),ro("ngIf",e.showRefLabels)}}function gQ(t,e){if(1&t&&(Qn(),ao(0,"g"),Ys(1,mQ,3,4,"g",7),so()),2&t){const t=_o();Hi(1),ro("ngIf",t.showRefLines)}}const yQ=["ngx-charts-y-axis",""];function vQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",2),fo("dimensionsChanged",(function(e){return Tn(t),_o().emitTicksWidth(e)})),so()}if(2&t){const t=_o();ro("trimTicks",t.trimTicks)("maxTickLength",t.maxTickLength)("tickFormatting",t.tickFormatting)("tickArguments",t.tickArguments)("tickValues",t.ticks)("tickStroke",t.tickStroke)("scale",t.yScale)("orient",t.yOrient)("showGridLines",t.showGridLines)("gridLineWidth",t.dims.width)("referenceLines",t.referenceLines)("showRefLines",t.showRefLines)("showRefLabels",t.showRefLabels)("height",t.dims.height)}}function _Q(t,e){if(1&t&&(Qn(),oo(0,"g",3)),2&t){const t=_o();ro("label",t.labelText)("offset",t.labelOffset)("orient",t.yOrient)("height",t.dims.height)("width",t.dims.width)}}const bQ=["ngx-charts-circle-series",""];function xQ(t,e){if(1&t&&(Qn(),oo(0,"rect",4)),2&t){const t=_o(2);ro("@animationState","active"),Ks("x",t.circle.cx-t.circle.radius)("y",t.circle.cy)("width",2*t.circle.radius)("height",t.circle.height)("fill",t.gradientFill)}}const wQ=function(t){return{name:t}};function SQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g"),ao(1,"defs"),oo(2,"g",1),so(),Ys(3,xQ,1,6,"rect",2),ao(4,"g",3),fo("select",(function(){Tn(t);const e=_o();return e.onClick(e.circle.data)}))("activate",(function(){return Tn(t),_o().activateCircle()}))("deactivate",(function(){return Tn(t),_o().deactivateCircle()})),so(),so()}if(2&t){const t=_o();Hi(2),ro("name",t.gradientId)("stops",t.circle.gradientStops),Hi(1),ro("ngIf",t.barVisible&&"standard"===t.type),Hi(1),Ro("active",t.isActive(ou(18,wQ,t.circle.seriesName))),ro("cx",t.circle.cx)("cy",t.circle.cy)("r",t.circle.radius)("fill",t.circle.color)("pointerEvents",0===t.circle.value?"none":"all")("data",t.circle.value)("classNames",t.circle.classNames)("tooltipDisabled",t.tooltipDisabled)("tooltipPlacement","top")("tooltipType","tooltip")("tooltipTitle",t.tooltipTemplate?void 0:t.getTooltipText(t.circle))("tooltipTemplate",t.tooltipTemplate)("tooltipContext",t.circle.data)}}const CQ=["ngx-charts-circle",""],DQ=["ngx-charts-svg-linear-gradient",""];function IQ(t,e){if(1&t&&(Qn(),oo(0,"stop")),2&t){const t=e.$implicit;To("stop-color",t.color)("stop-opacity",t.opacity),Ks("offset",t.offset+"%")}}const kQ=["ngx-charts-svg-radial-gradient",""];function EQ(t,e){if(1&t&&(Qn(),oo(0,"stop")),2&t){const t=e.$implicit;To("stop-color",t.color)("stop-opacity",t.opacity),Ks("offset",t.offset+"%")}}const AQ=["ngx-charts-area",""];function TQ(t,e){if(1&t&&(Qn(),ao(0,"defs"),oo(1,"g",2),so()),2&t){const t=_o();Hi(1),ro("name",t.gradientId)("stops",t.gradientStops)}}const RQ=["tooltipAnchor"],MQ=["ngx-charts-tooltip-area",""];function NQ(t,e){if(1&t&&(ao(0,"div",6),oo(1,"span",7),Vo(2),so()),2&t){const t=e.$implicit,n=_o(2);Hi(1),To("background-color",t.color),Hi(1),jo(" ",n.getToolTipText(t)," ")}}function OQ(t,e){if(1&t&&(Qn(),tr(),ao(0,"div",4),Ys(1,NQ,3,3,"div",5),so()),2&t){const t=e.model;Hi(1),ro("ngForOf",t)}}const PQ=["ngx-charts-timeline",""];function FQ(t,e){if(1&t&&(ao(0,"header",4),ao(1,"span",5),Vo(2),so(),so()),2&t){const t=_o();Hi(2),Uo(t.title)}}function LQ(t,e){if(1&t){const t=co();ao(0,"li",6),ao(1,"ngx-charts-legend-entry",7),fo("select",(function(e){return Tn(t),_o().labelClick.emit(e)}))("activate",(function(e){return Tn(t),_o().activate(e)}))("deactivate",(function(e){return Tn(t),_o().deactivate(e)})),so(),so()}if(2&t){const t=e.$implicit,n=_o();Hi(1),ro("label",t.label)("formattedLabel",t.formattedLabel)("color",t.color)("isActive",n.isActive(t))}}const zQ=["tooltipTemplate"],$Q=["seriesTooltipTemplate"],BQ=function(t,e){return[t,e]},WQ=["ngx-charts-bar",""];function qQ(t,e){if(1&t&&(Qn(),ao(0,"defs"),oo(1,"g",2),so()),2&t){const t=_o();Hi(1),ro("orientation",t.orientation)("name",t.gradientId)("stops",t.gradientStops)}}function VQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",5),fo("dimensionsChanged",(function(e){return Tn(t),_o().updateXAxisHeight(e)})),so()}if(2&t){const t=_o();ro("xScale",t.xScale)("dims",t.dims)("showLabel",t.showXAxisLabel)("labelText",t.xAxisLabel)("trimTicks",t.trimXAxisTicks)("rotateTicks",t.rotateXAxisTicks)("maxTickLength",t.maxXAxisTickLength)("tickFormatting",t.xAxisTickFormatting)("ticks",t.xAxisTicks)("xAxisOffset",t.dataLabelMaxHeight.negative)}}function UQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",6),fo("dimensionsChanged",(function(e){return Tn(t),_o().updateYAxisWidth(e)})),so()}if(2&t){const t=_o();ro("yScale",t.yScale)("dims",t.dims)("showGridLines",t.showGridLines)("showLabel",t.showYAxisLabel)("labelText",t.yAxisLabel)("trimTicks",t.trimYAxisTicks)("maxTickLength",t.maxYAxisTickLength)("tickFormatting",t.yAxisTickFormatting)("ticks",t.yAxisTicks)}}const jQ=["ngx-charts-series-vertical",""];function HQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",2),fo("select",(function(e){return Tn(t),_o().onClick(e)}))("activate",(function(e){return Tn(t),_o().activate.emit(e)}))("deactivate",(function(e){return Tn(t),_o().deactivate.emit(e)})),so()}if(2&t){const t=e.$implicit,n=_o();ro("@animationState","active")("@.disabled",!n.animations)("width",t.width)("height",t.height)("x",t.x)("y",t.y)("fill",t.color)("stops",t.gradientStops)("data",t.data)("orientation","vertical")("roundEdges",t.roundEdges)("gradient",n.gradient)("ariaLabel",t.ariaLabel)("isActive",n.isActive(t.data))("tooltipDisabled",n.tooltipDisabled)("tooltipPlacement",n.tooltipPlacement)("tooltipType",n.tooltipType)("tooltipTitle",n.tooltipTemplate?void 0:t.tooltipText)("tooltipTemplate",n.tooltipTemplate)("tooltipContext",t.data)("noBarWhenZero",n.noBarWhenZero)("animations",n.animations)}}function GQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",4),fo("dimensionsChanged",(function(n){Tn(t);const r=e.index;return _o(2).dataLabelHeightChanged.emit({size:n,index:r})})),so()}if(2&t){const t=e.$implicit,n=_o(2);ro("barX",t.x)("barY",t.y)("barWidth",t.width)("barHeight",t.height)("value",t.total)("valueFormatting",n.dataLabelFormatting)("orientation","vertical")}}function JQ(t,e){if(1&t&&(Qn(),ao(0,"g"),Ys(1,GQ,1,7,"g",3),so()),2&t){const t=_o();Hi(1),ro("ngForOf",t.barsForDataLabels)("ngForTrackBy",t.trackDataLabelBy)}}const XQ=["ngx-charts-bar-label",""],KQ=["ngx-charts-line",""];function ZQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",7),fo("dimensionsChanged",(function(e){return Tn(t),_o().updateXAxisHeight(e)})),so()}if(2&t){const t=_o();ro("xScale",t.xScale)("dims",t.dims)("showGridLines",t.showGridLines)("showLabel",t.showXAxisLabel)("labelText",t.xAxisLabel)("trimTicks",t.trimXAxisTicks)("rotateTicks",t.rotateXAxisTicks)("maxTickLength",t.maxXAxisTickLength)("tickFormatting",t.xAxisTickFormatting)("ticks",t.xAxisTicks)}}function YQ(t,e){if(1&t){const t=co();Qn(),ao(0,"g",8),fo("dimensionsChanged",(function(e){return Tn(t),_o().updateYAxisWidth(e)})),so()}if(2&t){const t=_o();ro("yScale",t.yScale)("dims",t.dims)("showGridLines",t.showGridLines)("showLabel",t.showYAxisLabel)("labelText",t.yAxisLabel)("trimTicks",t.trimYAxisTicks)("maxTickLength",t.maxYAxisTickLength)("tickFormatting",t.yAxisTickFormatting)("ticks",t.yAxisTicks)("referenceLines",t.referenceLines)("showRefLines",t.showRefLines)("showRefLabels",t.showRefLabels)}}function QQ(t,e){if(1&t&&(Qn(),ao(0,"g"),oo(1,"g",9),so()),2&t){const t=e.$implicit,n=_o();ro("@animationState","active"),Hi(1),ro("xScale",n.xScale)("yScale",n.yScale)("colors",n.colors)("data",t)("activeEntries",n.activeEntries)("scaleType",n.scaleType)("curve",n.curve)("rangeFillOpacity",n.rangeFillOpacity)("hasRange",n.hasRange)("animations",n.animations)}}function t0(t,e){if(1&t){const t=co();Qn(),ao(0,"g"),ao(1,"g",13),fo("select",(function(e){return Tn(t),_o(2).onClick(e)}))("activate",(function(e){return Tn(t),_o(2).onActivate(e)}))("deactivate",(function(e){return Tn(t),_o(2).onDeactivate(e)})),so(),so()}if(2&t){const t=e.$implicit,n=_o(2);Hi(1),ro("xScale",n.xScale)("yScale",n.yScale)("colors",n.colors)("data",t)("scaleType",n.scaleType)("visibleValue",n.hoveredVertical)("activeEntries",n.activeEntries)("tooltipDisabled",n.tooltipDisabled)("tooltipTemplate",n.tooltipTemplate)}}function e0(t,e){if(1&t){const t=co();Qn(),ao(0,"g",10),fo("mouseleave",(function(){return Tn(t),_o().hideCircles()})),ao(1,"g",11),fo("hover",(function(e){return Tn(t),_o().updateHoveredVertical(e)})),so(),Ys(2,t0,2,9,"g",12),so()}if(2&t){const t=_o();Hi(1),ro("dims",t.dims)("xSet",t.xSet)("xScale",t.xScale)("yScale",t.yScale)("results",t.results)("colors",t.colors)("tooltipDisabled",t.tooltipDisabled)("tooltipTemplate",t.seriesTooltipTemplate),Hi(1),ro("ngForOf",t.results)}}function n0(t,e){if(1&t&&(Qn(),ao(0,"g"),oo(1,"g",15),so()),2&t){const t=e.$implicit,n=_o(2);Hi(1),ro("xScale",n.timelineXScale)("yScale",n.timelineYScale)("colors",n.colors)("data",t)("scaleType",n.scaleType)("curve",n.curve)("hasRange",n.hasRange)("animations",n.animations)}}function r0(t,e){if(1&t){const t=co();Qn(),ao(0,"g",14),fo("onDomainChange",(function(e){return Tn(t),_o().updateDomain(e)})),Ys(1,n0,2,8,"g",4),so()}if(2&t){const t=_o();ro("results",t.results)("view",lu(10,BQ,t.timelineWidth,t.height))("height",t.timelineHeight)("scheme",t.scheme)("customColors",t.customColors)("scaleType",t.scaleType)("legend",t.legend),Ks("transform",t.timelineTransform),Hi(1),ro("ngForOf",t.results)("ngForTrackBy",t.trackBy)}}const i0=["ngx-charts-line-series",""];function a0(t,e){if(1&t&&(Qn(),oo(0,"g",4)),2&t){const t=_o();ro("name",t.gradientId)("stops",t.gradientStops)}}function s0(t,e){if(1&t&&(Qn(),oo(0,"g",5)),2&t){const t=_o();Ro("active",t.isActive(t.data))("inactive",t.isInactive(t.data)),ro("data",t.data)("path",t.outerPath)("fill",t.hasGradient?t.gradientUrl:t.colors.getColor(t.data.name))("opacity",t.rangeFillOpacity)("animations",t.animations)}}const o0=["ngx-charts-pie-label",""],l0=["ngx-charts-pie-arc",""];function u0(t,e){if(1&t&&(Qn(),ao(0,"defs"),oo(1,"g",3),so()),2&t){const t=_o();Hi(1),ro("color",t.fill)("name",t.radialGradientId)("startOpacity",t.startOpacity)}}const c0=["ngx-charts-pie-series",""];function h0(t,e){if(1&t&&(Qn(),oo(0,"g",3)),2&t){const t=_o().$implicit,e=_o();ro("data",t)("radius",e.outerRadius)("color",e.color(t))("label",e.labelText(t))("labelTrim",e.trimLabels)("labelTrimSize",e.maxLabelLength)("max",e.max)("value",t.value)("explodeSlices",e.explodeSlices)("animations",e.animations)}}function d0(t,e){if(1&t){const t=co();Qn(),ao(0,"g"),Ys(1,h0,1,10,"g",1),ao(2,"g",2),fo("select",(function(e){return Tn(t),_o().onClick(e)}))("activate",(function(e){return Tn(t),_o().activate.emit(e)}))("deactivate",(function(e){return Tn(t),_o().deactivate.emit(e)}))("dblclick",(function(e){return Tn(t),_o().dblclick.emit(e)})),so(),so()}if(2&t){const t=e.$implicit,n=_o();Hi(1),ro("ngIf",n.labelVisible(t)),Hi(1),ro("startAngle",t.startAngle)("endAngle",t.endAngle)("innerRadius",n.innerRadius)("outerRadius",n.outerRadius)("fill",n.color(t))("value",t.data.value)("gradient",n.gradient)("data",t.data)("max",n.max)("explodeSlices",n.explodeSlices)("isActive",n.isActive(t.data))("animate",n.animations)("tooltipDisabled",n.tooltipDisabled)("tooltipPlacement","top")("tooltipType","tooltip")("tooltipTitle",n.getTooltipTitle(t))("tooltipTemplate",n.tooltipTemplate)("tooltipContext",t.data)}}var p0;let f0=(()=>{let t=p0=class{constructor(t,e,n){this.applicationRef=t,this.componentFactoryResolver=e,this.injector=n}static setGlobalRootViewContainer(t){p0.globalRootViewContainer=t}getRootViewContainer(){if(this._container)return this._container;if(p0.globalRootViewContainer)return p0.globalRootViewContainer;if(this.applicationRef.components.length)return this.applicationRef.components[0];throw new Error("View Container not found! ngUpgrade needs to manually set this via setRootViewContainer or setGlobalRootViewContainer.")}setRootViewContainer(t){this._container=t}getComponentRootNode(t){return t.element?t.element.nativeElement:t.hostView&&t.hostView.rootNodes.length>0?t.hostView.rootNodes[0]:t.location.nativeElement}getRootViewContainerNode(t){return this.getComponentRootNode(t)}projectComponentBindings(t,e){if(e){if(void 0!==e.inputs){const n=Object.getOwnPropertyNames(e.inputs);for(const r of n)t.instance[r]=e.inputs[r]}if(void 0!==e.outputs){const n=Object.getOwnPropertyNames(e.outputs);for(const r of n)t.instance[r]=e.outputs[r]}}return t}appendComponent(t,e={},n){n||(n=this.getRootViewContainer());const r=this.getComponentRootNode(n),i=new Yq(r,this.componentFactoryResolver,this.applicationRef,this.injector),a=new Gq(t),s=i.attach(a);return this.projectComponentBindings(s,e),s}};return t.\u0275fac=function(e){return new(e||t)(Ae(xc),Ae(gl),Ae(Fs))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t.globalRootViewContainer=null,t})();function m0(t,e,n){let r,i,a;n=n||{};let s=null,o=0;function l(){o=!1===n.leading?0:+new Date,s=null,a=t.apply(r,i)}return function(){const u=+new Date;o||!1!==n.leading||(o=u);const c=e-(u-o);return r=this,i=arguments,c<=0?(clearTimeout(s),s=null,o=u,a=t.apply(r,i)):s||!1===n.trailing||(s=setTimeout(l,c)),a}}var g0=function(t){return t[t.top="top"]="top",t[t.bottom="bottom"]="bottom",t[t.left="left"]="left",t[t.right="right"]="right",t}({});function y0(t,e,n){return"top"===n?t.top-7:"bottom"===n?t.top+t.height-e.height+7:"center"===n?t.top+t.height/2-e.height/2:void 0}function v0(t,e,n){return"left"===n?t.left-7:"right"===n?t.left+t.width-e.width+7:"center"===n?t.left+t.width/2-e.width/2:void 0}class _0{static calculateVerticalAlignment(t,e,n){let r=y0(t,e,n);return r+e.height>window.innerHeight&&(r=window.innerHeight-e.height),r}static calculateVerticalCaret(t,e,n,r){let i;"top"===r&&(i=t.height/2-n.height/2+7),"bottom"===r&&(i=e.height-t.height/2-n.height/2-7),"center"===r&&(i=e.height/2-n.height/2);const a=y0(t,e,r);return a+e.height>window.innerHeight&&(i+=a+e.height-window.innerHeight),i}static calculateHorizontalAlignment(t,e,n){let r=v0(t,e,n);return r+e.width>window.innerWidth&&(r=window.innerWidth-e.width),r}static calculateHorizontalCaret(t,e,n,r){let i;"left"===r&&(i=t.width/2-n.width/2+7),"right"===r&&(i=e.width-t.width/2-n.width/2-7),"center"===r&&(i=e.width/2-n.width/2);const a=v0(t,e,r);return a+e.width>window.innerWidth&&(i+=a+e.width-window.innerWidth),i}static shouldFlip(t,e,n,r){let i=!1;return"right"===n&&t.left+t.width+e.width+r>window.innerWidth&&(i=!0),"left"===n&&t.left-e.width-r<0&&(i=!0),"top"===n&&t.top-e.height-r<0&&(i=!0),"bottom"===n&&t.top+t.height+e.height+r>window.innerHeight&&(i=!0),i}static positionCaret(t,e,n,r,i){let a=0,s=0;return t===g0.right?(s=-7,a=_0.calculateVerticalCaret(n,e,r,i)):t===g0.left?(s=e.width,a=_0.calculateVerticalCaret(n,e,r,i)):t===g0.top?(a=e.height,s=_0.calculateHorizontalCaret(n,e,r,i)):t===g0.bottom&&(a=-7,s=_0.calculateHorizontalCaret(n,e,r,i)),{top:a,left:s}}static positionContent(t,e,n,r,i){let a=0,s=0;return t===g0.right?(s=n.left+n.width+r,a=_0.calculateVerticalAlignment(n,e,i)):t===g0.left?(s=n.left-e.width-r,a=_0.calculateVerticalAlignment(n,e,i)):t===g0.top?(a=n.top-e.height-r,s=_0.calculateHorizontalAlignment(n,e,i)):t===g0.bottom&&(a=n.top+n.height+r,s=_0.calculateHorizontalAlignment(n,e,i)),{top:a,left:s}}static determinePlacement(t,e,n,r){if(_0.shouldFlip(n,e,t,r)){if(t===g0.right)return g0.left;if(t===g0.left)return g0.right;if(t===g0.top)return g0.bottom;if(t===g0.bottom)return g0.top}return t}}let b0=(()=>{let t=class{constructor(t,e){this.element=t,this.renderer=e}get cssClasses(){let t="ngx-charts-tooltip-content";return t+=` position-${this.placement}`,t+=` type-${this.type}`,t+=` ${this.cssClass}`,t}ngAfterViewInit(){setTimeout(this.position.bind(this))}position(){const t=this.element.nativeElement,e=this.host.nativeElement.getBoundingClientRect();if(!e.height&&!e.width)return;const n=t.getBoundingClientRect();this.checkFlip(e,n),this.positionContent(t,e,n),this.showCaret&&this.positionCaret(e,n),setTimeout(()=>this.renderer.addClass(t,"animate"),1)}positionContent(t,e,n){const{top:r,left:i}=_0.positionContent(this.placement,n,e,this.spacing,this.alignment);this.renderer.setStyle(t,"top",`${r}px`),this.renderer.setStyle(t,"left",`${i}px`)}positionCaret(t,e){const n=this.caretElm.nativeElement,r=n.getBoundingClientRect(),{top:i,left:a}=_0.positionCaret(this.placement,e,t,r,this.alignment);this.renderer.setStyle(n,"top",`${i}px`),this.renderer.setStyle(n,"left",`${a}px`)}checkFlip(t,e){this.placement=_0.determinePlacement(this.placement,e,t,this.spacing)}onWindowResize(){this.position()}};return t.\u0275fac=function(e){return new(e||t)(to(yl),to(xl))},t.\u0275cmp=Je({type:t,selectors:[["ngx-tooltip-content"]],viewQuery:function(t,e){var n;1&t&&Su(UY,!0),2&t&&xu(n=Eu())&&(e.caretElm=n.first)},hostVars:2,hostBindings:function(t,e){1&t&&fo("resize",(function(){return e.onWindowResize()}),!1,br),2&t&&Oo(Be,Mo,e.cssClasses,!0)},inputs:{placement:"placement",host:"host",showCaret:"showCaret",type:"type",alignment:"alignment",spacing:"spacing",cssClass:"cssClass",title:"title",template:"template",context:"context"},decls:6,vars:6,consts:[[3,"hidden"],["caretElm",""],[1,"tooltip-content"],[4,"ngIf"],[3,"innerHTML",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"]],template:function(t,e){1&t&&(ao(0,"div"),oo(1,"span",0,1),ao(3,"div",2),Ys(4,GY,2,4,"span",3),Ys(5,JY,1,1,"span",4),so(),so()),2&t&&(Hi(1),Go("tooltip-caret position-",e.placement,""),ro("hidden",!e.showCaret),Hi(3),ro("ngIf",!e.title),Hi(1),ro("ngIf",e.title))},directives:[ah,ph],styles:[".ngx-charts-tooltip-content{position:fixed;border-radius:3px;z-index:5000;display:block;font-weight:400;opacity:0;pointer-events:none!important}.ngx-charts-tooltip-content.type-popover{background:#fff;color:#060709;border:1px solid #72809b;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);font-size:13px;padding:4px}.ngx-charts-tooltip-content.type-popover .tooltip-caret{position:absolute;z-index:5001;width:0;height:0}.ngx-charts-tooltip-content.type-popover .tooltip-caret.position-left{border-top:7px solid transparent;border-bottom:7px solid transparent;border-left:7px solid #fff}.ngx-charts-tooltip-content.type-popover .tooltip-caret.position-top{border-left:7px solid transparent;border-right:7px solid transparent;border-top:7px solid #fff}.ngx-charts-tooltip-content.type-popover .tooltip-caret.position-right{border-top:7px solid transparent;border-bottom:7px solid transparent;border-right:7px solid #fff}.ngx-charts-tooltip-content.type-popover .tooltip-caret.position-bottom{border-left:7px solid transparent;border-right:7px solid transparent;border-bottom:7px solid #fff}.ngx-charts-tooltip-content.type-tooltip{color:#fff;background:rgba(0,0,0,.75);font-size:12px;padding:0 10px;text-align:center;pointer-events:auto}.ngx-charts-tooltip-content.type-tooltip .tooltip-caret.position-left{border-top:7px solid transparent;border-bottom:7px solid transparent;border-left:7px solid rgba(0,0,0,.75)}.ngx-charts-tooltip-content.type-tooltip .tooltip-caret.position-top{border-left:7px solid transparent;border-right:7px solid transparent;border-top:7px solid rgba(0,0,0,.75)}.ngx-charts-tooltip-content.type-tooltip .tooltip-caret.position-right{border-top:7px solid transparent;border-bottom:7px solid transparent;border-right:7px solid rgba(0,0,0,.75)}.ngx-charts-tooltip-content.type-tooltip .tooltip-caret.position-bottom{border-left:7px solid transparent;border-right:7px solid transparent;border-bottom:7px solid rgba(0,0,0,.75)}.ngx-charts-tooltip-content .tooltip-label{display:block;line-height:1em;padding:8px 5px 5px;font-size:1em}.ngx-charts-tooltip-content .tooltip-val{display:block;font-size:1.3em;line-height:1em;padding:0 5px 8px}.ngx-charts-tooltip-content .tooltip-caret{position:absolute;z-index:5001;width:0;height:0}.ngx-charts-tooltip-content.position-right{transform:translate3d(10px,0,0)}.ngx-charts-tooltip-content.position-left{transform:translate3d(-10px,0,0)}.ngx-charts-tooltip-content.position-top{transform:translate3d(0,-10px,0)}.ngx-charts-tooltip-content.position-bottom{transform:translate3d(0,10px,0)}.ngx-charts-tooltip-content.animate{opacity:1;transition:opacity .3s,transform .3s;transform:translate3d(0,0,0);pointer-events:auto}.area-tooltip-container{padding:5px 0;pointer-events:none}.tooltip-item{text-align:left;line-height:1.2em;padding:5px 0}.tooltip-item .tooltip-item-color{display:inline-block;height:12px;width:12px;margin-right:5px;color:#5b646b;border-radius:3px}"],encapsulation:2}),function(t,e,n,r){var i,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(s=(a<3?i(s):a>3?i(e,n,s):i(e,n))||s);a>3&&s&&Object.defineProperty(e,n,s)}([function(t,e,n){return{configurable:!0,enumerable:n.enumerable,get:function(){return Object.defineProperty(this,e,{configurable:!0,enumerable:n.enumerable,value:m0(n.value,100,void 0)}),this[e]}}}],t.prototype,"onWindowResize",null),t})(),x0=(()=>{let t=class extends class{constructor(t){this.injectionService=t,this.defaults={},this.components=new Map}getByType(t=this.type){return this.components.get(t)}create(t){return this.createByType(this.type,t)}createByType(t,e){e=this.assignDefaults(e);const n=this.injectComponent(t,e);return this.register(t,n),n}destroy(t){const e=this.components.get(t.componentType);if(e&&e.length){const n=e.indexOf(t);n>-1&&(e[n].destroy(),e.splice(n,1))}}destroyAll(){this.destroyByType(this.type)}destroyByType(t){const e=this.components.get(t);if(e&&e.length){let t=e.length-1;for(;t>=0;)this.destroy(e[t--])}}injectComponent(t,e){return this.injectionService.appendComponent(t,e)}assignDefaults(t){const e=Object.assign({},this.defaults.inputs),n=Object.assign({},this.defaults.outputs);return t.inputs||t.outputs||(t={inputs:t}),e&&(t.inputs=Object.assign(Object.assign({},e),t.inputs)),n&&(t.outputs=Object.assign(Object.assign({},n),t.outputs)),t}register(t,e){this.components.has(t)||this.components.set(t,[]),this.components.get(t).push(e)}}{constructor(t){super(t),this.type=b0}};return t.\u0275fac=function(e){return new(e||t)(Ae(f0))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),w0=(()=>{let t=class{constructor(){this.showLegend=!1,this.animations=!0,this.legendLabelClick=new cu,this.legendLabelActivate=new cu,this.legendLabelDeactivate=new cu}ngOnChanges(t){this.update()}update(){let t=0;this.showLegend&&(this.legendType=this.getLegendType(),this.legendOptions&&"right"!==this.legendOptions.position||(t="scaleLegend"===this.legendType?1:2)),this.chartWidth=Math.floor(this.view[0]*(12-t)/12),this.legendWidth=this.legendOptions&&"right"!==this.legendOptions.position?this.chartWidth:Math.floor(this.view[0]*t/12)}getLegendType(){return"linear"===this.legendOptions.scaleType?"scaleLegend":"legend"}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["ngx-charts-chart"]],inputs:{showLegend:"showLegend",animations:"animations",legendType:"legendType",view:"view",legendOptions:"legendOptions",data:"data",legendData:"legendData",colors:"colors",activeEntries:"activeEntries"},outputs:{legendLabelClick:"legendLabelClick",legendLabelActivate:"legendLabelActivate",legendLabelDeactivate:"legendLabelDeactivate"},features:[pl([x0]),rl],ngContentSelectors:ZY,decls:5,vars:8,consts:[[1,"ngx-charts-outer"],[1,"ngx-charts"],["class","chart-legend",3,"horizontal","valueRange","colors","height","width",4,"ngIf"],["class","chart-legend",3,"horizontal","data","title","colors","height","width","activeEntries","labelClick","labelActivate","labelDeactivate",4,"ngIf"],[1,"chart-legend",3,"horizontal","valueRange","colors","height","width"],[1,"chart-legend",3,"horizontal","data","title","colors","height","width","activeEntries","labelClick","labelActivate","labelDeactivate"]],template:function(t,e){1&t&&(xo(),ao(0,"div",0),Qn(),ao(1,"svg",1),wo(2),so(),Ys(3,XY,1,5,"ngx-charts-scale-legend",2),Ys(4,KY,1,7,"ngx-charts-legend",3),so()),2&t&&(To("width",e.view[0],"px"),ro("@animationState","active")("@.disabled",!e.animations),Hi(1),Ks("width",e.chartWidth)("height",e.view[1]),Hi(2),ro("ngIf",e.showLegend&&"scaleLegend"===e.legendType),Hi(1),ro("ngIf",e.showLegend&&"legend"===e.legendType))},directives:function(){return[ah,e1,Q0]},encapsulation:2,data:{animation:[jF("animationState",[KF(":enter",[JF({opacity:0}),HF("500ms 100ms",JF({opacity:1}))])])]},changeDetection:0}),t})(),S0=(()=>{let t=class{constructor(t,e){this.element=t,this.zone=e,this.visible=new cu,this.isVisible=!1,this.runCheck()}destroy(){clearTimeout(this.timeout)}onVisibilityChange(){this.zone.run(()=>{this.isVisible=!0,this.visible.emit(!0)})}runCheck(){const t=()=>{if(!this.element)return;const{offsetHeight:e,offsetWidth:n}=this.element.nativeElement;e&&n?(clearTimeout(this.timeout),this.onVisibilityChange()):(clearTimeout(this.timeout),this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t(),100)}))};this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t())})}};return t.\u0275fac=function(e){return new(e||t)(to(yl),to(ec))},t.\u0275dir=tn({type:t,selectors:[["visibility-observer"]],outputs:{visible:"visible"}}),t})(),C0=(()=>{let t=class{constructor(t,e,n){this.chartElement=t,this.zone=e,this.cd=n,this.scheme="cool",this.schemeType="ordinal",this.animations=!0,this.select=new cu}ngAfterViewInit(){this.bindWindowResizeEvent(),this.visibilityObserver=new S0(this.chartElement,this.zone),this.visibilityObserver.visible.subscribe(this.update.bind(this))}ngOnDestroy(){this.unbindEvents(),this.visibilityObserver&&(this.visibilityObserver.visible.unsubscribe(),this.visibilityObserver.destroy())}ngOnChanges(t){this.update()}update(){if(this.results=this.results?this.cloneData(this.results):[],this.view)this.width=this.view[0],this.height=this.view[1];else{const t=this.getContainerDims();t&&(this.width=t.width,this.height=t.height)}this.width||(this.width=600),this.height||(this.height=400),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this.cd&&this.cd.markForCheck()}getContainerDims(){let t,e;const n=this.chartElement.nativeElement;if(null!==n.parentNode){const r=n.parentNode.getBoundingClientRect();t=r.width,e=r.height}return t&&e?{width:t,height:e}:null}formatDates(){for(let t=0;t<this.results.length;t++){const e=this.results[t];if(e.label=e.name,e.label instanceof Date&&(e.label=e.label.toLocaleDateString()),e.series)for(let t=0;t<e.series.length;t++){const n=e.series[t];n.label=n.name,n.label instanceof Date&&(n.label=n.label.toLocaleDateString())}}}unbindEvents(){this.resizeSubscription&&this.resizeSubscription.unsubscribe()}bindWindowResizeEvent(){const t=qP(window,"resize").pipe(gF(200)).subscribe(t=>{this.update(),this.cd&&this.cd.markForCheck()});this.resizeSubscription=t}cloneData(t){const e=[];for(const n of t){const t={name:n.name};if(void 0!==n.value&&(t.value=n.value),void 0!==n.series){t.series=[];for(const e of n.series){const n=Object.assign({},e);t.series.push(n)}}void 0!==n.extra&&(t.extra=JSON.parse(JSON.stringify(n.extra))),e.push(t)}return e}};return t.\u0275fac=function(e){return new(e||t)(to(yl),to(ec),to(bs))},t.\u0275cmp=Je({type:t,selectors:[["base-chart"]],inputs:{scheme:"scheme",schemeType:"schemeType",animations:"animations",results:"results",view:"view",customColors:"customColors"},outputs:{select:"select"},features:[rl],decls:1,vars:0,template:function(t,e){1&t&&oo(0,"div")},encapsulation:2}),t})(),D0=(()=>{let t=class{constructor(t){this.textHeight=25,this.margin=5,this.element=t.nativeElement}ngOnChanges(t){this.update()}update(){switch(this.strokeWidth="0.01",this.textAnchor="middle",this.transform="",this.orient){case"top":case"bottom":this.y=this.offset,this.x=this.width/2;break;case"left":this.y=-(this.offset+this.textHeight+this.margin),this.x=-this.height/2,this.transform="rotate(270)";break;case"right":this.y=this.offset+this.margin,this.x=-this.height/2,this.transform="rotate(270)"}}};return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-axis-label",""]],inputs:{orient:"orient",label:"label",offset:"offset",width:"width",height:"height"},features:[rl],attrs:YY,decls:2,vars:6,template:function(t,e){1&t&&(Qn(),ao(0,"text"),Vo(1),so()),2&t&&(Ks("stroke-width",e.strokeWidth)("x",e.x)("y",e.y)("text-anchor",e.textAnchor)("transform",e.transform),Hi(1),jo(" ",e.label," "))},encapsulation:2,changeDetection:0}),t})();function I0(t,e=16){return"string"!=typeof t?"number"==typeof t?t+"":"":(t=t.trim()).length<=e?t:`${t.slice(0,e)}...`}function k0(t,e){if(t.length>e){const n=[],r=Math.floor(t.length/e);for(let e=0;e<t.length;e++)e%r==0&&n.push(t[e]);t=n}return t}let E0=(()=>{let t=class{constructor(){this.tickArguments=[5],this.tickStroke="#ccc",this.trimTicks=!0,this.maxTickLength=16,this.showGridLines=!1,this.rotateTicks=!0,this.dimensionsChanged=new cu,this.verticalSpacing=20,this.rotateLabels=!1,this.innerTickSize=6,this.outerTickSize=6,this.tickPadding=3,this.textAnchor="middle",this.maxTicksLength=0,this.maxAllowedLength=16,this.height=0}ngOnChanges(t){this.update()}ngAfterViewInit(){setTimeout(()=>this.updateDims())}updateDims(){const t=parseInt(this.ticksElement.nativeElement.getBoundingClientRect().height,10);t!==this.height&&(this.height=t,this.dimensionsChanged.emit({height:t}),setTimeout(()=>this.updateDims()))}update(){const t=this.scale;this.ticks=this.getTicks(),this.tickFormat=this.tickFormatting?this.tickFormatting:t.tickFormat?t.tickFormat.apply(t,this.tickArguments):function(t){return"Date"===t.constructor.name?t.toLocaleDateString():t.toLocaleString()};const e=this.rotateTicks?this.getRotationAngle(this.ticks):null;this.adjustedScale=this.scale.bandwidth?function(t){return this.scale(t)+.5*this.scale.bandwidth()}:this.scale,this.textTransform="",e&&0!==e?(this.textTransform=`rotate(${e})`,this.textAnchor="end",this.verticalSpacing=10):this.textAnchor="middle",setTimeout(()=>this.updateDims())}getRotationAngle(t){let e=0;this.maxTicksLength=0;for(let a=0;a<t.length;a++){const e=this.tickFormat(t[a]).toString();let n=e.length;this.trimTicks&&(n=this.tickTrim(e).length),n>this.maxTicksLength&&(this.maxTicksLength=n)}const n=8*Math.min(this.maxTicksLength,this.maxAllowedLength);let r=n;const i=Math.floor(this.width/t.length);for(;r>i&&e>-90;)e-=30,r=Math.cos(e*(Math.PI/180))*n;return e}getTicks(){let t;const e=this.getMaxTicks(20),n=this.getMaxTicks(100);return this.tickValues?t=this.tickValues:this.scale.ticks?t=this.scale.ticks.apply(this.scale,[n]):(t=this.scale.domain(),t=k0(t,e)),t}getMaxTicks(t){return Math.floor(this.width/t)}tickTransform(t){return"translate("+this.adjustedScale(t)+","+this.verticalSpacing+")"}gridLineTransform(){return`translate(0,${-this.verticalSpacing-5})`}tickTrim(t){return this.trimTicks?I0(t,this.maxTickLength):t}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-x-axis-ticks",""]],viewQuery:function(t,e){var n;1&t&&Su(QY,!0),2&t&&xu(n=Eu())&&(e.ticksElement=n.first)},inputs:{tickArguments:"tickArguments",tickStroke:"tickStroke",trimTicks:"trimTicks",maxTickLength:"maxTickLength",showGridLines:"showGridLines",rotateTicks:"rotateTicks",scale:"scale",orient:"orient",tickValues:"tickValues",tickFormatting:"tickFormatting",gridLineHeight:"gridLineHeight",width:"width"},outputs:{dimensionsChanged:"dimensionsChanged"},features:[rl],attrs:tQ,decls:4,vars:2,consts:[["ticksel",""],["class","tick",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"tick"],["stroke-width","0.01"],[4,"ngIf"],["y2","0",1,"gridline-path","gridline-path-vertical"]],template:function(t,e){1&t&&(Qn(),ao(0,"g",null,0),Ys(2,eQ,5,7,"g",1),so(),Ys(3,rQ,2,2,"g",2)),2&t&&(Hi(2),ro("ngForOf",e.ticks),Hi(1),ro("ngForOf",e.ticks))},directives:[rh,ah],encapsulation:2,changeDetection:0}),t})(),A0=(()=>{let t=class{constructor(){this.rotateTicks=!0,this.showGridLines=!1,this.xOrient="bottom",this.xAxisOffset=0,this.dimensionsChanged=new cu,this.xAxisClassName="x axis",this.labelOffset=0,this.fill="none",this.stroke="stroke",this.tickStroke="#ccc",this.strokeWidth="none",this.padding=5}ngOnChanges(t){this.update()}update(){this.transform=`translate(0,${this.xAxisOffset+this.padding+this.dims.height})`,void 0!==this.xAxisTickCount&&(this.tickArguments=[this.xAxisTickCount])}emitTicksHeight({height:t}){const e=t+25+5;e!==this.labelOffset&&(this.labelOffset=e,setTimeout(()=>{this.dimensionsChanged.emit({height:t})},0))}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-x-axis",""]],viewQuery:function(t,e){var n;1&t&&Su(E0,!0),2&t&&xu(n=Eu())&&(e.ticksComponent=n.first)},inputs:{rotateTicks:"rotateTicks",showGridLines:"showGridLines",xOrient:"xOrient",xAxisOffset:"xAxisOffset",xScale:"xScale",dims:"dims",trimTicks:"trimTicks",maxTickLength:"maxTickLength",tickFormatting:"tickFormatting",showLabel:"showLabel",labelText:"labelText",ticks:"ticks",xAxisTickInterval:"xAxisTickInterval",xAxisTickCount:"xAxisTickCount"},outputs:{dimensionsChanged:"dimensionsChanged"},features:[rl],attrs:iQ,decls:3,vars:4,consts:[["ngx-charts-x-axis-ticks","",3,"trimTicks","rotateTicks","maxTickLength","tickFormatting","tickArguments","tickStroke","scale","orient","showGridLines","gridLineHeight","width","tickValues","dimensionsChanged",4,"ngIf"],["ngx-charts-axis-label","",3,"label","offset","orient","height","width",4,"ngIf"],["ngx-charts-x-axis-ticks","",3,"trimTicks","rotateTicks","maxTickLength","tickFormatting","tickArguments","tickStroke","scale","orient","showGridLines","gridLineHeight","width","tickValues","dimensionsChanged"],["ngx-charts-axis-label","",3,"label","offset","orient","height","width"]],template:function(t,e){1&t&&(Qn(),ao(0,"g"),Ys(1,aQ,1,12,"g",0),Ys(2,sQ,1,5,"g",1),so()),2&t&&(Ks("class",e.xAxisClassName)("transform",e.transform),Hi(1),ro("ngIf",e.xScale),Hi(1),ro("ngIf",e.showLabel))},directives:[ah,E0,D0],encapsulation:2,changeDetection:0}),t})();function T0(t,e,n,r,i,[a,s,o,l]){let u="";return u=`M${[t+i,e]}`,u+=`h${(n=0===(n=Math.floor(n))?1:n)-2*i}`,u+=s?`a${[i,i]} 0 0 1 ${[i,i]}`:`h${i}v${i}`,u+=`v${(r=0===(r=Math.floor(r))?1:r)-2*i}`,u+=l?`a${[i,i]} 0 0 1 ${[-i,i]}`:`v${i}h${-i}`,u+=`h${2*i-n}`,u+=o?`a${[i,i]} 0 0 1 ${[-i,-i]}`:`h${-i}v${-i}`,u+=`v${2*i-r}`,u+=a?`a${[i,i]} 0 0 1 ${[i,-i]}`:`v${-i}h${i}`,u+="z",u}let R0=(()=>{let t=class{constructor(){this.tickArguments=[5],this.tickStroke="#ccc",this.trimTicks=!0,this.maxTickLength=16,this.showGridLines=!1,this.showRefLabels=!1,this.showRefLines=!1,this.dimensionsChanged=new cu,this.innerTickSize=6,this.tickPadding=3,this.verticalSpacing=20,this.textAnchor="middle",this.width=0,this.outerTickSize=6,this.rotateLabels=!1,this.referenceLineLength=0}ngOnChanges(t){this.update()}ngAfterViewInit(){setTimeout(()=>this.updateDims())}updateDims(){const t=parseInt(this.ticksElement.nativeElement.getBoundingClientRect().width,10);t!==this.width&&(this.width=t,this.dimensionsChanged.emit({width:t}),setTimeout(()=>this.updateDims()))}update(){let t;const e="top"===this.orient||"right"===this.orient?-1:1;switch(this.tickSpacing=Math.max(this.innerTickSize,0)+this.tickPadding,t=this.scale,this.ticks=this.getTicks(),this.tickFormat=this.tickFormatting?this.tickFormatting:t.tickFormat?t.tickFormat.apply(t,this.tickArguments):function(t){return"Date"===t.constructor.name?t.toLocaleDateString():t.toLocaleString()},this.adjustedScale=t.bandwidth?function(e){return t(e)+.5*t.bandwidth()}:t,this.showRefLines&&this.referenceLines&&this.setReferencelines(),this.orient){case"top":case"bottom":this.transform=function(t){return"translate("+this.adjustedScale(t)+",0)"},this.textAnchor="middle",this.y2=this.innerTickSize*e,this.y1=this.tickSpacing*e,this.dy=e<0?"0em":".71em";break;case"left":this.transform=function(t){return"translate(0,"+this.adjustedScale(t)+")"},this.textAnchor="end",this.x2=this.innerTickSize*-e,this.x1=this.tickSpacing*-e,this.dy=".32em";break;case"right":this.transform=function(t){return"translate(0,"+this.adjustedScale(t)+")"},this.textAnchor="start",this.x2=this.innerTickSize*-e,this.x1=this.tickSpacing*-e,this.dy=".32em"}setTimeout(()=>this.updateDims())}setReferencelines(){this.refMin=this.adjustedScale(Math.min.apply(null,this.referenceLines.map(t=>t.value))),this.refMax=this.adjustedScale(Math.max.apply(null,this.referenceLines.map(t=>t.value))),this.referenceLineLength=this.referenceLines.length,this.referenceAreaPath=T0(0,this.refMax,this.gridLineWidth,this.refMin-this.refMax,0,[!1,!1,!1,!1])}getTicks(){let t;const e=this.getMaxTicks(20),n=this.getMaxTicks(50);return this.tickValues?t=this.tickValues:this.scale.ticks?t=this.scale.ticks.apply(this.scale,[n]):(t=this.scale.domain(),t=k0(t,e)),t}getMaxTicks(t){return Math.floor(this.height/t)}tickTransform(t){return`translate(${this.adjustedScale(t)},${this.verticalSpacing})`}gridLineTransform(){return"translate(5,0)"}tickTrim(t){return this.trimTicks?I0(t,this.maxTickLength):t}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-y-axis-ticks",""]],viewQuery:function(t,e){var n;1&t&&Su(QY,!0),2&t&&xu(n=Eu())&&(e.ticksElement=n.first)},inputs:{tickArguments:"tickArguments",tickStroke:"tickStroke",trimTicks:"trimTicks",maxTickLength:"maxTickLength",showGridLines:"showGridLines",showRefLabels:"showRefLabels",showRefLines:"showRefLines",scale:"scale",orient:"orient",tickValues:"tickValues",tickFormatting:"tickFormatting",gridLineWidth:"gridLineWidth",height:"height",referenceLines:"referenceLines"},outputs:{dimensionsChanged:"dimensionsChanged"},features:[rl],attrs:oQ,decls:6,vars:4,consts:[["ticksel",""],["class","tick",4,"ngFor","ngForOf"],["class","reference-area",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"tick"],["stroke-width","0.01"],[1,"reference-area"],[4,"ngIf"],["class","gridline-path gridline-path-horizontal","x1","0",4,"ngIf"],["x1","0",1,"gridline-path","gridline-path-horizontal"],["x1","0",1,"refline-path","gridline-path-horizontal"],[1,"refline-label"]],template:function(t,e){1&t&&(Qn(),ao(0,"g",null,0),Ys(2,lQ,5,9,"g",1),so(),Ys(3,uQ,1,2,"path",2),Ys(4,pQ,2,2,"g",3),Ys(5,gQ,2,1,"g",3)),2&t&&(Hi(2),ro("ngForOf",e.ticks),Hi(1),ro("ngIf",e.referenceLineLength>1&&e.refMax&&e.refMin&&e.showRefLines),Hi(1),ro("ngForOf",e.ticks),Hi(1),ro("ngForOf",e.referenceLines))},directives:[rh,ah],encapsulation:2,changeDetection:0}),t})(),M0=(()=>{let t=class{constructor(){this.showGridLines=!1,this.yOrient="left",this.yAxisOffset=0,this.dimensionsChanged=new cu,this.yAxisClassName="y axis",this.labelOffset=15,this.fill="none",this.stroke="#CCC",this.tickStroke="#CCC",this.strokeWidth=1,this.padding=5}ngOnChanges(t){this.update()}update(){this.offset=-(this.yAxisOffset+this.padding),"right"===this.yOrient?(this.labelOffset=65,this.transform=`translate(${this.offset+this.dims.width} , 0)`):(this.offset=this.offset,this.transform=`translate(${this.offset} , 0)`),void 0!==this.yAxisTickCount&&(this.tickArguments=[this.yAxisTickCount])}emitTicksWidth({width:t}){t!==this.labelOffset&&"right"===this.yOrient?(this.labelOffset=t+this.labelOffset,setTimeout(()=>{this.dimensionsChanged.emit({width:t})},0)):t!==this.labelOffset&&(this.labelOffset=t,setTimeout(()=>{this.dimensionsChanged.emit({width:t})},0))}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-y-axis",""]],viewQuery:function(t,e){var n;1&t&&Su(R0,!0),2&t&&xu(n=Eu())&&(e.ticksComponent=n.first)},inputs:{showGridLines:"showGridLines",yOrient:"yOrient",yAxisOffset:"yAxisOffset",yScale:"yScale",dims:"dims",trimTicks:"trimTicks",maxTickLength:"maxTickLength",tickFormatting:"tickFormatting",ticks:"ticks",showLabel:"showLabel",labelText:"labelText",yAxisTickInterval:"yAxisTickInterval",yAxisTickCount:"yAxisTickCount",referenceLines:"referenceLines",showRefLines:"showRefLines",showRefLabels:"showRefLabels"},outputs:{dimensionsChanged:"dimensionsChanged"},features:[rl],attrs:yQ,decls:3,vars:4,consts:[["ngx-charts-y-axis-ticks","",3,"trimTicks","maxTickLength","tickFormatting","tickArguments","tickValues","tickStroke","scale","orient","showGridLines","gridLineWidth","referenceLines","showRefLines","showRefLabels","height","dimensionsChanged",4,"ngIf"],["ngx-charts-axis-label","",3,"label","offset","orient","height","width",4,"ngIf"],["ngx-charts-y-axis-ticks","",3,"trimTicks","maxTickLength","tickFormatting","tickArguments","tickValues","tickStroke","scale","orient","showGridLines","gridLineWidth","referenceLines","showRefLines","showRefLabels","height","dimensionsChanged"],["ngx-charts-axis-label","",3,"label","offset","orient","height","width"]],template:function(t,e){1&t&&(Qn(),ao(0,"g"),Ys(1,vQ,1,14,"g",0),Ys(2,_Q,1,5,"g",1),so()),2&t&&(Ks("class",e.yAxisClassName)("transform",e.transform),Hi(1),ro("ngIf",e.yScale),Hi(1),ro("ngIf",e.showLabel))},directives:[ah,R0,D0],encapsulation:2,changeDetection:0}),t})(),N0=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh]]}),t})();var O0=function(t){return t[t.popover="popover"]="popover",t[t.tooltip="tooltip"]="tooltip",t}({}),P0=function(t){return t[t.left="left"]="left",t[t.center="center"]="center",t[t.right="right"]="right",t}({}),F0=function(t){return t[t.all="all"]="all",t[t.focus="focus"]="focus",t[t.mouseover="mouseover"]="mouseover",t}({});let L0=(()=>{let t=class{constructor(t,e,n){this.tooltipService=t,this.viewContainerRef=e,this.renderer=n,this.tooltipCssClass="",this.tooltipTitle="",this.tooltipAppendToBody=!0,this.tooltipSpacing=10,this.tooltipDisabled=!1,this.tooltipShowCaret=!0,this.tooltipPlacement=g0.top,this.tooltipAlignment=P0.center,this.tooltipType=O0.popover,this.tooltipCloseOnClickOutside=!0,this.tooltipCloseOnMouseLeave=!0,this.tooltipHideTimeout=300,this.tooltipShowTimeout=100,this.tooltipShowEvent=F0.all,this.tooltipImmediateExit=!1,this.show=new cu,this.hide=new cu}get listensForFocus(){return this.tooltipShowEvent===F0.all||this.tooltipShowEvent===F0.focus}get listensForHover(){return this.tooltipShowEvent===F0.all||this.tooltipShowEvent===F0.mouseover}ngOnDestroy(){this.hideTooltip(!0)}onFocus(){this.listensForFocus&&this.showTooltip()}onBlur(){this.listensForFocus&&this.hideTooltip(!0)}onMouseEnter(){this.listensForHover&&this.showTooltip()}onMouseLeave(t){if(this.listensForHover&&this.tooltipCloseOnMouseLeave){if(clearTimeout(this.timeout),this.component&&this.component.instance.element.nativeElement.contains(t))return;this.hideTooltip(this.tooltipImmediateExit)}}onMouseClick(){this.listensForHover&&this.hideTooltip(!0)}showTooltip(t){if(this.component||this.tooltipDisabled)return;const e=t?0:this.tooltipShowTimeout;clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.tooltipService.destroyAll();const t=this.createBoundOptions();this.component=this.tooltipService.create(t),setTimeout(()=>{this.component&&this.addHideListeners(this.component.instance.element.nativeElement)},10),this.show.emit(!0)},e)}addHideListeners(t){this.mouseEnterContentEvent=this.renderer.listen(t,"mouseenter",()=>{clearTimeout(this.timeout)}),this.tooltipCloseOnMouseLeave&&(this.mouseLeaveContentEvent=this.renderer.listen(t,"mouseleave",()=>{this.hideTooltip(this.tooltipImmediateExit)})),this.tooltipCloseOnClickOutside&&(this.documentClickEvent=this.renderer.listen(document,"click",e=>{t.contains(e.target)||this.hideTooltip()}))}hideTooltip(t=!1){if(!this.component)return;const e=()=>{this.mouseLeaveContentEvent&&this.mouseLeaveContentEvent(),this.mouseEnterContentEvent&&this.mouseEnterContentEvent(),this.documentClickEvent&&this.documentClickEvent(),this.hide.emit(!0),this.tooltipService.destroy(this.component),this.component=void 0};clearTimeout(this.timeout),t?e():this.timeout=setTimeout(e,this.tooltipHideTimeout)}createBoundOptions(){return{title:this.tooltipTitle,template:this.tooltipTemplate,host:this.viewContainerRef.element,placement:this.tooltipPlacement,alignment:this.tooltipAlignment,type:this.tooltipType,showCaret:this.tooltipShowCaret,cssClass:this.tooltipCssClass,spacing:this.tooltipSpacing,context:this.tooltipContext}}};return t.\u0275fac=function(e){return new(e||t)(to(x0),to(Vl),to(xl))},t.\u0275dir=tn({type:t,selectors:[["","ngx-tooltip",""]],hostBindings:function(t,e){1&t&&fo("focusin",(function(){return e.onFocus()}))("blur",(function(){return e.onBlur()}))("mouseenter",(function(){return e.onMouseEnter()}))("mouseleave",(function(t){return e.onMouseLeave(t.target)}))("click",(function(){return e.onMouseClick()}))},inputs:{tooltipCssClass:"tooltipCssClass",tooltipTitle:"tooltipTitle",tooltipAppendToBody:"tooltipAppendToBody",tooltipSpacing:"tooltipSpacing",tooltipDisabled:"tooltipDisabled",tooltipShowCaret:"tooltipShowCaret",tooltipPlacement:"tooltipPlacement",tooltipAlignment:"tooltipAlignment",tooltipType:"tooltipType",tooltipCloseOnClickOutside:"tooltipCloseOnClickOutside",tooltipCloseOnMouseLeave:"tooltipCloseOnMouseLeave",tooltipHideTimeout:"tooltipHideTimeout",tooltipShowTimeout:"tooltipShowTimeout",tooltipShowEvent:"tooltipShowEvent",tooltipImmediateExit:"tooltipImmediateExit",tooltipTemplate:"tooltipTemplate",tooltipContext:"tooltipContext"},outputs:{show:"show",hide:"hide"}}),t})(),z0=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[f0,x0],imports:[[fh]]}),t})();function $0(t){return t instanceof Date?t.toLocaleDateString():t.toLocaleString()}function B0(t){return t.toLocaleString().replace(/[&'`"<>]/g,t=>({"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[t]))}const W0={};function q0(){let t=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);return t=`a${t}`,W0[t]?q0():(W0[t]=!0,t)}let V0,U0=(()=>{let t=class{constructor(){this.type="standard",this.tooltipDisabled=!1,this.select=new cu,this.activate=new cu,this.deactivate=new cu,this.barVisible=!1}ngOnInit(){this.gradientId="grad"+q0().toString(),this.gradientFill=`url(#${this.gradientId})`}ngOnChanges(t){this.update()}update(){this.circle=this.getActiveCircle()}getActiveCircle(){const t=this.data.series.findIndex(t=>{const e=t.name;return e&&this.visibleValue&&e.toString()===this.visibleValue.toString()&&void 0!==t.value});if(-1!==t)return this.mapDataPointToCircle(this.data.series[t],t)}mapDataPointToCircle(t,e){const n=this.data.name,r=t.value,i=t.name,a=$0(i);let s;s=this.xScale("time"===this.scaleType?i:"linear"===this.scaleType?Number(i):i);const o=this.yScale("standard"===this.type?r:t.d1),l=this.yScale.range()[0]-o;let u;return u=this.colors.getColor("linear"===this.colors.scaleType?"standard"===this.type?r:t.d1:n),{classNames:[`circle-data-${e}`],value:r,label:i,data:Object.assign({},t,{series:n,value:r,name:i}),cx:s,cy:o,radius:5,height:l,tooltipLabel:a,color:u,opacity:1,seriesName:n,gradientStops:this.getGradientStops(u),min:t.min,max:t.max}}getTooltipText({tooltipLabel:t,value:e,seriesName:n,min:r,max:i}){return`\n      <span class="tooltip-label">${B0(n)} \u2022 ${B0(t)}</span>\n      <span class="tooltip-val">${e.toLocaleString()}${this.getTooltipMinMaxText(r,i)}</span>\n    `}getTooltipMinMaxText(t,e){if(void 0!==t||void 0!==e){let n=" (";return void 0!==t?(void 0===e&&(n+="\u2265"),n+=t.toLocaleString(),void 0!==e&&(n+=" - ")):void 0!==e&&(n+="\u2264"),void 0!==e&&(n+=e.toLocaleString()),n+=")",n}return""}getGradientStops(t){return[{offset:0,color:t,opacity:.2},{offset:100,color:t,opacity:1}]}onClick(t){this.select.emit(t)}isActive(t){return!!this.activeEntries&&void 0!==this.activeEntries.find(e=>t.name===e.name)}activateCircle(){this.barVisible=!0,this.activate.emit({name:this.data.name})}deactivateCircle(){this.barVisible=!1,this.circle.opacity=0,this.deactivate.emit({name:this.data.name})}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-circle-series",""]],inputs:{type:"type",tooltipDisabled:"tooltipDisabled",data:"data",xScale:"xScale",yScale:"yScale",colors:"colors",scaleType:"scaleType",visibleValue:"visibleValue",activeEntries:"activeEntries",tooltipTemplate:"tooltipTemplate"},outputs:{select:"select",activate:"activate",deactivate:"deactivate"},features:[rl],attrs:bQ,decls:1,vars:1,consts:[[4,"ngIf"],["ngx-charts-svg-linear-gradient","","orientation","vertical",3,"name","stops"],["class","tooltip-bar",4,"ngIf"],["ngx-charts-circle","","ngx-tooltip","",1,"circle",3,"cx","cy","r","fill","pointerEvents","data","classNames","tooltipDisabled","tooltipPlacement","tooltipType","tooltipTitle","tooltipTemplate","tooltipContext","select","activate","deactivate"],[1,"tooltip-bar"]],template:function(t,e){1&t&&Ys(0,SQ,5,20,"g",0),2&t&&ro("ngIf",e.circle)},directives:function(){return[ah,H0,j0,L0]},encapsulation:2,data:{animation:[jF("animationState",[KF(":enter",[JF({opacity:0}),HF(250,JF({opacity:1}))])])]},changeDetection:0}),t})(),j0=(()=>{let t=class{constructor(){this.select=new cu,this.activate=new cu,this.deactivate=new cu}onClick(){this.select.emit(this.data)}onMouseEnter(){this.activate.emit(this.data)}onMouseLeave(){this.deactivate.emit(this.data)}ngOnChanges(t){this.classNames=Array.isArray(this.classNames)?this.classNames.join(" "):"",this.classNames+="circle"}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-circle",""]],hostBindings:function(t,e){1&t&&fo("click",(function(){return e.onClick()}))("mouseenter",(function(){return e.onMouseEnter()}))("mouseleave",(function(){return e.onMouseLeave()}))},inputs:{classNames:"classNames",cx:"cx",cy:"cy",r:"r",fill:"fill",stroke:"stroke",data:"data",circleOpacity:"circleOpacity",pointerEvents:"pointerEvents"},outputs:{select:"select",activate:"activate",deactivate:"deactivate"},features:[rl],attrs:CQ,decls:1,vars:8,template:function(t,e){1&t&&(Qn(),oo(0,"circle")),2&t&&Ks("cx",e.cx)("cy",e.cy)("r",e.r)("fill",e.fill)("stroke",e.stroke)("opacity",e.circleOpacity)("class",e.classNames)("pointer-events",e.pointerEvents)},encapsulation:2,changeDetection:0}),t})(),H0=(()=>{let t=class{constructor(){this.orientation="vertical"}ngOnChanges(t){this.x1="0%",this.x2="0%",this.y1="0%",this.y2="0%","horizontal"===this.orientation?this.x2="100%":"vertical"===this.orientation&&(this.y1="100%")}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-svg-linear-gradient",""]],inputs:{orientation:"orientation",name:"name",stops:"stops"},features:[rl],attrs:DQ,decls:2,vars:6,consts:[[3,"id"],[3,"stop-color","stop-opacity",4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(Qn(),ao(0,"linearGradient",0),Ys(1,IQ,1,5,"stop",1),so()),2&t&&(ro("id",e.name),Ks("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2),Hi(1),ro("ngForOf",e.stops))},directives:[rh],encapsulation:2,changeDetection:0}),t})(),G0=(()=>{let t=class{constructor(){this.endOpacity=1,this.cx=0,this.cy=0}get stops(){return this.stopsInput||this.stopsDefault}set stops(t){this.stopsInput=t}ngOnChanges(t){this.r="30%",("color"in t||"startOpacity"in t||"endOpacity"in t)&&(this.stopsDefault=[{offset:0,color:this.color,opacity:this.startOpacity},{offset:100,color:this.color,opacity:this.endOpacity}])}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-svg-radial-gradient",""]],inputs:{endOpacity:"endOpacity",cx:"cx",cy:"cy",stops:"stops",color:"color",name:"name",startOpacity:"startOpacity"},features:[rl],attrs:kQ,decls:2,vars:5,consts:[["gradientUnits","userSpaceOnUse",3,"id"],[3,"stop-color","stop-opacity",4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(Qn(),ao(0,"radialGradient",0),Ys(1,EQ,1,5,"stop",1),so()),2&t&&(ro("id",e.name),Ks("cx",e.cx)("cy",e.cy)("r",e.r),Hi(1),ro("ngForOf",e.stops))},directives:[rh],encapsulation:2,changeDetection:0}),t})(),J0=(()=>{let t=class{constructor(t){this.opacity=1,this.startOpacity=.5,this.endOpacity=1,this.gradient=!1,this.animations=!0,this.select=new cu,this.initialized=!1,this.hasGradient=!1,this.element=t.nativeElement}ngOnChanges(t){this.initialized?this.update():(this.loadAnimation(),this.initialized=!0)}update(){this.gradientId="grad"+q0().toString(),this.gradientFill=`url(#${this.gradientId})`,this.gradient||this.stops?(this.gradientStops=this.getGradient(),this.hasGradient=!0):this.hasGradient=!1,this.updatePathEl()}loadAnimation(){this.areaPath=this.startingPath,setTimeout(this.update.bind(this),100)}updatePathEl(){const t=RH(this.element).select(".area");this.animations?t.transition().duration(750).attr("d",this.path):t.attr("d",this.path)}getGradient(){return this.stops?this.stops:[{offset:0,color:this.fill,opacity:this.startOpacity},{offset:100,color:this.fill,opacity:this.endOpacity}]}};return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-area",""]],inputs:{opacity:"opacity",startOpacity:"startOpacity",endOpacity:"endOpacity",gradient:"gradient",animations:"animations",data:"data",path:"path",startingPath:"startingPath",fill:"fill",activeLabel:"activeLabel",stops:"stops"},outputs:{select:"select"},features:[rl],attrs:AQ,decls:2,vars:5,consts:[[4,"ngIf"],[1,"area"],["ngx-charts-svg-linear-gradient","","orientation","vertical",3,"name","stops"]],template:function(t,e){1&t&&(Ys(0,TQ,2,2,"defs",0),Qn(),oo(1,"path",1)),2&t&&(ro("ngIf",e.gradient),Hi(1),To("opacity",e.opacity),Ks("d",e.areaPath)("fill",e.gradient?e.gradientFill:e.fill))},directives:[ah,H0],encapsulation:2,changeDetection:0}),t})();"undefined"!=typeof window?V0=window:"undefined"!=typeof global&&(V0=global);const X0=V0.MouseEvent;function K0(t,e=!1,n=!0){if("function"==typeof X0)return new X0(t,{bubbles:e,cancelable:n});{const r=document.createEvent("MouseEvent");return r.initEvent(t,e,n),r}}let Z0=(()=>{let t=class{constructor(){this.anchorOpacity=0,this.anchorPos=-1,this.anchorValues=[],this.showPercentage=!1,this.tooltipDisabled=!1,this.hover=new cu}getValues(t){const e=[];for(const n of this.results){const r=n.series.find(e=>e.name.toString()===t.toString());let i=n.name;if(i instanceof Date&&(i=i.toLocaleDateString()),r){const t=r.name;let a,s=r.value;if(this.showPercentage&&(s=(r.d1-r.d0).toFixed(2)+"%"),"linear"===this.colors.scaleType){let t=s;r.d1&&(t=r.d1),a=this.colors.getColor(t)}else a=this.colors.getColor(n.name);const o=Object.assign({},r,{value:s,name:t,series:i,min:r.min,max:r.max,color:a});e.push(o)}}return e}mouseMove(t){const e=t.pageX-t.target.getBoundingClientRect().left,n=this.findClosestPointIndex(e),r=this.xSet[n];if(this.anchorPos=this.xScale(r),this.anchorPos=Math.max(0,this.anchorPos),this.anchorPos=Math.min(this.dims.width,this.anchorPos),this.anchorValues=this.getValues(r),this.anchorPos!==this.lastAnchorPos){const t=K0("mouseleave");this.tooltipAnchor.nativeElement.dispatchEvent(t),this.anchorOpacity=.7,this.hover.emit({value:r}),this.showTooltip(),this.lastAnchorPos=this.anchorPos}}findClosestPointIndex(t){let e=0,n=this.xSet.length-1,r=Number.MAX_VALUE,i=0;for(;e<=n;){const a=(e+n)/2|0,s=this.xScale(this.xSet[a]),o=Math.abs(s-t);if(o<r&&(r=o,i=a),s<t)e=a+1;else{if(!(s>t)){r=0,i=a;break}n=a-1}}return i}showTooltip(){const t=K0("mouseenter");this.tooltipAnchor.nativeElement.dispatchEvent(t)}hideTooltip(){const t=K0("mouseleave");this.tooltipAnchor.nativeElement.dispatchEvent(t),this.anchorOpacity=0,this.lastAnchorPos=-1}getToolTipText(t){let e="";return e+=void 0!==t.series?t.series:"???",e+=": ",void 0!==t.value&&(e+=t.value.toLocaleString()),void 0===t.min&&void 0===t.max||(e+=" (",void 0!==t.min?(void 0===t.max&&(e+="\u2265"),e+=t.min.toLocaleString(),void 0!==t.max&&(e+=" - ")):void 0!==t.max&&(e+="\u2264"),void 0!==t.max&&(e+=t.max.toLocaleString()),e+=")"),e}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-tooltip-area",""]],viewQuery:function(t,e){var n;1&t&&Su(RQ,!0),2&t&&xu(n=Eu())&&(e.tooltipAnchor=n.first)},inputs:{showPercentage:"showPercentage",tooltipDisabled:"tooltipDisabled",dims:"dims",xSet:"xSet",xScale:"xScale",yScale:"yScale",results:"results",colors:"colors",tooltipTemplate:"tooltipTemplate"},outputs:{hover:"hover"},attrs:MQ,decls:6,vars:18,consts:[["y","0",1,"tooltip-area",2,"opacity","0","cursor","auto",3,"mousemove","mouseleave"],["defaultTooltipTemplate",""],["y","0","ngx-tooltip","",1,"tooltip-anchor",3,"tooltipDisabled","tooltipPlacement","tooltipType","tooltipSpacing","tooltipTemplate","tooltipContext","tooltipImmediateExit"],["tooltipAnchor",""],[1,"area-tooltip-container"],["class","tooltip-item",4,"ngFor","ngForOf"],[1,"tooltip-item"],[1,"tooltip-item-color"]],template:function(t,e){if(1&t&&(Qn(),ao(0,"g"),ao(1,"rect",0),fo("mousemove",(function(t){return e.mouseMove(t)}))("mouseleave",(function(){return e.hideTooltip()})),so(),Ys(2,OQ,2,1,"ng-template",null,1,Mu),oo(4,"rect",2,3),so()),2&t){const t=Qs(3);Hi(1),Ks("x",0)("width",e.dims.width)("height",e.dims.height),Hi(3),To("opacity",e.anchorOpacity)("pointer-events","none"),ro("@animationState",0!==e.anchorOpacity?"active":"inactive")("tooltipDisabled",e.tooltipDisabled)("tooltipPlacement","right")("tooltipType","tooltip")("tooltipSpacing",15)("tooltipTemplate",e.tooltipTemplate?e.tooltipTemplate:t)("tooltipContext",e.anchorValues)("tooltipImmediateExit",!0),Ks("x",e.anchorPos)("width",1)("height",e.dims.height)}},directives:[L0,rh],encapsulation:2,data:{animation:[jF("animationState",[KF("inactive => active",[JF({opacity:0}),HF(250,JF({opacity:.7}))]),KF("active => inactive",[JF({opacity:.7}),HF(250,JF({opacity:0}))])])]},changeDetection:0}),t})(),Y0=(()=>{let t=class{constructor(t,e){this.cd=e,this.height=50,this.select=new cu,this.onDomainChange=new cu,this.initialized=!1,this.element=t.nativeElement}ngOnChanges(t){this.update(),this.initialized||(this.addBrush(),this.initialized=!0)}update(){this.dims=this.getDims(),this.height=this.dims.height;const t=this.view[1]-this.height;this.xDomain=this.getXDomain(),this.xScale=this.getXScale(),this.brush&&this.updateBrush(),this.transform=`translate(0 , ${t})`,this.filterId="filter"+q0().toString(),this.filter=`url(#${this.filterId})`,this.cd.markForCheck()}getXDomain(){let t=[];for(const n of this.results)for(const e of n.series)t.includes(e.name)||t.push(e.name);let e=[];return"time"===this.scaleType?e=[Math.min(...t),Math.max(...t)]:"linear"===this.scaleType?(t=t.map(t=>Number(t)),e=[Math.min(...t),Math.max(...t)]):e=t,e}getXScale(){let t;return"time"===this.scaleType?t=SZ().range([0,this.dims.width]).domain(this.xDomain):"linear"===this.scaleType?t=$Z().range([0,this.dims.width]).domain(this.xDomain):"ordinal"===this.scaleType&&(t=jZ().range([0,this.dims.width]).padding(.1).domain(this.xDomain)),t}addBrush(){if(this.brush)return;const t=this.height,e=this.view[0];this.brush=function(t){var e,n=pX,r=dX,i=fX,a=!0,s=zH("start","brush","end"),o=6;function l(e){var n=e.property("__brush",m).selectAll(".overlay").data([hX("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",sX.overlay).merge(n).each((function(){var t=mX(this).extent;RH(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([hX("selection")]).enter().append("rect").attr("class","selection").attr("cursor",sX.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return sX[t.type]})),e.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(i).on("touchstart.brush",d).on("touchmove.brush",p).on("touchend.brush touchcancel.brush",f).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var t=RH(this),e=mX(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-o/2:e[0][0]-o/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-o/2:e[0][1]-o/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+o:o})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+o:o}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(t,e,n){return!n&&t.__brush.emitter||new h(t,e)}function h(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function d(){if((!e||vH.touches)&&r.apply(this,arguments)){var n,i,s,o,l,h,d,p,f,m,g,y=this,v=vH.target.__data__.type,_="selection"===(a&&vH.metaKey?v="overlay":v)?ZJ:a&&vH.altKey?tX:QJ,b=t===aX?null:uX[v],x=t===iX?null:cX[v],w=mX(y),S=w.extent,C=w.selection,D=S[0][0],I=S[0][1],k=S[1][0],E=S[1][1],A=0,T=0,R=b&&x&&a&&vH.shiftKey,M=vH.touches?rX(vH.changedTouches[0].identifier):PG,N=M(y),O=N,P=c(y,arguments,!0).beforestart();"overlay"===v?(C&&(f=!0),w.selection=C=[[n=t===aX?D:N[0],s=t===iX?I:N[1]],[l=t===aX?k:n,d=t===iX?E:s]]):(n=C[0][0],s=C[0][1],l=C[1][0],d=C[1][1]),i=n,o=s,h=l,p=d;var F=RH(y).attr("pointer-events","none"),L=F.selectAll(".overlay").attr("cursor",sX[v]);if(vH.touches)P.moved=$,P.ended=W;else{var z=RH(vH.view).on("mousemove.brush",$,!0).on("mouseup.brush",W,!0);a&&z.on("keydown.brush",q,!0).on("keyup.brush",V,!0),BH(vH.view)}XJ(),lJ(y),u.call(y),P.start()}function $(){var t=M(y);!R||m||g||(Math.abs(t[0]-O[0])>Math.abs(t[1]-O[1])?g=!0:m=!0),O=t,f=!0,KJ(),B()}function B(){var t;switch(A=O[0]-N[0],T=O[1]-N[1],_){case YJ:case ZJ:b&&(A=Math.max(D-n,Math.min(k-l,A)),i=n+A,h=l+A),x&&(T=Math.max(I-s,Math.min(E-d,T)),o=s+T,p=d+T);break;case QJ:b<0?(A=Math.max(D-n,Math.min(k-n,A)),i=n+A,h=l):b>0&&(A=Math.max(D-l,Math.min(k-l,A)),i=n,h=l+A),x<0?(T=Math.max(I-s,Math.min(E-s,T)),o=s+T,p=d):x>0&&(T=Math.max(I-d,Math.min(E-d,T)),o=s,p=d+T);break;case tX:b&&(i=Math.max(D,Math.min(k,n-A*b)),h=Math.max(D,Math.min(k,l+A*b))),x&&(o=Math.max(I,Math.min(E,s-T*x)),p=Math.max(I,Math.min(E,d+T*x)))}h<i&&(b*=-1,t=n,n=l,l=t,t=i,i=h,h=t,v in oX&&L.attr("cursor",sX[v=oX[v]])),p<o&&(x*=-1,t=s,s=d,d=t,t=o,o=p,p=t,v in lX&&L.attr("cursor",sX[v=lX[v]])),w.selection&&(C=w.selection),m&&(i=C[0][0],h=C[1][0]),g&&(o=C[0][1],p=C[1][1]),C[0][0]===i&&C[0][1]===o&&C[1][0]===h&&C[1][1]===p||(w.selection=[[i,o],[h,p]],u.call(y),P.brush())}function W(){if(XJ(),vH.touches){if(vH.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else WH(vH.view,f),z.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);F.attr("pointer-events","all"),L.attr("cursor",sX.overlay),w.selection&&(C=w.selection),gX(C)&&(w.selection=null,u.call(y)),P.end()}function q(){switch(vH.keyCode){case 16:R=b&&x;break;case 18:_===QJ&&(b&&(l=h-A*b,n=i+A*b),x&&(d=p-T*x,s=o+T*x),_=tX,B());break;case 32:_!==QJ&&_!==tX||(b<0?l=h-A:b>0&&(n=i-A),x<0?d=p-T:x>0&&(s=o-T),_=YJ,L.attr("cursor",sX.selection),B());break;default:return}KJ()}function V(){switch(vH.keyCode){case 16:R&&(m=g=R=!1,B());break;case 18:_===tX&&(b<0?l=h:b>0&&(n=i),x<0?d=p:x>0&&(s=o),_=QJ,B());break;case 32:_===YJ&&(vH.altKey?(b&&(l=h-A*b,n=i+A*b),x&&(d=p-T*x,s=o+T*x),_=tX):(b<0?l=h:b>0&&(n=i),x<0?d=p:x>0&&(s=o),_=QJ),L.attr("cursor",sX[v]),B());break;default:return}KJ()}}function p(){c(this,arguments).moved()}function f(){c(this,arguments).ended()}function m(){var e=this.__brush||{selection:null};return e.extent=nX(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n){e.selection?e.on("start.brush",(function(){c(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){c(this,arguments).end()})).tween("brush",(function(){var e=this,r=e.__brush,i=c(e,arguments),a=r.selection,s=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),o=MG(a,s);function l(t){r.selection=1===t&&null===s?null:o(t),u.call(e),i.brush()}return null!==a&&null!==s?l:l(1)})):e.each((function(){var e=this,r=arguments,i=e.__brush,a=t.input("function"==typeof n?n.apply(e,r):n,i.extent),s=c(e,r).beforestart();lJ(e),i.selection=null===a?null:a,u.call(e),s.start().brush().end()}))},l.clear=function(t){l.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){!function(t,e,n,r){var i=vH;t.sourceEvent=vH,vH=t;try{e.apply(n,r)}finally{vH=i}}(new JJ(l,e,t.output(this.state.selection)),s.apply,s,[e,this.that,this.args])}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:GJ(nX(t)),l):n},l.filter=function(t){return arguments.length?(r="function"==typeof t?t:GJ(!!t),l):r},l.touchable=function(t){return arguments.length?(i="function"==typeof t?t:GJ(!!t),l):i},l.handleSize=function(t){return arguments.length?(o=+t,l):o},l.keyModifiers=function(t){return arguments.length?(a=!!t,l):a},l.on=function(){var t=s.on.apply(s,arguments);return t===s?l:t},l}(iX).extent([[0,0],[e,t]]).on("brush end",()=>{const t=(vH.selection||this.xScale.range()).map(this.xScale.invert);this.onDomainChange.emit(t),this.cd.markForCheck()}),RH(this.element).select(".brush").call(this.brush)}updateBrush(){this.brush&&(this.brush.extent([[0,0],[this.view[0],this.height]]),RH(this.element).select(".brush").call(this.brush),RH(this.element).select(".selection").attr("fill",void 0).attr("stroke",void 0).attr("fill-opacity",void 0),this.cd.markForCheck())}getDims(){return{width:this.view[0],height:this.height}}};return t.\u0275fac=function(e){return new(e||t)(to(yl),to(bs))},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-timeline",""]],inputs:{height:"height",view:"view",state:"state",results:"results",scheme:"scheme",customColors:"customColors",legend:"legend",miniChart:"miniChart",autoScale:"autoScale",scaleType:"scaleType"},outputs:{select:"select",onDomainChange:"onDomainChange"},features:[rl],attrs:PQ,ngContentSelectors:ZY,decls:7,vars:4,consts:[[1,"timeline"],["in","SourceGraphic","type","matrix","values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"],[1,"embedded-chart"],["x","0","y","0",1,"brush-background"],[1,"brush"]],template:function(t,e){1&t&&(xo(),Qn(),ao(0,"g",0),ao(1,"filter"),oo(2,"feColorMatrix",1),so(),ao(3,"g",2),wo(4),so(),oo(5,"rect",3),oo(6,"g",4),so()),2&t&&(Ks("transform",e.transform),Hi(1),Ks("id",e.filterId),Hi(4),Ks("width",e.view[0])("height",e.height))},styles:[".timeline .brush-background{fill:rgba(0,0,0,.05)}.timeline .brush .selection{fill:rgba(0,0,0,.1);stroke-width:1px;stroke:#888}.timeline .brush .handle{fill-opacity:0}.timeline .embedded-chart{opacity:.6}"],encapsulation:2,changeDetection:0}),t})(),Q0=(()=>{let t=class{constructor(t){this.cd=t,this.horizontal=!1,this.labelClick=new cu,this.labelActivate=new cu,this.labelDeactivate=new cu,this.legendEntries=[]}ngOnChanges(t){this.update()}update(){this.cd.markForCheck(),this.legendEntries=this.getLegendEntries()}getLegendEntries(){const t=[];for(const e of this.data){const n=$0(e);-1===t.findIndex(t=>t.label===n)&&t.push({label:e,formattedLabel:n,color:this.colors.getColor(e)})}return t}isActive(t){return!!this.activeEntries&&void 0!==this.activeEntries.find(e=>t.label===e.name)}activate(t){this.labelActivate.emit(t)}deactivate(t){this.labelDeactivate.emit(t)}trackBy(t,e){return e.label}};return t.\u0275fac=function(e){return new(e||t)(to(bs))},t.\u0275cmp=Je({type:t,selectors:[["ngx-charts-legend"]],inputs:{horizontal:"horizontal",data:"data",title:"title",colors:"colors",height:"height",width:"width",activeEntries:"activeEntries"},outputs:{labelClick:"labelClick",labelActivate:"labelActivate",labelDeactivate:"labelDeactivate"},features:[rl],decls:5,vars:9,consts:[["class","legend-title",4,"ngIf"],[1,"legend-wrap"],[1,"legend-labels"],["class","legend-label",4,"ngFor","ngForOf","ngForTrackBy"],[1,"legend-title"],[1,"legend-title-text"],[1,"legend-label"],[3,"label","formattedLabel","color","isActive","select","activate","deactivate"]],template:function(t,e){1&t&&(ao(0,"div"),Ys(1,FQ,3,1,"header",0),ao(2,"div",1),ao(3,"ul",2),Ys(4,LQ,2,4,"li",3),so(),so(),so()),2&t&&(To("width",e.width,"px"),Hi(1),ro("ngIf",(null==e.title?null:e.title.length)>0),Hi(2),To("max-height",e.height-45,"px"),Ro("horizontal-legend",e.horizontal),Hi(1),ro("ngForOf",e.legendEntries)("ngForTrackBy",e.trackBy))},directives:function(){return[ah,rh,t1]},styles:[".chart-legend{display:inline-block;padding:0;width:auto!important}.chart-legend .legend-title{white-space:nowrap;overflow:hidden;margin-left:10px;margin-bottom:5px;font-size:14px;font-weight:700}.chart-legend li,.chart-legend ul{padding:0;margin:0;list-style:none}.chart-legend .horizontal-legend li{display:inline-block}.chart-legend .legend-wrap{width:calc(100% - 10px)}.chart-legend .legend-labels{line-height:85%;list-style:none;text-align:left;float:left;width:100%;border-radius:3px;overflow-y:auto;overflow-x:hidden;white-space:nowrap;background:rgba(0,0,0,.05)}.chart-legend .legend-label{cursor:pointer;font-size:90%;margin:8px;color:#afb7c8}.chart-legend .legend-label:hover{color:#000;transition:.2s}.chart-legend .legend-label .active .legend-label-text{color:#000}.chart-legend .legend-label-color{display:inline-block;height:15px;width:15px;margin-right:5px;color:#5b646b;border-radius:3px}.chart-legend .legend-label-text{display:inline-block;vertical-align:top;line-height:15px;font-size:12px;width:calc(100% - 20px);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.chart-legend .legend-title-text{vertical-align:bottom;display:inline-block;line-height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}"],encapsulation:2,changeDetection:0}),t})(),t1=(()=>{let t=class{constructor(){this.isActive=!1,this.select=new cu,this.activate=new cu,this.deactivate=new cu,this.toggle=new cu}get trimmedLabel(){return this.formattedLabel||"(empty)"}onMouseEnter(){this.activate.emit({name:this.label})}onMouseLeave(){this.deactivate.emit({name:this.label})}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["ngx-charts-legend-entry"]],hostBindings:function(t,e){1&t&&fo("mouseenter",(function(){return e.onMouseEnter()}))("mouseleave",(function(){return e.onMouseLeave()}))},inputs:{isActive:"isActive",color:"color",label:"label",formattedLabel:"formattedLabel"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",toggle:"toggle"},decls:4,vars:6,consts:[["tabindex","-1",3,"title","click"],[1,"legend-label-color",3,"click"],[1,"legend-label-text"]],template:function(t,e){1&t&&(ao(0,"span",0),fo("click",(function(){return e.select.emit(e.formattedLabel)})),ao(1,"span",1),fo("click",(function(){return e.toggle.emit(e.formattedLabel)})),so(),ao(2,"span",2),Vo(3),so(),so()),2&t&&(Ro("active",e.isActive),ro("title",e.formattedLabel),Hi(1),To("background-color",e.color),Hi(2),jo(" ",e.trimmedLabel," "))},encapsulation:2,changeDetection:0}),t})(),e1=(()=>{let t=class{constructor(t){this.sanitizer=t,this.horizontal=!1}ngOnChanges(t){const e=this.gradientString(this.colors.range(),this.colors.domain());this.gradient=this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to ${this.horizontal?"right":"bottom"}, ${e})`)}gradientString(t,e){e.push(1);const n=[];return t.reverse().forEach((t,r)=>{n.push(`${t} ${Math.round(100*e[r])}%`)}),n.join(", ")}};return t.\u0275fac=function(e){return new(e||t)(to(qh))},t.\u0275cmp=Je({type:t,selectors:[["ngx-charts-scale-legend"]],inputs:{horizontal:"horizontal",valueRange:"valueRange",colors:"colors",height:"height",width:"width"},features:[rl],decls:8,vars:10,consts:[[1,"scale-legend"],[1,"scale-legend-label"],[1,"scale-legend-wrap"]],template:function(t,e){1&t&&(ao(0,"div",0),ao(1,"div",1),ao(2,"span"),Vo(3),so(),so(),oo(4,"div",2),ao(5,"div",1),ao(6,"span"),Vo(7),so(),so(),so()),2&t&&(To("height",e.horizontal?void 0:e.height,"px")("width",e.width,"px"),Ro("horizontal-legend",e.horizontal),Hi(3),Uo(e.valueRange[1].toLocaleString()),Hi(1),To("background",e.gradient,Ai),Hi(3),Uo(e.valueRange[0].toLocaleString()))},styles:[".chart-legend{display:inline-block;padding:0;width:auto!important}.chart-legend .scale-legend{text-align:center;display:flex;flex-direction:column}.chart-legend .scale-legend-wrap{display:inline-block;flex:1;width:30px;border-radius:5px;margin:0 auto}.chart-legend .scale-legend-label{font-size:12px}.chart-legend .horizontal-legend.scale-legend{flex-direction:row}.chart-legend .horizontal-legend .scale-legend-wrap{width:auto;height:30px;margin:0 16px}"],encapsulation:2,changeDetection:0}),t})(),n1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,N0,z0],fh,N0,z0]}),t})();function r1({width:t,height:e,margins:n,showXAxis:r=!1,showYAxis:i=!1,xAxisHeight:a=0,yAxisWidth:s=0,showXLabel:o=!1,showYLabel:l=!1,showLegend:u=!1,legendType:c="ordinal",legendPosition:h="right",columns:d=12}){let p=n[3],f=t,m=e-n[0]-n[2];if(u&&"right"===h&&(d-="ordinal"===c?2:1),f=f*d/12,f=f-n[1]-n[3],r&&(m-=5,m-=a,o)&&(m-=30),i&&(f-=5,f-=s,p+=s,p+=10,l)){const t=30;f-=t,p+=t}return f=Math.max(0,f),m=Math.max(0,m),{width:Math.floor(f),height:Math.floor(m),xOffset:Math.floor(p)}}let i1=[{name:"vivid",selectable:!0,group:"Ordinal",domain:["#647c8a","#3f51b5","#2196f3","#00b862","#afdf0a","#a7b61a","#f3e562","#ff9800","#ff5722","#ff4514"]},{name:"natural",selectable:!0,group:"Ordinal",domain:["#bf9d76","#e99450","#d89f59","#f2dfa7","#a5d7c6","#7794b1","#afafaf","#707160","#ba9383","#d9d5c3"]},{name:"cool",selectable:!0,group:"Ordinal",domain:["#a8385d","#7aa3e5","#a27ea8","#aae3f5","#adcded","#a95963","#8796c0","#7ed3ed","#50abcc","#ad6886"]},{name:"fire",selectable:!0,group:"Ordinal",domain:["#ff3d00","#bf360c","#ff8f00","#ff6f00","#ff5722","#e65100","#ffca28","#ffab00"]},{name:"solar",selectable:!0,group:"Continuous",domain:["#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffc107","#ffb300","#ffa000","#ff8f00","#ff6f00"]},{name:"air",selectable:!0,group:"Continuous",domain:["#e1f5fe","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#03a9f4","#039be5","#0288d1","#0277bd","#01579b"]},{name:"aqua",selectable:!0,group:"Continuous",domain:["#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00bcd4","#00acc1","#0097a7","#00838f","#006064"]},{name:"flame",selectable:!1,group:"Ordinal",domain:["#A10A28","#D3342D","#EF6D49","#FAAD67","#FDDE90","#DBED91","#A9D770","#6CBA67","#2C9653","#146738"]},{name:"ocean",selectable:!1,group:"Ordinal",domain:["#1D68FB","#33C0FC","#4AFFFE","#AFFFFF","#FFFC63","#FDBD2D","#FC8A25","#FA4F1E","#FA141B","#BA38D1"]},{name:"forest",selectable:!1,group:"Ordinal",domain:["#55C22D","#C1F33D","#3CC099","#AFFFFF","#8CFC9D","#76CFFA","#BA60FB","#EE6490","#C42A1C","#FC9F32"]},{name:"horizon",selectable:!1,group:"Ordinal",domain:["#2597FB","#65EBFD","#99FDD0","#FCEE4B","#FEFCFA","#FDD6E3","#FCB1A8","#EF6F7B","#CB96E8","#EFDEE0"]},{name:"neons",selectable:!1,group:"Ordinal",domain:["#FF3333","#FF33FF","#CC33FF","#0000FF","#33CCFF","#33FFFF","#33FF66","#CCFF33","#FFCC00","#FF6600"]},{name:"picnic",selectable:!1,group:"Ordinal",domain:["#FAC51D","#66BD6D","#FAA026","#29BB9C","#E96B56","#55ACD2","#B7332F","#2C83C9","#9166B8","#92E7E8"]},{name:"night",selectable:!1,group:"Ordinal",domain:["#2B1B5A","#501356","#183356","#28203F","#391B3C","#1E2B3C","#120634","#2D0432","#051932","#453080","#75267D","#2C507D","#4B3880","#752F7D","#35547D"]},{name:"nightLights",selectable:!1,group:"Ordinal",domain:["#4e31a5","#9c25a7","#3065ab","#57468b","#904497","#46648b","#32118d","#a00fb3","#1052a2","#6e51bd","#b63cc3","#6c97cb","#8671c1","#b455be","#7496c3"]}];class a1{constructor(t,e,n,r){"string"==typeof t&&(t=i1.find(e=>e.name===t)),this.colorDomain=t.domain,this.scaleType=e,this.domain=n,this.customColors=r,this.scale=this.generateColorScheme(t,e,this.domain)}generateColorScheme(t,e,n){let r;if("string"==typeof t&&(t=i1.find(e=>e.name===t)),"quantile"===e)r=function t(){var e,n=[],r=[],i=[];function a(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=XZ(n,t/e);return s}function s(t){return isNaN(t=+t)?e:r[uZ(i,t)]}return s.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},s.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(yX),a()},s.range=function(t){return arguments.length?(r=Array.from(t),a()):r.slice()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.quantiles=function(){return i.slice()},s.copy=function(){return t().domain(n).range(r).unknown(e)},_Z.apply(s,arguments)}().range(t.domain).domain(n);else if("ordinal"===e)r=qZ().range(t.domain).domain(n);else if("linear"===e){const e=[...t.domain];1===e.length&&(e.push(e[0]),this.colorDomain=e);const n=BZ(0,1,1/e.length);r=$Z().domain(n).range(e)}return r}getColor(t){if(null==t)throw new Error("Value can not be null");if("linear"===this.scaleType){const e=$Z().domain(this.domain).range([0,1]);return this.scale(e(t))}{if("function"==typeof this.customColors)return this.customColors(t);const e=t.toString();let n;return this.customColors&&this.customColors.length>0&&(n=this.customColors.find(t=>t.name.toLowerCase()===e.toLowerCase())),n?n.value:this.scale(t)}}getLinearGradientStops(t,e){void 0===e&&(e=this.domain[0]);const n=$Z().domain(this.domain).range([0,1]),r=VZ().domain(this.colorDomain).range([0,1]),i=this.getColor(t),a=n(e),s=this.getColor(e),o=n(t);let l=1,u=a;const c=[];for(c.push({color:s,offset:a,originalOffset:a,opacity:1});u<o&&l<this.colorDomain.length;){const t=this.colorDomain[l],e=r(t);if(e<=a)l++;else{if(e.toFixed(4)>=(o-r.bandwidth()).toFixed(4))break;c.push({color:t,offset:e,opacity:1}),u=e,l++}}if(c[c.length-1].offset<100&&c.push({color:i,offset:o,opacity:1}),o===a)c[0].offset=0,c[1].offset=100;else if(100!==c[c.length-1].offset)for(const h of c)h.offset=(h.offset-a)/(o-a)*100;return c}}let s1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})(),o1=(()=>{let t=class{constructor(t){this.roundEdges=!0,this.gradient=!1,this.offset=0,this.isActive=!1,this.animations=!0,this.noBarWhenZero=!0,this.select=new cu,this.activate=new cu,this.deactivate=new cu,this.hasGradient=!1,this.hideBar=!1,this.element=t.nativeElement}ngOnChanges(t){t.roundEdges&&this.loadAnimation(),this.update()}update(){this.gradientId="grad"+q0().toString(),this.gradientFill=`url(#${this.gradientId})`,this.gradient||this.stops?(this.gradientStops=this.getGradient(),this.hasGradient=!0):this.hasGradient=!1,this.updatePathEl(),this.checkToHideBar()}loadAnimation(){this.path=this.getStartingPath(),setTimeout(this.update.bind(this),100)}updatePathEl(){const t=RH(this.element).select(".bar"),e=this.getPath();this.animations?t.transition().duration(500).attr("d",e):t.attr("d",e)}getGradient(){return this.stops?this.stops:[{offset:0,color:this.fill,opacity:this.getStartOpacity()},{offset:100,color:this.fill,opacity:1}]}getStartingPath(){if(!this.animations)return this.getPath();let t,e=this.getRadius();return this.roundEdges?"vertical"===this.orientation?(e=Math.min(this.height,e),t=T0(this.x,this.y+this.height,this.width,1,0,this.edges)):"horizontal"===this.orientation&&(e=Math.min(this.width,e),t=T0(this.x,this.y,1,this.height,0,this.edges)):"vertical"===this.orientation?t=T0(this.x,this.y+this.height,this.width,1,0,this.edges):"horizontal"===this.orientation&&(t=T0(this.x,this.y,1,this.height,0,this.edges)),t}getPath(){let t,e=this.getRadius();return this.roundEdges?"vertical"===this.orientation?(e=Math.min(this.height,e),t=T0(this.x,this.y,this.width,this.height,e,this.edges)):"horizontal"===this.orientation&&(e=Math.min(this.width,e),t=T0(this.x,this.y,this.width,this.height,e,this.edges)):t=T0(this.x,this.y,this.width,this.height,e,this.edges),t}getRadius(){let t=0;return this.roundEdges&&this.height>5&&this.width>5&&(t=Math.floor(Math.min(5,this.height/2,this.width/2))),t}getStartOpacity(){return this.roundEdges?.2:.5}get edges(){let t=[!1,!1,!1,!1];return this.roundEdges&&("vertical"===this.orientation?t=this.data.value>0?[!0,!0,!1,!1]:[!1,!1,!0,!0]:"horizontal"===this.orientation&&(t=this.data.value>0?[!1,!0,!1,!0]:[!0,!1,!0,!1])),t}onMouseEnter(){this.activate.emit(this.data)}onMouseLeave(){this.deactivate.emit(this.data)}checkToHideBar(){this.hideBar=this.noBarWhenZero&&("vertical"===this.orientation&&0===this.height||"horizontal"===this.orientation&&0===this.width)}};return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-bar",""]],hostBindings:function(t,e){1&t&&fo("mouseenter",(function(){return e.onMouseEnter()}))("mouseleave",(function(){return e.onMouseLeave()}))},inputs:{roundEdges:"roundEdges",gradient:"gradient",offset:"offset",isActive:"isActive",animations:"animations",noBarWhenZero:"noBarWhenZero",fill:"fill",data:"data",width:"width",height:"height",x:"x",y:"y",orientation:"orientation",stops:"stops",ariaLabel:"ariaLabel"},outputs:{select:"select",activate:"activate",deactivate:"deactivate"},features:[rl],attrs:WQ,decls:2,vars:8,consts:[[4,"ngIf"],["stroke","none","role","img","tabIndex","-1",1,"bar",3,"click"],["ngx-charts-svg-linear-gradient","",3,"orientation","name","stops"]],template:function(t,e){1&t&&(Ys(0,qQ,2,3,"defs",0),Qn(),ao(1,"path",1),fo("click",(function(){return e.select.emit(e.data)})),so()),2&t&&(ro("ngIf",e.hasGradient),Hi(1),Ro("active",e.isActive)("hidden",e.hideBar),Ks("d",e.path)("aria-label",e.ariaLabel)("fill",e.hasGradient?e.gradientFill:e.fill))},directives:[ah,H0],encapsulation:2,changeDetection:0}),t})(),l1=(()=>{let t=class extends C0{constructor(){super(...arguments),this.legend=!1,this.legendTitle="Legend",this.legendPosition="right",this.tooltipDisabled=!1,this.showGridLines=!0,this.activeEntries=[],this.trimXAxisTicks=!0,this.trimYAxisTicks=!0,this.rotateXAxisTicks=!0,this.maxXAxisTickLength=16,this.maxYAxisTickLength=16,this.barPadding=8,this.roundDomains=!1,this.roundEdges=!0,this.showDataLabel=!1,this.noBarWhenZero=!0,this.activate=new cu,this.deactivate=new cu,this.margin=[10,20,10,20],this.xAxisHeight=0,this.yAxisWidth=0,this.dataLabelMaxHeight={negative:0,positive:0}}update(){super.update(),this.showDataLabel||(this.dataLabelMaxHeight={negative:0,positive:0}),this.margin=[10+this.dataLabelMaxHeight.positive,20,10+this.dataLabelMaxHeight.negative,20],this.dims=r1({width:this.width,height:this.height,margins:this.margin,showXAxis:this.xAxis,showYAxis:this.yAxis,xAxisHeight:this.xAxisHeight,yAxisWidth:this.yAxisWidth,showXLabel:this.showXAxisLabel,showYLabel:this.showYAxisLabel,showLegend:this.legend,legendType:this.schemeType,legendPosition:this.legendPosition}),this.formatDates(),this.showDataLabel&&(this.dims.height-=this.dataLabelMaxHeight.negative),this.xScale=this.getXScale(),this.yScale=this.getYScale(),this.setColors(),this.legendOptions=this.getLegendOptions(),this.transform=`translate(${this.dims.xOffset} , ${this.margin[0]+this.dataLabelMaxHeight.negative})`}getXScale(){this.xDomain=this.getXDomain();const t=this.xDomain.length/(this.dims.width/this.barPadding+1);return VZ().range([0,this.dims.width]).paddingInner(t).domain(this.xDomain)}getYScale(){this.yDomain=this.getYDomain();const t=$Z().range([this.dims.height,0]).domain(this.yDomain);return this.roundDomains?t.nice():t}getXDomain(){return this.results.map(t=>t.label)}getYDomain(){const t=this.results.map(t=>t.value);let e=this.yScaleMin?Math.min(this.yScaleMin,...t):Math.min(0,...t);this.yAxisTicks&&!this.yAxisTicks.some(isNaN)&&(e=Math.min(e,...this.yAxisTicks));let n=this.yScaleMax?Math.max(this.yScaleMax,...t):Math.max(0,...t);return this.yAxisTicks&&!this.yAxisTicks.some(isNaN)&&(n=Math.max(n,...this.yAxisTicks)),[e,n]}onClick(t){this.select.emit(t)}setColors(){let t;t="ordinal"===this.schemeType?this.xDomain:this.yDomain,this.colors=new a1(this.scheme,this.schemeType,t,this.customColors)}getLegendOptions(){const t={scaleType:this.schemeType,colors:void 0,domain:[],title:void 0,position:this.legendPosition};return"ordinal"===t.scaleType?(t.domain=this.xDomain,t.colors=this.colors,t.title=this.legendTitle):(t.domain=this.yDomain,t.colors=this.colors.scale),t}updateYAxisWidth({width:t}){this.yAxisWidth=t,this.update()}updateXAxisHeight({height:t}){this.xAxisHeight=t,this.update()}onDataLabelMaxHeightChanged(t){t.size.negative?this.dataLabelMaxHeight.negative=Math.max(this.dataLabelMaxHeight.negative,t.size.height):this.dataLabelMaxHeight.positive=Math.max(this.dataLabelMaxHeight.positive,t.size.height),t.index===this.results.length-1&&setTimeout(()=>this.update())}onActivate(t,e=!1){t=this.results.find(n=>e?n.label===t.name:n.name===t.name),this.activeEntries.findIndex(e=>e.name===t.name&&e.value===t.value&&e.series===t.series)>-1||(this.activeEntries=[t,...this.activeEntries],this.activate.emit({value:t,entries:this.activeEntries}))}onDeactivate(t,e=!1){t=this.results.find(n=>e?n.label===t.name:n.name===t.name);const n=this.activeEntries.findIndex(e=>e.name===t.name&&e.value===t.value&&e.series===t.series);this.activeEntries.splice(n,1),this.activeEntries=[...this.activeEntries],this.deactivate.emit({value:t,entries:this.activeEntries})}};return t.\u0275fac=function(e){return A1(e||t)},t.\u0275cmp=Je({type:t,selectors:[["ngx-charts-bar-vertical"]],contentQueries:function(t,e,n){var r;1&t&&Du(n,zQ,!0),2&t&&xu(r=Eu())&&(e.tooltipTemplate=r.first)},inputs:{legend:"legend",legendTitle:"legendTitle",legendPosition:"legendPosition",tooltipDisabled:"tooltipDisabled",showGridLines:"showGridLines",activeEntries:"activeEntries",trimXAxisTicks:"trimXAxisTicks",trimYAxisTicks:"trimYAxisTicks",rotateXAxisTicks:"rotateXAxisTicks",maxXAxisTickLength:"maxXAxisTickLength",maxYAxisTickLength:"maxYAxisTickLength",barPadding:"barPadding",roundDomains:"roundDomains",roundEdges:"roundEdges",showDataLabel:"showDataLabel",noBarWhenZero:"noBarWhenZero",xAxis:"xAxis",yAxis:"yAxis",showXAxisLabel:"showXAxisLabel",showYAxisLabel:"showYAxisLabel",xAxisLabel:"xAxisLabel",yAxisLabel:"yAxisLabel",gradient:"gradient",schemeType:"schemeType",xAxisTickFormatting:"xAxisTickFormatting",yAxisTickFormatting:"yAxisTickFormatting",xAxisTicks:"xAxisTicks",yAxisTicks:"yAxisTicks",yScaleMax:"yScaleMax",yScaleMin:"yScaleMin",dataLabelFormatting:"dataLabelFormatting"},outputs:{activate:"activate",deactivate:"deactivate"},features:[Zo],decls:5,vars:25,consts:[[3,"view","showLegend","legendOptions","activeEntries","animations","legendLabelClick","legendLabelActivate","legendLabelDeactivate"],[1,"bar-chart","chart"],["ngx-charts-x-axis","",3,"xScale","dims","showLabel","labelText","trimTicks","rotateTicks","maxTickLength","tickFormatting","ticks","xAxisOffset","dimensionsChanged",4,"ngIf"],["ngx-charts-y-axis","",3,"yScale","dims","showGridLines","showLabel","labelText","trimTicks","maxTickLength","tickFormatting","ticks","dimensionsChanged",4,"ngIf"],["ngx-charts-series-vertical","",3,"xScale","yScale","colors","series","dims","gradient","tooltipDisabled","tooltipTemplate","showDataLabel","dataLabelFormatting","activeEntries","roundEdges","animations","noBarWhenZero","activate","deactivate","select","dataLabelHeightChanged"],["ngx-charts-x-axis","",3,"xScale","dims","showLabel","labelText","trimTicks","rotateTicks","maxTickLength","tickFormatting","ticks","xAxisOffset","dimensionsChanged"],["ngx-charts-y-axis","",3,"yScale","dims","showGridLines","showLabel","labelText","trimTicks","maxTickLength","tickFormatting","ticks","dimensionsChanged"]],template:function(t,e){1&t&&(ao(0,"ngx-charts-chart",0),fo("legendLabelClick",(function(t){return e.onClick(t)}))("legendLabelActivate",(function(t){return e.onActivate(t,!0)}))("legendLabelDeactivate",(function(t){return e.onDeactivate(t,!0)})),Qn(),ao(1,"g",1),Ys(2,VQ,1,10,"g",2),Ys(3,UQ,1,9,"g",3),ao(4,"g",4),fo("activate",(function(t){return e.onActivate(t)}))("deactivate",(function(t){return e.onDeactivate(t)}))("select",(function(t){return e.onClick(t)}))("dataLabelHeightChanged",(function(t){return e.onDataLabelMaxHeightChanged(t)})),so(),so(),so()),2&t&&(ro("view",lu(22,BQ,e.width,e.height))("showLegend",e.legend)("legendOptions",e.legendOptions)("activeEntries",e.activeEntries)("animations",e.animations),Hi(1),Ks("transform",e.transform),Hi(1),ro("ngIf",e.xAxis),Hi(1),ro("ngIf",e.yAxis),Hi(1),ro("xScale",e.xScale)("yScale",e.yScale)("colors",e.colors)("series",e.results)("dims",e.dims)("gradient",e.gradient)("tooltipDisabled",e.tooltipDisabled)("tooltipTemplate",e.tooltipTemplate)("showDataLabel",e.showDataLabel)("dataLabelFormatting",e.dataLabelFormatting)("activeEntries",e.activeEntries)("roundEdges",e.roundEdges)("animations",e.animations)("noBarWhenZero",e.noBarWhenZero))},directives:function(){return[w0,ah,c1,A0,M0]},styles:[".ngx-charts{float:left;overflow:visible}.ngx-charts .arc,.ngx-charts .bar,.ngx-charts .circle{cursor:pointer}.ngx-charts .arc.active,.ngx-charts .arc:hover,.ngx-charts .bar.active,.ngx-charts .bar:hover,.ngx-charts .card.active,.ngx-charts .card:hover,.ngx-charts .cell.active,.ngx-charts .cell:hover{opacity:.8;transition:opacity .1s ease-in-out}.ngx-charts .arc:focus,.ngx-charts .bar:focus,.ngx-charts .card:focus,.ngx-charts .cell:focus{outline:0}.ngx-charts .arc.hidden,.ngx-charts .bar.hidden,.ngx-charts .card.hidden,.ngx-charts .cell.hidden{display:none}.ngx-charts g:focus{outline:0}.ngx-charts .area-series.inactive,.ngx-charts .line-series-range.inactive,.ngx-charts .line-series.inactive,.ngx-charts .polar-series-area.inactive,.ngx-charts .polar-series-path.inactive{transition:opacity .1s ease-in-out;opacity:.2}.ngx-charts .line-highlight{display:none}.ngx-charts .line-highlight.active{display:block}.ngx-charts .area{opacity:.6}.ngx-charts .circle:hover{cursor:pointer}.ngx-charts .label{font-size:12px;font-weight:400}.ngx-charts .tooltip-anchor{fill:#000}.ngx-charts .gridline-path{stroke:#ddd;stroke-width:1;fill:none}.ngx-charts .refline-path{stroke:#a8b2c7;stroke-width:1;stroke-dasharray:5;stroke-dashoffset:5}.ngx-charts .refline-label{font-size:9px}.ngx-charts .reference-area{fill-opacity:.05;fill:#000}.ngx-charts .gridline-path-dotted{stroke:#ddd;stroke-width:1;fill:none;stroke-dasharray:1,20;stroke-dashoffset:3}.ngx-charts .grid-panel rect{fill:none}.ngx-charts .grid-panel.odd rect{fill:rgba(0,0,0,.05)}"],encapsulation:2,changeDetection:0}),t})();var u1=function(t){return t.positive="positive",t.negative="negative",t}({});let c1=(()=>{let t=class{constructor(){this.type="standard",this.tooltipDisabled=!1,this.animations=!0,this.showDataLabel=!1,this.noBarWhenZero=!0,this.select=new cu,this.activate=new cu,this.deactivate=new cu,this.dataLabelHeightChanged=new cu,this.barsForDataLabels=[]}ngOnChanges(t){this.update()}update(){let t;this.updateTooltipSettings(),this.series.length&&(t=this.xScale.bandwidth()),t=Math.round(t);const e=Math.max(this.yScale.domain()[0],0),n={[u1.positive]:0,[u1.negative]:0};let r,i=u1.positive;"normalized"===this.type&&(r=this.series.map(t=>t.value).reduce((t,e)=>t+e,0)),this.bars=this.series.map((a,s)=>{let o=a.value;const l=this.getLabel(a),u=$0(l);i=o>0?u1.positive:u1.negative;const c={value:o,label:l,roundEdges:this.roundEdges,data:a,width:t,formattedLabel:u,height:0,x:0,y:0};if("standard"===this.type)c.height=Math.abs(this.yScale(o)-this.yScale(e)),c.x=this.xScale(l),c.y=this.yScale(o<0?0:o);else if("stacked"===this.type){const t=n[i],e=t+o;n[i]+=o,c.height=this.yScale(t)-this.yScale(e),c.x=0,c.y=this.yScale(e),c.offset0=t,c.offset1=e}else if("normalized"===this.type){let t=n[i],e=t+o;n[i]+=o,r>0?(t=100*t/r,e=100*e/r):(t=0,e=0),c.height=this.yScale(t)-this.yScale(e),c.x=0,c.y=this.yScale(e),c.offset0=t,c.offset1=e,o=(e-t).toFixed(2)+"%"}"ordinal"===this.colors.scaleType?c.color=this.colors.getColor(l):"standard"===this.type?(c.color=this.colors.getColor(o),c.gradientStops=this.colors.getLinearGradientStops(o)):(c.color=this.colors.getColor(c.offset1),c.gradientStops=this.colors.getLinearGradientStops(c.offset1,c.offset0));let h=u;return c.ariaLabel=u+" "+o.toLocaleString(),this.seriesName&&(h=`${this.seriesName} \u2022 ${u}`,c.data.series=this.seriesName,c.ariaLabel=this.seriesName+" "+c.ariaLabel),c.tooltipText=this.tooltipDisabled?void 0:`\n        <span class="tooltip-label">${B0(h)}</span>\n        <span class="tooltip-val">${o.toLocaleString()}</span>\n      `,c}),this.updateDataLabels()}updateDataLabels(){if("stacked"===this.type){this.barsForDataLabels=[];const t={};t.series=this.seriesName;const e=this.series.map(t=>t.value).reduce((t,e)=>e>0?t+e:t,0),n=this.series.map(t=>t.value).reduce((t,e)=>e<0?t+e:t,0);t.total=e+n,t.x=0,t.y=0,t.height=this.yScale(t.total>0?e:n),t.width=this.xScale.bandwidth(),this.barsForDataLabels.push(t)}else this.barsForDataLabels=this.series.map(t=>{const e={};return e.series=this.seriesName?this.seriesName:t.label,e.total=t.value,e.x=this.xScale(t.label),e.y=this.yScale(0),e.height=this.yScale(e.total)-this.yScale(0),e.width=this.xScale.bandwidth(),e})}updateTooltipSettings(){this.tooltipPlacement=this.tooltipDisabled?void 0:"top",this.tooltipType=this.tooltipDisabled?void 0:"tooltip"}isActive(t){return!!this.activeEntries&&void 0!==this.activeEntries.find(e=>t.name===e.name&&t.series===e.series)}onClick(t){this.select.emit(t)}getLabel(t){return t.label?t.label:t.name}trackBy(t,e){return e.label}trackDataLabelBy(t,e){return t+"#"+e.series+"#"+e.total}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-series-vertical",""]],inputs:{type:"type",tooltipDisabled:"tooltipDisabled",animations:"animations",showDataLabel:"showDataLabel",noBarWhenZero:"noBarWhenZero",dims:"dims",series:"series",xScale:"xScale",yScale:"yScale",colors:"colors",gradient:"gradient",activeEntries:"activeEntries",seriesName:"seriesName",tooltipTemplate:"tooltipTemplate",roundEdges:"roundEdges",dataLabelFormatting:"dataLabelFormatting"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",dataLabelHeightChanged:"dataLabelHeightChanged"},features:[rl],attrs:jQ,decls:2,vars:3,consts:[["ngx-charts-bar","","ngx-tooltip","",3,"width","height","x","y","fill","stops","data","orientation","roundEdges","gradient","ariaLabel","isActive","tooltipDisabled","tooltipPlacement","tooltipType","tooltipTitle","tooltipTemplate","tooltipContext","noBarWhenZero","animations","select","activate","deactivate",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["ngx-charts-bar","","ngx-tooltip","",3,"width","height","x","y","fill","stops","data","orientation","roundEdges","gradient","ariaLabel","isActive","tooltipDisabled","tooltipPlacement","tooltipType","tooltipTitle","tooltipTemplate","tooltipContext","noBarWhenZero","animations","select","activate","deactivate"],["ngx-charts-bar-label","",3,"barX","barY","barWidth","barHeight","value","valueFormatting","orientation","dimensionsChanged",4,"ngFor","ngForOf","ngForTrackBy"],["ngx-charts-bar-label","",3,"barX","barY","barWidth","barHeight","value","valueFormatting","orientation","dimensionsChanged"]],template:function(t,e){1&t&&(Ys(0,HQ,1,22,"g",0),Ys(1,JQ,2,2,"g",1)),2&t&&(ro("ngForOf",e.bars)("ngForTrackBy",e.trackBy),Hi(1),ro("ngIf",e.showDataLabel))},directives:function(){return[rh,ah,o1,L0,h1]},encapsulation:2,data:{animation:[jF("animationState",[KF(":leave",[JF({opacity:1}),HF(500,JF({opacity:0}))])])]},changeDetection:0}),t})(),h1=(()=>{let t=class{constructor(t){this.dimensionsChanged=new cu,this.horizontalPadding=2,this.verticalPadding=5,this.element=t.nativeElement}ngOnChanges(t){this.update()}getSize(){return{height:this.element.getBoundingClientRect().height,width:this.element.getBoundingClientRect().width,negative:this.value<0}}ngAfterViewInit(){this.dimensionsChanged.emit(this.getSize())}update(){this.formatedValue=this.valueFormatting?this.valueFormatting(this.value):$0(this.value),"horizontal"===this.orientation?(this.x=this.barX+this.barWidth,this.value<0?(this.x=this.x-this.horizontalPadding,this.textAnchor="end"):(this.x=this.x+this.horizontalPadding,this.textAnchor="start"),this.y=this.barY+this.barHeight/2):(this.x=this.barX+this.barWidth/2,this.y=this.barY+this.barHeight,this.value<0?(this.y=this.y+this.verticalPadding,this.textAnchor="end"):(this.y=this.y-this.verticalPadding,this.textAnchor="start"),this.transform=`rotate(-45, ${this.x} , ${this.y})`)}};return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-bar-label",""]],inputs:{value:"value",valueFormatting:"valueFormatting",barX:"barX",barY:"barY",barWidth:"barWidth",barHeight:"barHeight",orientation:"orientation"},outputs:{dimensionsChanged:"dimensionsChanged"},features:[rl],attrs:XQ,decls:2,vars:5,consts:[["alignment-baseline","middle",1,"textDataLabel"]],template:function(t,e){1&t&&(Qn(),ao(0,"text",0),Vo(1),so()),2&t&&(Ks("text-anchor",e.textAnchor)("transform",e.transform)("x",e.x)("y",e.y),Hi(1),jo(" ",e.formatedValue," "))},styles:[".textDataLabel[_ngcontent-%COMP%]{font-size:11px}"],changeDetection:0}),t})(),d1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})(),p1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})(),f1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})(),m1=(()=>{let t=class{constructor(t){this.element=t,this.fill="none",this.animations=!0,this.select=new cu,this.initialized=!1}ngOnChanges(t){this.initialized?this.updatePathEl():(this.initialized=!0,this.initialPath=this.path)}updatePathEl(){const t=RH(this.element.nativeElement).select(".line");this.animations?t.transition().duration(750).attr("d",this.path):t.attr("d",this.path)}};return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-line",""]],inputs:{fill:"fill",animations:"animations",path:"path",stroke:"stroke",data:"data"},outputs:{select:"select"},features:[rl],attrs:KQ,decls:1,vars:4,consts:[["stroke-width","1.5px",1,"line"]],template:function(t,e){1&t&&(Qn(),oo(0,"path",0)),2&t&&(ro("@animationState","active"),Ks("d",e.initialPath)("fill",e.fill)("stroke",e.stroke))},encapsulation:2,data:{animation:[jF("animationState",[KF(":enter",[JF({strokeDasharray:2e3,strokeDashoffset:2e3}),HF(1e3,JF({strokeDashoffset:0}))])])]},changeDetection:0}),t})(),g1=(()=>{let t=class extends C0{constructor(){super(...arguments),this.legendTitle="Legend",this.legendPosition="right",this.showGridLines=!0,this.curve=ZZ,this.activeEntries=[],this.trimXAxisTicks=!0,this.trimYAxisTicks=!0,this.rotateXAxisTicks=!0,this.maxXAxisTickLength=16,this.maxYAxisTickLength=16,this.roundDomains=!1,this.tooltipDisabled=!1,this.showRefLines=!1,this.showRefLabels=!0,this.activate=new cu,this.deactivate=new cu,this.margin=[10,20,10,20],this.xAxisHeight=0,this.yAxisWidth=0,this.timelineHeight=50,this.timelinePadding=10}update(){super.update(),this.dims=r1({width:this.width,height:this.height,margins:this.margin,showXAxis:this.xAxis,showYAxis:this.yAxis,xAxisHeight:this.xAxisHeight,yAxisWidth:this.yAxisWidth,showXLabel:this.showXAxisLabel,showYLabel:this.showYAxisLabel,showLegend:this.legend,legendType:this.schemeType,legendPosition:this.legendPosition}),this.timeline&&(this.dims.height-=this.timelineHeight+this.margin[2]+this.timelinePadding),this.xDomain=this.getXDomain(),this.filteredDomain&&(this.xDomain=this.filteredDomain),this.yDomain=this.getYDomain(),this.seriesDomain=this.getSeriesDomain(),this.xScale=this.getXScale(this.xDomain,this.dims.width),this.yScale=this.getYScale(this.yDomain,this.dims.height),this.updateTimeline(),this.setColors(),this.legendOptions=this.getLegendOptions(),this.transform=`translate(${this.dims.xOffset} , ${this.margin[0]})`,this.clipPathId="clip"+q0().toString(),this.clipPath=`url(#${this.clipPathId})`}updateTimeline(){this.timeline&&(this.timelineWidth=this.dims.width,this.timelineXDomain=this.getXDomain(),this.timelineXScale=this.getXScale(this.timelineXDomain,this.timelineWidth),this.timelineYScale=this.getYScale(this.yDomain,this.timelineHeight),this.timelineTransform=`translate(${this.dims.xOffset}, ${-this.margin[2]})`)}getXDomain(){let t=function(t){const e=new Set;for(const n of t)for(const t of n.series)e.add(t.name);return Array.from(e)}(this.results);this.scaleType=function(t,e=!0){return e&&t.every(t=>t instanceof Date)?"time":t.every(t=>"number"==typeof t)?"linear":"ordinal"}(t);let e,n,r=[];return"linear"===this.scaleType&&(t=t.map(t=>Number(t))),"time"!==this.scaleType&&"linear"!==this.scaleType||(e=this.xScaleMin?this.xScaleMin:Math.min(...t),n=this.xScaleMax?this.xScaleMax:Math.max(...t)),"time"===this.scaleType?(r=[new Date(e),new Date(n)],this.xSet=[...t].sort((t,e)=>{const n=t.getTime(),r=e.getTime();return n>r?1:r>n?-1:0})):"linear"===this.scaleType?(r=[e,n],this.xSet=[...t].sort((t,e)=>t-e)):(r=t,this.xSet=t),r}getYDomain(){const t=[];for(const n of this.results)for(const e of n.series)t.indexOf(e.value)<0&&t.push(e.value),void 0!==e.min&&(this.hasRange=!0,t.indexOf(e.min)<0&&t.push(e.min)),void 0!==e.max&&(this.hasRange=!0,t.indexOf(e.max)<0&&t.push(e.max));const e=[...t];return this.autoScale||e.push(0),[this.yScaleMin?this.yScaleMin:Math.min(...e),this.yScaleMax?this.yScaleMax:Math.max(...e)]}getSeriesDomain(){return this.results.map(t=>t.name)}getXScale(t,e){let n;return"time"===this.scaleType?n=SZ().range([0,e]).domain(t):"linear"===this.scaleType?(n=$Z().range([0,e]).domain(t),this.roundDomains&&(n=n.nice())):"ordinal"===this.scaleType&&(n=jZ().range([0,e]).padding(.1).domain(t)),n}getYScale(t,e){const n=$Z().range([e,0]).domain(t);return this.roundDomains?n.nice():n}updateDomain(t){this.filteredDomain=t,this.xDomain=this.filteredDomain,this.xScale=this.getXScale(this.xDomain,this.dims.width)}updateHoveredVertical(t){this.hoveredVertical=t.value,this.deactivateAll()}hideCircles(){this.hoveredVertical=null,this.deactivateAll()}onClick(t){this.select.emit(t)}trackBy(t,e){return e.name}setColors(){let t;t="ordinal"===this.schemeType?this.seriesDomain:this.yDomain,this.colors=new a1(this.scheme,this.schemeType,t,this.customColors)}getLegendOptions(){const t={scaleType:this.schemeType,colors:void 0,domain:[],title:void 0,position:this.legendPosition};return"ordinal"===t.scaleType?(t.domain=this.seriesDomain,t.colors=this.colors,t.title=this.legendTitle):(t.domain=this.yDomain,t.colors=this.colors.scale),t}updateYAxisWidth({width:t}){this.yAxisWidth=t,this.update()}updateXAxisHeight({height:t}){this.xAxisHeight=t,this.update()}onActivate(t){this.deactivateAll(),this.activeEntries.findIndex(e=>e.name===t.name&&e.value===t.value)>-1||(this.activeEntries=[t],this.activate.emit({value:t,entries:this.activeEntries}))}onDeactivate(t){const e=this.activeEntries.findIndex(e=>e.name===t.name&&e.value===t.value);this.activeEntries.splice(e,1),this.activeEntries=[...this.activeEntries],this.deactivate.emit({value:t,entries:this.activeEntries})}deactivateAll(){this.activeEntries=[...this.activeEntries];for(const t of this.activeEntries)this.deactivate.emit({value:t,entries:[]});this.activeEntries=[]}};return t.\u0275fac=function(e){return T1(e||t)},t.\u0275cmp=Je({type:t,selectors:[["ngx-charts-line-chart"]],contentQueries:function(t,e,n){var r;1&t&&(Du(n,zQ,!0),Du(n,$Q,!0)),2&t&&(xu(r=Eu())&&(e.tooltipTemplate=r.first),xu(r=Eu())&&(e.seriesTooltipTemplate=r.first))},hostBindings:function(t,e){1&t&&fo("mouseleave",(function(){return e.hideCircles()}))},inputs:{legendTitle:"legendTitle",legendPosition:"legendPosition",showGridLines:"showGridLines",curve:"curve",activeEntries:"activeEntries",trimXAxisTicks:"trimXAxisTicks",trimYAxisTicks:"trimYAxisTicks",rotateXAxisTicks:"rotateXAxisTicks",maxXAxisTickLength:"maxXAxisTickLength",maxYAxisTickLength:"maxYAxisTickLength",roundDomains:"roundDomains",tooltipDisabled:"tooltipDisabled",showRefLines:"showRefLines",showRefLabels:"showRefLabels",legend:"legend",xAxis:"xAxis",yAxis:"yAxis",showXAxisLabel:"showXAxisLabel",showYAxisLabel:"showYAxisLabel",xAxisLabel:"xAxisLabel",yAxisLabel:"yAxisLabel",autoScale:"autoScale",timeline:"timeline",gradient:"gradient",schemeType:"schemeType",rangeFillOpacity:"rangeFillOpacity",xAxisTickFormatting:"xAxisTickFormatting",yAxisTickFormatting:"yAxisTickFormatting",xAxisTicks:"xAxisTicks",yAxisTicks:"yAxisTicks",referenceLines:"referenceLines",xScaleMin:"xScaleMin",xScaleMax:"xScaleMax",yScaleMin:"yScaleMin",yScaleMax:"yScaleMax"},outputs:{activate:"activate",deactivate:"deactivate"},features:[Zo],decls:11,vars:20,consts:[[3,"view","showLegend","legendOptions","activeEntries","animations","legendLabelClick","legendLabelActivate","legendLabelDeactivate"],[1,"line-chart","chart"],["ngx-charts-x-axis","",3,"xScale","dims","showGridLines","showLabel","labelText","trimTicks","rotateTicks","maxTickLength","tickFormatting","ticks","dimensionsChanged",4,"ngIf"],["ngx-charts-y-axis","",3,"yScale","dims","showGridLines","showLabel","labelText","trimTicks","maxTickLength","tickFormatting","ticks","referenceLines","showRefLines","showRefLabels","dimensionsChanged",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"mouseleave",4,"ngIf"],["ngx-charts-timeline","",3,"results","view","height","scheme","customColors","scaleType","legend","onDomainChange",4,"ngIf"],["ngx-charts-x-axis","",3,"xScale","dims","showGridLines","showLabel","labelText","trimTicks","rotateTicks","maxTickLength","tickFormatting","ticks","dimensionsChanged"],["ngx-charts-y-axis","",3,"yScale","dims","showGridLines","showLabel","labelText","trimTicks","maxTickLength","tickFormatting","ticks","referenceLines","showRefLines","showRefLabels","dimensionsChanged"],["ngx-charts-line-series","",3,"xScale","yScale","colors","data","activeEntries","scaleType","curve","rangeFillOpacity","hasRange","animations"],[3,"mouseleave"],["ngx-charts-tooltip-area","",3,"dims","xSet","xScale","yScale","results","colors","tooltipDisabled","tooltipTemplate","hover"],[4,"ngFor","ngForOf"],["ngx-charts-circle-series","",3,"xScale","yScale","colors","data","scaleType","visibleValue","activeEntries","tooltipDisabled","tooltipTemplate","select","activate","deactivate"],["ngx-charts-timeline","",3,"results","view","height","scheme","customColors","scaleType","legend","onDomainChange"],["ngx-charts-line-series","",3,"xScale","yScale","colors","data","scaleType","curve","hasRange","animations"]],template:function(t,e){1&t&&(ao(0,"ngx-charts-chart",0),fo("legendLabelClick",(function(t){return e.onClick(t)}))("legendLabelActivate",(function(t){return e.onActivate(t)}))("legendLabelDeactivate",(function(t){return e.onDeactivate(t)})),Qn(),ao(1,"defs"),ao(2,"clipPath"),oo(3,"rect"),so(),so(),ao(4,"g",1),Ys(5,ZQ,1,10,"g",2),Ys(6,YQ,1,12,"g",3),ao(7,"g"),Ys(8,QQ,2,11,"g",4),Ys(9,e0,3,9,"g",5),so(),so(),Ys(10,r0,2,13,"g",6),so()),2&t&&(ro("view",lu(17,BQ,e.width,e.height))("showLegend",e.legend)("legendOptions",e.legendOptions)("activeEntries",e.activeEntries)("animations",e.animations),Hi(2),Ks("id",e.clipPathId),Hi(1),Ks("width",e.dims.width+10)("height",e.dims.height+10)("transform","translate(-5, -5)"),Hi(1),Ks("transform",e.transform),Hi(1),ro("ngIf",e.xAxis),Hi(1),ro("ngIf",e.yAxis),Hi(1),Ks("clip-path",e.clipPath),Hi(1),ro("ngForOf",e.results)("ngForTrackBy",e.trackBy),Hi(1),ro("ngIf",!e.tooltipDisabled),Hi(1),ro("ngIf",e.timeline&&"ordinal"!=e.scaleType))},directives:function(){return[w0,ah,rh,A0,M0,y1,Z0,U0,Y0]},styles:[".ngx-charts{float:left;overflow:visible}.ngx-charts .arc,.ngx-charts .bar,.ngx-charts .circle{cursor:pointer}.ngx-charts .arc.active,.ngx-charts .arc:hover,.ngx-charts .bar.active,.ngx-charts .bar:hover,.ngx-charts .card.active,.ngx-charts .card:hover,.ngx-charts .cell.active,.ngx-charts .cell:hover{opacity:.8;transition:opacity .1s ease-in-out}.ngx-charts .arc:focus,.ngx-charts .bar:focus,.ngx-charts .card:focus,.ngx-charts .cell:focus{outline:0}.ngx-charts .arc.hidden,.ngx-charts .bar.hidden,.ngx-charts .card.hidden,.ngx-charts .cell.hidden{display:none}.ngx-charts g:focus{outline:0}.ngx-charts .area-series.inactive,.ngx-charts .line-series-range.inactive,.ngx-charts .line-series.inactive,.ngx-charts .polar-series-area.inactive,.ngx-charts .polar-series-path.inactive{transition:opacity .1s ease-in-out;opacity:.2}.ngx-charts .line-highlight{display:none}.ngx-charts .line-highlight.active{display:block}.ngx-charts .area{opacity:.6}.ngx-charts .circle:hover{cursor:pointer}.ngx-charts .label{font-size:12px;font-weight:400}.ngx-charts .tooltip-anchor{fill:#000}.ngx-charts .gridline-path{stroke:#ddd;stroke-width:1;fill:none}.ngx-charts .refline-path{stroke:#a8b2c7;stroke-width:1;stroke-dasharray:5;stroke-dashoffset:5}.ngx-charts .refline-label{font-size:9px}.ngx-charts .reference-area{fill-opacity:.05;fill:#000}.ngx-charts .gridline-path-dotted{stroke:#ddd;stroke-width:1;fill:none;stroke-dasharray:1,20;stroke-dashoffset:3}.ngx-charts .grid-panel rect{fill:none}.ngx-charts .grid-panel.odd rect{fill:rgba(0,0,0,.05)}"],encapsulation:2,data:{animation:[jF("animationState",[KF(":leave",[JF({opacity:1}),HF(500,JF({opacity:0}))])])]},changeDetection:0}),t})(),y1=(()=>{let t=class{constructor(){this.animations=!0}ngOnChanges(t){this.update()}update(){this.updateGradients();const t=this.sortData(this.data.series),e=this.getLineGenerator();this.path=e(t)||"";const n=this.getAreaGenerator();if(this.areaPath=n(t)||"",this.hasRange){const e=this.getRangeGenerator();this.outerPath=e(t)||""}if(this.hasGradient){this.stroke=this.gradientUrl;const t=this.data.series.map(t=>t.value),e=Math.max(...t);e===Math.min(...t)&&(this.stroke=this.colors.getColor(e))}else this.stroke=this.colors.getColor(this.data.name)}getLineGenerator(){return oY().x(t=>{const e=t.name;let n;return n=this.xScale("time"===this.scaleType?e:"linear"===this.scaleType?Number(e):e),n}).y(t=>this.yScale(t.value)).curve(this.curve)}getRangeGenerator(){return lY().x(t=>{const e=t.name;let n;return n=this.xScale("time"===this.scaleType?e:"linear"===this.scaleType?Number(e):e),n}).y0(t=>this.yScale("number"==typeof t.min?t.min:t.value)).y1(t=>this.yScale("number"==typeof t.max?t.max:t.value)).curve(this.curve)}getAreaGenerator(){return lY().x(t=>this.xScale(t.name)).y0(()=>this.yScale.range()[0]).y1(t=>this.yScale(t.value)).curve(this.curve)}sortData(t){return"linear"===this.scaleType?function(t,e,n="asc"){return t.sort((t,r)=>"asc"===n?t[e]-r[e]:r[e]-t[e])}(t,"name"):"time"===this.scaleType?function(t,e,n="asc"){return t.sort((t,r)=>{const i=t[e].getTime(),a=r[e].getTime();return"asc"===n?i>a?1:a>i?-1:0:i>a?-1:a>i?1:0})}(t,"name"):function(t,e,n="asc",r){return t.sort((t,i)=>{const a=i[e],s=r.indexOf(t[e]),o=r.indexOf(a);return"asc"===n?s-o:o-s})}(t,"name","asc",this.xScale.domain())}updateGradients(){if("linear"===this.colors.scaleType){this.hasGradient=!0,this.gradientId="grad"+q0().toString(),this.gradientUrl=`url(#${this.gradientId})`;const t=this.data.series.map(t=>t.value),e=Math.max(...t),n=Math.min(...t);this.gradientStops=this.colors.getLinearGradientStops(e,n),this.areaGradientStops=this.colors.getLinearGradientStops(e)}else this.hasGradient=!1,this.gradientStops=void 0,this.areaGradientStops=void 0}isActive(t){return!!this.activeEntries&&void 0!==this.activeEntries.find(e=>t.name===e.name)}isInactive(t){return!(!this.activeEntries||0===this.activeEntries.length)&&void 0===this.activeEntries.find(e=>t.name===e.name)}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-line-series",""]],inputs:{animations:"animations",data:"data",xScale:"xScale",yScale:"yScale",colors:"colors",scaleType:"scaleType",curve:"curve",activeEntries:"activeEntries",rangeFillOpacity:"rangeFillOpacity",hasRange:"hasRange"},features:[rl],attrs:i0,decls:6,vars:22,consts:[["ngx-charts-svg-linear-gradient","","orientation","vertical",3,"name","stops",4,"ngIf"],["ngx-charts-area","",1,"line-highlight",3,"data","path","fill","opacity","startOpacity","gradient","stops","animations"],["ngx-charts-line","",1,"line-series",3,"data","path","stroke","animations"],["ngx-charts-area","","class","line-series-range",3,"data","path","fill","active","inactive","opacity","animations",4,"ngIf"],["ngx-charts-svg-linear-gradient","","orientation","vertical",3,"name","stops"],["ngx-charts-area","",1,"line-series-range",3,"data","path","fill","opacity","animations"]],template:function(t,e){1&t&&(Qn(),ao(0,"g"),ao(1,"defs"),Ys(2,a0,1,2,"g",0),so(),oo(3,"g",1),oo(4,"g",2),Ys(5,s0,1,9,"g",3),so()),2&t&&(Hi(2),ro("ngIf",e.hasGradient),Hi(1),Ro("active",e.isActive(e.data))("inactive",e.isInactive(e.data)),ro("data",e.data)("path",e.areaPath)("fill",e.hasGradient?e.gradientUrl:e.colors.getColor(e.data.name))("opacity",.25)("startOpacity",0)("gradient",!0)("stops",e.areaGradientStops)("animations",e.animations),Hi(1),Ro("active",e.isActive(e.data))("inactive",e.isInactive(e.data)),ro("data",e.data)("path",e.path)("stroke",e.stroke)("animations",e.animations),Hi(1),ro("ngIf",e.hasRange))},directives:[ah,J0,m1,H0],encapsulation:2,changeDetection:0}),t})(),v1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})();Math;let _1=(()=>{let t=class{constructor(){this.animations=!0,this.labelTrim=!0,this.labelTrimSize=10,this.isIE=/(edge|msie|trident)/i.test(navigator.userAgent),this.trimLabel=I0}ngOnChanges(t){this.update()}update(){let t=this.radius;this.explodeSlices&&(t=this.radius*this.value/this.max);const e=NY().innerRadius(t).outerRadius(t).centroid(this.data);let n=this.data.pos[1]/e[1];0!==this.data.pos[1]&&0!==e[1]||(n=1),this.line=`M${e}L${[n*e[0],n*e[1]]}L${this.data.pos}`}get textX(){return this.data.pos[0]}get textY(){return this.data.pos[1]}get styleTransform(){return this.isIE?null:`translate3d(${this.textX}px,${this.textY}px, 0)`}get attrTransform(){return this.isIE?`translate(${this.textX},${this.textY})`:null}get textTransition(){return this.isIE||!this.animations?null:"transform 0.75s"}textAnchor(){return this.midAngle(this.data)<Math.PI?"start":"end"}midAngle(t){return t.startAngle+(t.endAngle-t.startAngle)/2}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-pie-label",""]],inputs:{animations:"animations",labelTrim:"labelTrim",labelTrimSize:"labelTrimSize",data:"data",radius:"radius",label:"label",color:"color",max:"max",value:"value",explodeSlices:"explodeSlices"},features:[rl],attrs:o0,decls:6,vars:17,consts:[["dy",".35em",1,"pie-label"],["fill","none",1,"pie-label-line","line"]],template:function(t,e){1&t&&(ao(0,"title"),Vo(1),so(),Qn(),ao(2,"g"),ao(3,"text",0),Vo(4),so(),so(),oo(5,"path",1)),2&t&&(Hi(1),Uo(e.label),Hi(1),To("transform",e.styleTransform)("transition",e.textTransition),Ks("transform",e.attrTransform),Hi(1),To("text-anchor",e.textAnchor())("shape-rendering","crispEdges"),Ro("animation",e.animations),Hi(1),jo(" ",e.labelTrim?e.trimLabel(e.label,e.labelTrimSize):e.label," "),Hi(1),Ro("animation",e.animations),Ks("d",e.line)("stroke",e.color))},encapsulation:2,changeDetection:0}),t})(),b1=(()=>{let t=class{constructor(t){this.startAngle=0,this.endAngle=2*Math.PI,this.cornerRadius=0,this.explodeSlices=!1,this.gradient=!1,this.animate=!0,this.pointerEvents=!0,this.isActive=!1,this.select=new cu,this.activate=new cu,this.deactivate=new cu,this.dblclick=new cu,this.initialized=!1,this.element=t.nativeElement}ngOnChanges(t){this.update()}getGradient(){return this.gradient?this.gradientFill:this.fill}getPointerEvents(){return this.pointerEvents?"auto":"none"}update(){const t=this.calculateArc();this.startOpacity=.5,this.radialGradientId="linearGrad"+q0().toString(),this.gradientFill=`url(#${this.radialGradientId})`,this.animate?this.initialized?this.updateAnimation():(this.loadAnimation(),this.initialized=!0):this.path=t.startAngle(this.startAngle).endAngle(this.endAngle)()}calculateArc(){let t=this.outerRadius;return this.explodeSlices&&0===this.innerRadius&&(t=this.outerRadius*this.value/this.max),NY().innerRadius(this.innerRadius).outerRadius(t).cornerRadius(this.cornerRadius)}loadAnimation(){const t=RH(this.element).selectAll(".arc").data([{startAngle:this.startAngle,endAngle:this.endAngle}]),e=this.calculateArc();t.transition().attrTween("d",(function(t){this._current=this._current||t;const n=Object.assign({},t);n.endAngle=n.startAngle;const r=MG(n,n);return this._current=r(0),function(t){return e(r(t))}})).transition().duration(750).attrTween("d",(function(t){this._current=this._current||t;const n=MG(this._current,t);return this._current=n(0),function(t){return e(n(t))}}))}updateAnimation(){const t=RH(this.element).selectAll(".arc").data([{startAngle:this.startAngle,endAngle:this.endAngle}]),e=this.calculateArc();t.transition().duration(750).attrTween("d",(function(t){this._current=this._current||t;const n=MG(this._current,t);return this._current=n(0),function(t){return e(n(t))}}))}onClick(){clearTimeout(this._timeout),this._timeout=setTimeout(()=>this.select.emit(this.data),200)}onDblClick(t){t.preventDefault(),t.stopPropagation(),clearTimeout(this._timeout),this.dblclick.emit({data:this.data,nativeEvent:t})}};return t.\u0275fac=function(e){return new(e||t)(to(yl))},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-pie-arc",""]],inputs:{startAngle:"startAngle",endAngle:"endAngle",cornerRadius:"cornerRadius",explodeSlices:"explodeSlices",gradient:"gradient",animate:"animate",pointerEvents:"pointerEvents",isActive:"isActive",fill:"fill",innerRadius:"innerRadius",outerRadius:"outerRadius",value:"value",max:"max",data:"data"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",dblclick:"dblclick"},features:[rl],attrs:l0,decls:3,vars:7,consts:[[1,"arc-group"],[4,"ngIf"],[1,"arc",3,"click","dblclick","mouseenter","mouseleave"],["ngx-charts-svg-radial-gradient","","orientation","vertical",3,"color","name","startOpacity"]],template:function(t,e){1&t&&(Qn(),ao(0,"g",0),Ys(1,u0,2,3,"defs",1),ao(2,"path",2),fo("click",(function(){return e.onClick()}))("dblclick",(function(t){return e.onDblClick(t)}))("mouseenter",(function(){return e.activate.emit(e.data)}))("mouseleave",(function(){return e.deactivate.emit(e.data)})),so(),so()),2&t&&(Hi(1),ro("ngIf",e.gradient),Hi(1),To("pointer-events",e.getPointerEvents()),Ro("active",e.isActive),Ks("d",e.path)("fill",e.getGradient()))},directives:[ah,G0],encapsulation:2,changeDetection:0}),t})(),x1=(()=>{let t=class extends C0{constructor(){super(...arguments),this.labels=!1,this.legend=!1,this.legendTitle="Legend",this.legendPosition="right",this.explodeSlices=!1,this.doughnut=!1,this.arcWidth=.25,this.activeEntries=[],this.tooltipDisabled=!1,this.trimLabels=!0,this.maxLabelLength=10,this.dblclick=new cu,this.select=new cu,this.activate=new cu,this.deactivate=new cu}update(){super.update(),this.labels&&this.hasNoOptionalMarginsSet()?this.margins=[30,80,30,80]:!this.labels&&this.hasNoOptionalMarginsSet()&&(this.margins=[20,20,20,20]),this.dims=r1({width:this.width,height:this.height,margins:this.margins,showLegend:this.legend,legendPosition:this.legendPosition}),this.formatDates(),this.translation=`translate(${this.margins[3]+this.dims.width/2}, ${this.margins[0]+this.dims.height/2})`,this.outerRadius=Math.min(this.dims.width,this.dims.height),this.outerRadius/=this.labels?3:2,this.innerRadius=0,this.doughnut&&(this.innerRadius=this.outerRadius*(1-this.arcWidth)),this.domain=this.getDomain(),this.data=this.results.sort((t,e)=>this.domain.indexOf(t.name)-this.domain.indexOf(e.name)),this.setColors(),this.legendOptions=this.getLegendOptions()}getDomain(){return this.results.map(t=>t.label)}onClick(t){this.select.emit(t)}setColors(){this.colors=new a1(this.scheme,"ordinal",this.domain,this.customColors)}getLegendOptions(){return{scaleType:"ordinal",domain:this.domain,colors:this.colors,title:this.legendTitle,position:this.legendPosition}}onActivate(t,e=!1){t=this.results.find(n=>e?n.label===t.name:n.name===t.name),this.activeEntries.findIndex(e=>e.name===t.name&&e.value===t.value&&e.series===t.series)>-1||(this.activeEntries=[t,...this.activeEntries],this.activate.emit({value:t,entries:this.activeEntries}))}onDeactivate(t,e=!1){t=this.results.find(n=>e?n.label===t.name:n.name===t.name);const n=this.activeEntries.findIndex(e=>e.name===t.name&&e.value===t.value&&e.series===t.series);this.activeEntries.splice(n,1),this.activeEntries=[...this.activeEntries],this.deactivate.emit({value:t,entries:this.activeEntries})}hasNoOptionalMarginsSet(){return!this.margins||this.margins.length<=0}};return t.\u0275fac=function(e){return R1(e||t)},t.\u0275cmp=Je({type:t,selectors:[["ngx-charts-pie-chart"]],contentQueries:function(t,e,n){var r;1&t&&Du(n,zQ,!0),2&t&&xu(r=Eu())&&(e.tooltipTemplate=r.first)},inputs:{labels:"labels",legend:"legend",legendTitle:"legendTitle",legendPosition:"legendPosition",explodeSlices:"explodeSlices",doughnut:"doughnut",arcWidth:"arcWidth",activeEntries:"activeEntries",tooltipDisabled:"tooltipDisabled",trimLabels:"trimLabels",maxLabelLength:"maxLabelLength",margins:"margins",gradient:"gradient",labelFormatting:"labelFormatting",tooltipText:"tooltipText"},outputs:{dblclick:"dblclick",select:"select",activate:"activate",deactivate:"deactivate"},features:[Zo],decls:3,vars:24,consts:[[3,"view","showLegend","legendOptions","activeEntries","animations","legendLabelActivate","legendLabelDeactivate","legendLabelClick"],[1,"pie-chart","chart"],["ngx-charts-pie-series","",3,"colors","series","showLabels","labelFormatting","trimLabels","maxLabelLength","activeEntries","innerRadius","outerRadius","explodeSlices","gradient","animations","tooltipDisabled","tooltipTemplate","tooltipText","dblclick","select","activate","deactivate"]],template:function(t,e){1&t&&(ao(0,"ngx-charts-chart",0),fo("legendLabelActivate",(function(t){return e.onActivate(t,!0)}))("legendLabelDeactivate",(function(t){return e.onDeactivate(t,!0)}))("legendLabelClick",(function(t){return e.onClick(t)})),Qn(),ao(1,"g",1),ao(2,"g",2),fo("dblclick",(function(t){return e.dblclick.emit(t)}))("select",(function(t){return e.onClick(t)}))("activate",(function(t){return e.onActivate(t)}))("deactivate",(function(t){return e.onDeactivate(t)})),so(),so(),so()),2&t&&(ro("view",lu(21,BQ,e.width,e.height))("showLegend",e.legend)("legendOptions",e.legendOptions)("activeEntries",e.activeEntries)("animations",e.animations),Hi(1),Ks("transform",e.translation),Hi(1),ro("colors",e.colors)("series",e.data)("showLabels",e.labels)("labelFormatting",e.labelFormatting)("trimLabels",e.trimLabels)("maxLabelLength",e.maxLabelLength)("activeEntries",e.activeEntries)("innerRadius",e.innerRadius)("outerRadius",e.outerRadius)("explodeSlices",e.explodeSlices)("gradient",e.gradient)("animations",e.animations)("tooltipDisabled",e.tooltipDisabled)("tooltipTemplate",e.tooltipTemplate)("tooltipText",e.tooltipText))},directives:function(){return[w0,w1]},styles:[".ngx-charts{float:left;overflow:visible}.ngx-charts .arc,.ngx-charts .bar,.ngx-charts .circle{cursor:pointer}.ngx-charts .arc.active,.ngx-charts .arc:hover,.ngx-charts .bar.active,.ngx-charts .bar:hover,.ngx-charts .card.active,.ngx-charts .card:hover,.ngx-charts .cell.active,.ngx-charts .cell:hover{opacity:.8;transition:opacity .1s ease-in-out}.ngx-charts .arc:focus,.ngx-charts .bar:focus,.ngx-charts .card:focus,.ngx-charts .cell:focus{outline:0}.ngx-charts .arc.hidden,.ngx-charts .bar.hidden,.ngx-charts .card.hidden,.ngx-charts .cell.hidden{display:none}.ngx-charts g:focus{outline:0}.ngx-charts .area-series.inactive,.ngx-charts .line-series-range.inactive,.ngx-charts .line-series.inactive,.ngx-charts .polar-series-area.inactive,.ngx-charts .polar-series-path.inactive{transition:opacity .1s ease-in-out;opacity:.2}.ngx-charts .line-highlight{display:none}.ngx-charts .line-highlight.active{display:block}.ngx-charts .area{opacity:.6}.ngx-charts .circle:hover{cursor:pointer}.ngx-charts .label{font-size:12px;font-weight:400}.ngx-charts .tooltip-anchor{fill:#000}.ngx-charts .gridline-path{stroke:#ddd;stroke-width:1;fill:none}.ngx-charts .refline-path{stroke:#a8b2c7;stroke-width:1;stroke-dasharray:5;stroke-dashoffset:5}.ngx-charts .refline-label{font-size:9px}.ngx-charts .reference-area{fill-opacity:.05;fill:#000}.ngx-charts .gridline-path-dotted{stroke:#ddd;stroke-width:1;fill:none;stroke-dasharray:1,20;stroke-dashoffset:3}.ngx-charts .grid-panel rect{fill:none}.ngx-charts .grid-panel.odd rect{fill:rgba(0,0,0,.05)}",".pie-label{font-size:11px}.pie-label.animation{-webkit-animation:750ms ease-in fadeIn;animation:750ms ease-in fadeIn}@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.pie-label-line{stroke-dasharray:100%}.pie-label-line.animation{-webkit-animation:3s linear drawOut;animation:3s linear drawOut;transition:d 750ms}@-webkit-keyframes drawOut{from{stroke-dashoffset:100%}to{stroke-dashoffset:0}}@keyframes drawOut{from{stroke-dashoffset:100%}to{stroke-dashoffset:0}}"],encapsulation:2,changeDetection:0}),t})(),w1=(()=>{let t=class{constructor(){this.series=[],this.innerRadius=60,this.outerRadius=80,this.trimLabels=!0,this.maxLabelLength=10,this.tooltipDisabled=!1,this.animations=!0,this.select=new cu,this.activate=new cu,this.deactivate=new cu,this.dblclick=new cu}ngOnChanges(t){this.update()}update(){const t=function(){var t=PY,e=OY,n=null,r=iY(0),i=iY(SY),a=iY(0);function s(s){var o,l,u,c,h,d=s.length,p=0,f=new Array(d),m=new Array(d),g=+r.apply(this,arguments),y=Math.min(SY,Math.max(-SY,i.apply(this,arguments)-g)),v=Math.min(Math.abs(y)/d,a.apply(this,arguments)),_=v*(y<0?-1:1);for(o=0;o<d;++o)(h=m[f[o]=o]=+t(s[o],o,s))>0&&(p+=h);for(null!=e?f.sort((function(t,n){return e(m[t],m[n])})):null!=n&&f.sort((function(t,e){return n(s[t],s[e])})),o=0,u=p?(y-d*_)/p:0;o<d;++o,g=c)m[l=f[o]]={data:s[l],index:o,value:h=m[l],startAngle:g,endAngle:c=g+(h>0?h*u:0)+_,padAngle:v};return m}return s.value=function(e){return arguments.length?(t="function"==typeof e?e:iY(+e),s):t},s.sortValues=function(t){return arguments.length?(e=t,n=null,s):e},s.sort=function(t){return arguments.length?(n=t,e=null,s):n},s.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:iY(+t),s):r},s.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:iY(+t),s):i},s.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:iY(+t),s):a},s}().value(t=>t.value).sort(null)(this.series);this.max=HZ(t,t=>t.value),this.data=this.calculateLabelPositions(t),this.tooltipText=this.tooltipText||this.defaultTooltipText}midAngle(t){return t.startAngle+(t.endAngle-t.startAngle)/2}outerArc(){return NY().innerRadius(1.5*this.outerRadius).outerRadius(1.5*this.outerRadius)}calculateLabelPositions(t){const e=t;e.forEach(t=>{t.pos=this.outerArc().centroid(t),t.pos[0]=1.5*this.outerRadius*(this.midAngle(t)<Math.PI?1:-1)});for(let n=0;n<e.length-1;n++){const t=e[n];if(this.labelVisible(t))for(let r=n+1;r<e.length;r++){const n=e[r];if(this.labelVisible(n)&&n.pos[0]*t.pos[0]>0){const e=10-Math.abs(n.pos[1]-t.pos[1]);e>0&&(n.pos[1]+=Math.sign(n.pos[0])*e)}}}return e}labelVisible(t){return this.showLabels&&t.endAngle-t.startAngle>Math.PI/30}getTooltipTitle(t){return this.tooltipTemplate?void 0:this.tooltipText(t)}labelText(t){return this.labelFormatting?this.labelFormatting(t.data.name):this.label(t)}label(t){return $0(t.data.name)}defaultTooltipText(t){const e=this.label(t),n=$0(t.data.value);return`\n      <span class="tooltip-label">${B0(e)}</span>\n      <span class="tooltip-val">${n}</span>\n    `}color(t){return this.colors.getColor(this.label(t))}trackBy(t,e){return e.data.name}onClick(t){this.select.emit(t)}isActive(t){return!!this.activeEntries&&void 0!==this.activeEntries.find(e=>t.name===e.name&&t.series===e.series)}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Je({type:t,selectors:[["g","ngx-charts-pie-series",""]],inputs:{series:"series",innerRadius:"innerRadius",outerRadius:"outerRadius",trimLabels:"trimLabels",maxLabelLength:"maxLabelLength",tooltipDisabled:"tooltipDisabled",animations:"animations",tooltipText:"tooltipText",colors:"colors",dims:"dims",explodeSlices:"explodeSlices",showLabels:"showLabels",gradient:"gradient",activeEntries:"activeEntries",labelFormatting:"labelFormatting",tooltipTemplate:"tooltipTemplate"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",dblclick:"dblclick"},features:[rl],attrs:c0,decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],["ngx-charts-pie-label","",3,"data","radius","color","label","labelTrim","labelTrimSize","max","value","explodeSlices","animations",4,"ngIf"],["ngx-charts-pie-arc","","ngx-tooltip","",3,"startAngle","endAngle","innerRadius","outerRadius","fill","value","gradient","data","max","explodeSlices","isActive","animate","tooltipDisabled","tooltipPlacement","tooltipType","tooltipTitle","tooltipTemplate","tooltipContext","select","activate","deactivate","dblclick"],["ngx-charts-pie-label","",3,"data","radius","color","label","labelTrim","labelTrimSize","max","value","explodeSlices","animations"]],template:function(t,e){1&t&&Ys(0,d0,3,19,"g",0),2&t&&ro("ngForOf",e.data)("ngForTrackBy",e.trackBy)},directives:[rh,ah,b1,L0,_1],encapsulation:2,changeDetection:0}),t})(),S1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})(),C1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1,S1,v1]]}),t})(),D1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})(),I1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1]]}),t})(),k1=(()=>{let t=class{};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[n1,S1,d1]]}),t})(),E1=(()=>{let t=class{constructor(){"undefined"!=typeof SVGElement&&void 0===SVGElement.prototype.contains&&(SVGElement.prototype.contains=HTMLDivElement.prototype.contains)}};return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[n1,s1,d1,p1,f1,v1,C1,D1,S1,I1,k1]}),t})();const A1=zr(l1),T1=zr(g1),R1=zr(x1);function M1(t,e){if(1&t&&(Qn(),oo(0,"circle",3)),2&t){const t=_o();To("animation-name","mat-progress-spinner-stroke-rotate-"+t.diameter)("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),Ks("r",t._circleRadius)}}function N1(t,e){if(1&t&&(Qn(),oo(0,"circle",3)),2&t){const t=_o();To("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),Ks("r",t._circleRadius)}}function O1(t,e){if(1&t&&(Qn(),oo(0,"circle",3)),2&t){const t=_o();To("animation-name","mat-progress-spinner-stroke-rotate-"+t.diameter)("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),Ks("r",t._circleRadius)}}function P1(t,e){if(1&t&&(Qn(),oo(0,"circle",3)),2&t){const t=_o();To("stroke-dashoffset",t._strokeDashOffset,"px")("stroke-dasharray",t._strokeCircumference,"px")("stroke-width",t._circleStrokeWidth,"%"),Ks("r",t._circleRadius)}}class F1{constructor(t){this._elementRef=t}}const L1=x$(F1,"primary"),z1=new _e("mat-progress-spinner-default-options",{providedIn:"root",factory:function(){return{diameter:100}}});let $1=(()=>{class t extends L1{constructor(e,n,r,i,a){super(e),this._elementRef=e,this._document=r,this._diameter=100,this._value=0,this._fallbackAnimation=!1,this.mode="determinate";const s=t._diameters;s.has(r.head)||s.set(r.head,new Set([100])),this._fallbackAnimation=n.EDGE||n.TRIDENT,this._noopAnimations="NoopAnimations"===i&&!!a&&!a._forceAnimations,a&&(a.diameter&&(this.diameter=a.diameter),a.strokeWidth&&(this.strokeWidth=a.strokeWidth))}get diameter(){return this._diameter}set diameter(t){this._diameter=zP(t),!this._fallbackAnimation&&this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(t){this._strokeWidth=zP(t)}get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,zP(t)))}ngOnInit(){const t=this._elementRef.nativeElement;this._styleRoot=FP(t)||this._document.head,this._attachStyleNode(),t.classList.add(`mat-progress-spinner-indeterminate${this._fallbackAnimation?"-fallback":""}-animation`)}get _circleRadius(){return(this.diameter-10)/2}get _viewBox(){const t=2*this._circleRadius+this.strokeWidth;return`0 0 ${t} ${t}`}get _strokeCircumference(){return 2*Math.PI*this._circleRadius}get _strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference*(100-this._value)/100:this._fallbackAnimation&&"indeterminate"===this.mode?.2*this._strokeCircumference:null}get _circleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const e=this._styleRoot,n=this._diameter,r=t._diameters;let i=r.get(e);if(!i||!i.has(n)){const t=this._document.createElement("style");t.setAttribute("mat-spinner-animation",n+""),t.textContent=this._getAnimationText(),e.appendChild(t),i||(i=new Set,r.set(e,i)),i.add(n)}}_getAnimationText(){return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,`${.95*this._strokeCircumference}`).replace(/END_VALUE/g,`${.2*this._strokeCircumference}`).replace(/DIAMETER/g,`${this.diameter}`)}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(kP),to(Nc,8),to(c$,8),to(z1))},t.\u0275cmp=Je({type:t,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(t,e){2&t&&(Ks("aria-valuemin","determinate"===e.mode?0:null)("aria-valuemax","determinate"===e.mode?100:null)("aria-valuenow","determinate"===e.mode?e.value:null)("mode",e.mode),To("width",e.diameter,"px")("height",e.diameter,"px"),Ro("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color",mode:"mode",diameter:"diameter",strokeWidth:"strokeWidth",value:"value"},exportAs:["matProgressSpinner"],features:[Zo],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(Qn(),ao(0,"svg",0),Ys(1,M1,1,9,"circle",1),Ys(2,N1,1,7,"circle",2),so()),2&t&&(To("width",e.diameter,"px")("height",e.diameter,"px"),ro("ngSwitch","indeterminate"===e.mode),Ks("viewBox",e._viewBox),Hi(1),ro("ngSwitchCase",!0),Hi(1),ro("ngSwitchCase",!1))},directives:[uh,ch],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),t._diameters=new WeakMap,t})(),B1=(()=>{class t extends $1{constructor(t,e,n,r,i){super(t,e,n,r,i),this.mode="indeterminate"}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(kP),to(Nc,8),to(c$,8),to(z1))},t.\u0275cmp=Je({type:t,selectors:[["mat-spinner"]],hostAttrs:["role","progressbar","mode","indeterminate",1,"mat-spinner","mat-progress-spinner"],hostVars:6,hostBindings:function(t,e){2&t&&(To("width",e.diameter,"px")("height",e.diameter,"px"),Ro("_mat-animation-noopable",e._noopAnimations))},inputs:{color:"color"},features:[Zo],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(t,e){1&t&&(Qn(),ao(0,"svg",0),Ys(1,O1,1,9,"circle",1),Ys(2,P1,1,7,"circle",2),so()),2&t&&(To("width",e.diameter,"px")("height",e.diameter,"px"),ro("ngSwitch","indeterminate"===e.mode),Ks("viewBox",e._viewBox),Hi(1),ro("ngSwitchCase",!0),Hi(1),ro("ngSwitchCase",!1))},directives:[uh,ch],styles:[".mat-progress-spinner{display:block;position:relative}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{animation:mat-progress-spinner-stroke-rotate-fallback 10000ms cubic-bezier(0.87, 0.03, 0.33, 1) infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate]{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition-property:stroke}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-fallback-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}@keyframes mat-progress-spinner-stroke-rotate-fallback{0%{transform:rotate(0deg)}25%{transform:rotate(1170deg)}50%{transform:rotate(2340deg)}75%{transform:rotate(3510deg)}100%{transform:rotate(4680deg)}}\n"],encapsulation:2,changeDetection:0}),t})(),W1=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$,fh],_$]}),t})();function q1(t,e){if(1&t){const t=co();ao(0,"div",12),ao(1,"ngx-charts-pie-chart",20),fo("select",(function(e){return Tn(t),_o(2).selected(e)})),so(),so()}if(2&t){const t=_o(2);Hi(1),ro("view",t.view)("scheme",t.colorScheme)("results",t.single)}}function V1(t,e){if(1&t){const t=co();ao(0,"div",12),ao(1,"ngx-charts-bar-vertical",21),fo("select",(function(e){return Tn(t),_o(2).selected(e)})),so(),so()}if(2&t){const t=_o(2);Hi(1),ro("view",t.view)("scheme",t.colorScheme)("results",t.single)}}function U1(t,e){if(1&t){const t=co();ao(0,"div"),ao(1,"div",12),ao(2,"div",13),ao(3,"div",14),ao(4,"h1"),Vo(5),so(),ao(6,"mat-slider",15,16),fo("input",(function(e){return Tn(t),_o().changeDate(e)})),so(),so(),so(),ao(8,"div",17),ao(9,"div"),ao(10,"h3"),Vo(11),so(),so(),so(),so(),ao(12,"button",18),fo("click",(function(){return Tn(t),_o().changeView()})),Vo(13," change view "),so(),Ys(14,q1,2,3,"div",19),Ys(15,V1,2,3,"div",19),so()}if(2&t){const t=Qs(7),e=_o();Hi(5),Uo(e.byDate[0][0].query),Hi(1),ro("displayWith",e.formatLabel)("value",t),Hi(5),Uo(e.byDate[e.sliderIndex][0].date),Hi(3),ro("ngIf",e.viewValue),Hi(1),ro("ngIf",!e.viewValue)}}function j1(t,e){if(1&t){const t=co();ao(0,"mat-tab",22),ao(1,"button",23),fo("click",(function(){return Tn(t),_o().changeSelect()})),ao(2,"span"),Vo(3,"\xd7"),so(),so(),ao(4,"h1",24),Vo(5),so(),ao(6,"button",18),fo("click",(function(){return Tn(t),_o().onAnalyze()})),Vo(7," Predict next 3 months "),so(),oo(8,"br"),oo(9,"ngx-charts-line-chart",25),so()}if(2&t){const t=_o();Hi(5),Ho("",t.sentData[0].series[0].query," popularity in ",t.sentData[0].name,""),Hi(4),ro("view",t.view)("scheme",t.colorScheme)("results",t.data)}}function H1(t,e){1&t&&oo(0,"mat-spinner",26),2&t&&ro("diameter",150)}let G1=(()=>{class t{constructor(t,e){this.SidebarService=t,this.tensorflowService=e,this.select=!1,this.view=[.37*window.innerWidth,.7*window.innerHeight],this.viewValue=!0,this.showLegend=!0,this.showLabels=!0,this.colorScheme={domain:["#FF6633","#FFB399","#FF33FF","#FFFF99","#00B3E6","#E6B333","#3366E6","#999966","#99FF99","#B34D4D","#80B300","#809900","#E6B3B3","#6680B3","#66991A","#FF99E6","#CCFF1A","#FF1A66","#E6331A","#33FFCC","#66994D","#B366CC","#4D8000","#B33300","#CC80CC","#66664D","#991AFF","#E666FF","#4DB3FF","#1AB399","#E666B3","#33991A","#CC9999","#B3B31A","#00E680","#4D8066","#809980","#E6FF80","#1AFF33","#999933","#FF3380","#CCCC00","#66E64D","#4D80CC","#9900B3","#E64D66","#4DB380","#FF4D4D","#99E6E6","#6666FF"]},this.byDate=[],this.original=[],this.sliderIndex=0,this.sentData=[]}changeDate(t){this.single=this.byDate[this.sliderIndex],this.SidebarService.getCountriesData(t.value)}changeView(){this.viewValue=!this.viewValue,console.log(this.viewValue)}ngOnInit(){this.arraybyDate=this.SidebarService.byDate.subscribe(t=>{this.byDate=t,this.single=this.byDate[0]}),this.isLoading=this.SidebarService.Loading.subscribe(t=>this.loading=t),this.SidebarService.saveByDate(this.byDate),this.single=this.byDate[0],this.Index=this.SidebarService.sliderIndex.subscribe(t=>this.sliderIndex=t),this.arrayOriginal=this.SidebarService.original.subscribe(t=>{this.original=t}),this.SidebarService.saveOriginal(this.original),this.dataSent=this.SidebarService.sentData.subscribe(t=>{this.sentData=t,this.data=this.sentData})}formatLabel(t){return t>=1e3?Math.round(t/1e3)+"k":t}changeSelect(){this.select=!1}selected(t){this.select=!0,this.SidebarService.parseSendData("string"==typeof t?t:t.name),console.log(this.sentData)}checkLoading(){return this.loading}ngOnDestroy(){this.Index.unsubscribe(),this.arraybyDate.unsubscribe(),this.arrayOriginal.unsubscribe(),this.isLoading.unsubscribe(),this.dataSent.unsubscribe()}onAnalyze(){let t=[10,20,15],e=[{name:"CA",series:[]}];for(let n=0;n<t.length;n++)e[0].series.push({name:(51+n+1).toString(),value:t[n]});this.sentData[0].series.reverse(),this.sentData[0].series.forEach(t=>{e[0].series.unshift(t)}),console.log(e),this.SidebarService._sentData.next(e)}}return t.\u0275fac=function(e){return new(e||t)(to(Am),to(DP))},t.\u0275cmp=Je({type:t,selectors:[["app-sidebar"]],decls:16,vars:4,consts:[["autosize","",3,"hidden"],["mode","side","opened","true",1,"container-fluid"],["drawer",""],["mat-button","","id","closeBtn",1,"",3,"click"],[1,""],["label","Global"],[4,"ngIf"],["label","Country Analysis",4,"ngIf"],["id","spinner"],[3,"diameter",4,"ngIf"],["id","openBtn"],["type","button","mat-raised-button","",3,"click"],[1,"container"],[1,"row"],[1,"col-7"],["min","0","max","51",3,"displayWith","value","input"],["matslider",""],[1,"col-4"],["mat-raised-button","",3,"click"],["class","container",4,"ngIf"],["labels","true","doughnut","true","legend","true","legendTitle","countries",1,"",3,"view","scheme","results","select"],["legend","true","legendTitle","countries","xAxis","true","yAxies","false","showXAxisLabel","true","showYAxisLabel","true",1,"",3,"view","scheme","results","select"],["label","Country Analysis"],["mat-button","","label","close",3,"click"],[2,"text-align","left"],["legend","true","showXAxisLabel","true","showYAxisLabel","true","xAxis","popularity","yAxis","time(weeks)","xAxisLabel","time(weeks)","yAxisLabel","popularity","timeline","true",3,"view","scheme","results"],[3,"diameter"]],template:function(t,e){if(1&t){const t=co();ao(0,"mat-drawer-container",0),ao(1,"mat-sidenav",1,2),ao(3,"button",3),fo("click",(function(){return Tn(t),Qs(2).toggle()})),ao(4,"span"),Vo(5,"\xd7"),so(),so(),oo(6,"app-searchbar",4),ao(7,"mat-tab-group"),ao(8,"mat-tab",5),Ys(9,U1,16,6,"div",6),so(),Ys(10,j1,10,5,"mat-tab",7),so(),ao(11,"div",8),Ys(12,H1,1,1,"mat-spinner",9),so(),so(),so(),ao(13,"div",10),ao(14,"button",11),fo("click",(function(){return Tn(t),Qs(2).toggle()})),Vo(15," Open Sidebar "),so(),so()}2&t&&(ro("hidden",!Qs(2).opened),Hi(9),ro("ngIf",!e.checkLoading()),Hi(1),ro("ngIf",e.select),Hi(2),ro("ngIf",e.checkLoading()))},directives:[bB,xB,AB,bU,nj,jU,ah,yj,x1,l1,g1,B1],styles:["mat-drawer-container[_ngcontent-%COMP%]{height:100%;max-width:40%;min-width:600px;background-color:rgba(255,255,100,0)}#spinner[_ngcontent-%COMP%]{text-align:center}.col-6[_ngcontent-%COMP%]{padding:0}.container-fluid[_ngcontent-%COMP%]{padding-left:5px;padding-right:0}.outer[_ngcontent-%COMP%]{height:95%;position:relative}#closeBtn[_ngcontent-%COMP%]{position:absolute;right:0}#openBtn[_ngcontent-%COMP%]{position:absolute;top:0;left:0}h3[_ngcontent-%COMP%]{left:5px;text-align:left}.mat-progress-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%], .mat-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{height:-webkit-max-content;height:-moz-max-content;height:max-content;width:-webkit-max-content;width:-moz-max-content;width:max-content}.pie-chart-container[_ngcontent-%COMP%]{height:600px;min-width:600px}.pie-label[_ngcontent-%COMP%]{font-size:14}"]}),t})();const J1=[{path:"home",component:G1}];let X1=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[vm.forRoot(J1)],vm]}),t})();var K1=n("4ZJM");let Z1=(()=>{class t{constructor(t){this.sidebarService=t}ngOnInit(){this.map=new K1.Map({accessToken:"pk.eyJ1IjoidHJhdmVsbmV0IiwiYSI6ImNrYjJ4bnpxZDBnMHUydG10cXJmeGNjazEifQ.Z2ajmP1ywUc77Z74VlXmWw",container:"mapbox",style:"mapbox://styles/travelnet/ckb47dkvn0dh31ila3aizjqlt",center:[-71.22,46.85],zoom:2}),this.byDateSubscription=this.sidebarService.byDate.subscribe(t=>{let e=this.byDate;this.byDate=t,JSON.stringify(e)!=JSON.stringify(this.byDate)&&e&&this.colorMap()}),this.byDateSubscription=this.sidebarService.sliderIndex.subscribe(t=>{let e=this.sliderValue;this.sliderValue=t,e!=this.sliderValue&&0!=t&&this.colorMap()})}colorMap(){this.byDate[this.sliderValue].forEach(t=>{let e=t.value/100;this.map.setPaintProperty(t.name.toLowerCase(),"fill-opacity",e)})}ngOnDestroy(){this.byDateSubscription.unsubscribe(),this.sliderValueSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(to(Am))},t.\u0275cmp=Je({type:t,selectors:[["app-map"]],decls:2,vars:0,consts:[["href","https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css","rel","stylesheet"],["id","mapbox",3,"click"]],template:function(t,e){1&t&&(oo(0,"link",0),ao(1,"div",1),fo("click",(function(){return e.colorMap()})),so())},styles:["#mapbox[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute}body[_ngcontent-%COMP%]{margin:0;padding:0}.map-overlay[_ngcontent-%COMP%]{font:700 12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;position:absolute;width:25%;bottom:0;left:0;padding:10px}.map-overlay[_ngcontent-%COMP%]   .map-overlay-inner[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 1px 2px rgba(0,0,0,.2);border-radius:3px;padding:10px;margin-bottom:10px}.map-overlay[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin:0 0 10px}.map-overlay[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;display:inline-block;width:100%;position:relative;margin:0;cursor:ew-resize}"]}),t})(),Y1=(()=>{class t{constructor(t){this.TensorflowService=t,this.title="EnVision"}ngAfterContentInit(){this.TensorflowService.loadModel()}}return t.\u0275fac=function(e){return new(e||t)(to(DP))},t.\u0275cmp=Je({type:t,selectors:[["app-root"]],decls:8,vars:0,consts:[["lang","en"],["href","https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css","rel","stylesheet"],[1,""]],template:function(t,e){1&t&&(ao(0,"html",0),ao(1,"head"),ao(2,"title"),Vo(3,"Document"),so(),oo(4,"link",1),so(),ao(5,"body"),oo(6,"app-map"),oo(7,"app-sidebar",2),so(),so())},directives:[Z1,G1],styles:["h1[_ngcontent-%COMP%]{z-index:2}body[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky}"]}),t})(),Q1=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})(),t2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[J$,_$,SF,Q1],_$,Q1]}),t})(),e2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[J$,_$],_$]}),t})();const n2={provide:new _e("mat-autocomplete-scroll-strategy"),deps:[AV],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let r2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[n2],imports:[[oB,PV,_$,fh],pF,oB,_$]}),t})(),i2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[qF,_$],_$]}),t})(),a2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[PV,_$,rV],_$]}),t})(),s2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$,J$],_$]}),t})(),o2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$],_$]}),t})();const l2=new _e("mat-chips-default-options"),u2={separatorKeyCodes:[13]};let c2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[z$,{provide:l2,useValue:u2}]}),t})(),h2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[lF]]}),t})(),d2=(()=>{class t{constructor(){this.changes=new at,this.optionalLabel="Optional"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const p2={provide:d2,deps:[[new $t,new Wt,d2]],useFactory:function(t){return t||new d2}};let f2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[p2,z$],imports:[[_$,fh,rV,TB,h2,yU,J$],_$]}),t})();function m2(t,e){}class g2{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}}const y2={dialogContainer:jF("dialogContainer",[XF("void, exit",JF({opacity:0,transform:"scale(0.7)"})),XF("enter",JF({transform:"none"})),KF("* => enter",HF("150ms cubic-bezier(0, 0, 0.2, 1)",JF({transform:"none",opacity:1}))),KF("* => void, * => exit",HF("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",JF({opacity:0})))])};function v2(){throw Error("Attempting to attach dialog content after content is already attached")}let _2=(()=>{class t extends Kq{constructor(t,e,n,r,i){super(),this._elementRef=t,this._focusTrapFactory=e,this._changeDetectorRef=n,this._config=i,this._elementFocusedBeforeDialogWasOpened=null,this._state="enter",this._animationStateChanged=new cu,this.attachDomPortal=t=>(this._portalOutlet.hasAttached()&&v2(),this._setupFocusTrap(),this._portalOutlet.attachDomPortal(t)),this._ariaLabelledBy=i.ariaLabelledBy||null,this._document=r}attachComponentPortal(t){return this._portalOutlet.hasAttached()&&v2(),this._setupFocusTrap(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached()&&v2(),this._setupFocusTrap(),this._portalOutlet.attachTemplatePortal(t)}_recaptureFocus(){this._containsFocus()||this._focusTrap.focusInitialElement()||this._elementRef.nativeElement.focus()}_trapFocus(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}_restoreFocus(){const t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){const e=this._document.activeElement,n=this._elementRef.nativeElement;e&&e!==this._document.body&&e!==n&&!n.contains(e)||t.focus()}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)),this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then(()=>this._elementRef.nativeElement.focus()))}_containsFocus(){const t=this._elementRef.nativeElement,e=this._document.activeElement;return t===e||t.contains(e)}_onAnimationDone(t){"enter"===t.toState?this._trapFocus():"exit"===t.toState&&this._restoreFocus(),this._animationStateChanged.emit(t)}_onAnimationStart(t){this._animationStateChanged.emit(t)}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(RF),to(bs),to(Nc,8),to(g2))},t.\u0275cmp=Je({type:t,selectors:[["mat-dialog-container"]],viewQuery:function(t,e){var n;1&t&&wu(tV,!0),2&t&&xu(n=Eu())&&(e._portalOutlet=n.first)},hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,e){1&t&&mo("@dialogContainer.start",(function(t){return e._onAnimationStart(t)}))("@dialogContainer.done",(function(t){return e._onAnimationDone(t)})),2&t&&(Ks("id",e._id)("role",e._config.role)("aria-labelledby",e._config.ariaLabel?null:e._ariaLabelledBy)("aria-label",e._config.ariaLabel)("aria-describedby",e._config.ariaDescribedBy||null),Xo("@dialogContainer",e._state))},features:[Zo],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,e){1&t&&Ys(0,m2,0,0,"ng-template",0)},directives:[tV],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[y2.dialogContainer]}}),t})(),b2=0;class x2{constructor(t,e,n=`mat-dialog-${b2++}`){this._overlayRef=t,this._containerInstance=e,this.id=n,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new at,this._afterClosed=new at,this._beforeClosed=new at,this._state=0,e._id=n,e._animationStateChanged.pipe(rd(t=>"done"===t.phaseName&&"enter"===t.toState),xd(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),e._animationStateChanged.pipe(rd(t=>"done"===t.phaseName&&"exit"===t.toState),xd(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),t.keydownEvents().pipe(rd(t=>27===t.keyCode&&!this.disableClose&&!mF(t))).subscribe(t=>{t.preventDefault(),this.close()}),t.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():this.close()})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(rd(t=>"start"===t.phaseName),xd(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._containerInstance._startExitAnimation(),this._state=1}afterOpened(){return this._afterOpened.asObservable()}afterClosed(){return this._afterClosed.asObservable()}beforeClosed(){return this._beforeClosed.asObservable()}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(t){let e=this._getPositionStrategy();return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(t="",e=""){return this._getPositionStrategy().width(t).height(e),this._overlayRef.updatePosition(),this}addPanelClass(t){return this._overlayRef.addPanelClass(t),this}removePanelClass(t){return this._overlayRef.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}const w2=new _e("MatDialogData"),S2=new _e("mat-dialog-default-options"),C2=new _e("mat-dialog-scroll-strategy"),D2={provide:C2,deps:[AV],useFactory:function(t){return()=>t.scrollStrategies.block()}};let I2=(()=>{class t{constructor(t,e,n,r,i,a,s){this._overlay=t,this._injector=e,this._defaultOptions=r,this._parentDialog=a,this._overlayContainer=s,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new at,this._afterOpenedAtThisLevel=new at,this._ariaHiddenElements=new Map,this.afterAllClosed=ed(()=>this.openDialogs.length?this._afterAllClosed:this._afterAllClosed.pipe(Rd(void 0))),this._scrollStrategy=i}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}get _afterAllClosed(){const t=this._parentDialog;return t?t._afterAllClosed:this._afterAllClosedAtThisLevel}open(t,e){if((e=function(t,e){return Object.assign(Object.assign({},e),t)}(e,this._defaultOptions||new g2)).id&&this.getDialogById(e.id))throw Error(`Dialog with id "${e.id}" exists already. The dialog id must be unique.`);const n=this._createOverlay(e),r=this._attachDialogContainer(n,e),i=this._attachDialogContent(t,r,n,e);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(i),i.afterClosed().subscribe(()=>this._removeOpenDialog(i)),this.afterOpened.next(i),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(e=>e.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t){const e=this._getOverlayConfig(t);return this._overlay.create(e)}_getOverlayConfig(t){const e=new dV({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(e.backdropClass=t.backdropClass),e}_attachDialogContainer(t,e){const n=Fs.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:g2,useValue:e}]}),r=new Gq(_2,e.viewContainerRef,n,e.componentFactoryResolver);return t.attach(r).instance}_attachDialogContent(t,e,n,r){const i=new x2(n,e,r.id);if(t instanceof Wl)e.attachTemplatePortal(new Jq(t,null,{$implicit:r.data,dialogRef:i}));else{const n=this._createInjector(r,i,e),a=e.attachComponentPortal(new Gq(t,r.viewContainerRef,n));i.componentInstance=a.instance}return i.updateSize(r.width,r.height).updatePosition(r.position),i}_createInjector(t,e,n){const r=t&&t.viewContainerRef&&t.viewContainerRef.injector,i=[{provide:_2,useValue:n},{provide:w2,useValue:t.data},{provide:x2,useValue:e}];return!t.direction||r&&r.get(oF,null)||i.push({provide:oF,useValue:{value:t.direction,change:Gh()}}),Fs.create({parent:r||this._injector,providers:i})}_removeOpenDialog(t){const e=this.openDialogs.indexOf(t);e>-1&&(this.openDialogs.splice(e,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((t,e)=>{t?e.setAttribute("aria-hidden",t):e.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._afterAllClosed.next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const e=t.parentElement.children;for(let n=e.length-1;n>-1;n--){let r=e[n];r===t||"SCRIPT"===r.nodeName||"STYLE"===r.nodeName||r.hasAttribute("aria-live")||(this._ariaHiddenElements.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}}}_closeDialogs(t){let e=t.length;for(;e--;)t[e].close()}}return t.\u0275fac=function(e){return new(e||t)(Ae(AV),Ae(Fs),Ae(Jc,8),Ae(S2,8),Ae(C2),Ae(t,12),Ae(_V))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),k2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[I2,D2],imports:[[PV,rV,_$],_$]}),t})(),E2=(()=>{class t{constructor(){this.changes=new at,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 20 years",this.nextMultiYearLabel="Next 20 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}formatYearRange(t,e){return`${t} \u2013 ${e}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const A2={provide:new _e("mat-datepicker-scroll-strategy"),deps:[AV],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let T2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[E2,A2],imports:[[fh,TB,k2,PV,qF,rV],pF]}),t})(),R2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$],_$]}),t})(),M2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})(),N2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,M2,rV]]}),t})(),O2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[$$,_$],$$,_$]}),t})(),P2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[$$,J$,_$,K$,fh],$$,_$,K$,R2]}),t})();const F2={provide:new _e("mat-menu-scroll-strategy"),deps:[AV],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let L2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[F2],imports:[_$]}),t})(),z2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[F2],imports:[[fh,_$,J$,PV,L2],pF,_$,L2]}),t})();const $2={provide:new _e("mat-tooltip-scroll-strategy"),deps:[AV],useFactory:function(t){return()=>t.scrollStrategies.reposition({scrollThrottle:20})}};let B2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[$2],imports:[[qF,fh,PV,_$],_$,pF]}),t})(),W2=(()=>{class t{constructor(){this.changes=new at,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,e,n)=>{if(0==n||0==e)return`0 of ${n}`;const r=t*e;return`${r+1} \u2013 ${r<(n=Math.max(n,0))?Math.min(r+e,n):r+e} of ${n}`}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const q2={provide:W2,deps:[[new $t,new Wt,W2]],useFactory:function(t){return t||new W2}};let V2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[q2],imports:[[fh,TB,eU,B2]]}),t})(),U2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,_$],_$]}),t})(),j2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})(),H2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[j2,J$,_$,SF],j2,_$]}),t})(),G2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[PV,rV,fh,TB,_$],_$]}),t})(),J2=(()=>{class t{constructor(){this.changes=new at,this.sortButtonLabel=t=>`Change sorting for ${t}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const X2={provide:J2,deps:[[new $t,new Wt,J2]],useFactory:function(t){return t||new J2}};let K2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[X2],imports:[[fh]]}),t})(),Z2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})(),Y2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[Z2,_$],_$]}),t})(),Q2=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[_$],_$]}),t})(),t3=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(to(Wl))},t.\u0275dir=tn({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),e3=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[zF,t3]}),t})(),n3=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[e3,_$],_$]}),t})();const r3=()=>"undefined"!=typeof document,i3=t=>t&&t.observers.length>0;class a3{constructor(t){this.resizeBatchService=t,this.resize=new cu,this.acceptedSize=!1,this.state=0}acceptSize(t=this.measure()){this.lastWidth=t.width,this.lastHeight=t.height,this.acceptedSize=!0}checkChanges(){r3()&&0===this.state&&(this.state=1,this.resizeBatchService.schedule(this,this.init))}destroy(){this.resizeBatchService.cancel(this)}checkSize(){if(!this.parentElement)return;const{width:t,height:e}=this.measure();return t===this.lastWidth&&e===this.lastHeight?void 0:(this.lastWidth=t,this.lastHeight=e,this.acceptedSize=!1,this.resize.emit(),!0)}initSize(){const t=this.measure();this.lastWidth=t.width,this.lastHeight=t.height}measure(){let t=0,e=0;return this.parentElement&&(e=this.parentElement.offsetHeight,t=this.parentElement.offsetWidth),{height:e,width:t}}}const s3=t=>{const e=document.createElement("div");return e.style.cssText=t,e},o3="position: absolute; display: block; left: 0; top: 0; right: 0; bottom: 0; z-index: -1;overflow: hidden; visibility: hidden;";class l3 extends a3{constructor(t,e,n){super(t),this.element=e,this.ngZone=n}checkChanges(){2!==this.state?super.checkChanges():this.resizeBatchService.isScheduled(this)||this.resizeBatchService.schedule(this,this.checkSize)}destroy(){if(super.destroy(),this.subscription&&this.subscription.unsubscribe(),this.expand){const t=this.element.nativeElement;t.removeChild(this.expand),t.removeChild(this.shrink),this.expand.removeChild(this.expandChild),this.expand=this.expandChild=this.shrink=this.element=null}}checkSize(){if(super.checkSize())return this.reset(),!0}init(){const t=this.parentElement=this.element.nativeElement.parentElement;"static"===getComputedStyle(t,null).getPropertyValue("position")&&(t.style.position="relative"),this.state=2,this.render(),this.reset(),this.initSize(),this.subscribe()}render(){const t=this.element.nativeElement;t.style.cssText=o3,t.setAttribute("dir","ltr"),this.expand=s3(o3),this.expandChild=s3("position: absolute; left: 0; top: 0; transition: 0s;"),this.expand.appendChild(this.expandChild),t.appendChild(this.expand),this.shrink=s3(o3);const e=s3("position: absolute; left: 0; top: 0; transition: 0s;width: 200%; height: 200%;");this.shrink.appendChild(e),t.appendChild(this.shrink)}reset(){const t=this.expandChild;t.style.width="100000px",t.style.height="100000px";const e=this.expand;e.scrollLeft=1e5,e.scrollTop=1e5;const n=this.shrink;n.scrollLeft=1e5,n.scrollTop=1e5}subscribe(){this.ngZone.runOutsideAngular(()=>{this.subscription=kt(qP(this.shrink,"scroll"),qP(this.expand,"scroll")).subscribe(()=>{this.checkSize()})})}}const u3="undefined"!=typeof ResizeObserver;class c3 extends a3{constructor(t,e,n){super(t),this.element=e,this.ngZone=n}static supported(){return u3}destroy(){super.destroy(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.parentElement=null}init(){this.parentElement=this.element.nativeElement.parentElement,this.initSize(),this.state=2,this.ngZone.runOutsideAngular(()=>{this.resizeObserver=new ResizeObserver(()=>{this.checkSize()}),this.resizeObserver.observe(this.parentElement)})}}let h3=(()=>{class t{constructor(t){this.ngZone=t,this.scheduled=[],this.resolvedPromise=Promise.resolve(null),this.flush=this.flush.bind(this)}schedule(t,e){this.scheduled.push({instance:t,method:e}),this.subscription||this.ngZone.runOutsideAngular(()=>{this.subscription=xt(this.resolvedPromise).subscribe(this.flush)})}isScheduled(t){return Boolean(this.scheduled.find(e=>e.instance===t))}cancel(t){const e=this.scheduled,n=e.length;for(let r=0;r<n;r++)if(e[r].instance===t)return e.splice(r,1),void(e.length||this.unsubscribe())}ngOnDestroy(){this.unsubscribe()}unsubscribe(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}flush(){this.scheduled.forEach(t=>{t.method.call(t.instance)}),this.scheduled=[],this.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Ae(ec))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),d3=(()=>{class t{constructor(t,e,n){this.rateLimit=10,this.resize=new cu;const r=c3.supported()?c3:l3;this.resizeService=new r(t,e,n),this.subscription=this.resizeService.resize.pipe(nF(1e3/(this.rateLimit||10))).subscribe(()=>{this.resizeService.acceptedSize||this.resize.emit()})}ngAfterViewChecked(){this.resizeService.checkChanges()}ngOnDestroy(){this.subscription.unsubscribe(),this.resizeService.destroy()}acceptSize(t){this.resizeService.acceptSize(t)}}return t.\u0275fac=function(e){return new(e||t)(to(h3),to(yl),to(ec))},t.\u0275cmp=Je({type:t,selectors:[["kendo-resize-sensor"]],inputs:{rateLimit:"rateLimit"},outputs:{resize:"resize"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})(),p3=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[h3]}),t})();function f3(t){return t.ownerDocument||t.document||t}var m3=t=>f3(t).defaultView,g3=t=>f3(t).documentElement;let y3=0;function v3(){if(!y3&&"undefined"!=typeof document){const t=document.createElement("div");t.style.cssText="overflow:scroll;overflow-x:hidden;zoom:1;clear:both;display:block",t.innerHTML="&nbsp;",document.body.appendChild(t),y3=t.offsetWidth-t.scrollWidth,document.body.removeChild(t)}return y3}function _3(t){const e=m3(t),n=g3(t),r={height:e.innerHeight,width:e.innerWidth};return n.scrollHeight-n.clientHeight>0&&(r.width-=v3()),r}var b3=t=>{let e=t.offsetParent;for(;e&&"static"===e.style.position;)e=e.offsetParent;return e||g3(t)},x3=t=>{let e=t.getBoundingClientRect(),{left:n,top:r}=e;return e.height||e.width||(e=(t=>{const{display:e,left:n,position:r}=t.style;t.style.display="",t.style.left="-10000px",t.style.position="absolute";const i=t.getBoundingClientRect();return t.style.display=e,t.style.left=n,t.style.position=r,i})(t)),{top:r,left:n,height:e.height,width:e.width}},w3=(t,e)=>{const n=[];let r=t.parentNode;for(;r&&(n.push(r),r!==e);)r=r.parentNode;return n};function S3(t){const e=g3(t),n=m3(t);return{x:n.pageXOffset||e.scrollLeft||0,y:n.pageYOffset||e.scrollTop||0}}var C3=t=>t===(t.ownerDocument||{}).body?S3(t):{x:t.scrollLeft,y:t.scrollTop};const D3=function(t,e,n){let r=0;return t+e>n&&(r=n-(t+e)),t<0&&(r=-t),r},I3=function({offset:t,size:e,anchorSize:n,viewPortSize:r,anchorAlignPoint:i,elementAlignPoint:a,margin:s}){let o=0;const l=2*s;if(a!==i&&"center"!==a&&"middle"!==a&&"center"!==i&&"middle"!==i){const a="top"===i||"left"===i;t<0&&a?(o=e+n+l,t+o+e>r&&(o=0)):t>=0&&!a&&(t+e>r&&(o+=-(n+e+l)),t+o<0&&(o=0))}return o};var k3=t=>{const e=[];let n=t.parentNode.firstElementChild;for(;n;)n!==t&&e.push(n),n=n.nextElementSibling;return e};const E3=["container"];function A3(t,e){}const T3=["*"],R3=(t,e)=>t||{height:0,left:e.left,top:e.top,width:0},M3=()=>"undefined"!=typeof window,N3=/auto|scroll/,O3=t=>(t=>`${t.style.overflow}${t.style.overflowX}${t.style.overflowY}`)(t)||(t=>{const e=window.getComputedStyle(t);return`${e.overflow}${e.overflowX}${e.overflowY}`})(t);function P3(t){let e,n=!1;return(...r)=>(n||(e=t(...r),n=!0),e)}const F3=P3(()=>{if(!r3()&&null!==document.body)return!1;const t=document.createElement("div");t.style.transform="matrix(10, 0, 0, 10, 0, 0)",t.innerHTML='<div style="position: fixed; top: 10px;">child</div>',document.body.appendChild(t);const e=10!==t.children[0].getBoundingClientRect().top;return document.body.removeChild(t),e}),L3=(t,e)=>t&&1!==e?{height:t.height/e,left:t.left/e,top:t.top/e,width:t.width/e}:t,z3=["font-size","font-family","font-stretch","font-style","font-weight","line-height"];let $3=(()=>{class t{addOffset(t,e){return{left:t.left+e.left,top:t.top+e.top}}addScroll(t,e){return function(t,e){return{top:t.top+e.y,left:t.left+e.x,height:t.height,width:t.width}}(t,e)}align(t){return(t=>{const{anchorRect:e,anchorAlign:n,elementRect:r,elementAlign:i,margin:a={}}=t,s=n.horizontal,o=n.vertical,l=i.horizontal,u=i.vertical;let c=a.horizontal||0,h=a.vertical||0,d=e.top,p=e.left;return"bottom"===o&&(d+=e.height),"center"!==o&&"middle"!==o||(d+=Math.round(e.height/2)),"bottom"===u&&(d-=r.height,h*=-1),"center"!==u&&"middle"!==u||(d-=Math.round(r.height/2),h*=-1),"right"===s&&(p+=e.width),"center"!==s&&"middle"!==s||(p+=Math.round(e.width/2)),"right"===l&&(p-=r.width,c*=-1),"center"!==l&&"middle"!==l||(p-=Math.round(r.width/2),c*=-1),{top:d+h,left:p+c}})(t)}boundingOffset(t){return(t=>{if(!t.getBoundingClientRect){const e=_3(t);return{bottom:e.height,left:0,right:e.width,top:0}}const{bottom:e,left:n,right:r,top:i}=t.getBoundingClientRect();return{bottom:e,left:n,right:r,top:i}})(this.nativeElement(t))}getFontStyles(t){const e=this.getWindow();if(!e||!t)return[];const n=e.getComputedStyle(this.nativeElement(t));return z3.map(t=>({key:t,value:n[t]}))}getWindow(){return M3()?window:null}hasOffsetParent(t){return!!t&&!!this.nativeElement(t).offsetParent}offset(t){return t?x3(this.nativeElement(t)):null}offsetAtPoint(t,e){if(!t)return null;const n=this.nativeElement(t),{left:r,top:i,transition:a}=n.style;n.style.transition="none",n.style.left=`${e.left}px`,n.style.top=`${e.top}px`;const s=x3(n);return n.style.left=r,n.style.top=i,n.style.transition=a,s}nativeElement(t){return t?t.nativeElement||t:null}position(t,e,n=1){return t&&e?((t,e,n=1)=>{const r=e?b3(e):null,{top:i,left:a,height:s,width:o}=((t,e)=>{const n=m3(t),r=n.getComputedStyle(t),i=x3(t),a=e||b3(t),s=t.ownerDocument;let o={top:0,left:0};if("fixed"!==r.position&&a!==s.body&&a!==s.documentElement){const t=n.getComputedStyle(a);o=x3(a),o.top+=parseInt(t.borderTopWidth,10),o.left+=parseInt(t.borderLeftWidth,10)}return{top:i.top-o.top,left:i.left-o.left,height:i.height,width:i.width}})(t,r),{x:l,y:u}=((t,e)=>t?C3(t):function(t){const e=b3(t);return e?C3(e):{x:0,y:0}}(e))(r,t),c=t.ownerDocument,h=r===c.body||r===c.documentElement?1:n;return{top:i+u*h,left:a+l*h,height:s,width:o}})(this.nativeElement(t),this.nativeElement(e),n):null}removeScroll(t,e){return function(t,e){return{top:t.top-e.y,left:t.left-e.x,height:t.height,width:t.width}}(t,e)}restrictToView(t){return(t=>{const{anchorRect:e,anchorAlign:n,elementRect:r,elementAlign:i,collisions:a,viewPort:s,margin:o={}}=t,{top:l,left:u,height:c,width:h}=r,{height:d,width:p}=s,f=o.horizontal||0,m=o.vertical||0;let g=0,y=0;const v="flip"===a.horizontal,_="flip"===a.vertical;"fit"===a.vertical&&(y+=D3(l,c,d)),"fit"===a.horizontal&&(g+=D3(u,h,p)),_&&(y+=I3({margin:m,offset:l,size:c,anchorSize:e.height,viewPortSize:d,anchorAlignPoint:n.vertical,elementAlignPoint:i.vertical})),v&&(g+=I3({margin:f,offset:u,size:h,anchorSize:e.width,viewPortSize:p,anchorAlignPoint:n.horizontal,elementAlignPoint:i.horizontal}));const b=v&&0!==g,x=_&&0!==y;return{flipped:b||x,flip:{horizontal:b,vertical:x},offset:{left:g,top:y}}})(t)}scrollPosition(t){return S3(this.nativeElement(t))}scrollableParents(t){return(t=>{const e=[];if(!r3()||!M3())return e;let n=t.parentElement;for(;n;)(N3.test(O3(n))||n.hasAttribute("data-scrollable"))&&e.push(n),n=n.parentElement;return e.push(window),e})(this.nativeElement(t))}stackingElementOffset(t){const e=this.getRelativeContextElement(t);return e?x3(e):null}stackingElementScroll(t){const e=this.getRelativeContextElement(t);return e?{x:e.scrollLeft,y:e.scrollTop}:{x:0,y:0}}getRelativeContextElement(t){if(!t||!F3())return null;let e=this.nativeElement(t).parentElement;for(;e;){if("none"!==window.getComputedStyle(e).transform)return e;e=e.parentElement}return null}useRelativePosition(t){return!!this.getRelativeContextElement(t)}windowViewPort(t){return _3(this.nativeElement(t))}zIndex(t,e){return((t,e)=>{if(!t||!r3()||!M3())return null;const n=((t,e)=>{const n=w3(t);let r,i,a=e;for(;a&&(r=k3(a),i=n.reduce((t,e)=>t.concat(r.filter(t=>t===e)),[])[0],!i);)a=a.parentElement;return i})(t,e);if(!n)return null;const r=[t].concat(w3(t,n)).reduce((t,e)=>{const n=e.style.zIndex||window.getComputedStyle(e).zIndex,r=parseInt(n,10);return r>t?r:t},0);return r?r+1:null})(this.nativeElement(t),this.nativeElement(e))}zoomLevel(){return r3()&&M3()&&parseFloat((document.documentElement.clientWidth/window.innerWidth).toFixed(2))||1}isZoomed(){return this.zoomLevel()>1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const B3=new _e("Popup Document Scale");let W3=(()=>{class t{constructor(t,e=1){this._dom=t,this.scale=e}alignElement(t){const{anchor:e,element:n,anchorAlign:r,elementAlign:i,margin:a,offset:s,positionMode:o}=t,l=this.scale||1,u="fixed"!==o&&this._dom.hasOffsetParent(n)?this.relativeRect(e,n,s,l):this.absoluteRect(e,n,s,l),c=L3(this._dom.offset(n),l);return this._dom.align({anchorAlign:r,anchorRect:u,elementAlign:i,elementRect:c,margin:a})}absoluteRect(t,e,n,r){const i=this.elementScrollPosition(t,e),a=R3(this._dom.offset(t),n),s=2*r,o=this._dom.stackingElementScroll(e);1!==r&&o&&(o.x/=s,o.y/=s);const l=this._dom.stackingElementOffset(e);return 1!==r&&l&&(l.left/=s,l.top/=s),this._dom.removeScroll(this._dom.addScroll(((t,e)=>e?{height:t.height,left:t.left-e.left,top:t.top-e.top,width:t.width}:t)(L3(a,r),l),o),i)}elementScrollPosition(t,e){return t?{x:0,y:0}:this._dom.scrollPosition(e)}relativeRect(t,e,n,r){const i=R3(this._dom.position(t,e,r),n);return L3(i,r)}}return t.\u0275fac=function(e){return new(e||t)(Ae($3),Ae(B3,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),q3=(()=>{class t{constructor(t,e=1){this._dom=t,this.scale=e}positionElement(t){const{anchor:e,currentLocation:n,element:r,anchorAlign:i,elementAlign:a,collisions:s,margin:o}=t,l=this._dom,u=this.scale||1,c=l.offsetAtPoint(r,n),h=L3(c,u),d=L3(l.offset(e),u),p=R3(d,n),f=t.viewPort||l.windowViewPort(r);f.width=f.width/u,f.height=f.height/u;const m=l.restrictToView({anchorAlign:i,anchorRect:p,collisions:s,elementAlign:a,elementRect:h,margin:o,viewPort:f}),g=l.addOffset(n,m.offset);return{flip:m.flip,flipped:m.flipped,offset:g}}}return t.\u0275fac=function(e){return new(e||t)(Ae($3),Ae(B3,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),V3=(()=>{class t{constructor(t,e){this._dom=t,this._zone=e}subscribe(t){r3()&&this._zone.runOutsideAngular(()=>{this.subscription=qP(this._dom.getWindow(),"resize").pipe(nF(1e3/60)).subscribe(()=>t())})}unsubscribe(){this.subscription&&this.subscription.unsubscribe()}isUnsubscribed(){return this.subscription&&this.subscription.closed}}return t.\u0275fac=function(e){return new(e||t)(Ae($3),Ae(ec))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),U3=(()=>{class t{constructor(t,e){this._dom=t,this._zone=e}forElement(t){return this.unsubscribe(),this.element=t,this}subscribe(t){if(!t||!r3()||!this.element)return;const e=this._dom.nativeElement(this.element),n=this._dom.scrollableParents(this.element);this._zone.runOutsideAngular(()=>{const r=n.map(t=>qP(t,"scroll").pipe(nF(1e3/60)));this.subscription=kt(...r).subscribe(r=>{const i=r.target,a=n.filter(t=>t===i).length>0,s=i===document,o=i===window;(a||s||o)&&t(this.isVisible(e,i))})})}unsubscribe(){this.subscription&&this.subscription.unsubscribe()}isVisible(t,e){const n=this._dom.boundingOffset(t),r=this._dom.boundingOffset(e);return!(1<r.top-n.bottom||1<n.top-r.bottom||1<n.left-r.right||1<r.left-n.right)}}return t.\u0275fac=function(e){return new(e||t)(Ae($3),Ae(ec))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const j3=function(){return{expand:t=>{const e="up"===t||"down"===t?"scaleY":"scaleX";let n;return n="down"===t?"top":"left"===t?"right":"right"===t?"left":"bottom",{start:{transform:`${e}(0)`,transformOrigin:n},end:{transform:`${e}(1)`}}},slide:t=>{const e="left"===t||"right"===t?"translateX":"translateY";return{start:{transform:`${e}(${"right"===t||"down"===t?-100:100}%)`},end:{transform:`${e}(0%)`}}},fade:()=>({start:{opacity:0},end:{opacity:1}}),zoom:()=>({start:{transform:"scale(0)"},end:{transform:"scale(1)"}})}}();let H3=(()=>{class t{constructor(t){this.animationBuilder=t,this.start=new cu,this.end=new cu}play(t,e,n){if(!this.flip||this.flip.horizontal!==n.horizontal||this.flip.vertical!==n.vertical){this.flip=n;const r=e.type||"slide",i=j3[r];if(i){const r=i(this.getDirection(n,e));this.playStates(t,r,e)}else if(ti())throw new Error(`Unsupported animation type: "${r}". The supported types are slide, expand, fade and zoom.`)}}ngOnDestroy(){this.stopPlayer()}playStates(t,e,n){this.stopPlayer();const r=n.duration||100,i=this.animationBuilder.build([JF(e.start),HF(`${r}ms ease-in`,JF(e.end))]),a=this.player=i.create(t);a.onDone(()=>{this.end.emit(),this.stopPlayer()}),this.start.emit(),a.play()}getDirection(t,e){let n=e.direction||"down";return t.horizontal&&("left"===n?n="right":"right"===n&&(n="left")),t.vertical&&("down"===n?n="up":"up"===n&&(n="down")),n}stopPlayer(){this.player&&(this.player.destroy(),this.player=null)}}return t.\u0275fac=function(e){return new(e||t)(Ae(UF))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})();const G3={left:-1e4,top:0};let J3=(()=>{class t{constructor(t,e,n,r,i,a,s,o,l){this.container=t,this._alignService=e,this.domService=n,this._positionService=r,this._resizeService=i,this._scrollableService=a,this.animationService=s,this._renderer=o,this._zone=l,this.animate=!0,this.anchorAlign={horizontal:"left",vertical:"bottom"},this.collision={horizontal:"fit",vertical:"flip"},this.popupAlign={horizontal:"left",vertical:"top"},this.copyAnchorStyles=!1,this.positionMode="fixed",this.offset=G3,this.anchorViewportLeave=new cu,this.close=new cu,this.open=new cu,this.positionChange=new cu,this.resolvedPromise=Promise.resolve(null),this.initialCheck=!0,this._renderer.addClass(t.nativeElement,"k-animation-container"),this.updateFixedClass()}ngOnInit(){this.reposition=this.reposition.bind(this),this._resizeService.subscribe(this.reposition),this.animationSubscriptions=this.animationService.start.subscribe(this.onAnimationStart.bind(this)),this.animationSubscriptions.add(this.animationService.end.subscribe(this.onAnimationEnd.bind(this))),this._scrollableService.forElement(this.anchor||this.container).subscribe(this.onScroll.bind(this)),this.currentOffset=G3,this.setZIndex(),this.copyFontStyles(),this.updateFixedClass()}ngOnChanges(t){t.copyAnchorStyles&&this.copyFontStyles(),t.positionMode&&this.updateFixedClass()}ngAfterViewInit(){this.reposition(),this.animate||this.resolvedPromise.then(()=>{this.onAnimationEnd()})}ngAfterViewChecked(){this.initialCheck?this.initialCheck=!1:this._zone.runOutsideAngular(()=>{this.unsubscribeReposition(),this.repositionSubscription=xt(this.resolvedPromise).subscribe(this.reposition)})}ngOnDestroy(){this.anchorViewportLeave.complete(),this.positionChange.complete(),this.close.emit(),this.close.complete(),this._resizeService.unsubscribe(),this._scrollableService.unsubscribe(),this.animationSubscriptions.unsubscribe(),this.unsubscribeReposition()}onResize(){this.reposition()}onAnimationStart(){this._renderer.removeClass(this.container.nativeElement,"k-animation-container-shown")}onAnimationEnd(){this._renderer.addClass(this.container.nativeElement,"k-animation-container-shown"),this.open.emit(),this.open.complete()}get currentOffset(){return this._currentOffset}set currentOffset(t){this.setContainerStyle("left",`${t.left}px`),this.setContainerStyle("top",`${t.top}px`),this._currentOffset=t}setZIndex(){this.anchor&&this.setContainerStyle("z-index",String(this.domService.zIndex(this.anchor,this.container)))}reposition(){if(!r3())return;const{flip:t,offset:e}=this.position();this.currentOffset&&!((t,e)=>{const{left:n,top:r}=t,{left:i,top:a}=e;return Math.abs(n-i)>=1||Math.abs(r-a)>=1})(this.currentOffset,e)||(this.currentOffset=e,i3(this.positionChange)&&this._zone.run(()=>this.positionChange.emit({offset:e,flip:t}))),this.animate&&this.animationService.play(this.contentContainer.nativeElement,this.animate,t),this.resizeSensor.acceptSize()}position(){const t=this._alignService.alignElement({anchor:this.anchor,anchorAlign:this.anchorAlign,element:this.container,elementAlign:this.popupAlign,margin:this.margin,offset:this.offset,positionMode:this.positionMode});return this._positionService.positionElement({anchor:this.anchor,anchorAlign:this.anchorAlign,collisions:this.collision,currentLocation:t,element:this.container,elementAlign:this.popupAlign,margin:this.margin})}onScroll(t){const e=i3(this.anchorViewportLeave);t||!e?this.reposition():e&&this._zone.run(()=>{this.anchorViewportLeave.emit()})}copyFontStyles(){this.anchor&&this.copyAnchorStyles&&this.domService.getFontStyles(this.anchor).forEach(t=>this.setContainerStyle(t.key,t.value))}updateFixedClass(){this._renderer["fixed"===this.positionMode?"addClass":"removeClass"](this.container.nativeElement,"k-animation-container-fixed")}setContainerStyle(t,e){this._renderer.setStyle(this.container.nativeElement,t,e)}unsubscribeReposition(){this.repositionSubscription&&this.repositionSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(to(yl),to(W3),to($3),to(q3),to(V3),to(U3),to(H3),to(xl),to(ec))},t.\u0275cmp=Je({type:t,selectors:[["kendo-popup"]],viewQuery:function(t,e){var n;1&t&&(Su(E3,!0),Su(d3,!0)),2&t&&(xu(n=Eu())&&(e.contentContainer=n.first),xu(n=Eu())&&(e.resizeSensor=n.first))},inputs:{animate:"animate",anchorAlign:"anchorAlign",collision:"collision",popupAlign:"popupAlign",copyAnchorStyles:"copyAnchorStyles",positionMode:"positionMode",offset:"offset",anchor:"anchor",popupClass:"popupClass",margin:"margin"},outputs:{anchorViewportLeave:"anchorViewportLeave",close:"close",open:"open",positionChange:"positionChange"},exportAs:["kendo-popup"],features:[pl([W3,H3,$3,q3,V3,U3]),rl],ngContentSelectors:T3,decls:5,vars:4,consts:[[1,"k-popup",3,"ngClass"],["container",""],[3,"ngTemplateOutlet","ngIf"],[3,"rateLimit","resize"]],template:function(t,e){1&t&&(xo(),ao(0,"div",0,1),wo(2),Ys(3,A3,0,0,"ng-template",2),ao(4,"kendo-resize-sensor",3),fo("resize",(function(){return e.onResize()})),so(),so()),2&t&&(ro("ngClass",e.popupClass),Hi(3),ro("ngTemplateOutlet",e.content)("ngIf",e.content),Hi(1),ro("rateLimit",100))},directives:[eh,ph,ah,d3],encapsulation:2}),t})();const X3=new _e("Popup Container");let K3=(()=>{class t{constructor(t,e,n,r){this.applicationRef=t,this.componentFactoryResolver=e,this.injector=n,this.container=r}get rootViewContainer(){const t=this.applicationRef.components||[];if(t[0])return t[0];throw new Error("\n            View Container not found! Inject the POPUP_CONTAINER or define a specific ViewContainerRef via the appendTo option.\n            See http://www.telerik.com/kendo-angular-ui/components/popup/api/POPUP_CONTAINER/ for more details.\n        ")}get rootViewContainerNode(){return this.container?this.container.nativeElement:this.getComponentRootNode(this.rootViewContainer)}open(t={}){const{component:e,nodes:n}=this.contentFrom(t.content),r=this.appendPopup(n,t.appendTo),i=r.instance;this.projectComponentInputs(r,t),r.changeDetectorRef.detectChanges(),e&&e.changeDetectorRef.detectChanges();const a=this.getComponentRootNode(r);return{close:()=>{var t;e&&e.destroy(),r.destroy(),(t=a)&&t.parentNode&&t.parentNode.removeChild(t)},content:e,popup:r,popupAnchorViewportLeave:i.anchorViewportLeave,popupClose:i.close,popupElement:a,popupOpen:i.open,popupPositionChange:i.positionChange}}appendPopup(t,e){const n=this.createComponent(J3,t,e);return e||this.rootViewContainerNode.appendChild(this.getComponentRootNode(n)),n}getComponentRootNode(t){return t.location.nativeElement}getComponentFactory(t){return this.componentFactoryResolver.resolveComponentFactory(t)}createComponent(t,e,n){const r=this.getComponentFactory(t);if(n)return n.createComponent(r,void 0,this.injector,e);{const t=r.create(this.injector,e);return this.applicationRef.attachView(t.hostView),t}}projectComponentInputs(t,e){return Object.getOwnPropertyNames(e).filter(t=>"content"!==t||e.content instanceof Wl).map(n=>{t.instance[n]=e[n]}),t}contentFrom(t){if(!t||t instanceof Wl)return{component:null,nodes:[[]]};const e=this.createComponent(t);return{component:e,nodes:[e?[e.location.nativeElement]:[]]}}}return t.\u0275fac=function(e){return new(e||t)(Ae(xc),Ae(gl),Ae(Fs),Ae(X3,8))},t.\u0275prov=jt({token:t,factory:t.\u0275fac}),t})(),Z3=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[K3],imports:[[fh,p3]]}),t})(),Y3=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)}}),t})(),Q3=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,Y3]]}),t})(),t9=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh]]}),t})(),e9=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,Z3,Y3,t9],t9]}),t})(),n9=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh,Z3,t9,Y3],t9]}),t})(),r9=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[[fh]]}),t})(),i9=(()=>{class t{}return t.\u0275mod=Ye({type:t}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},imports:[Q3,Y3,e9,n9,r9]}),t})(),a9=(()=>{class t{}return t.\u0275mod=Ye({type:t,bootstrap:[Y1]}),t.\u0275inj=Ht({factory:function(e){return new(e||t)},providers:[],imports:[[Hh,X1,Oq,Uq,yU,t2,TB,e2,r2,i2,a2,TB,s2,o2,t2,c2,f2,T2,k2,R2,N2,O2,yU,Uq,P2,z2,L$,V2,U2,W1,e2,J$,eU,SB,bj,H2,G2,K2,Y2,cj,Q2,B2,n3,d$,E1,SP,QW,i9]]}),t})();(function(){if(Qr)throw new Error("Cannot enable prod mode after platform setup.");Yr=!1})(),Uh().bootstrapModule(a9).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);